<!DOCTYPE html>
<html lang="fi" xml:lang="fi">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä." />
<meta name="github-repo" content="hirjus/capaper" />

<meta name="author" content="Jussi Hirvonen" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä.">

<title>Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/navigation-1.1/codefolding.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="#alkutoimia">Alkutoimia</a></li>
<li class="has-sub"><a href="#johdanto"><span class="toc-section-number">1</span> Johdanto</a><ul>
<li><a href="#tutkielman-tavoite-ja-toteutus"><span class="toc-section-number">1.1</span> Tutkielman tavoite ja toteutus</a></li>
<li><a href="#korrespondenssianalyysin-historiaa"><span class="toc-section-number">1.2</span> Korrespondenssianalyysin historiaa</a></li>
<li><a href="#tutkielman-rakenne"><span class="toc-section-number">1.3</span> Tutkielman rakenne</a></li>
<li><a href="#tärkeimmät-lähteet"><span class="toc-section-number">1.4</span> Tärkeimmät lähteet</a></li>
</ul></li>
<li class="has-sub"><a href="#data"><span class="toc-section-number">2</span> Data</a><ul>
<li><a href="#aineiston-rajaaminen"><span class="toc-section-number">2.1</span> Aineiston rajaaminen</a></li>
</ul></li>
<li class="has-sub"><a href="#yksinkertainen-korrespondenssianalyysi"><span class="toc-section-number">3</span> Yksinkertainen korrespondenssianalyysi</a><ul>
<li><a href="#äiti-töissä---kärsiikö-lapsi"><span class="toc-section-number">3.1</span> Äiti töissä - kärsiikö lapsi?</a></li>
<li><a href="#symmetrinen-kartta"><span class="toc-section-number">3.2</span> Symmetrinen kartta</a></li>
<li><a href="#asymmetrinen-kartta-ja-ideaalipisteet"><span class="toc-section-number">3.3</span> Asymmetrinen kartta ja ideaalipisteet</a></li>
<li><a href="#kontribuutiot-kartalla"><span class="toc-section-number">3.4</span> Kontribuutiot kartalla</a></li>
<li><a href="#massat"><span class="toc-section-number">3.5</span> Massat</a></li>
<li><a href="#karttojen-erot"><span class="toc-section-number">3.6</span> Karttojen erot</a></li>
</ul></li>
<li class="has-sub"><a href="#täydentävät-pisteet"><span class="toc-section-number">4</span> Täydentävät pisteet</a><ul>
<li><a href="#saksan-ja-belgian-alueet"><span class="toc-section-number">4.1</span> Saksan ja Belgian alueet</a></li>
<li><a href="#korrespondenssianalyysin-numeeriset-tulokset"><span class="toc-section-number">4.2</span> Korrespondenssianalyysin numeeriset tulokset</a></li>
<li><a href="#esimerkki-kolmiulotteisesta-kartasta"><span class="toc-section-number">4.3</span> Esimerkki kolmiulotteisesta kartasta</a></li>
</ul></li>
<li class="has-sub"><a href="#yhteisvaikutusmuuttujat"><span class="toc-section-number">5</span> Yhteisvaikutusmuuttujat</a><ul>
<li><a href="#ikä-ja-sukupuoli"><span class="toc-section-number">5.1</span> Ikä ja sukupuoli</a></li>
<li><a href="#ikä-sukupuoli-ja-maa"><span class="toc-section-number">5.2</span> Ikä, sukupuoli ja maa</a></li>
<li><a href="#stabiilisuus"><span class="toc-section-number">5.3</span> Stabiilisuus</a></li>
</ul></li>
<li><a href="#osajoukon-korrespondenssianalyysi"><span class="toc-section-number">6</span> Osajoukon korrespondenssianalyysi</a></li>
<li class="has-sub"><a href="#monimuuttujakorrespondenssianalyysi-mca"><span class="toc-section-number">7</span> Monimuuttujakorrespondenssianalyysi (MCA)</a><ul>
<li><a href="#pinotut-ja-yhdistetyt-taulukot"><span class="toc-section-number">7.1</span> Pinotut ja yhdistetyt taulukot</a></li>
<li><a href="#monimuuttujakorrespondenssianalyysi-mca-1"><span class="toc-section-number">7.2</span> Monimuuttujakorrespondenssianalyysi (MCA)</a></li>
</ul></li>
<li><a href="#yhteenveto"><span class="toc-section-number">8</span> Yhteenveto</a></li>
<li><a href="#lähteet">Lähteet</a></li>
<li class="appendix"><span><b>Liitteet</b></span></li>
<li class="has-sub"><a href="#liite-1-korrespondenssianalyysin-teoriaa">Liite 1: Korrespondenssianalyysin teoriaa</a><ul>
<li><a href="#korrespondenssianalyysin-perusyhtälöt-ja-kaavat">Korrespondenssianalyysin perusyhtälöt ja kaavat</a></li>
</ul></li>
<li><a href="#liite-2-tekninen-ympäristö-ja-bookdown-paketti">Liite 2: Tekninen ympäristö ja Bookdown-paketti</a></li>
<li><a href="#liite-3-r---koodi">Liite 3: R - koodi</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="header">
<h1 class="title">Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä</h1>
<h4 class="author"><em>Jussi Hirvonen</em></h4>
<h4 class="date"><em>Versio 2.0, tulostettu 2020-11-29</em></h4>
</div>
<div id="alkutoimia" class="section level1 unnumbered">
<h1>Alkutoimia</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># testaukseen 7.11.2020 virheilmoituksia varten arvo TRUE</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">options</span>(<span class="dt">tinytex.verbose =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><strong>29.11.2020 Oikoluettu valmis versio</strong></p>
<p><strong>Tämä luku poistetaan kun tutkielma on valmis</strong></p>
<p><strong>Raportti yhtenä html-tiedostona</strong> (<a href="https://hirjus.github.io/capaper/JH_capaper.html" class="uri">https://hirjus.github.io/capaper/JH_capaper.html</a>)</p>
<p><strong>PDF-tulostus oikuttelee ja kaatuu, mutta pdf-syntyy</strong>. MikTeX vaihdettu TinyTeX-engineen
ja pdflatex -&gt; xelatex (15.11.20). PDF-tulostus kaatuu <strong>luultavasti</strong> koodilistaukseen.
Pandoc ei osaa rivittää koodia oikein tms. Koodilistauksen poistaminen ei auta, syystä tai toisesta.</p>
<p><strong>Suunnitelma: PDF html-raportista -&gt; pdfExchange-ohjelmalla sivunumerot ja kansilehdet</strong></p>
<p><strong>22.11.2020 luonnos kansilehdeksi, sisällysluetteloksi ja tiivistelmän aihio</strong></p>
<p>(<a href="https://hirjus.github.io/capaper/GraduKansilehti1.pdf" class="uri">https://hirjus.github.io/capaper/GraduKansilehti1.pdf</a>)
(<a href="https://hirjus.github.io/capaper/wordTOC.pdf" class="uri">https://hirjus.github.io/capaper/wordTOC.pdf</a>)
(<a href="https://hirjus.github.io/capaper/GtiivisTesti1.pdf" class="uri">https://hirjus.github.io/capaper/GtiivisTesti1.pdf</a>)</p>
<p>Tiivistelmästä löytyy uudempi pohja, jota käytetään.</p>
<p>RefWorksistä tuotu jhca2020.bib-tiedosto tarkistettu ja korjailtu virheet. Ei enään ladata uutta (21.11.2020),
packages.bib (r-pakettien viitekanta) tarkistettu ja korjattu erikoismerkit. Ei päivitetä enään (24.11.20)</p>
<p>Data-analyysi: (<a href="https://hirjus.github.io/Galku" class="uri">https://hirjus.github.io/Galku</a>).</p>

</div>
<div id="johdanto" class="section level1">
<h1><span class="header-section-number">Luku 1</span> Johdanto</h1>
<p>Korrespondenssianalyysi on deskriptiivinen data-analyysin menetelmä, joka
soveltuu erityisesti luokitteluasteikon muuttujien yhteyksien analyysiin.
Yksinkertainen esimerkki on kahden luokittelumuuttuja taulukko. Yksinkertainen
korrespondenssianalyysi esittää taulukon rivien ja sarakkeiden riippuvuuden
graafisesti, kaksiulotteisena karttana. Kahden muuttujan analyysin perusideat
soveltuvat myös useamman muuttujan yhteyksien kuvaamiseen.</p>
<p>Taulukoita on kaikkialla, mutta niiden graafinen analyysi ei ole kovin yleistä.</p>
<div id="tutkielman-tavoite-ja-toteutus" class="section level2">
<h2><span class="header-section-number">1.1</span> Tutkielman tavoite ja toteutus</h2>
<p>Tämän tutkielman tavoite on esittää korrespondenssianalyysin periaatteet
data-analyysin sovellusten avulla. Tutustuin aiheeseen Michael Greenacren
luennoilla Helsingissä keväällä 2017.
Aivan huomaamatta tein harjoitustehtävinä karttoja, joita en oikein ymmärtänyt.</p>
<p>Pyrin esittelemään menetelmän niin, että data-analyysistä kiinnostunut lukija
oivaltaa karttojen tulkinnan perusperiaatteet. Tilastotieteessä on aina ollut
osana käytännöllinen, soveltajille suunnattu menetelmien esittely. En kirjoita
kuitenkaan oppikirjaa, vaan tutkielman, jossa esittelen aineiston analyysin
avulla menetelmää. Analyysien r-koodi on vapaasti saatavilla verkossa, kuten
tämän tutkielman käsikirjoitus.</p>
<p>En etsi datasta vastauksia joihinkin substanssikysymyksiin vaan havainnollistan
menetelmän mahdollisuuksia datan analyysissä. Tavoitteena on myös oman
ymmärryksen lisääminen.</p>
<p>Tutkielman toteutus on rakennettu kolmelle perusajatukselle.</p>
<p>Yksinkertainen kahden luokittelumuuttujan korrespondenssianalyysi antaa graafisen
analyysin ”…perussäännöt tulkinnalle. Kaikki muut korrespondenssianalyysin
muodot ovat saman algoritmin soveltamista toisen tyyppisiin datamatriiseihin,
ja tulkintaa sovelletaan vastaavasti (with the consequent adaptation of the
interpretation)”(<span class="citation">Greenacre ja Hastie (<a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664d84" role="doc-biblioref">1987</a>)</span> s. 437). Tutkielman laajin
osa on yksinkertaisen korrespondenssianalyysin tulosten ja peruskäsitteiden
esittelyä.</p>
<p>Toiseksi käytän laajaa ja laadukasta kansainvälisen haastattelututkimuksen aineistoa.
Korrespondenssianalyysi sopii survey-aineistojen analyysiin mainiosti, ja samaa
dataa on käytetty alan oppikirjoissa ja artikkeleissa esimerkkiaineistona.
Laaja ja mutkikas aineisto antaa oikean kuvan data-analyysistä ja samalla ohjaa
analyysin kulkua. Data yllättää aina. Menetelmän on taivuttava tarvittaessa
uusiin suuntiin. Tutkielman data-analyysissä jouduin moneen kertaan miettimään
mihin suuntaan kannattaisi edetä. Datan analyysi tuo esiin sen ominaisuuksia,
vaikka mitään sisällöllistä tutkimusongelmaa ei ole määritelty.</p>
<p>Kolmanneksi keskityn graafiseen analyysiin, kuvien tulkintaan.
Korrespondenssianalyysin idea on esittää mutkikkaat riippuvuudet ja yhteydet
kuvana. Samalla tavoite on tiivistää moniulotteisen datan informaatiosta
mahdollisimman paljon kaksiulotteiselle kartalle. Informaatiota menetetään,
ja tulkinnan varmistaminen numeerisista tuloksista estää virhepäätelmät. Kartan
lukeminen ei ole aivan helppoa, mutta perussäännöt ovat melko selkeät.
Graafinen data-analyysi on tasapainoilua datan analyysin ja tulosten esittämisen
välillä. Tässä painottuu data-analyysi, ei vaativa viimeisteltyjen
graafisten esitysten suunnittelu ja toteutus. Graafinen data-analyysi
ei aina ole helppoa ja nopeaa.</p>
</div>
<div id="korrespondenssianalyysin-historiaa" class="section level2">
<h2><span class="header-section-number">1.2</span> Korrespondenssianalyysin historiaa</h2>
<p>Korrespondenssianalyysi on 80-luvun alusta vähitellen vakiinnuttanut asemansa
yhtenä ei-parametrisen kuvailevan data-analyysin menetelmänä. Kansainvälinen
tutkijaverkosto CARME (Correspondence analysis and related methods network)
järjesti ensimmäisen konferenssin 1991 (<a href="http://www.carme-n.org" class="uri">http://www.carme-n.org</a>).</p>
<p>Korrespondenssianalyysi esitellään oppikirjoissa muiden menetelmien rinnalla.
Hyviä esimerkkejä ovat ekologisen datan monimuuttujamenetelmien <span class="citation">(M. Greenacre ja Primicerio <a href="#ref-RefWorks:doc:5b8175eee4b08da192f99a35" role="doc-biblioref">2013</a>)</span>,
kaksoiskuvien <span class="citation">(Greenacre <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d7c" role="doc-biblioref">2010</a>)</span> ja
“koostumusdatan” (compositional data) <span class="citation">(Greenacre <a href="#ref-RefWorks:doc:5f934955e4b08d20366a5bd1" role="doc-biblioref">2018</a>)</span>
kirjat. Suomessa korrespondenssianalyysi esitellään ainakin kahdessa oppikirjassa
(<span class="citation">Mustonen (<a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664d95" role="doc-biblioref">1995</a>)</span> , <span class="citation">Vehkalahti (<a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664da4" role="doc-biblioref">2008</a>)</span>).</p>
<p>Korrespondenssianalyysi ja koulukunta syntyi ja vakiintui Ranskassa Jean - Paul Benzecrin
(1932-2019) ympärille 60-luvulla. 70-luku oli “loistavan eristyksen” aikaa,
“Analyse des Donnees” -liikkeen kultainen kausi Ranskassa mutta ei muualla.
Vasta 80-luvulla menetelmä ylitti kielimuurin, ehkä osittain menetelmää
soveltaneen sosiologi Pierre Bourdieun kansainvälisesti tunnettujen tutkimusten
ansiosta. Benzecrin oppilaista Greenacre on oppikirjoillaan vaikuttanut paljon
menetelmän vakiinnuttamiseen osaksi tilastotieteen perustekniikoita. Näiden
kirjojen kansissa ei turhaan lue “…in practice”.</p>
<p>Toisena muurina on pidetty ranskalaisen koulukunnan tiukkaa “bourbakilaista”
matemaattista esitystapaa. <span class="citation">LeRoux ja Rouanet (<a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>)</span> esittelevät tämän
lähestymistavan englanniksi. Lyhyt historiallinen katsaus
ja menetelmä soveltamisen perusajatusten esittely
valaisevat ranskaa taitamattomalle data-analyysin koulukunnan ideoita.
Kirjassa esitellään myös perusteellisesti muutama empiirinen tutkimus.</p>
<p>Tarina on kiinnostava ja tärkeäkin osa tieteenhistoriaa, mutta eristys on päättynyt.</p>
</div>
<div id="tutkielman-rakenne" class="section level2">
<h2><span class="header-section-number">1.3</span> Tutkielman rakenne</h2>
<p>Datan esittelyn jälkeen esitellään korrespondenssianalyysin peruskäsitteet
yksikertaisen esimerkinavulla luvussa 3.</p>
<p>Luvuissa 4 - 5 analyysiin lisätään täydentäviä pisteitä tulkinnan tueksi
ja muodostetaan luokittelumuuttujien yhteisvaikutusmuuttujia (ikä ja sukupuoli).</p>
<p>Kolmen muuttujan yhteisvaikutusmuuttujan (maa, sukupuoli ja ikäluokka) analyysi
tehdään osajoukon korrespondenssianalyysillä luvussa 6.</p>
<p>Luvussa 7 esitellään lyhyesti kaksi tapaa tutkia useamman muuttujan yhteyksiä.
Taulukoita yhdistämällä voidaan analysoida <em>kahden muuttujaryhmän välisiä yhteyksiä</em>.
Monimuuttujakorrespondenssianalyysia (MCA) sovelletaan isoon aineistoon ja tällaisten
aineistojen yleiseen ongelmaan, puuttuviin tietoihin. Menetelmällä tutkitaan
<em>yhden muuttujajoukon sisäisiä yhteyksiä</em>.</p>
<p>Luvussa 8 kerrotaan, mistä alettiin ja mitä tuloksia saatiin.</p>
<p>Tutkielmassa on kolme liitettä.</p>
<p>Liite 1 esittelee tiiviisti menetelmän teorian.
Korrespondenssianalyysin numeerisia tuloksia havainnollistetaan kuvalla, ja
monimuuttujakorrespondenssianalyysin (MCA) käsitteitä esitellään hieman enemmän.
MCA:n teoriaa ei käsitellä laajemmin, mutta tulkinnan ongelmat esitellään lyhyesti.</p>
<p>Tutkielma on tehty R-tilastohjelmalla, ja korrespondenssianalyyseissä on käytetty
ca-pakettia( <span class="citation">Nenadic ja Greenacre (<a href="#ref-ca2007" role="doc-biblioref">2007</a>)</span> ).</p>
<p>Tutkielman koodi on julkaistu Github-palvelussa (<a href="https://github.com/hirjus/capaper" class="uri">https://github.com/hirjus/capaper</a>),
samoin tutkielman käsikirjoitus ( <a href="https://hirjus.github.io/capaper/" class="uri">https://hirjus.github.io/capaper/</a> )
ja alustava data-analyysi.</p>
<p>Tekninen ympäristö on kuvattu tarkemmin liitteessä 2, myös sen ongelmat.</p>
<p>Liitteessä 3 on listattu tutkielman R-koodi.</p>
</div>
<div id="tärkeimmät-lähteet" class="section level2">
<h2><span class="header-section-number">1.4</span> Tärkeimmät lähteet</h2>
<p>Tutkielman tärkein lähde on <span class="citation">(M. J. Greenacre <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d78" role="doc-biblioref">2017</a>)</span> (jatkossa CAiP),
ja muitakin saman tekijän artikkeleita on käytetty paljon. Kevään 2017
kurssimateriaali<span class="citation">(M. Greenacre <a href="#ref-RefWorks:doc:5b6ef091e4b0984fd9b8c0ca" role="doc-biblioref">2017</a>)</span> ja laskuharjoitusten koodi
on ollut hyödyllinen pikaopas peruskäsitteisiin ja r-toteutuksen ratkaisuihin.</p>
<p>Carme-verkoston kolmas artikkelikokoelma<span class="citation">(M. Greenacre ja Blasius <a href="#ref-RefWorks:doc:5ab76b43e4b003f4468d1f07" role="doc-biblioref">2006</a>)</span>
on ajantasainen perusteos. Perusteelliset artikkelit kattavat myös
korrespondenssianalyysin tärkeimmät aiheet.</p>
<p>Data on ensin luettava ohjelman ymmärtämään muotoon, ja erilaiset muunnokset kannattaa
tehdä heti kun data luetaan. <span class="citation">McNamara ja Horton (<a href="#ref-RefWorks:doc:5c3759c2e4b0085b307c82b5" role="doc-biblioref">2018</a>)</span> kertovat,
miten luokittelumuuttujia pitää R-koodissa käsitellä.</p>

</div>
</div>
<div id="data" class="section level1">
<h1><span class="header-section-number">Luku 2</span> Data</h1>
<p>Käytän tutkielmassa International Social Survey - projektin (ISSP) vuoden 2012
kyselytutkimusta “Perhe, työ ja sukupuoliroolit” (International Social Survey
Programme: Family and Changing Gender Roles IV). Tutkimuksen aikaisempien
toteutusten dataa on käytetty tutkielman tärkeimmissä lähteissä esimerkkidatana.</p>
<p>Länsi-Saksan ja USA:n tutkimuslaitosten yhteistyö vakiintui ISSP-organisaatioksi
1984 (<a href="http://www.issp.org" class="uri">http://www.issp.org</a>). Vuonna 2015 neljän perustajajäsenen joukko oli kasvanut 49 maahan.
Vertailevan tutkimuksen aineistoja on kerätty monista teemoista, perhearvoista
ja naisten työmarkkina-asemasta neljä kertaa (1988, 1994,2002,2012).
USA:n edustajana mukana ollut Tom W. Smith näkee aineistojen arvon juuri
kansainvälisessä vertailevassa tutkimuksessa. Järjestön julkaisuluettelossa oli
2012 yli 5200 julkaisua. Viime vuosina luetteloon on lisätty noin 400 julkaisua
vuodessa <span class="citation">(Smith <a href="#ref-RefWorks:doc:5c0543a5e4b077eba1dc3cd8" role="doc-biblioref">2015</a>)</span>.</p>
<p>Data ja dokumentaatio on vapaasti saatavilla saksalaisen GESIS-tutkimuslaitoksen
ylläpitämästä data-arkistosta
(<a href="https://www.gesis.org/en/issp/home" class="uri">https://www.gesis.org/en/issp/home</a>). Suomessa tutkimuksen data ja dokumentaatio
löytyvät Tampereen yliopiston Aila-tietoarkistosta
(<a href="https://services.fsd.uta.fi/catalogue/FSD2820?tab=summary&amp;study_language=fi" class="uri">https://services.fsd.uta.fi/catalogue/FSD2820?tab=summary&amp;study_language=fi</a>).</p>
<p>GESIS-instituutin ”datakatalogista”(<a href="https://zacat.gesis.org" class="uri">https://zacat.gesis.org</a>)
löytää kätevästi kaiken dokumentaation ja datan<span class="citation">(ISSP <a href="#ref-RefWorks:doc:5b6c7f6ce4b0e4e15164ab1a" role="doc-biblioref">2016</a>)</span>,
mutta edes saksalaiset eivät voi estää www-sivustojen innokkaita uudistajia.
Monet linkit lähdeluettelossa vievät GESIS-arkistosivulle,
josta löytyy pitkä lista pdf-dokumentteja.</p>
<p>Taulukkoon <a href="#tab:ISSPdocsTable">2.1</a> on koottu neljän tärkeimmän dokumentin
tiedostonimet ja lyhyt kuvaus.</p>
<table>
<caption><span id="tab:ISSPdocsTable">Taulukko 2.1: </span> ISSP 2012: tärkeimmät dokumentit</caption>
<colgroup>
<col width="21%" />
<col width="36%" />
<col width="42%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">dokumentti</th>
<th align="left">sisältö</th>
<th align="left">tiedosto</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Variable Report</td>
<td align="left">Perusdokumentti, muuttujien kuvaukset ja taulukot</td>
<td align="left">ZA5900_cdb.pdf</td>
</tr>
<tr class="even">
<td align="left">Study Monitoring Report</td>
<td align="left">tiedokeruun toteutus eri maissa</td>
<td align="left">ZA5900_mr.pdf</td>
</tr>
<tr class="odd">
<td align="left">Basic Questionnaire</td>
<td align="left">Maittain sovellettava kyselylomake</td>
<td align="left">ZA5900_bq.pdf</td>
</tr>
<tr class="even">
<td align="left">Contents of ISSP 2012 module</td>
<td align="left">substanssikysymykset taulukkona</td>
<td align="left">ZA5900_overview.pdf</td>
</tr>
<tr class="odd">
<td align="left">Questionnaire Development</td>
<td align="left">kyselylomakkeen laatiminen</td>
<td align="left">ssoar-2014-scholz_et_al-ISSP_2012_Family_and_Changing.pdf</td>
</tr>
</tbody>
</table>
<p>Tätä kirjoittaessa (10.11.2020) ISSP 2012 - aineisto löytyy osoitteesta
[<a href="https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900" class="uri">https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900</a>].</p>
<p>Koodikirja (“Variable report”) <span class="citation">(GESIS <a href="#ref-RefWorks:doc:5bb9041be4b06677e5e61f83" role="doc-biblioref">2016</a>)</span> selostaa
tarkasti tietosisällön. Tutkimuksen seurantaraportti (“Study Monitoring Report”)
<span class="citation">(Gendall ja Randow <a href="#ref-RefWorks:doc:5c053d69e4b0191a580d6451" role="doc-biblioref">2016</a>)</span> kertoo miten tutkimus käytännössä
toteutettiin. Kyselylomake <span class="citation">(”ISSP 2012 - Family and Changing Gender Roles IV Basic Questionnaire” <a href="#ref-RefWorks:doc:5bb9044fe4b0dfeb95352229" role="doc-biblioref">2011</a>)</span>,
suomenkielinen versio <span class="citation">(Tilastokeskus <a href="#ref-RefWorks:doc:5bb90a0ae4b018435936a488" role="doc-biblioref">2012</a>)</span> ja muut
kieliversiot voivat olla hyödyllisiä. Tiedonkeruun tarkoitus ja kyselyn
suunnittelun ideat kerrotaan omassa raportissa <span class="citation">(Scholz ym. <a href="#ref-RefWorks:doc:5f9439fde4b04741789a2187" role="doc-biblioref">2014</a>)</span>.</p>
<div id="aineiston-rajaaminen" class="section level2">
<h2><span class="header-section-number">2.1</span> Aineiston rajaaminen</h2>
<p>Olen valinnut laajasta aineistosta 25 maata ja joukon muuttujia. Maat on valittu
niin, että ne ovat suhteellisen samankaltaisia ja valitut muuttujat ovat niissä
samanlaisia. Kysymyksissä on jonkin verran pieniä eroja, mutta joissain
tapauksissa ero on merkittävä. Esimerkiksi Espanja on jostain syystä jättänyt
tässä käytetyistä muuttujista ns. neutraalin (”en samaa enkä eri mieltä”)
vastausvaihtoehdon pois, joten Espanja jää pois.</p>
<p>Substanssimuuttujat ovat yksi ”kysymyspatteri”, jolla luodataan asenteita
naisten roolista työmarkkinoilla. Aiheen pysyvää ajankohtaisuutta kuvaa hyvin
The Economist - lehden artikkeli Saksojen jälleenyhdistymisen 30-vuotispäivänä
(3.10.2020, “A report…reveals the interplay between policy and attitudes that
influences the decision to work.”).
Artikkeli on maksumuurin takana mutta tutkimus on vapaasti luettavissa
<a href="https://www.diw.de/de/diw_01.c.799302.de/publikationen/weekly_reports/2020_38_1/mothers_in_eastern_and_western_germany__employment_rates_and_attitudes_are_converging__full-time_employment_is_not.html">(DIW Weekly Report 38 / 2020, S. 403-410)</a></p>
<p>Taulukon <a href="#tab:vartable1">2.2</a> kysymysten lyhyet versiot ovat datassa mukana.
Sarakkeessa “muuttuja” on alkuperäisen aineiston muuttujanimi,
kysymyksen tunnus on valittuun dataan luotu muuttujanimi.</p>
<table>
<caption><span id="tab:vartable1">Taulukko 2.2: </span>ISSP2012:Työelämä ja perhearvot - kysymykset</caption>
<colgroup>
<col width="9%" />
<col width="90%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">muuttuja</th>
<th align="left">kysymyksen tunnus, lyhennetty kysymys</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">V5</td>
<td align="left">Q1a Working mother can have warm relation with child</td>
</tr>
<tr class="even">
<td align="left">V6</td>
<td align="left">Q1b Pre-school child suffers through working mother</td>
</tr>
<tr class="odd">
<td align="left">V7</td>
<td align="left">Q1c Family life suffers through working mother</td>
</tr>
<tr class="even">
<td align="left">V8</td>
<td align="left">Q1d Women’s preference: home and children</td>
</tr>
<tr class="odd">
<td align="left">V9</td>
<td align="left">Q1e Being housewife is satisfying</td>
</tr>
<tr class="even">
<td align="left">V10</td>
<td align="left">Q2a Both should contribute to household income</td>
</tr>
<tr class="odd">
<td align="left">V11</td>
<td align="left">Q2b Men’s job is earn money, women’s job household</td>
</tr>
<tr class="even">
<td align="left">V12</td>
<td align="left">Q3a Should women work: Child under school age</td>
</tr>
<tr class="odd">
<td align="left">V13</td>
<td align="left">Q3b Should women work: Youngest kid at school</td>
</tr>
<tr class="even">
<td align="left">SEX</td>
<td align="left">Respondents age</td>
</tr>
<tr class="odd">
<td align="left">AGE</td>
<td align="left">Respondents gender</td>
</tr>
<tr class="even">
<td align="left">DEGREE</td>
<td align="left">Highest completed degree of education: Categories for international comparison</td>
</tr>
<tr class="odd">
<td align="left">MAINSTAT</td>
<td align="left">Main status: work, unemployed, in education…</td>
</tr>
<tr class="even">
<td align="left">TOPBOT</td>
<td align="left">Top-Bottom self-placement (10 pt scale)</td>
</tr>
<tr class="odd">
<td align="left">HHCHILDR</td>
<td align="left">How many children in household: children between [school age] and 17 years of age</td>
</tr>
<tr class="even">
<td align="left">MARITAL</td>
<td align="left">Legal partnership status: married, civil partership…</td>
</tr>
<tr class="odd">
<td align="left">URBRURAL</td>
<td align="left">Place of living: urban - rural</td>
</tr>
</tbody>
</table>
<p>Kyselylomakkeilla kysymykset olivat hieman pidempiä. Kuva <a href="#fig:suom-kys">2.1</a>
on osa suomenkielistä lomaketta.</p>
<div class="figure" style="text-align: center"><span id="fig:suom-kys"></span>
<img src="img/substvar_fi_Q1Q2.png" alt="Suomenkielinen lomake" width="50%" />
<p class="caption">
Kuva 2.1: Suomenkielinen lomake
</p>
</div>
<p>Valituista taustamuuttujista monet on kerätty haastattelulla.
Tiedonkeruu, otantamenetelmät ja yksikkövastauskadon (unit non-response, otokseen
valitulta ei saada mitään tietoja) huomioiminen on tehty joka
maassa omalla tavallaan. Aineistoissa on mukana painot, joilla tulokset voidaan
korottaa perusjoukon tasolle, mutta kansainvälisiä vertailupainoja ei syystä tai
toisesta ole. Taustamuuttujat kuten koulutustaso on harmonisoitu
vertailukelpoisiksi.</p>
<p>Tutkimuksen kohdeperusjoukko on 18-vuotiaat tai sitä vanhemmat,
poikkeuksina Suomi (15 - 74 vuotiaat), Islanti, Japani, Etelä-Afrikka ja Venezuela.</p>
<p>Jos ohitetaan pienet erot kysymyksissä ja vastausvaihtoehdoissa jäljelle jää
erävastauskato, kyselytutkimusten ominaisuus. Monista eri syistä joihinkin kysymyksiin
ei vastata. Esimerkiksi Ranskassa yli 20 prosenttia kieltäytyi vastaamasta lasten
lukumäärää kysyttäessä (HHCHILDR), ja aika moni myös muissa perherakenteeseen
liittyvissä kysymyksissä. Tässä tutkielmassa monimuuttujakorrespondenssianalyysiä
käytetään tämän ongelman tai datan ominaisuuden analyysiin.</p>
<p>Poistin aineistosta havainnot, joissa tieto iästä tai sukupuolesta puuttuu
(32969-32823 = 146 havaintoa).</p>
<p>Aineiston luokittelu- ja järjestysasteikon muuttujat muunnetaan R-ohjelmiston
factor-tietotyypiksi. Teen muunnokset useammassa vaiheessa heti kun data on
luettu SPSS-tiedosta. Käsittelyssä koitan noudattaa helposti toistettavan
tutkimuksen periaatteita <span class="citation">(McNamara ja Horton <a href="#ref-RefWorks:doc:5c3759c2e4b0085b307c82b5" role="doc-biblioref">2018</a>)</span>.
Koodi ei saisi olla kovin virhealtista (”haurasta”) ja tarkistuksia tehdään
paljon. Data-analyysin ja ehkä erityisesti korrespondenssianalyysin idea on
kuitenkin operoida matriiseilla, lisätä ja poistaa rivejä ja sarakkeita ja
rakennella mutkikkaampia matriiseja yksinkertaisemmista.
Analyysivaiheessa koodi muuttuu hauraammaksi.</p>
<p><strong>Aineisto ja korrespondenssianalyysi</strong></p>
<p>Michael Greenacre on käyttänyt aineistoa eri vuosilta luentomateriaaleissa kuten
Helsingissä 2017<span class="citation">(M. Greenacre <a href="#ref-RefWorks:doc:5b6ef091e4b0984fd9b8c0ca" role="doc-biblioref">2017</a>)</span> ja ainakin kahdessa
oppikirjassaan(<span class="citation">(Greenacre <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d7c" role="doc-biblioref">2010</a>)</span>,
<span class="citation">(M. J. Greenacre <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d78" role="doc-biblioref">2017</a>)</span>).
ISSP - aineisto vuodelta 1989 on käytetty myös neljän singulaariarvohajoitelmaan
perustuvan menetelmän vertailuun<span class="citation">(Greenacre <a href="#ref-RefWorks:doc:5b6f159ce4b0bc0f31734b76" role="doc-biblioref">2003</a>)</span>. Blasius
ja Thiessen (<span class="citation">(Blasius ja Thiessen <a href="#ref-RefWorks:doc:5b15542ee4b0e2616bc42dca" role="doc-biblioref">2006</a>)</span>) arvioivat aineiston laatua
ja maiden vertailtavuutta vuoden 1994 aineistolla.</p>
<p>Sukupuoliroolien (gender roles) ja niihin liittyvien asenteiden vertailevaa
kansainvälistä (cross-cultural) tutkimusta on tehty paljon. Tutkimusongelman
sisällöllisten ja teoreettisen kysymysten nykytilaa kuvaa tuore artikkeli
<span class="citation">(Walter <a href="#ref-RefWorks:doc:5bd08fb6e4b05c5447c9a9f9" role="doc-biblioref">2018</a>)</span>.</p>
<p><span class="citation">Ferragina ja Seeleib-Kaiser (<a href="#ref-RefWorks:doc:5bd0a663e4b0c91dcf7c4be9" role="doc-biblioref">2015</a>)</span> tutkivat ensin 18
OECD-maan perhepolitiikan muutoksia kolmen viime vuosikymmenen ajalta. Näkökulma on
työllisyyspolitiikka ja menetelmänä monimuuttuja-korrespondenssianalyysi (MCA).
Havaituille kehityssuunnille etsitään toisessa vaiheessa selityksiä. Aineistona
on viisi kansainväliseen vertailuun soveltuvaa aineistoa, yhtenä niistä ISSP:n
data kolmelta kierrokselta (1988,1994,2002).</p>

</div>
</div>
<div id="yksinkertainen-korrespondenssianalyysi" class="section level1">
<h1><span class="header-section-number">Luku 3</span> Yksinkertainen korrespondenssianalyysi</h1>
<p>Korrespondenssianalyysin peruskäsitteet ja muuttujien yhteyden graafisen analyysin
periaatteet voi esittää kahden luokittelumuuttujan ristiintaulukoinnin eli
kontingenssitaulun analyysin avulla. Kyse ei ole pelkästään helposta esimerkistä,
vaan peruskäsitteet ja geometrisiin perusteisiin nojaava graafinen analyysi ovat
oleellisilta osin samat myös monimutkaisemmissa menetelmän sovelluksissa
<span class="citation">(Greenacre ja Hastie <a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664d84" role="doc-biblioref">1987</a>)</span>.</p>
<p>Greenacren oppikirjat ovat hyvä esimerkki
perusteellisesta yksinkertaisen taulukon analyysin esitystavasta.
<span class="citation">LeRoux ja Rouanet (<a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>)</span> ranskalaisen perinteen mukaisesti
matemaattista teoriaperustaa, mutta menetelmän peruskäsitteet ja tulkinnat
esitellään yksinkertaisella esimerkillä. <span class="citation">Mustonen (<a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664d95" role="doc-biblioref">1995</a>)</span>
käyttää samaa Fisherin Cairness-aineistoa korrespondenssianalyysin esittelyyn</p>
<p>Esitän tässä jaksossa korrespondenssianalyysin peruskäsitteet intuitiivisesti,
matemaattiset yksityiskohdat löytyvät liitteestä 1. Kun taulukko on
pieni, johtopäätökset voi helposti tarkastaa datasta. Datan analyysin tärkein
väline on kuva, yleensä kaksiulotteinen kartta. Tulkinta ja erityisesti väärien
johtopäätösten välttäminen vaati kartan tulkinnan varmistamista ratkaisun
numeerisista tuloksista. Kun analysoitava taulukko, sen rivien ja sarakkeiden
riippuvuuksia kuvaava kartta ja kartan perustana olevat numeeriset tulokset
esitetään yhdessä, on helpompi ymmärtää tulkinnan perussäännöt.</p>
<p><span class="citation">LeRoux ja Rouanet (<a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>)</span> esittävät tulkinnan perussäännöt hieman
eri korostuksella kuin Greenacre (CAiP). Yhteistä on graafisen analyysin tärkeys,
mutta ranskalaiset tutkijat korostavat numeeristen tulosten ensisijaisuuta.
Analyysi pitää aloittaa tutkimalla numeerisen ratkaisun ominaisuuksia.
Greenacren mielestä numeerisia tuloksia tarvitaan johtopäätösten varmistamiseen,
ensin katsotaan karttaa. Eroa ei kannata liioitella, molempia tarvitaan.
Eksploratiivisessa data-analyysissä näkökulmaa muutetaan, kun datan ominaisuudet
tai omituisuudet havaitaan. Kun kartat ovat aina approksimaatiota, numeerisia
tuloksia tarvitaan.</p>
<div id="äiti-töissä---kärsiikö-lapsi" class="section level2">
<h2><span class="header-section-number">3.1</span> Äiti töissä - kärsiikö lapsi?</h2>
<p>Aineistossa on kuuden maan vastaukset kysymykseen Q1b: ”Alle kouluikäinen lapsi
todennäköisesti kärsii, jos hänen äitinsä käy työssä”. Kysymys on voimakkaasti
muotoiltu. Eräs lastensuojelun ammattilainen piti vastaamista mahdottomana,
pitäisi tietää missä lapsi on ja mitä hän tekee. Kysymykset on kuitenkin suunniteltu
kokonaisuudeksi, ja niitä analysoidaan yhdessä luvussa 7. Yhden taulukon analyysi
esittelee menetelmän, oikeassa tutkimuksessa pitää käyttää vähintään koko
kysymyssarjaa.</p>
<p>Aineistosta on poistettu havainnot, joissa tieto vastauksesta puuttuu.
Taustamuuttujia ovat vastaajan sukupuoli ja ikä. Taulukoissa vastausvaihtoehtojen
tunnuksina käytetään samoja symboleja kuin kuvissa (E = täysin eri mieltä,
e = eri mieltä, ? = ei samaa eikä eri mieltä, s = samaa mieltä, S = täysin samaa
mieltä).</p>
<p>Frekvenssitaulukossa <a href="#tab:simpeCA-frekTa1">3.1</a> on esitetty vastausten suhteellinen jakauma,
lukumäärät on jaettu havaintojen lukumäärällä (8143). Korrespondenssianalyysissä
kaikki on suhteellista, ja analyysi perustuu tähän taulukkoon. Taulukon
reunajakaumat kertovat jokaisen maan ja jokaisen vastausvaihtoehdon suhteellisen
osuuden. Näitä suhteellisia osuuksia kutsustaan korrespondenssianalyysissä
<em>rivi- ja sarakemassoiksi</em>.</p>
<table>
<caption><span id="tab:simpeCA-frekTa1">Taulukko 3.1: </span>Kysymyksen Q1b vastaukset, suhteelliset frekvenssit</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">S</th>
<th align="left">s</th>
<th align="left">?</th>
<th align="left">e</th>
<th align="left">E</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BE</td>
<td align="left">2.35</td>
<td align="left">5.54</td>
<td align="left">5.38</td>
<td align="left">6.78</td>
<td align="left">4.68</td>
<td align="left">24.72</td>
</tr>
<tr class="even">
<td align="left">BG</td>
<td align="left">1.45</td>
<td align="left">4.85</td>
<td align="left">2.52</td>
<td align="left">2.33</td>
<td align="left">0.16</td>
<td align="left">11.31</td>
</tr>
<tr class="odd">
<td align="left">DE</td>
<td align="left">2.03</td>
<td align="left">4.61</td>
<td align="left">2.43</td>
<td align="left">6.61</td>
<td align="left">5.38</td>
<td align="left">21.05</td>
</tr>
<tr class="even">
<td align="left">DK</td>
<td align="left">0.86</td>
<td align="left">2.92</td>
<td align="left">1.87</td>
<td align="left">2.85</td>
<td align="left">8.55</td>
<td align="left">17.05</td>
</tr>
<tr class="odd">
<td align="left">FI</td>
<td align="left">0.58</td>
<td align="left">2.31</td>
<td align="left">1.83</td>
<td align="left">5.19</td>
<td align="left">3.72</td>
<td align="left">13.63</td>
</tr>
<tr class="even">
<td align="left">HU</td>
<td align="left">2.69</td>
<td align="left">3.54</td>
<td align="left">2.76</td>
<td align="left">2.33</td>
<td align="left">0.92</td>
<td align="left">12.24</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="left">9.95</td>
<td align="left">23.76</td>
<td align="left">16.79</td>
<td align="left">26.10</td>
<td align="left">23.41</td>
<td align="left">100.00</td>
</tr>
</tbody>
</table>
<p>Muuttujien luonne on usein erilainen. Tähän aineistoon sopii
riviprosenttientaulukko, vertaillaan vastausten jakaumia maiden välillä. Taulukon
sarakkeet ovat muuttujia ja rivit havaintoja. Rivit on saatu summaamalla
(aggregoimalla) vastaukset maittain. Greenacre käyttää näistä yksittäisten
vastausten (havaintojen) summariveistä termiä “sample”.</p>
<table>
<caption><span id="tab:simpeCA-rprosTa1">Taulukko 3.2: </span>Kysymyksen Q1b vastaukset, riviprosentit</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">S</th>
<th align="left">s</th>
<th align="left">?</th>
<th align="left">e</th>
<th align="left">E</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BE</td>
<td align="left">9.49</td>
<td align="left">22.40</td>
<td align="left">21.76</td>
<td align="left">27.42</td>
<td align="left">18.93</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">BG</td>
<td align="left">12.81</td>
<td align="left">42.89</td>
<td align="left">22.26</td>
<td align="left">20.63</td>
<td align="left">1.41</td>
<td align="left">100.00</td>
</tr>
<tr class="odd">
<td align="left">DE</td>
<td align="left">9.63</td>
<td align="left">21.88</td>
<td align="left">11.55</td>
<td align="left">31.39</td>
<td align="left">25.55</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">DK</td>
<td align="left">5.04</td>
<td align="left">17.15</td>
<td align="left">10.95</td>
<td align="left">16.71</td>
<td align="left">50.14</td>
<td align="left">100.00</td>
</tr>
<tr class="odd">
<td align="left">FI</td>
<td align="left">4.23</td>
<td align="left">16.94</td>
<td align="left">13.42</td>
<td align="left">38.11</td>
<td align="left">27.30</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">HU</td>
<td align="left">21.97</td>
<td align="left">28.89</td>
<td align="left">22.57</td>
<td align="left">19.06</td>
<td align="left">7.52</td>
<td align="left">100.00</td>
</tr>
<tr class="odd">
<td align="left">All</td>
<td align="left">9.95</td>
<td align="left">23.76</td>
<td align="left">16.79</td>
<td align="left">26.10</td>
<td align="left">23.41</td>
<td align="left">100.00</td>
</tr>
</tbody>
</table>
<p>Sarakeprosentit antavat toisen näkökulmaan samaan dataan.</p>
<table>
<caption><span id="tab:simpeCA-cprosTa1">Taulukko 3.3: </span>Kysymyksen Q1b vastaukset, sarakeprosentit</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">S</th>
<th align="left">s</th>
<th align="left">?</th>
<th align="left">e</th>
<th align="left">E</th>
<th align="left">All</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">BE</td>
<td align="left">23.58</td>
<td align="left">23.31</td>
<td align="left">32.04</td>
<td align="left">25.98</td>
<td align="left">19.99</td>
<td align="left">24.72</td>
</tr>
<tr class="even">
<td align="left">BG</td>
<td align="left">14.57</td>
<td align="left">20.41</td>
<td align="left">15.00</td>
<td align="left">8.94</td>
<td align="left">0.68</td>
<td align="left">11.31</td>
</tr>
<tr class="odd">
<td align="left">DE</td>
<td align="left">20.37</td>
<td align="left">19.38</td>
<td align="left">14.48</td>
<td align="left">25.32</td>
<td align="left">22.98</td>
<td align="left">21.05</td>
</tr>
<tr class="even">
<td align="left">DK</td>
<td align="left">8.64</td>
<td align="left">12.30</td>
<td align="left">11.12</td>
<td align="left">10.92</td>
<td align="left">36.52</td>
<td align="left">17.05</td>
</tr>
<tr class="odd">
<td align="left">FI</td>
<td align="left">5.80</td>
<td align="left">9.72</td>
<td align="left">10.90</td>
<td align="left">19.91</td>
<td align="left">15.90</td>
<td align="left">13.63</td>
</tr>
<tr class="even">
<td align="left">HU</td>
<td align="left">27.04</td>
<td align="left">14.88</td>
<td align="left">16.46</td>
<td align="left">8.94</td>
<td align="left">3.93</td>
<td align="left">12.24</td>
</tr>
<tr class="odd">
<td align="left">Total</td>
<td align="left">100.00</td>
<td align="left">100.00</td>
<td align="left">100.00</td>
<td align="left">100.00</td>
<td align="left">100.00</td>
<td align="left">100.00</td>
</tr>
</tbody>
</table>
<p>Tavoitteena on korrespondenssianalyysin kartta, jossa rivi- ja sarakepisteet on
esitetty samassa kuvassa. Sarakeprosenttien taulukossa on esitetty sarakkeiden
suhteelliset jakaumat. Näitä suhteellisia rivejä ja sarakkeita kutsutaan
korrespondenssianalyysissä <em>rivi- ja sarakeprofiileiksi</em>.</p>
<p>Korrespondenssianalyysin perusidea on analysoida rivien ja sarakkeiden yhteyttä
(korrespondenssia) rivi- tai sarakeprofiilien hajonnan avulla. Hajontaa mitataan
poikkeamilla keskiarvorivistä tai sarakkeesta, ja massat otetaan huomioon,
kun poikkeamat lasketaan yhteen.</p>
<div class="figure"><span id="fig:g1-2kuva1"></span>
<img src="JH_capaper_files/figure-html/g1-2kuva1-1.png" alt="Q1b:Sarakeprofiilit ja keskiarvoprofiili" width="672" />
<p class="caption">
Kuva 3.1: Q1b:Sarakeprofiilit ja keskiarvoprofiili
</p>
</div>
<div class="figure"><span id="fig:g1-2kuva2"></span>
<img src="JH_capaper_files/figure-html/g1-2kuva2-1.png" alt="Q1b: riviprofiilit ja keskiarvorivi" width="672" />
<p class="caption">
Kuva 3.2: Q1b: riviprofiilit ja keskiarvorivi
</p>
</div>
<p>Kuvasta <a href="#fig:g1-2kuva2">3.2</a> esimerkiksi näkee, että Tanska (DK) näyttäisi
poikkeava keskiarvorivistä paljon, samoin Bulgaria.
Bulgarian massa on kuitenkin aineiston pienin (11,31 %), Tanskan taas
kohtalainen (17 %).
Sarakeprofiilikuvassa <a href="#fig:g1-2kuva1">3.1</a> täysin eri mieltä - vastaus (E) on
selvästi erilainen ja sen massa on suuri (23%). Kaikki luvut ovat suhteellisia,
havaintojen lukumäärä ei vaikuta tulkintaan periaatteessa mitenkään.</p>
<p>Mikä on rivien ja sarakkeiden yhteys?</p>
<p>Kahden luokittelumuuttujan riippuvuutta voidaan testata <span class="math inline">\(\chi^{2}\)</span> - testillä.
Riippumattomuushypoteesin mukainen odotettu solufrekvenssi on taulukon
<a href="#tab:simpeCA-frekTa1">3.1</a> reunajakaumien alkioiden tulo.</p>
<p>Testisuure saadaan laskemalla yhteen jokaisen solun havaittujen ja odotettujen
frekvenssien erotukset muodossa</p>
<p><span class="math display" id="eq:khii21">\[\begin{equation}
  \chi^{2} = \frac{(havaittu - odotettu)^2} {odotettu}.
    \tag{3.1}
\end{equation}\]</span></p>
<p>Tämä voidaan esittää korrespondenssianalyysin esittelyyn sopivammalla tavalla
parilla muunnoksella, jolloin saamme riveittäin vastaavat termit rivisummalla
painotettuna.</p>
<p><span class="math display" id="eq:khii22">\[\begin{equation}
  rivisumma \times \frac{(havaittu \: riviprofiili - odotettu \: riviprofiili)^2} {odotettu \: riviprofiili}.
    \tag{3.2}
\end{equation}\]</span></p>
<p>Kun jaamme nämä tekijät havaintojen kokonaismäärällä <span class="math inline">\(n\)</span>, rivisumma muuntuu
rivin massaksi, ja niiden summa muotoon <span class="math inline">\(\frac{\chi^{2}}{n}\)</span>.</p>
<p><span class="math display" id="eq:inert1">\[\begin{equation}
 \frac{\chi^{2}}{n} = \phi^{2}.
  \tag{3.3}
 \end{equation}\]</span></p>
<p>Jakajassa ei ole vapausastekorjausta (n-1), korrespondenssianalyysi on
deskriptiivistä data-analyysiä.</p>
<p>Tunnusluku <span class="math inline">\(\phi^{2}\)</span> on korrespondenssianalyysissä <em>kokonaisinertia</em> (total
inertia). Se kuvaa, kuinka paljon varianssia taulukossa on ja on riippumaton
havaintojen lukumäärästä. Tilastotieteessä tunnusluvulla on useita vaihtoehtoisia
nimiä (esim. mean square contingency coefficient) ja sen neliöjuurta kutsutaan
<span class="math inline">\(\phi\)</span> - kertoimeksi.</p>
<p>Korrespondenssianalyysin ratkaisussa käytetään suhteellisten frekvenssien
taulukkoa.</p>
<p>Frekvenssitaulukossa kahden rivin (esimerkiksi rivien 1 ja 3) euklidinen etäisyys
on</p>
<p><span class="math display" id="eq:euclid1">\[\begin{equation}
 \sqrt{(p_{11} - p_{31})^2 + (p_{12} - p_{32})^2 + (p_{13} - _{33})^2+ (p_{14} - _{34})^2+ (p_{15} - _{35})^2}.
 \tag{3.4}
 \end{equation}\]</span></p>
<p>Rivien <span class="math inline">\(\chi^{2}\)</span> - etäisyys on painotettu euklidinen etäisyys, jossa painoina
ovat riviprofiilin odotetut arvot. Ne ovat riippumattomuushypoteesin mukaisesti
riviprofiilien keskiarvoprofiilin vastaavat alkiot <span class="math inline">\(r_{i}\)</span> .</p>
<p><span class="math display" id="eq:euclid2">\[\begin{equation}
 \sqrt{\frac{(p_{11} - p_{31})^2} { r_{1}} + \dots + \frac{(p_{15} - p_{35})^2} {r_{5}}}
 \tag{3.5}
\end{equation}\]</span></p>
<p>Inertia voidaan esittää rivien ja keskiarvorivin (sentroidin) <span class="math inline">\(\chi^{2}\)</span> -etäisyyksien
neliöiden painotettuna summana, jossa painoina ovat rivien massat <span class="math inline">\(m_{i}\)</span> ja
summa lasketaan yli rivien <span class="math inline">\({i}\)</span>.</p>
<p><span class="math display" id="eq:inert2">\[\begin{equation}
 \phi^{2} = \sum_{i} (massa \: m_{i}) \times (profiilin \: i \: \chi^{2} - etäisyys \: sentroidista)^{2}
 \tag{3.6}
\end{equation}\]</span></p>
<p>Korrespondenssianalyysin kolme peruskäsitteen “tripletti” – <em>profiili</em>,
<em>massa</em> ja <em><span class="math inline">\(\chi^{2}\)</span> - etäisyys</em> – on esitelty. “Triplettiä” täydentää “kvartetti”,
johon <em>inertia</em> kuuluu.</p>
<p>Rivi- ja sarakeprofiilien taulukoista huomaa, että keskiarvoprofiilien
alkiot ovat massoja. Rivien keskiarvoprofiilin alkiot ovat sarakemassoja, ja sama
pätee sarakkeille. Tämä rivi- ja sarakeongelmien duaalisuus on yksinkertaisen
korrespondenssianalyysin keskeinen idea (CAiP, s. 57). Rivi- tai sarakeongelman
ratkaisu tuottaa saman tuloksen.</p>
<p>Ratkaisun dimensio on sarakkeiden tai rivien lukumäärä vähennettynä yhdellä,
pienempi kahdesta vaihtoehdosta. Se on myös kokonaisinertian teoreettinen maksimi.</p>
<p>Korrespondenssianalyysi on läheistä sukua pääkomponenttianalyysille. Etäisyysmitta on
khii2-etäisyys (käytän tekstissä tätä kirjoitusasua) ja ovat massat ovat mukana
painoina. Ratkaisussa etsitään haluttu yleensä kaksiulotteinen ratkaisu (taso),
joka minimoi pisteiden khii2-etäisyyksien poikkeamien summan eli
on mahdollisimman lähellä pisteitä. Alkuperäisen täyden dimension (full space)
data projisoidaan tälle tasolle.</p>
</div>
<div id="symmetrinen-kartta" class="section level2">
<h2><span class="header-section-number">3.2</span> Symmetrinen kartta</h2>
<p>Korrespondenssianalyysi kuvaa taulukon riippuvuudet karttana. <em>Symmetrinen kartta</em>
on yleisin ja useiden ohjelmistojen oletuskartta.</p>
<div class="figure" style="text-align: center"><span id="fig:simpleCA1map1"></span>
<img src="JH_capaper_files/figure-html/simpleCA1map1-1.png" alt="Q1b: lapsi kärsii jos äiti on töissä" width="90%" />
<p class="caption">
Kuva 3.3: Q1b: lapsi kärsii jos äiti on töissä
</p>
</div>
<p>Akselien prosenttimerkinnät kertovat, kuinka paljon aineiston inertiasta eli
hajonnasta on kaksiulotteisessa projektiossa saatu kuvattua akseleille.</p>
<p>Akselit ovat sisäkkäisiä (nested) Ensimmäinen akseli saa aina suurimman osan
inertiasta, tässä 76 prosenttia. Kun toinen akseli kuvaa 15 prosenttia koko inertiasta,
on kartalla esitetty 91 prosenttia aineiston hajonnasta. Loput 9 prosenttia jää
3. ja 4. dimensiolle. Nämä ”selitysosuudet” ovat samantapainen laskelma kuin
perinteisen regressiomallin ”selitetty” vaihtelu ja ”jäännösvaihtelu”.</p>
<p>Akselien tulkinta on korrespondenssianalyysin perustehtävä._Kontrastit_ määrittävät
akselien tulkinnan. Benzacrin ohjeen mukaan (<span class="citation">(LeRoux ja Rouanet <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>)</span>, s. 49)
katsotaan mitä on oikealla ja mitä vasemmalla. Akselien tulkinta perustuu siihen,
mitä yhteistä on kaikilla elementeillä, jotka ovat origon vasemmalla puolella
ja vastaavasti origon oikealla puolella. Samalla tavalla tulkitaan toinen akseli,
mitä on ylhäällä ja alhaalla. Tulkinta tehdään akseleiden suuntaan. Kuvan tulkintaa
ei aloiteta pisteiden etäisyyksiä vertailemalla.</p>
<p>Kun taulukon rivit ovat havaintoja ja sarakkeet muuttujia, akselien tulkinta
tehdään muuttujien avulla. Vasemmalla on E ja oikealla puolella samanmieliset
vastaukset s ja S. Neutraali ”?” on s-vastausten vasemmalla puolella mutta
kuitenkin oikealla. Kuvan perusteella ei voi sanoa kuinka paljon,
kaikki erot ovat suhteellisia.</p>
<p>Sarakkeet ovat oikeassa järjestyksessä, mutta niiden koordinaatit
x-akselilla eivät olen tasavälisiä. Jos muuttuja jostain syystä halutaan
esittää välimatka- tai suhdeasteikon muuttujana koordinaatti ensimmäisellä
dimensiolla on yksi vaihtoehto.</p>
<p>Ensimmäisen dimension tulkinta on aika selkeä. Toinen akseli on kontrasti
lievemmän tai maltillisemman erimielisyyden (e) ja muiden vastausten kanssa.
Se on 1. dimension suuntaan kaikkein lähimpänä origoa. Hieman varovaisemmin
akselin voi tulkita maltillisen ja jyrkemmän tai varmemman mielipiteen kontrastiksi.</p>
<p>En jatkossa esitä kuvailevia akseleiden nimiä kuvissa, akseleiden tulkinta on
analyysin ensimmäinen tehtävä.</p>
<p>Maiden vertailu tehdään näiden akselien suuntaan. Sekä sarakepisteiden että
rivipisteiden keskinäiset välimatkat approksimoivat optimaalisesti niiden
khii2-etäisyyksiä. Sarake- ja rivipisteiden välisillä etäisyyksillä ei ole
mitään suoraa tulkintaa. Pisteiden etäisyydet samassa pistepilvessä ovat
suhteellisia, Saksa on konservatiivisempi kuin Suomi mutta emme tiedä kuinka paljon.
Maiden järjestys oikealta vasemmalle on selkeä, Tanska on vasemmalla
liberaalina ”ääripäänä”, oikealla taas Unkari ja Bulgaria. Pystyakselin suuntaan
nähdään, että kaikkein ”maltillisin” mutta kuitenkin liberaali on Suomi,
jyrkimmät mielipiteet löytyvät Unkarista ja Tanskasta.</p>
<p>Näitä tulkintoja voi vertailla edellä esitettyihin kahteen kuvaan rivi- ja
sarakeprofiileista. Näkeekö niistä helposti saman riippuvuuden rakenteen? Kartta
kertoo selvästi enemmän, mutta vaati ensin tulkinnan.</p>
<p>Kartta on approksimaatio neliulotteisen pistepilven hajonnalle. Vain origo on
siinä tarkasti esitetty. Se on koko aineiston keskiarvopiste, ja pisteiden
hajonta sen ympärillä kuvaa poikkeamaa riippumattomuushypoteesista.</p>
<p>Tärkeä geometrinen periaate on se, että kaukana on kaukana myös alkuperäisessä
pistepilvessä, mutta kartalla lähellä olevat pisteet eivät välttämättä ole lähellä.
Projektio kutistaa pisteiden etäisyyksiä.</p>
<p>Approksimaation laatu selviää korrespondenssianalyysin numeerisista tuloksista,
samoin se miten rivi- ja sarakepisteen määrittävät akselit.</p>
<p>Kartoissa tärkein tekninen yksityiskohta on kuva- tai muotosuhde (aspect ratio).
Akseleiden mittayksikön pitää olla sama eli muotosuhteen yksi. Jos kuvia
tulostetaan useassa formaatissa kannattaa olla tarkkana. Kuvien on jo
analyysivaiheessa oltava lukukelpoisia, ja symbolien kokoa joutuu isoissa
aineistoissa säätämään. Tulosten esittäminen lopullisessa muodossa vaatii jo
paljon vaivannäköä, tässä tutkielmassa esitetään vain datan analysoinnin
valikoituja kuvia. Tutkielman karttojen ulkoasu ei ole paras mahdollinen, mutta
tarkoitukseen riittävän hyvä. Graafinen data-analyysi on vaivatonta vasta
sitten kun se tehty.</p>
<p><strong>Vaatimukset datalle</strong></p>
<p>Korrespondenssianalyysin sovelletaan yleisimmin frekvenssitaulujen analyysiin,
lukumäärädataan (count data). Periaatteessa mikä tahansa data sopii, kunhan se
voidaan järkevästi esittää suhteellisina lukumäärinä (relative amounts), siis
suhdeasteikon (ratio scale) muuttujana. Tässä oleellista on tulkittavuus
tutkimusongelman näkökulmasta. Välttämätön ehto on sama mittayksikkö: lukumäärä,
rahayksikkö, pituusmitta kelpaavat. (CAiP s. 15). Taulukon lukujen on oltava
ei-negatiivisia (positiivisia, nolla sallittu).</p>
<p>Rajat ovat joustavia, kun mukaan otetaan erilaiset uudelleenskaalaukset
ja transformaatiot. Tämä oli menetelmän perusidea jo Benzecrillä (CAiP, s. 201).</p>
<p>Menetelmää sovelletaan profiileihin, jotka painotetaan massoilla, ja
profiilien etäisyyksiä mitataan khii2-etäisyysmitalla. Jos datan voi esittää
tässä muodossa, menetelmää voi käyttää.</p>
</div>
<div id="asymmetrinen-kartta-ja-ideaalipisteet" class="section level2">
<h2><span class="header-section-number">3.3</span> Asymmetrinen kartta ja ideaalipisteet</h2>
<p>Symmetrisessä kartassa <a href="#fig:simpleCA1map1">3.3</a> molemmat pisteparvet on esitetty
pääkoordinaateissa (principal coordinates) ikään kuin päällekkäin, samassa kuvassa.</p>
<p>Toinen vaihtoehto on asymmetrinen kartta, jossa toinen pistejoukko esitetään
standardikoordinaateissa ja toinen pääkoordinaateissa. Asymmetrisessä
kartassa <a href="#fig:G1-3asymm2">3.4</a> sarakkeet on esitetty standardikoordinaateissa
ja rivit pääkoordinaateissa.</p>
<p>Sarakepisteitä kutsutaan ideaalipisteiksi, ne edustavat kuvitteellisia maita joissa
kaikki vastaukset ovat samoja. Matemaattisesti kartalle projisoidut ideaalipisteet
ovat (tässä esimerkissä) neliulotteisen avaruuden verteksin (monikulmion)
kärkipisteitä. Rivipisteet ovat tämän verteksin sisällä.</p>
<div class="figure" style="text-align: center"><span id="fig:G1-3asymm2"></span>
<img src="JH_capaper_files/figure-html/G1-3asymm2-1.png" alt="Q1b: lapsi kärsii jos äiti on töissä" width="90%" />
<p class="caption">
Kuva 3.4: Q1b: lapsi kärsii jos äiti on töissä
</p>
</div>
<p>Sarakepisteet kuvaavat maksimi-inertiaa, ja rivipisteiden paljon pienempi hajonta
kuvaa niiden poikkeamaa tästä hypoteettisesta tilanteesta. Sarakepisteet
skaalautuvat origosta ulospäin. Asymmetrisessä kartassa rivi- ja sarakepisteiden
etäisyydellä on tulkinta, samoin rivipisteiden välisellä etäisyydellä.
Sarakepisteiden välisillä etäisyyksillä ei ole tulkintaa. Sarakepisteet on
skaalattu ja mittakaavan ero symmetriseen karttaan näkyy selvästi.</p>
<p>Ideaalipisteiden tulkinnan voi varmistaa sarake kerrallaan, projisoimalla rivipisteet
origon kautta piirretylle janalle. Kuvassa <a href="#fig:G1-3-asymmtulk2">3.5</a> nähdään mikä
on maiden järjestys E-vastausvaihtoehdossa.</p>
<div class="figure" style="text-align: center"><span id="fig:G1-3-asymmtulk2"></span>
<img src="img/simpleCAasymmTulk2.png" alt="Rivipisteiden projektiot" width="90%" />
<p class="caption">
Kuva 3.5: Rivipisteiden projektiot
</p>
</div>
<p>Asymmetrinen kartta antaa toisen näkökulman rivien ja sarakkeiden suhteeseen.
Sen huono puoli on ideaalipisteiden karkaaminen kauas origosta ja rivipisteiden
pakkautuminen pieneksi parveksi. Jos rivipisteiden hajonta on suuri,
kuva on käytännöllinen. Kyselytutkimusaineistoissa näin ei yleensä ole.</p>
</div>
<div id="kontribuutiot-kartalla" class="section level2">
<h2><span class="header-section-number">3.4</span> Kontribuutiot kartalla</h2>
<p>Kartassa <a href="#fig:simpleCA1map1">3.3</a> on esitetty myös pisteiden massat. Tässä aineistossa
pisteiden tai sarakesymbolien kokoerot eivät kovin selvästi erotu, mutta yleiskuvan
ne kertovat.</p>
<p>Rivipisteiden ja sarakkeiden <em>kontribuutiot</em> voidaan myös esittämien värisävynä.</p>
<p>Kun kartalla pistejoukon inertia kuvataan akseleille, on jokaisella pisteellä oma
osuutensa akseleiden kuvaamasta inertiasta. <em>Absoluuttinen kontribuutio</em> kertoo rivin
tai sarakkeen osuuden akselin inertiasta. Vaikutuksessa on mukana pisteen massa.</p>
<p><em>Suhteellinen kontribuutio</em> kertoo akselin osuuden pisteen inertiasta.
Tämä tunnusluku kuvaa pisteen projektion laatua, kuinka hyvin se on kartalla esitetty.</p>
<p>Kontribuutiokartta on asymmetrinen kartta, jossa sarakevektorit on skaalattu
kertomalla ne massojen neliöjuurilla. Näin sarakevektorit “kutistuvat” kohti
origoa mutta vektorin pituus kertoo edelleen sen suhteellisen massan.
Kartta sopii niin pienen kuin suuren inertian tilanteisiin
<span class="citation">(M. Greenacre <a href="#ref-RefWorks:doc:5c768b09e4b02df9431e950a" role="doc-biblioref">2006</a>)</span>.</p>
<p><strong>Absoluuttiset kontribuutiot</strong></p>
<p>Absoluuttisten kontribuutioiden jakautumista akseleille voi varovaisesti päätellä
sarakevektorin ja akseleiden välisistä kulmista. Mitä lähempänä sarakevektori on
akselia, sitä suurempi on sen osuus akselin inertiasta. Samanlaisia päätelmiä
voi tehdä myös rivipisteistä hahmottamalla niistä janan origoon.</p>
<p>Käsitteisiin palataan tarkemmin seuraavissa luvuissa ja teorialiitteessä, ja liian
tarkkaan karttaa ei kannata tutkia. Numeeriset tulokset ovat yksityiskohdissa
selkeämpiä.</p>
<div class="figure" style="text-align: center"><span id="fig:G1-3asymmContrib1"></span>
<img src="JH_capaper_files/figure-html/G1-3asymmContrib1-1.png" alt="Q1b: lapsi kärsii jos äiti on töissä" width="90%" />
<p class="caption">
Kuva 3.6: Q1b: lapsi kärsii jos äiti on töissä
</p>
</div>
<p>Sarakkeista ratkaisuun vaikuttaa selvästi eniten E, ja juuri ensimmäiseen
dimensioon, joka selittää suurimman osan kokonaisinertiasta. Toista dimensiota määrittää
vahvimmin e, mutta myös kaikki muut sarakkeet x-akselin yläpuolella. Samaa mieltä
olevien (S ja s) vaikutus näyttäisi jakautuvan selvimmin molemmille dimensioille.</p>
<p>Vaikka massojen suhteellisia eroja ei kovin helposti pistekoosta erota, se näkyy
epäsuorasti Saksan melko vahvana kontribuutiona. Bulgarian pieni kontribuutio
näyttäisi olevan ensimmäiselle dimensiolle. Belgian kontribuutio ratkaisuun on
pienempi kuin Saksan vaikka sen massa on hieman suurempi. Belgian ja Saksan
pisteet ovat suhteellisesti lähempänä origoa jo suuren massansa ansiosta.</p>
<p><strong>Suhteelliset kontribuutiot</strong></p>
<p>Sarakkeiden laatu näyttäisi olevan hyvä, mutta rivipisteistä Saksa ja erityisesti
Belgia erottuvat hieman heikommin esitettyinä.</p>
<div class="figure" style="text-align: center"><span id="fig:G1-3asymmContrib2"></span>
<img src="JH_capaper_files/figure-html/G1-3asymmContrib2-1.png" alt="Q1b: lapsi kärsii jos äiti on töissä" width="90%" />
<p class="caption">
Kuva 3.7: Q1b: lapsi kärsii jos äiti on töissä
</p>
</div>
<p>Massojen ja kontribuutioiden esittäminen kartoilla näyttää selkeimmin poikkeavat
pisteet. Kontribuutioiden graafinen tarkastelu antaa myös yleiskuvan, jonka voi
varmistaa numeerisista tuloksista.</p>
<p>Kaikki edellä esitetyt päättelyt perustuvat tietysti kaksiulotteiseen projektioon.
Jos pisteet on esitetty hyvin eli niiden inertiasta (poikkeamasta keskiarvosta)
suuri osa on kuvattu kartalle, rivipiste on sitä lähempänä ideaalipistettä mitä
suurempi ideaalipisteen osuus on sen profiilissa.</p>
</div>
<div id="massat" class="section level2">
<h2><span class="header-section-number">3.5</span> Massat</h2>
<p>Massat ovat korrespondenssianalyysin keskeinen käsite, ja niiden kaksoisrooli on
menetelmässä tärkeä. Massat ovat normalisoiva muunnos khii2-etäisyysmitalle ja
profiilien painoja.</p>
<p>Tässä jälkimmäisessä roolissa massat liittyvät tutkimusongelmaan,
mitä halutaan vertailla? Kun vertaillaan eri maita, ei ole kovin perusteltua
käyttää massoina eri maiden otoskokoja. Jos taas halutaan vertailla vaikkapa miesten ja
naisten vastauksia on luonnollista normalisoida miesten ja naisten massat yhtä
suuriksi. Rivi- ja sarakemassat ovat verrannollisia taulukon rivi- ja sarakesummiin,
frekvenssitaulukon reunajakaumiin. Ne voidaan tutkimusongelmaan sopivalla tavalla
skaalata uudelleen. Kun esimerkiksi vertaillaan viittä koulutustaso-ryhmää
massat skaalataan verrannollisiksi niiden väestötason osuuksiin (CAiP, s. 23).
Tällainen datan esikäsittely on normaali osa korrespondenssianalyysin soveltamista.</p>
<p>Jos massat halutaan vakioida osajoukoissa yhtä suuriksi, ratkaisu on yksinkertainen.
Korrespondenssianalyysin taulukoksi otetaan riviprofiilitaulukko, jossa rivien summat
ovat yksi.</p>
<p>Kuvassa <a href="#fig:simpleCA3map1">3.8</a> on tehty näin, ja kartta eroaa hämmästyttävän
vähän maiden otoskokoja massoina käyttävästä kartasta <a href="#fig:simpleCA1map1">3.3</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:simpleCA3map1"></span>
<img src="JH_capaper_files/figure-html/simpleCA3map1-1.png" alt="Q1b: lapsi kärsii jos äiti on töissä" width="90%" />
<p class="caption">
Kuva 3.8: Q1b: lapsi kärsii jos äiti on töissä
</p>
</div>
<p>Pienimpien otosten maat (Bulgaria, Unkari) liikahtavat hieman origoa kohti,
Bulgaria hieman enemmän kohti maltillista puolta y-akselin suuntaan.</p>
<div class="figure" style="text-align: center"><span id="fig:simpleCA3map2"></span>
<img src="JH_capaper_files/figure-html/simpleCA3map2-1.png" alt="Q1b: lapsi kärsii jos äiti on töissä" width="90%" />
<p class="caption">
Kuva 3.9: Q1b: lapsi kärsii jos äiti on töissä
</p>
</div>
<p>Kontribuutiokartta <a href="#fig:simpleCA3map2">3.9</a> ei juuri eroa edellä esitetystä
kartasta <a href="#fig:G1-3asymmContrib1">3.6</a>.</p>
<p>En ole vakioinut vertailtavien ryhmien (tässä maat) suhteellisia osuuksia. Syy on
yksinkertainen: esittelen menetelmää sen perusmuodossa ilman kovin täsmällisiä
tutkimusongelmia. Oikeiden tutkimuskysymysten vastauksia pitää tietysti etsiä järkevillä massojen skaalauksella. Korrespondenssianalyysi on inertian
dekomponointia, jakamista osiin.</p>
</div>
<div id="karttojen-erot" class="section level2">
<h2><span class="header-section-number">3.6</span> Karttojen erot</h2>
<p>Yksinkertaisen korrespondenssianalyysin peruskuva on symmetrinen kartta. Ehkä
yllättäen sen “…tulkinta on edelleen menetelmän kaikkein kiistanalaisin aspekti”
(CAiP s.295, <span class="citation">M. Greenacre (<a href="#ref-RefWorks:doc:5c768b09e4b02df9431e950a" role="doc-biblioref">2006</a>)</span>).</p>
<p>Sarake- ja rivisteet esitetään siinä ikään kuin päällekkäin, samassa koordinaatistossa.
Niiden pääkoordinaatit ovat kuitenkin eri pistejoukoista tai avaruuksista. Asymmetrisessä
kartassa pisteet ovat samassa avaruudessa, ja ero on Greenacren mukaan vain skaalaus.
Asymmetrisessä kartassa standardikoordinaateissa esitetyt ideaalipisteet skaalataan
pääakselien suunnassa vastaavilla pääakselien inertioiden neliöjuurilla. Siten pisteiden
suuntavektorit niin pääkoordinaateissa kuin standardikoordinaateissa ovat lähes samat
kun akselien inertioiden (principal inertias) neliöjuuret eivät ole liian erisuuruisia.</p>
<p>Jos pääinertioiden neliöjuuret ovat hyvin eri suuruisia, tulkintaongelmia voi tulla, mutta
niillä ei käytännössä ole merkitystä. Siksi hän pitää skaalausdebattia akateemisena
kiistana, käytännön sovelluksissa sillä ei ole merkitystä.
<span class="citation">Greenacre (<a href="#ref-RefWorks:doc:5c754c6de4b0947789165cde" role="doc-biblioref">1989</a>)</span> kommentoi skaalausta perusteellisesti,
kiista on ollut aika sitkeä mutta lienee laantunut.</p>
<p>Symmetrinen kartta hyvä vaihtoehto, sillä asymmetrisessä kartassa skaalaus vie
ideaalipisteet usein kauas ja pääkoordinaateissa esitetyt pisteet pakkautuvat kuvan
keskelle. Jos dataa tulkitaan asymmetrisesti kontribuutiokartta on
hyvä vaihtoehto. Silloin rivipisteiden khii2-etäisyydet esitetään optimaalisesti
ja sarakkeiden suuntavektoreille projisoiduilla pistellä on kaksoiskuva-tulkinta.</p>
<p>Greenacren mukaan kartoilla voi tavoitella kolmea eri asiaa. Kuvassa voi esittää
rivipisteiden etäisyydet, sarakepisteiden etäisyydet tai rivi- ja sarakepisteiden
etäisyydet. Jälkimmäinen on kaksoiskuvien (biplot) ns. skalaaritulo-ominaisuus.
Rivi- ja sarakepisteen skalaaritulo “palauttaa” alkuperäisen datan, tässä
tapauksessa taulukon solun.</p>
<p>Näistä vain kaksi voidaan optimaalisesti esittää yhtä aikaa.</p>
<p><em>Symmetrisessä kartassa</em> khii2-etäisyydet rivipisteiden välillä ja sarakepisteiden
välillä esitetään optimaalisesti. Rivi- ja sarakepisteiden välisiä etäisyyksiä ei
esitetä optimaalisesti, mutta ne voidaan tulkita kohtalaisen hyvin, jos pääakselien
inertioiden neliöjuuret eivät ole liian erisuuruisia.</p>
<p><em>Asymmetrisessä kartassa</em> pääkoordinaateissa esitetyn pistejoukon etäisyydet
kuvataan optimaalisesti, standardikoordinaateissa esitetyt pisteet ovat “ääriprofiileja”,
verteksin kulmapisteitä. Rivi- ja sarakepisteiden etäisyydet esitetään optimaalisesti,
mutta sarakepisteiden etäisyyksillä ei ole suoraa tulkintaa,</p>
<p><em>Kontribuutiokartta</em> on muunnelma asymmetrisestä kartasta. “Ääriprofiilit” vedetään
kohti origoa kertomalla ne massojen neliöjuurilla. Näin kuva selkenee, ja “kutistetun”
pisteen etäisyys origosta kertoo sen kontribuution pääakseleille. Näiden pisteiden
välisillä etäisyyksillä ei ole suoraa tulkintaa.</p>
<p>Jako standardi- ja pääkoordinaatteihin on suora seuraus korrespondenssianalyysin
matemaattisesta ratkaisusta. Greenacre esittelee kaksoiskuvia käsittelevässä
kirjassaan <span class="citation">(Greenacre <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d7c" role="doc-biblioref">2010</a>)</span> selkeästi koordinaattien
yhteyden ratkaisualgoritmiin, singulaariarvohajotelmaan.</p>
<p>Koordinaattien yhteys voidaan esittää kahtena yksinkertaistettuna kaavana
( <span class="citation">M. Greenacre ja Primicerio (<a href="#ref-RefWorks:doc:5b8175eee4b08da192f99a35" role="doc-biblioref">2013</a>)</span>, s.174 ):</p>
<p><span class="math display" id="eq:pcfromstd1">\[\begin{equation}
  pääkoordinaatit = standardikoordinaatit \times \sqrt{pääakselien \: inertiat}
    \tag{3.7}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:kontribfromstd1">\[\begin{equation}
  kontribuutiokoordinaatit = \sqrt{massat} \times  standardikoordinaatit
    \tag{3.8}
\end{equation}\]</span></p>

</div>
</div>
<div id="täydentävät-pisteet" class="section level1">
<h1><span class="header-section-number">Luku 4</span> Täydentävät pisteet</h1>
<p>Kartat ovat analyysin väline, ja usein on hyödyllistä esittää kuvassa
lisäinformaatiota tulkinnan avuksi. Täydentävät pisteet (supplementary points,
CAiP s. 89-) ovat rivejä tai sarakkeita, jotka lisätään karttaan. Mikä tahansa
rivi tai sarake voidaan lisätä kuvaan, jos se on järkevästi vertailukelpoinen
kartan määrittäneiden profiilien kanssa.</p>
<p>Tällainen piste on kartan laskennassa <em>passiivinen</em>, sillä on sijainti kartalla
mutta ei massaa eikä vaikutusta inertiaan. Passiivisilla pisteillä ei ole vaikutusta
(kontribuutiota) kartan pääakseleihin.</p>
<p>Täydentävillä pisteillä on kolme yleistä käyttötarkoitusta. Kartalle voidaan lisätä
profiili, joka on jollain lailla sisällöllisesti erilainen kuin muut. Esimerkkiaineistossa
kartalle voisi lisätä joitain Euroopan ulkopuolisia maita. Vaikka nämä riviprofiilit
eivät vaikuta kartan akseleiden määräytymiseen, ne voidaan esittää kuuden maan
määrittämässä “avaruudessa”. Projektion laatu (suhteelliset kontribuutiot) voidaan myös
esittää.</p>
<p>Toinen käyttötapaus on pienen massan profiili. Tällaisella pisteellä voi olla iso
vaikutus ratkaisuun, mutta passiivisena pisteenä se sijoitetaan muiden pisteiden
määrittämälle kartalle. Jo sisällöllisistä syistä pienen massan pisteiden esitystä
kannattaa harkita, ne sijaitsevat kaukana origosta ja huonontavat kuvan laatua.</p>
<p>Kolmas mahdollisuus on jakaa pistejoukkoja osajoukkoihin ja esittää niiden
summaprofiili täydentävänä pisteenä. Summaprofiili on osiensa painotettu
(barysentrinen) keskiarvo. Kun se esitetään passiivisena pisteenä, havaintoja ei
oteta ratkaisuun kahta kertaa. Profiilien yhdistämiseen liittyy
korrespondenssianalyysin tärkein ominaisuus, jakaumaekvivalenssi (<em>distributional
equivalence</em>). Se on ollut menetelmän kehittämisen tärkein tavoiteltu ominaisuus,
Profiileiltaan samanlaiset rivit voidaan yhdistää, analyysin tulokset
eivät muutu. Khii2-etäisyysmitta on ainoa etäisyysmitta, joka toteuttaa tämän
periaatteen.</p>
<p><span class="citation">LeRoux ja Rouanet (<a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>)</span> esittelevät
menetelmän matemaattiset perusteet ja jakaumaekvivalenssin perusteellisesti.
Havainnollinen esitys löytyy Greenacren oppikirjasta (CAiP).</p>
<p>Täydentävien profiilien lisääminen vaatii jo yksinkertaisia matriisioperaatioita.
Korrespondenssianalyysi on käytännössä matriisien muokkausta tutkimusongelman
tarpeisiin.</p>
<div id="saksan-ja-belgian-alueet" class="section level2">
<h2><span class="header-section-number">4.1</span> Saksan ja Belgian alueet</h2>
<p>Saksan ja Belgian aineistossa on mukana aluejako: entiset itä- ja länsi-Saksa
(dE,dW), Flanderi (bF), Vallonia (bW) ja Bryssel (bB).</p>
<table>
<caption><span id="tab:BeDealueTable1">Taulukko 4.1: </span>Q1b vastaukset, Saksan ja Belgian alueet</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">S</th>
<th align="left">s</th>
<th align="left">?</th>
<th align="left">e</th>
<th align="left">E</th>
<th align="left">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bF</td>
<td align="left">5.04</td>
<td align="left">23.81</td>
<td align="left">25.89</td>
<td align="left">30.83</td>
<td align="left">14.43</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">bW</td>
<td align="left">10.82</td>
<td align="left">21.02</td>
<td align="left">18.57</td>
<td align="left">24.08</td>
<td align="left">25.51</td>
<td align="left">100.00</td>
</tr>
<tr class="odd">
<td align="left">bB</td>
<td align="left">17.03</td>
<td align="left">20.94</td>
<td align="left">16.63</td>
<td align="left">23.87</td>
<td align="left">21.53</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">BG</td>
<td align="left">12.81</td>
<td align="left">42.89</td>
<td align="left">22.26</td>
<td align="left">20.63</td>
<td align="left">1.41</td>
<td align="left">100.00</td>
</tr>
<tr class="odd">
<td align="left">dW</td>
<td align="left">11.40</td>
<td align="left">26.82</td>
<td align="left">11.83</td>
<td align="left">32.13</td>
<td align="left">17.82</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">dE</td>
<td align="left">5.85</td>
<td align="left">11.33</td>
<td align="left">10.97</td>
<td align="left">29.80</td>
<td align="left">42.05</td>
<td align="left">100.00</td>
</tr>
<tr class="odd">
<td align="left">DK</td>
<td align="left">5.04</td>
<td align="left">17.15</td>
<td align="left">10.95</td>
<td align="left">16.71</td>
<td align="left">50.14</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">FI</td>
<td align="left">4.23</td>
<td align="left">16.94</td>
<td align="left">13.42</td>
<td align="left">38.11</td>
<td align="left">27.30</td>
<td align="left">100.00</td>
</tr>
<tr class="odd">
<td align="left">HU</td>
<td align="left">21.97</td>
<td align="left">28.89</td>
<td align="left">22.57</td>
<td align="left">19.06</td>
<td align="left">7.52</td>
<td align="left">100.00</td>
</tr>
<tr class="even">
<td align="left">All</td>
<td align="left">9.95</td>
<td align="left">23.76</td>
<td align="left">16.79</td>
<td align="left">26.10</td>
<td align="left">23.41</td>
<td align="left">100.00</td>
</tr>
</tbody>
</table>
<p>Aineistoon lisätään passiiviisina riveinä Saksan ja Belgian maaprofiilit (DE, BE).
Maiden massoja ei skaalata yhtä suuriksi, otoskoot vaikuttavat ratkaisuun.</p>
<div class="figure" style="text-align: center"><span id="fig:suppointCA2map1"></span>
<img src="JH_capaper_files/figure-html/suppointCA2map1-1.png" alt="Q1b: Saksan ja  Belgian aluejako " width="90%" />
<p class="caption">
Kuva 4.1: Q1b: Saksan ja Belgian aluejako
</p>
</div>
<p>Saksan ja Belgian täydentävät pisteet ovat osiensa barysentrisiä keskiarvoja,
etäisyys on sitä pienempi mitä suurempi on osuus. Saksan piste sijaitsee siksi
lähempänä länsi-Saksan pistettä. Jos karttaa vertaa kuvaan <a href="#fig:simpleCA1map1">3.3</a>
ei eroja juuri ole. Saksan ja Belgian osien sijoittuminen on kiinnostava.
Itäinen Saksa on selvästi liberaalilla puolella, ensimmäisellä dimensiolla lähinnä Tanskaa.
Läntinen Saksa on ensimmäisellä dimensiolla konservatiivisella puolella Belgian maapisteen
tasolla. Belgian alueista Vallonia (bW) on liberaalilla puolella mutta kaikkein eniten oikealla.
Bryssel ja Flanderi ovat konservatiivisella puolella, toinen länsi-Saksaa
liberaalimpi ja toinen konservatiivisempi. Belgian osat hajoavat toiseen suuntaan kuin Saksan,
liberaalein Flanderi on myös kaikkein maltillisin ja Bryssel vastaavasti
tiukempien mielipiteiden puolella. Sarakepisteiden suhteelliset sijainnit
toisiinsa nähden eivät oleellisesti muutu.</p>
<p>Bryssel ja Vallonia näyttävä olevan hyvin lievästi U-muotoisen maapisteiden
parven sisällä. Tämä kaariefekti tai <em>Guttman-efekti</em> on kartoissa yleinen.
Se on tavallaan ratkaisun geometriasta. Rivipisteiden pilvi on
sarakkeiden ideaalipisteiden virittämän verteksin sisällä, ja ainoa reitti
verteksin kulmasta toiseen kulkee tasolla kaarevasti (CAiP, s. 127).
Voi myös sanoa, että kaariefektin taustalla on järjestysasteikon muuttujan
korrelaatio (<span class="citation">(LeRoux ja Rouanet <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>)</span>, s. 220). Kaaren sisäpisteet
ovat usein polarisoituneita ensimmäisen dimension “ääripäävastausten” välillä.
Tässä vaikutus on heikko, taulukossa <a href="#tab:BeDealueTable1">4.1</a> ei mitään selvää
polarisaatiota näy.</p>
<div class="figure" style="text-align: center"><span id="fig:suppointCA2map2"></span>
<img src="JH_capaper_files/figure-html/suppointCA2map2-1.png" alt="Q1b: Saksan ja  Belgian aluejako " width="90%" />
<p class="caption">
Kuva 4.2: Q1b: Saksan ja Belgian aluejako
</p>
</div>
<p>Kontribuutiokartasta täydentävät pisteet on jätetty pois, ne eivät vaikuta ratkaisuun.
Saksan ja Belgian osien massat ovat tietenkin pienempiä.</p>
<p>Sarakkeiden kontribuutiot ovat samantapaiset kuin alkuperäisessä kartassa
<a href="#fig:G1-3asymmContrib1">3.6</a>. Rivipisteiden kontribuutioista
osa on selvästi pienempiä, erityisesti länsi-Saksa kaksi Belgian aluetta (bB, bF).
Kuvan perusteella ei voi sanoa johtuuko tämä pelkästään massojen pienentymisestä.</p>
<p>Unkarin ja Bulgarian kontribuutiot muuttuvat eri suuntiin, Unkarin pienenee ja
Bulgarian kasvaa.</p>
</div>
<div id="korrespondenssianalyysin-numeeriset-tulokset" class="section level2">
<h2><span class="header-section-number">4.2</span> Korrespondenssianalyysin numeeriset tulokset</h2>
<p>Korrespondenssianalyysin numeeriset tulokset ovat tärkeitä tulkinnan varmistamiselle
ja antavat tarkemman kuvan ratkaisusta. Nämä tulokset ovat erilaisia kokonaisinertian
dekomponointeja. Kokonaisinertia (total inertia) profiilien ja keskiarvoprofiilin
khii2-etäisyyksien massoilla painotettu summa <a href="#eq:inert2">(3.6)</a>. Se kuvaa
profiilipisteiden hajontaa ideaalipisteiden verteksin sisällä. Maksimi-inertia
saavutetaan kun profiilit ovat verteksien kärkipisteissä, jokaisessa profiilissa
on vain yksi luokittelumuuttujan arvo. Inertia on sama kuin ratkaisun dimensio,
tässä esimerkissä 4(sarakkeiden lukumäärä - 1). Numeeristen tulosten esittelyn tärkein
lähde on (CAiP, luku 11 ja liite B).</p>
<p>R-paketti “ca” listaa numeeriset tulokset suppeasti (print) ja laajemmin
(summary). Alla on laajempi tulostus.</p>
<p>Ensimmäisenä on listattu kokonaisinertia pääakseleittain. Tässä suhteelliset luvut
on esitetty prosentteina. Muut luvut on luettavuuden vuoksi skaalattu, joko kerrottu
tuhannella tai esitetty “permills” (summa on 1000).</p>
<pre><code>## 
## Principal inertias (eigenvalues):
## 
##  dim    value      %   cum%   scree plot               
##  1      0.154101  73.4  73.4  ******************       
##  2      0.032489  15.5  88.9  ****                     
##  3      0.014294   6.8  95.7  **                       
##  4      0.008944   4.3 100.0  *                        
##         -------- -----                                 
##  Total: 0.209828 100.0                                 
## 
## 
## Rows:
##       name   mass  qlt  inr    k=1 cor  ctr    k=2 cor  ctr  
## 1  |    bF |  124  650   69 |  157 212   20 | -226 438  195 |
## 2  |    bW |   60  388    3 |  -36 137    0 |   48 252    4 |
## 3  |    bB |   63  481   17 |   85 127    3 |  142 354   39 |
## 4  |    BG |  113  878  215 |  590 874  255 |   43   5    6 |
## 5  |    dW |  143  345   33 |  100 208    9 |  -81 138   29 |
## 6  |    dE |   67  966   82 | -495 960  107 |  -41   7    3 |
## 7  |    DK |  170  971  327 | -591 869  387 |  202 102  214 |
## 8  |    FI |  136  957   79 | -206 352   38 | -271 605  307 |
## 9  |    HU |  122  927  177 |  477 751  181 |  231 176  201 |
## 10 | (*)BE | &lt;NA&gt;  512 &lt;NA&gt; |   92 338 &lt;NA&gt; |  -66 173 &lt;NA&gt; |
## 11 | (*)DE | &lt;NA&gt;  418 &lt;NA&gt; |  -90 265 &lt;NA&gt; |  -68 153 &lt;NA&gt; |
## 
## Columns:
##     name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1 |    S |   99  816  167 |  421 505 115 |  331 311 335 |
## 2 |    s |  238  781  143 |  309 759 147 |   52  22  20 |
## 3 |      |  168  594   88 |  255 589  71 |  -22   4   2 |
## 4 |    e |  261  871   98 |  -12   2   0 | -262 870 550 |
## 5 |    E |  234  999  505 | -663 971 667 |  113  28  93 |</code></pre>
<p>Rivi- ja sarakeprofiileista esitetään samat tiedot. Ensimmäisessä kolmen
sarakkeen joukossa kerrotaan pisteen massa, laatu (qlt) ja inertiakontribuutio.</p>
<p>Inertiakontribuutio (inr) on suhteellinen osuus kokonaisinertiasta. Aktiivisia rivejä on 9,
joten tasaisesti jaettu inertia olisi noin 110. Tanska, Bulgaria ja Unkari “selittävät”
suurimman osan inertiasta. Belgian ja Saksan alueiden kontribuutiot ovat pieniä.
Nämä inertiaosuudet ovat osuuksia kokonaisinertiasta alkuperäisessä neljässä
ulottuvuudessa.</p>
<p>Laatu kertoo, miten hyvin piste on esitetty kartalla, miten suuri osa sen
inertiasta on esitetty kartalla. Kaksiulotteinen kartta kuten tässä on yleisin
valinta, laatu kerrotaan valitulle dimensioiden määrälle. Laatu ei riipu massasta,
vaan pisteen ja kartan akseleiden välisistä kulmista (kts. teorialiite). Saksan
osien ero laadussa on iso, itä-Saksalla se on erittäin hyvä ja länsi-Saksalla huono.
Belgian alueista Vallonia on huonoimmin esitetty, ja vain Flanderin laatu on
kohtuullisen hyvä. Kovin hyvä ei ole täydentävien maapisteidenkään laatu.</p>
<p>Kaksi seuraavaa kolmen sarakkeen ryhmää kertovat tulokset valituille dimensioille
eli ratkaisulle. Molempien dimensioiden (“k=1”, “k=2”) pääkoordinaattien
(x 1000) lisäksi raportoidaan dimension <em>suhteellinen kontribuutio</em> pisteen
inertiaan (“cor”). Nämä tunnusluvut summautuvat laaduksi (qlt),
ja ne voidaan tulkita korrelaation neliöiksi (kts. teorialiite).</p>
<p>Erityisesti Belgian alueiden projektion laatu on huonompi ensimmäisellä dimensiolla.
Itä-Saksa ja Bulgaria taas ovat hyvin esitettyjä vain ensimmäisellä dimensiolla
eivätkä juuri ollenkaan korreloi toisen dimension kanssa.</p>
<p>Pisteen <em>absoluuttinen kontribuutio</em> kertoo sen osuuden dimension inertiasta
(summa 1000). E-sarake “selittää” ensimmäisen dimension inertiasta noin 66
prosenttia, ja dimensio saman verran kokonaisinertiasta. Absoluuttinen kontribuutio
riippuu massasta ja siitä paljonko piste poikkeaa koko aineiston keskiarvopisteestä.</p>
<p>Numeerisista tuloksista voidaan varmistaa akseleiden tulkinta sarakkeiden avulla.
Sarakkeet ovat hyvin esitettyjä tasossa, ainoastaan neutraali vaihtoehto on
heikommin kuvattu mutta sillä ei ollut roolia tulkinnassa.</p>
<p>E-sarakkeen vaikutuksen suunta ensimmäisellä dimensiolla näkyy pääkoordinaatin
etumerkistä (k1 = -663), ja sen kontrastina ovat S- ja s- sarakkeet positiiviseen
suuntaan. Toinen dimensio on kontrasti S- ja e-sarakkeiden välillä ja ne selittävät
akselin inertian. Kaikki tämä voitiin päätellä kuvasta, ja numeeriset tulokset
vahvistavat tulkinnan. Sarake S on ainoa, jonka kontribuutio on merkittävä
molemmille dimensioille.</p>
<p>Jos pisteen kontribuutio akselille on iso, akselin suhteellinen kontribuutio (cor)
pisteen inertiaan on suuri. Kääntäen tämä ei päde, piste voi olla akselilla hyvin
esitetty mutta kontribuutio on silti pieni.</p>
</div>
<div id="esimerkki-kolmiulotteisesta-kartasta" class="section level2">
<h2><span class="header-section-number">4.3</span> Esimerkki kolmiulotteisesta kartasta</h2>
<p>Belgian ja länsi-Saksan pisteet on esitetty huonosti kaksiulotteisella kartalla.
Kolmiulotteinen ratkaisu näyttää miten ne sijoittuvat kolmannen akselin suunnassa.
Tässä tarkastelu on vain diagnostiikkaa. Toisenlainen esimerkki on tutkimus Ranskan
politiikan dimensiosta (“French political space”) 1990-luvun lopulla
<span class="citation">(LeRoux ja Rouanet <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>, 365)</span>. Siinä Ranskan poliittiset
puolueet sijoitetaan kolmelle sisällöllisesti perustellulle dimensiolle.</p>
<p>Kolmannen dimension hajonnan voi esittää kahtena karttana.</p>
<p>Ensimmäisen ja kolmannen dimension kuvassa näkyy pisteparven hajonta tärkeimmän
dimension ympärillä. Sarakepisteiden järjestys säilyy samana, samoin maapisteiden
oikealta vasemmalle. Kaikki pisteet paitsi Vallonia hajoavat kolmannen akselin
suuntaan. Belgian kahden pisteen (bB ja bF) eron havaitsee helposti, samoin Unkarin
ja Bulgarian.</p>
<div class="figure" style="text-align: center"><span id="fig:suppointCA3map2"></span>
<img src="JH_capaper_files/figure-html/suppointCA3map2-1.png" alt="Q1b: Saksan ja  Belgian aluejako " width="90%" />
<p class="caption">
Kuva 4.3: Q1b: Saksan ja Belgian aluejako
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:suppointCA3map3"></span>
<img src="JH_capaper_files/figure-html/suppointCA3map3-1.png" alt="Q1b: Saksan ja  Belgian aluejako " width="90%" />
<p class="caption">
Kuva 4.4: Q1b: Saksan ja Belgian aluejako
</p>
</div>
<p>Toisen ja kolmannen dimension kartalla on esitetty noin viidesosa kokonaisinertiasta.
Tässäkin kuvassa Brysselin (bB) ja Unkarin pisteet ovat kontrastina Flanderin,
Bulgarian ja Tanskan pisteille.</p>
<p>Diagnostisessa tarkastelussa on helpompaa käyttää dynaamisia kolmiulotteisia
kuvia. R-ympäristössä saa grafiikkaikkunaan tulostettua kolmiulotteisen kuvan,
jota voi käännellä ja katsoa eri kulmista. Näin saa paljon helpommin käsityksen
kolmannen dimension hajonnasta.</p>
<p>Tässä on tyydyttävä kahteen kuvakaappaukseen.</p>
<div class="figure" style="text-align: center"><span id="fig:3dklippi1"></span>
<img src="img/3dSymMap_1.PNG" alt="Saksan ja  Belgian aluejako - 3d-kuva1" width="90%" />
<p class="caption">
Kuva 4.5: Saksan ja Belgian aluejako - 3d-kuva1
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:3dklippi2"></span>
<img src="img/3dSymMap_2.PNG" alt="Saksan ja  Belgian aluejako - 3d-kuva2" width="90%" />
<p class="caption">
Kuva 4.6: Saksan ja Belgian aluejako - 3d-kuva2
</p>
</div>
<p>Miten kaksiulotteisessa kartassa huonosti esitettyjen pisteiden analyysiä voisi
jatkaa? Siihen nämä kartat eivät suoraan anna mitään vastausta. Vaihtoehtoisia
tapoja esitellään seuraavissa luvuissa.</p>

</div>
</div>
<div id="yhteisvaikutusmuuttujat" class="section level1">
<h1><span class="header-section-number">Luku 5</span> Yhteisvaikutusmuuttujat</h1>
<p>Yksinkertaisin tapa tutkia taustamuuttujien yhteisvaikutuksia on yhdistää kaksi
muuttujaa uudeksi luokittelumuuttujaksi (“interactive coding”). Miehet ja naiset
on luokiteltu kuuteen ikäluokkaan (1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65,
6= 66 tai vanhempi).</p>
<p>Poikkileikkausaineistossa vastaajan ikä kertoo myös ikäluokan (kohortin).
Vastaajat ovat kokeneet kaksi suurta mullistusten vuotta elämänsä eri vaiheissa.
Kaksin nuorinta ikäluokka on ollut 1990 alle 14-vuotiaita ja vanhin ikäluokka
yli 44-vuotiaita. Finanssikriisin vuonna 2008 toiseksi nuorin ikäluokka on ollut
22-31 vuotiaita, ja kaksi vanhinta yli 51-vuotiaita. Pelkän ikävaikutuksen
analyysi edellyttäisi vähintään kahden aineiston yhdistämistä.</p>
<p>Kolmen muuttujan yhteisvaikutusmuuttajaan yhdistän vastaajan maan.
myös maa. Käytännössä kolmen luokittelumuuttujan yhdistäminen tekee taulukosta
jo huteron, joissain soluissa havaintojen määrä pienenee. Kaikissa
soluissa on sentään viisi havaintoa tai enemmän. Pienten massojen profiilien ja harvinaisten
kategorioiden vaikutukset on kuitenkin arvioitava, ne voivat joskus mutta onneksi
harvoin määrittää sitä liikaa.</p>
<div id="ikä-ja-sukupuoli" class="section level2">
<h2><span class="header-section-number">5.1</span> Ikä ja sukupuoli</h2>
<p>Ikäjakauma painottuu kaikissa maissa jonkin verran vanhempiin ikäluokkiin.
Nuorempien ikäluokkien osuus on (alle 26-vuotiaat ja alle 26-35 - vuotiaat)
varsinkin Bulgariassa (BG) ja Unkarissa (HU) pieni.</p>
<p>Ikäluokilla on luonnollinen järjestys, niiden pisteet voi yhdistää nuorimmasta
vanhimpaan.</p>
<div class="figure" style="text-align: center"><span id="fig:gaCA1map"></span>
<img src="JH_capaper_files/figure-html/gaCA1map-1.png" alt="Q1b: ikäluokka ja sukupuoli" width="90%" />
<p class="caption">
Kuva 5.1: Q1b: ikäluokka ja sukupuoli
</p>
</div>
<p>Ratkaisu on melko yksiulotteinen, ensimmäinen dimensio kuvaa 87 prosenttia
kokonaisinertiasta. Dimensioiden tulkinta on suurin piirtein sama kuin
edellisissä kartoissa, mutta S-sarake on kiusallisesti s-sarakkeen vasemmalla
puolella. Numeerisista tuloksista näkee, että sarakkeiden s ja E osuus
kokonaisinertiasta (sarake inr) on 768. Niiden kontribuutio x-akselille on
yhteensä vielä suurempi (849). Muut sarakkeet taas kontribuoivat y-akselin
inertiaan, mutta sen osuus kokonaisinertiasta on vain 9 prosenttia. Kun sarakkeet
kuitenkin ovat aika hyvin esitettyjä (qlt), voidaan x- akseli tulkinta hieman
karkeammin samaa mieltä - eri mieltä - tasolla samaksi liberaalien ja
konservatiivisten asenteiden ulottuvuudeksi. Toinen dimensio kuvaa tiukempaa
samanmielisyyttä (S), kontrastina neutraali (?) ja maltillinen erimielisyys (s).</p>
<pre><code>## 
## Principal inertias (eigenvalues):
## 
##  dim    value      %   cum%   scree plot               
##  1      0.037448  87.0  87.0  **********************   
##  2      0.003977   9.2  96.2  **                       
##  3      0.001041   2.4  98.6  *                        
##  4      0.000590   1.4 100.0                           
##         -------- -----                                 
##  Total: 0.043055 100.0                                 
## 
## 
## Rows:
##      name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1  |   f1 |   60  990   36 | -125 614  25 |  -98 376 145 |
## 2  |   f2 |   83  997  163 | -289 983 185 |   35  14  25 |
## 3  |   f3 |   91  984   47 | -146 958  52 |   24  26  13 |
## 4  |   f4 |  101 1000   97 | -186 836  93 |   82 164 172 |
## 5  |   f5 |   98  879    4 |  -35 658   3 |   20 221  10 |
## 6  |   f6 |  100  951  176 |  256 866 175 |   80  85 162 |
## 7  |   m1 |   57  659   32 |   42  72   3 | -120 587 205 |
## 8  |   m2 |   66  977   57 | -187 946  62 |  -34  30  19 |
## 9  |   m3 |   78  457    5 |  -31 318   2 |  -20 139   8 |
## 10 |   m4 |   89  674   14 |   58 482   8 |  -37 192  30 |
## 11 |   m5 |   89  988   90 |  189 818  85 |  -86 170 166 |
## 12 |   m6 |   89  978  277 |  360 963 307 |   45  15  45 |
## 
## Columns:
##     name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1 |    S |   99  915  128 |  196 695 102 |  110 220 304 |
## 2 |    s |  238  969  304 |  230 961 336 |   21   8  27 |
## 3 |      |  168  777   46 |   62 330  17 |  -73 447 223 |
## 4 |    e |  261  897   58 |  -68 473  32 |  -64 424 268 |
## 5 |    E |  234  997  464 | -286 962 513 |   55  35 177 |</code></pre>
<p>Rivien massat ovat melko samankokoisia, mutta kolmen ryhmän (f2, f6 ja m6)
osuus kokonaisinertiasta on 616 ja niiden kontribuutio ensimmäiselle dimensiolle
on 567. Vain 36-45-vuotiaiden miesten (m3) piste on huonosti esitetty (qlt = 457).
Tulkinta on hankalaa miesten ja naisten nuorimman ryhmän osalta, vaikka efekti
kartalla on iso. Molempien osuus kokonaisinertiasta on pieni (inr). Nuoret naiset
(f1) on kuvattu kartalla erittäin hyvin. Nuorten miesten (m1) esityksen laatu
on heikompi, ja kaikista suurin kontribuutio on vain y-akselille. Kun muut
ikäryhmät (paitsi f3) ovat ikäjärjestyksessä vasemmalta oikealle, voi nuorimpien
ja vanhimpien ikäryhmien sijainnin tulkita osittain toisen dimension (varma
mielipide - epävarma mielipide) avulla.</p>
<p>Selvästi kaikissa ikäluokissa miehet ovat konservatiivisempia kuin naiset.
Nuorin ikäluokka on vähemmän varma mielipiteistään kuin vanhin.
Yksi mahdollinen selitys kartan tulkinnan ongelmille on se, että maiden väliset
erot mielipiteissä ovat paljon suurempia kuin sukupuolten väliset maiden sisällä
(ISSP 1994 aineisto, CAiP, s.126).</p>
</div>
<div id="ikä-sukupuoli-ja-maa" class="section level2">
<h2><span class="header-section-number">5.2</span> Ikä, sukupuoli ja maa</h2>
<p>Ikäluokan, sukupuolen ja maan yhteisvaikutusmuuttuja lisää kuvapisteiden
määrää. Kuvasta saa jotenkin selvää, kun sen suurentaa mutta pisteitä on selvästi
liikaa. Joitain muuttujien nimiä voisi lyhentää, kuva-alaa voisi rajata joihinkin
osiin mutta osajoukon korrespondenssianalyysi tarjoaa pätevimmän vaihtoehdon.</p>
<div class="figure" style="text-align: center"><span id="fig:maagaCA1map1"></span>
<img src="JH_capaper_files/figure-html/maagaCA1map1-1.png" alt="Q1b: ikäluokka ja sukupuoli maittain" width="90%" />
<p class="caption">
Kuva 5.2: Q1b: ikäluokka ja sukupuoli maittain
</p>
</div>
<p>Sarakkeiden järjestys vasemmalta oikealle ja ylhäältä alas on sama kuin edellisissä
kartoissa. Dimensioiden tulkinta on sama, osuus inertiasta pienenee x-akselilla
noin 6 prosenttiyksikköä. Pisteiden järjestys liberaalista konservatiiviseen
alkaa Tanskan ja Suomen pisteistä, sitten tulevat Saksan ja Belgian pisteet ja
konservatiivisimpia ovat oikeassa laidassa Unkari ja Bulgaria. Toisella
akselilla maltillisia ja neutraaleja ovat karkeasti Suomen pisteet ja lähes
kaikki Saksan ja Belgian pisteet. Eri maiden osajoukkojen suhteita on hankalampi
hahmottaa, erityisesti kartan oikealla laidalla.</p>
<p>Numeeristen tulosten taulukko on pitkä, mutta kartan informaatio pitää varmistaa.
Numeeriset tulokset eivät ole pelkkää diagnostiikkaa ja kartan esittämien
riippuvuuksien varmistamista. Niistä näkee myös tarkemmin mahdolliset kiinnostavat
piirteet datassa. Regressiomallien tulosten raporteissa diagnostiikka on usein
liitteenä, mutta eksploratiivisessa data-analyysissä se ohjaa analyysiä eteenpäin.</p>
<p>Tässä voi nähdä myös todennäköisyysteoriaan perustuvan tilastollisen mallintamisen
vahvan puolen, aineiston rakenne ja muuttujien yhteydet saadaan parhaassa
tapauksessa esitettyä paljon tiiviimmin.</p>
<pre><code>## 
## Principal inertias (eigenvalues):
## 
##  dim    value      %   cum%   scree plot               
##  1      0.184895  70.3  70.3  ******************       
##  2      0.038751  14.7  85.0  ****                     
##  3      0.024006   9.1  94.1  **                       
##  4      0.015502   5.9 100.0  *                        
##         -------- -----                                 
##  Total: 0.263154 100.0                                 
## 
## 
## Rows:
##      name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1  | BEf1 |   14  678    9 |  -83  43   1 | -320 635  38 |
## 2  | BEf2 |   24  914   11 | -278 650  10 | -177 264  20 |
## 3  | BEf3 |   21  320    3 |  -62  96   0 |  -95 224   5 |
## 4  | BEf4 |   24  164    3 |  -50  92   0 |  -44  71   1 |
## 5  | BEf5 |   23  332    5 |  133 304   2 |  -40  28   1 |
## 6  | BEf6 |   23  832   17 |  371 710  17 |  153 121  14 |
## 7  | BEm1 |   11  429    9 |  284 367   5 | -117  62   4 |
## 8  | BEm2 |   17  372    5 | -113 169   1 | -125 203   7 |
## 9  | BEm3 |   20  108    1 |   17  29   0 |  -29  79   0 |
## 10 | BEm4 |   22  966    5 |  225 812   6 |  -98 154   5 |
## 11 | BEm5 |   22  728    8 |  255 686   8 |  -63  42   2 |
## 12 | BEm6 |   26  788   15 |  348 788  17 |   -5   0   0 |
## 13 | BGf1 |    5  531   11 |  547 531   8 |   -9   0   0 |
## 14 | BGf2 |    8  860   14 |  640 853  17 |   59   7   1 |
## 15 | BGf3 |   12  815   21 |  617 804  24 |   75  12   2 |
## 16 | BGf4 |   10  932   12 |  519 927  15 |  -39   5   0 |
## 17 | BGf5 |   14  880   23 |  609 870  28 |   66  10   2 |
## 18 | BGf6 |   18  921   32 |  627 846  39 |  186  74  16 |
## 19 | BGm1 |    5  940    7 |  596 878   9 |  159  62   3 |
## 20 | BGm2 |    6  830    9 |  557 788  11 | -130  43   3 |
## 21 | BGm3 |    8  709   19 |  655 698  19 |   83  11   1 |
## 22 | BGm4 |    8  771   11 |  540 754  12 |  -81  17   1 |
## 23 | BGm5 |   10  979   11 |  524 977  15 |   21   2   0 |
## 24 | BGm6 |    9  692   27 |  701 647  24 |  184  45   8 |
## 25 | DEf1 |   13  425    3 |  -41  29   0 | -149 395   7 |
## 26 | DEf2 |   15  938   10 | -415 919  14 |  -60  19   1 |
## 27 | DEf3 |   19  846   13 | -333 582  11 | -224 264  24 |
## 28 | DEf4 |   23  985   13 | -390 982  19 |  -18   2   0 |
## 29 | DEf5 |   17  839    7 | -297 772   8 |  -87  67   3 |
## 30 | DEf6 |   23  116    8 |  -56  32   0 |   90  84   5 |
## 31 | DEm1 |   13  912    4 |  124 180   1 | -250 732  20 |
## 32 | DEm2 |   13  766    4 |   38  16   0 | -259 749  22 |
## 33 | DEm3 |   15  737    4 |  -64  63   0 | -210 674  17 |
## 34 | DEm4 |   21  137    5 |   -1   0   0 |  -89 137   4 |
## 35 | DEm5 |   19  603    5 |   76  75   1 | -202 529  20 |
## 36 | DEm6 |   22  849   12 |  244 427   7 |  242 422  34 |
## 37 | DKf1 |   10  991   15 | -567 839  18 |  241 152  15 |
## 38 | DKf2 |   14  991   49 | -888 831  58 |  389 160  53 |
## 39 | DKf3 |   17  963   53 | -816 793  60 |  377 170  61 |
## 40 | DKf4 |   18  977   57 | -826 820  66 |  362 157  61 |
## 41 | DKf5 |   16  998   38 | -753 894  48 |  258 105  27 |
## 42 | DKf6 |   12  808    9 | -340 579   8 |  214 229  14 |
## 43 | DKm1 |   15  981    7 | -329 898   9 |  100  83   4 |
## 44 | DKm2 |   13  989   43 | -895 900  55 |  282  89  26 |
## 45 | DKm3 |   13  982   28 | -728 950  38 |  134  32   6 |
## 46 | DKm4 |   15  941   19 | -534 855  24 |  170  86  11 |
## 47 | DKm5 |   13  643    9 | -281 435   6 |  194 208  13 |
## 48 | DKm6 |   15  355    5 |   89  85   1 |  158 270   9 |
## 49 | FIf1 |   12  980   11 | -417 693  11 | -269 287  21 |
## 50 | FIf2 |   12  927   26 | -730 907  34 | -110  21   4 |
## 51 | FIf3 |   12  984   13 | -423 590  11 | -346 394  36 |
## 52 | FIf4 |   14  991   14 | -398 644  12 | -292 347  32 |
## 53 | FIf5 |   17  952    8 | -240 502   5 | -227 450  23 |
## 54 | FIf6 |   11  835    7 |  151 134   1 | -347 701  35 |
## 55 | FIm1 |    7  787    5 | -115  78   1 | -347 710  22 |
## 56 | FIm2 |    9  977   14 | -598 832  17 | -250 146  14 |
## 57 | FIm3 |    9  998    6 | -345 629   6 | -265 369  16 |
## 58 | FIm4 |   13  837    6 |   19   3   0 | -316 834  33 |
## 59 | FIm5 |   12  734    7 |  220 289   3 | -273 446  23 |
## 60 | FIm6 |    9  911    6 |  336 637   6 | -220 274  12 |
## 61 | HUf1 |    7  723    9 |  499 698   9 |   93  25   1 |
## 62 | HUf2 |   11  689   11 |  438 685  11 |  -35   4   0 |
## 63 | HUf3 |   12  808   18 |  484 586  15 |  298 222  27 |
## 64 | HUf4 |   11  768   18 |  491 564  15 |  296 204  25 |
## 65 | HUf5 |   12  850   13 |  474 753  14 |  170  97   9 |
## 66 | HUf6 |   13  671   34 |  637 581  28 |  251  90  21 |
## 67 | HUm1 |    6  935    5 |  426 766   6 |  201 170   6 |
## 68 | HUm2 |    9  381   11 |  344 381   6 |   -2   0   0 |
## 69 | HUm3 |   13  957   12 |  441 803  13 |  193 154  12 |
## 70 | HUm4 |   10  999   10 |  468 830  12 |  211 169  11 |
## 71 | HUm5 |   13  942   12 |  472 891  15 |  113  51   4 |
## 72 | HUm6 |    8  726   15 |  517 529  11 |  315 197  20 |
## 
## Columns:
##     name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1 |    S |   99  653  155 |  450 492 109 |  258 162 171 |
## 2 |    s |  238  741  174 |  364 687 170 |  102  54  63 |
## 3 |      |  168  535   96 |  284 534  73 |  -11   1   1 |
## 4 |    e |  261  941  103 |  -45  20   3 | -310 921 646 |
## 5 |    E |  234 1000  471 | -714 962 645 |  141  37 119 |</code></pre>
<p>Sarakkeet on kohtalaisen hyvin esitetty, heikoimmin neutraali vaihtoehto (qlt = 535).
Kun sen suhteellinen kontribuutio (cor) on vain 1 toisella dimensiolla jää
loppuosa x-akselille. Maltillisuuden dimensiota määrittää e-sarake (ctr = 646),
ja vain sitä. Ensimmäistä dimensiota määrittää vahvimmin E-sarake (ctr = 645)
liberaaliin ja samaa mieltä olevien sarakkeet (s, S) konservatiiviseen suuntaan.</p>
<p>Kun aineistossa on 72 riviä, on inertian suhteellisen kontribuution keskiarvo
noin 14. Tämän ylittäviä kontribuutiota on Bulgarian naisilla (BGf2, BGf3, BGf5
ja BGf6), kaikilla konservatiiviseen suuntaan. Sama pätee Unkarin naisille, muuten
naisten ikäluokat kontribuoivat yleensä liberaaliin suuntaan. Suomen pisteiden
absoluuttiset kontribuutiot ovat lähes pelkästään toiselle dimensiolle maltilliseen
suuntaan. Tanska taas kontribuoi vahvasti jyrkempien mielipiteiden suuntaan.</p>
</div>
<div id="stabiilisuus" class="section level2">
<h2><span class="header-section-number">5.3</span> Stabiilisuus</h2>
<p>Tarkastelen tässä vain ratkaisustabiiliutta (solution stability). Siinä data on
annettu, ja ratkaisun numeerisista tuloksista nähdään miten pisteet määrittävät
akselit. Ratkaisu on stabiili niiden pisteiden suhteen, jotka eivät vaikuta
siihen.</p>
<p>Ulkoinen stabiilius on laajempi käsite, siinä huomioidaan esimerkiksi
datan suhde johonkin perusjoukkoon (CAiP, s. 225).</p>
<p>Korrespondenssianalyysiä ja erityisesti khii2- etäisyysmittaa on arvosteltu siitä,
että se on liian herkkä harvinaisille luokittelumuuttujan arvoille.
Yhteenvetoartikkelissan <span class="citation">M. Greenacre (<a href="#ref-RefWorks:doc:5c768b09e4b02df9431e950a" role="doc-biblioref">2006</a>)</span> tarttuu ”vaikuttavien
poikkeavien havaintojen myyttiin”, ja pitää sitä lähes aina perusteettomana.</p>
<p>Harvinaiset kategoriat ovat usein kartalla kaukana origosta, mutta jokaisella
pisteellä on massa ja näillä ”outlayereilla” se on pieni. Niinpä niiden
vaikutuskin on vaatimaton.</p>
<p>Harvinaisten kategorioiden vaikutus voi olla suuri, joten numeerisista
tuloksista on tarkistettava, onko hyvin pienen massan pisteillä suuri kontribuutio
ratkaisuun. Käytännössä näin voi käydä esimerkiksi silloin, kun jonkun
harvinaisen luokittelumuuttujan arvon havainnot ovat keskittyneet muutamaan
profiiliin, joissa niiden osuus on suuri (CAiP, s 298). Luvussa 7 nähdään, miten
melko vähäinen määrä puuttuvia vastauksia kasaantuu samaan vastaajien osajoukkoon
ja mitä seurauksia sillä on.</p>
<p>Stabiiliutta voi helposti kokeilla määrittelemällä joitain pisteitä täydentäviksi
pisteiksi.</p>
<p>En löytänyt kartan <a href="#fig:maagaCA1map1">5.2</a> numeerisista tuloksista pienen massan
pisteitä, joilla on merkittävä kontribuutio akseleihin.</p>

</div>
</div>
<div id="osajoukon-korrespondenssianalyysi" class="section level1">
<h1><span class="header-section-number">Luku 6</span> Osajoukon korrespondenssianalyysi</h1>
<p>Graafisessa data-analyysissä kuvien on oltava selkeitä, mutta
korrespondenssianalyysin kartat ovat usein
liian täynnä pisteitä. Ongelmaa voi lieventää jättämällä pois ratkaisuun vain
vähän vaikuttavia pisteitä, keksimällä mahdollisimman lyhyitä symboleja
muuttujille tai rajaamalla kuvaa. Ongelma on kuitenkin syvempi, usein kartta
kertoo aika yllätyksettömän ja ilmeisen tarinan. Kiinnostavammat yhteydet
pysyvät piilossa ylemmissä dimensioissa. MCA-kartan perusongelma on se, että
siinä yritetään esittää monia erityyppisiä yhteyksiä simultaanisesti ja nämä
yhteydet eivät ole “isolated to particular dimensions”
(Greenacre ja Pardo artikkelikokoelmassa <span class="citation">(M. Greenacre ja Blasius <a href="#ref-RefWorks:doc:5ab76b43e4b003f4468d1f07" role="doc-biblioref">2006</a>)</span>, s. 198).</p>
<p>Osajoukon korrespondenssianalyysi (subset CA, subset MCA) on yksi vastaus tähän
pulmaan. Teoreettiset perusteet on esitetty Greenacren ja Pardon artikkelissa
<span class="citation">(M. Greenacre ja Pardo <a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664d87" role="doc-biblioref">2006</a>)</span>. Artikkelin laajennetussa versiossa (emt.)
esimerkkiaineistona on ISSP:n 1994 data. Selkeä oppikirjaesitys on CAiP (ss. 161-).</p>
<p>Eräs sovelluskohde yhteiskuntatieteellisissä kyselyaineistoissa on
puuttuvien vastausten analyysi, johon palataan seuraavassa luvussa.</p>
<p>Osajoukon korrespondenssianlyysin idea on säilyttää koko aineiston massat ja
khii2-etäisyyksien painot mutta analysoida vain osaa aineistosta. Koko aineiston
sentroidi säilyy kartan keksipisteenä. Osajoukkojen inertioiden summa on koko
aineiston inertia.</p>
<p>Osajoukon voi valita havaintojen tai muuttujien suhteen. Täydentäviä pisteitä
voi helposti lisätä kartalle, jos ne eivät kuulu siihen joukkoon josta
osajoukko on valittu. Osajoukon profiilit muuttuvat, niiden summa ei enää ole
yksi ja barysentristä periaatetta ei voi suoraan käyttää täydentävän pisteen
koordinaattien laskemiseen. Tässä esimerkissä emme voi suoraan ca-paketin avulla
sijoittaa esimerkiksi maapisteitä kartoille.</p>
<p>Kartan <a href="#fig:maagaCA1map1">5.2</a> avulla aineiston voi jakaa kahteen ryhmään.
Suomi, Tanska ja Saksa ovat pääakselin oikealla puolella. Bulgaria ja Unkari
ja Belgian kanssa ovat toinen ryhmä.</p>
<div class="figure" style="text-align: center"><span id="fig:maagaCA2sub2map1"></span>
<img src="JH_capaper_files/figure-html/maagaCA2sub2map1-1.png" alt="Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi" width="90%" />
<p class="caption">
Kuva 6.1: Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:maagaCA2sub2map3"></span>
<img src="JH_capaper_files/figure-html/maagaCA2sub2map3-1.png" alt="Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi" width="90%" />
<p class="caption">
Kuva 6.2: Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi
</p>
</div>
<p>Karttoja <a href="#fig:maagaCA2sub2map1">6.1</a> ja <a href="#fig:maagaCA2sub2map3">6.2</a> joutuu katsomaan
aika tarkkaan ennen kuin uskoo, että akseleiden skaalaus on akateeminen pulma
vailla käytännön merkitystä (kts. luku 3.4). Dataa analysoidaan graafisesti, ja kuvat
<em>näyttävät</em> erilaisilta. Pääakselien inertioiden neliöjuuret eivät poikkea toisistaan
huomattavasti ( 0.327 ja 0.158 ), joten
sarakkeiden etäisyyksiä voisi tulkita myös kontribuutiokuvista.</p>
<div class="figure" style="text-align: center"><span id="fig:maagaCA2sub2map2"></span>
<img src="JH_capaper_files/figure-html/maagaCA2sub2map2-1.png" alt="Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi" width="90%" />
<p class="caption">
Kuva 6.3: Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi
</p>
</div>
<pre><code>## 
## Principal inertias (eigenvalues):
## 
##  dim    value      %   cum%   scree plot               
##  1      0.107090  74.6  74.6  *******************      
##  2      0.024985  17.4  92.0  ****                     
##  3      0.006594   4.6  96.6  *                        
##  4      0.004882   3.4 100.0  *                        
##         -------- -----                                 
##  Total: 0.143551 100.0                                 
## 
## 
## Rows:
##      name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1  | DEf1 |   13  467    5 |  -12   3   0 | -162 464  13 |
## 2  | DEf2 |   15  930   19 | -387 799  21 | -157 131  14 |
## 3  | DEf3 |   19  919   25 | -271 385  13 | -318 533  76 |
## 4  | DEf4 |   23  993   25 | -376 913  30 | -111  80  11 |
## 5  | DEf5 |   17  893   13 | -271 641  11 | -169 252  19 |
## 6  | DEf6 |   23   48   15 |  -64  42   1 |   24   6   1 |
## 7  | DEm1 |   13  827    8 |  172 345   3 | -203 482  21 |
## 8  | DEm2 |   13  855    8 |   93  96   1 | -260 759  34 |
## 9  | DEm3 |   15  874    7 |  -13   3   0 | -238 871  34 |
## 10 | DEm4 |   21  285    8 |   25  11   0 | -126 274  13 |
## 11 | DEm5 |   19  684   10 |  116 174   2 | -198 510  30 |
## 12 | DEm6 |   22  750   22 |  190 260   8 |  261 490  61 |
## 13 | DKf1 |   10  979   27 | -603 949  35 |  107  30   5 |
## 14 | DKf2 |   14  996   89 | -955 960 115 |  184  36  18 |
## 15 | DKf3 |   17  985   98 | -885 933 122 |  210  53  29 |
## 16 | DKf4 |   18  983  104 | -889 950 132 |  165  33  20 |
## 17 | DKf5 |   16 1000   69 | -792 988  92 |   86  12   5 |
## 18 | DKf6 |   12  834   17 | -386 745  17 |  133  89   9 |
## 19 | DKm1 |   15  978   13 | -342 971  17 |   30   7   1 |
## 20 | DKm2 |   13  997   79 | -938 988 104 |   90   9   4 |
## 21 | DKm3 |   13  989   52 | -743 989  69 |  -14   0   0 |
## 22 | DKm4 |   15  962   36 | -563 952  45 |   57  10   2 |
## 23 | DKm5 |   13  682   16 | -314 543  12 |  159 139  13 |
## 24 | DKm6 |   15  291    9 |   45  22   0 |  158 269  15 |
## 25 | FIf1 |   12  951   20 | -346 478  13 | -345 474  55 |
## 26 | FIf2 |   12  941   48 | -680 788  50 | -300 153  42 |
## 27 | FIf3 |   12  952   24 | -335 370  12 | -420 582  82 |
## 28 | FIf4 |   14  999   25 | -323 426  14 | -375 573  82 |
## 29 | FIf5 |   17  982   14 | -185 299   6 | -280 683  55 |
## 30 | FIf6 |   11  704   13 |  217 274   5 | -271 430  33 |
## 31 | FIm1 |    7  624    8 |  -40  10   0 | -323 614  30 |
## 32 | FIm2 |    9  984   26 | -525 640  22 | -385 344  52 |
## 33 | FIm3 |    9  990   12 | -279 412   6 | -331 578  38 |
## 34 | FIm4 |   13  944   11 |   90  67   1 | -324 877  54 |
## 35 | FIm5 |   12  722   14 |  267 426   8 | -222 295  23 |
## 36 | FIm6 |    9  911   11 |  373 785  12 | -150 126   8 |
## 
## Columns:
##     name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1 |    S |   99  731  107 |  276 493  71 |  192 238 147 |
## 2 |    s |  238  832  114 |  218 688 105 |  100 144  94 |
## 3 |      |  168  647   88 |  208 576  68 |   73  70  35 |
## 4 |    e |  261  992  135 |   85  96  17 | -258 896 697 |
## 5 |    E |  234 1000  556 | -582 992 739 |   53   8  27 |</code></pre>
<p><strong>Tulkintaa</strong></p>
<p>Kolmen maan osajoukon ratkaisussa 2. dimensiolla (maltillinen liberaali - tiukka konservatiivi) on
inertiasta 17 prosenttia, edellä ollut paljon yksiulotteisempia ratkaisuja. Huono kvaliteetti (qlt)
on ryhmillä DEf1 (467) ja DEf6 (48), DEm4 (285). Tanskan havainnoista vanhimmat miehet
(DKm6,291) ovat kaikkein huonoimmin esitettyjä ratkaisussa, ja hieman nuoremmatkin
(DKm5, 682). Suomen aineistossa vain nuoret miehet (FIm1, 624) on esitetty kartalla
huonosti. Kaksi dimensiot selittävät osajoukon kokonaishajonnasta 92%, mutta muutaman
ryhmän hajonta on muissa dimensioissa. Saksan naisten iäkkäin ikäluokka (DEf6)
ja keski-ikäisen miehet (DEm4) vain näyttävät olevan lähekkäin origon tuntumassa,
samoin muutama muu huonosti tasoon sijoitettu piste. Huonosti kuvatuista pisteistä kuva
ei oikeastaan mitään muuta.</p>
<p>Sarakkeet on esitetty kohtalaisen hyvin, ja symmetrisessä kartassa tärkeimmälle
dimensioille projisoidut sarakepisteet ovat odotetussa järjestyksessä.</p>
<p>Kontribuutiokartasta nähdään, että tärkein kontrasti on tiukan erimielisyyden (E)
ja kaikkien muiden vastausvaihtoehtojen välillä. Epävarmojen tai maltillisten (e)
kontrasti hallitsee toista dimensiota, erityisesti S- ja s- kategorioiden kanssa.
Samalla kuvasta näkee (ja numeerisista tuloksista voi vahvistaa), että S-piste on
on lähempänä (kulma on pienempi) pystyakselia. Kontribuutio on suurempi (147 vs.
71 x-akselille). Toisaalta x-akseli selittää selvästi suurimman osan kaikkien muiden
sarakepisteiden inertiasta, ja y-akseli taas lähes täysin e-pisteen inertian.</p>
<p>Kartasta <a href="#fig:maagaCA2sub2map2">6.3</a> nähdään, että naisten ikäluokat ovat
kaikissa maissa liberaalimpia kuin vastaavat miesten ikäluokat. Nuorin ikäluokka
on konservatiivisemmalla puolella ja samalla toisella dimensiolla maltillisemmalla
puolella. Vanhemmat ikäluokat ovat konservatiivisempia.</p>
<div class="figure" style="text-align: center"><span id="fig:maagaCA2sub3map1"></span>
<img src="JH_capaper_files/figure-html/maagaCA2sub3map1-1.png" alt="Ikä, sukupuoli ja maa: Belgia-Bulgaria - Unkari" width="90%" />
<p class="caption">
Kuva 6.4: Ikä, sukupuoli ja maa: Belgia-Bulgaria - Unkari
</p>
</div>
<p>Belgian, Unkarin ja Bulgarian kartalla ensimmäisen dimension tulkinta
pysyy samana, mutta nyt molemmat erimieliset (E, e) vastauskategoriat ovat
selvästi vasemmalla liberaalilla puolella. Ne ovat lähes x-akselin päällä,
kun ensimmäisen osajoukon kartalla e-sarake oli oikealla ja alhaalla kontrastina
S- ja s- vastauksille ja myös neutraalille vaihtoehdolle. Kartan toinen dimensio
erottelee nyt tiukasti ja lievemmin samaa mieltä olevat, neutraali vaihtoehto
jää väliin.</p>
<p>Belgian nuoremmat ikäluokat ovat liberaalilla puolella, ja kiinnostavasti
kaksi vanhinta miesten ryhmää on pystysuunnassa kaikkein maltillisimpia.
Bulgarian ja Unkarin pisteen ovat tiukasti konservatiivisella puolella.
Vaihtelua on maltillisemman ja jyrkemmän konservatiivisuuden välillä
pystysuuntaan. Toisen dimension kontrasti on myös hieman yllättäen
Bulgarian nuorimpien naisten (BGf1) Unkarin vanhimpien naisten (HUf6)
välillä.</p>
<p>Kuvan <a href="#fig:maagaCA2sub2map2">6.3</a> tapaan ei Bulgarian ja Unkarin
ikäluokkia kannata yhdistää. Järjestys toki löytyy, mutta ei ollenkaan
niin selkeä. Saksan naisten ikäluokkakuva alkaa erkaantua hieman Suomen ja Tanskan
hyvin samanlaisista kuvioista. Saksan miehillä on jo eroja paljon toisen
dimension suuntaan, Unkarin ja Bulgarian osajoukkojen erot ovat lähes
pelkästään pystysuoria.</p>
<p>Suhteellinen kontribuutio eli pisteen laatu (numeerisissa
tuloksissa “cor”) on esitetty värisävynä. Sarakkeista e ja “?” on
esitetty huonosti, riveistä Belgian nuorimmat miehet ja naiset.</p>
<div class="figure" style="text-align: center"><span id="fig:maagaCA2sub3map2"></span>
<img src="JH_capaper_files/figure-html/maagaCA2sub3map2-1.png" alt="Ikä, sukupuoli ja maa: Belgia-Bulgaria - Unkari 2" width="90%" />
<p class="caption">
Kuva 6.5: Ikä, sukupuoli ja maa: Belgia-Bulgaria - Unkari 2
</p>
</div>
<p>Kontribuutiokartta (fig:maagaCA2sub3map2) eroaa kartasta (fig:maagaCA2sub2map3)
kolmen akselin (E, S ja s) erilaisella vaikutuksella ratkaisuun. Konservatiiviset
sarakepisteet ovat vaikuttavampia kuin E, maltillinen liberaali (s) ja neutraali vaihtoehto
vaikuttavat vähemmän.</p>
<p>Listataan vielä toisen osajoukon ratkaisun numeeriset tulokset.</p>
<pre><code>## 
## Principal inertias (eigenvalues):
## 
##  dim    value      %   cum%   scree plot               
##  1      0.086111  72.0  72.0  ******************       
##  2      0.018841  15.8  87.8  ****                     
##  3      0.011172   9.3  97.1  **                       
##  4      0.003477   2.9 100.0  *                        
##         -------- -----                                 
##  Total: 0.119602 100.0                                 
## 
## 
## Rows:
##      name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1  | BEf1 |   14  152   19 | -156 152   4 |    2   0   0 |
## 2  | BEf2 |   24  826   24 | -313 824  28 |   13   1   0 |
## 3  | BEf3 |   21  623    7 |  -90 201   2 |  130 422  19 |
## 4  | BEf4 |   24  556    6 |  -65 155   1 |  105 401  14 |
## 5  | BEf5 |   23  355   11 |  115 227   3 |   86 128   9 |
## 6  | BEf6 |   23  810   37 |  396 810  41 |   10   0   0 |
## 7  | BEm1 |   11  288   21 |  246 274   8 |   55  14   2 |
## 8  | BEm2 |   17  333   11 | -144 271   4 |   68  61   4 |
## 9  | BEm3 |   20  531    2 |    6   4   0 |   75 528   6 |
## 10 | BEm4 |   22  620   11 |  197 618  10 |   -8   1   0 |
## 11 | BEm5 |   22  917   18 |  243 620  15 | -168 297  33 |
## 12 | BEm6 |   26  977   33 |  347 782  36 | -173 195  41 |
## 13 | BGf1 |    5  979   23 |  557 549  18 | -492 430  63 |
## 14 | BGf2 |    8  974   32 |  649 875  38 | -219  99  20 |
## 15 | BGf3 |   12 1000   46 |  633 844  54 | -271 155  45 |
## 16 | BGf4 |   10  847   25 |  496 847  30 |    7   0   0 |
## 17 | BGf5 |   14  961   50 |  618 894  62 | -168  66  21 |
## 18 | BGf6 |   18  939   71 |  658 931  92 |  -60   8   4 |
## 19 | BGm1 |    5  999   15 |  608 912  19 |  188  87   9 |
## 20 | BGm2 |    6  892   21 |  526 703  20 | -273 189  25 |
## 21 | BGm3 |    8  994   41 |  677 746  43 | -390 247  64 |
## 22 | BGm4 |    8  669   25 |  508 666  23 |  -34   3   0 |
## 23 | BGm5 |   10  949   24 |  516 947  32 |  -22   2   0 |
## 24 | BGm6 |    9  978   58 |  748 737  60 | -428 241  89 |
## 25 | HUf1 |    7  888   20 |  493 681  19 |  271 207  26 |
## 26 | HUf2 |   11  762   25 |  406 589  20 |  220 173  27 |
## 27 | HUf3 |   12  916   39 |  525 688  37 |  301 227  56 |
## 28 | HUf4 |   11  970   40 |  528 651  36 |  370 319  81 |
## 29 | HUf5 |   12  985   29 |  490 802  32 |  234 183  34 |
## 30 | HUf6 |   13  933   75 |  655 614  64 |  472 319 151 |
## 31 | HUm1 |    6  948   12 |  455 871  14 |  135  77   6 |
## 32 | HUm2 |    9  902   24 |  312 313  10 |  428 589  90 |
## 33 | HUm3 |   13  945   26 |  477 938  33 |  -41   7   1 |
## 34 | HUm4 |   10  965   22 |  503 960  29 |   36   5   1 |
## 35 | HUm5 |   13  993   26 |  478 916  33 |  139  77  13 |
## 36 | HUm6 |    8  839   33 |  560 622  29 |  331 217  46 |
## 
## Columns:
##     name   mass  qlt  inr    k=1 cor ctr    k=2 cor ctr  
## 1 |    S |   99  944  214 |  351 479 142 |  346 465 630 |
## 2 |    s |  238  942  247 |  297 711 244 | -169 231 362 |
## 3 |      |  168  435  107 |  180 426  63 |   26   9   6 |
## 4 |    e |  261  640   65 | -138 639  57 |   -4   0   0 |
## 5 |    E |  234  966  368 | -426 965 494 |   10   1   1 |</code></pre>
<p>Kahden osajoukon inertioiden summa on sama kuin koko aineiston
( 0.144 + 0.12 = 0.263).
Selitysasteet nousevat hieman, ja aineiston riippuvuuden rakenteesta saadaan esiin
selviä eroja. Osajoukkojen analyysi täydentää ja tarkentaa
yleiskuvaa (@ref:fig:maagaCA1map1).</p>
<p>Belgian pisteistä osalla on huono kvaliteetti (BEf1, BEf5, BEm1, BEm2). Bulgaria ja
Unkari hyvin esitetty. Belgia on pulmallinen tapaus, ehkä taas omissa dimensioissaan.
Belgian poikkeavuus (annetulla aluejaolla) on kiinnostava havainto, korrespondenssianalyysin
tavoite ei ole pelkästään kohtuullisen luotettava yleiskuva taulukon riippuvuuksista.
Poikkeavat havainnot eivät ole ongelma, vaan datan ominaisuus.</p>

</div>
<div id="monimuuttujakorrespondenssianalyysi-mca" class="section level1">
<h1><span class="header-section-number">Luku 7</span> Monimuuttujakorrespondenssianalyysi (MCA)</h1>
<p>Usean muuttujan samanaikainen analyysi voidaan korrespondenssianalyysissä
jakaa kahteen erialaiseen tutkimusasetelmaan. Ensimmäisessä tutkitaan kahden
erilaisen muuttujaryhmän välisiä suhteita, toisessa yhden homogeenisen
muuttujaryhmän sisäisiä suhteita.</p>
<p>Esimerkkiaineistossa haastateltavien
vastaukset substanssikysymyksiin ovat oma ryhmänsä ja taustamuuttujat toinen
ryhmä. Kahden muuttujaryhmän välisiä suhteita voidaan tutkia rakentamalla
yhdistetty matriisi useasta kahden muuttujan ristiintaulukoinnista.
Tämä pinottujen ja yhdistettyjen (stacked and concatenated) taulukoiden
menetelmä (CAiP s. 129) ei kerro muuttujaryhmien sisäisistä yhteyksistä,
joita edellä analysoitiin vuorovaikutusmuuttujien avulla.</p>
<p>Toinen asetelma on keskenään homogeenisten muuttujien välisten suhteiden analyysi.
Monimuuttujakorrespondenssianalyysi (multiple correspondence analysis, MCA)
soveltuu hyvin kyselytutkimusten vastausten analyysiin. MCA - kartoilla voidaan
esittää myös havainnot, mutta usein on järkevämpää
käyttää kartalla taustamuuttujien keskiarvopisteitä. Keskiarvopisteisiin voi simuloimalla lisätä
luottamusellipsit (CAiP, s. 299).</p>
<p>Esitän molemmista analyyseistä yhden esimerkin. MCA-esimerkissä otan käyttöön
kaikki aineiston havainnot ja useita vastausmuuttujia, puuttuvat tiedot ovat
mukana yhtenä luokittelumuuttujan arvona.</p>
<p>Yksinkertaisen korrespondenssianalyysin yleistys usean muuttujan samanaikaiseen
analyysiin ei ole aivan yksikertainen asia. Silti MCA toimii käytännössä usein
hyvin juuri kyselytutkimusten analyysissä. Vaikka geometrinen tulkinta ei ole
läheskään niin selkeä kuin yksinkertaisessa korrespondenssianalyysissä,
skaalaustulkinta on pätevä. MCA-kartat esittävät luokittelumuuttujien arvot
optimaalisesti, kartalla esitettyjen havaintopisteiden hajonta on maksimaalinen
<span class="citation">(Greenacre ja Hastie <a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664d84" role="doc-biblioref">1987</a> , s. 447, kts. myös Liite 1)</span>.</p>
<div id="pinotut-ja-yhdistetyt-taulukot" class="section level2">
<h2><span class="header-section-number">7.1</span> Pinotut ja yhdistetyt taulukot</h2>
<p>Pinottujen taulukoiden idea on esitetty kuvassa <a href="#fig:stackedimg1">7.1</a>. Taulukossa
kaksi “selitettävää” muuttujaa on ristiintaulukoitu kolmen taustamuuttujan kanssa.</p>
<p>Jos reunajakaumat ovat samat eli puuttuvia tietoja ei ole, taulukon kokonaisinertia
on osataulukoiden inertioiden keskiarvo. Taulukon analyysi on yhden kysymyksen
ja yhden taustamuuttujan parittaisten suhteiden analyysiä, yksi pari kerrallaan.</p>
<p>Pierre Bourdieun tunnettu tutkimus La Distiction (1979) sovelsi tätä menetelmää.
Ranskan väestö luokitellaan ammattiryhmiin ja taulukoidaan useiden elämäntapaa
kuvaavien muuttujien kanssa. Taulukot yhdistetään pinoamalla ne
päällekkäin ( <span class="citation">M. Greenacre ja Blasius (<a href="#ref-RefWorks:doc:5ab76b43e4b003f4468d1f07" role="doc-biblioref">2006</a>)</span> , s.21).</p>
<div class="figure" style="text-align: center"><span id="fig:stackedimg1"></span>
<img src="img/stacked1.png" alt="Pinotut ja yhdistetyt taulut - periaate" width="50%" />
<p class="caption">
Kuva 7.1: Pinotut ja yhdistetyt taulut - periaate
</p>
</div>
<p>Seuraavassa esimerkissä “selitettäviä” luokittelumuuttujia on vain yksi. Tällainen
pinotun taulun analyysi on eräänlainen kaikkien siihen kuuluvien taulukoiden
“keskiarvokartta” (CAiP, s 136). Kysymyksen Q1b vastausten ristiintaulukointi
ikäluokan ja sukupuolen kanssa liitetään maarivien taulukkoon.</p>
<p>Pisteiden määrä kartoilla kasvaa, ja muuttujanimiä joudutaan tiivistämään.
Toinen tekninen detalji on kartan kääntäminen. Kuvat kääntyvät herkästi akselien
ympäri, vertailun helpottamiseksi koordinaattien etumerkkejä joutuu joskus
muuttamaan (kts. Liite 3: R-koodi).</p>
<div class="figure" style="text-align: center"><span id="fig:concat1map1"></span>
<img src="JH_capaper_files/figure-html/concat1map1-1.png" alt="Q1b: Lapsi kärsii jos äiti käy työssä" width="90%" />
<p class="caption">
Kuva 7.2: Q1b: Lapsi kärsii jos äiti käy työssä
</p>
</div>
<p>Tulkinta ei muutu, eikä maapisteiden sijaintikaan.</p>
<p>Koko aineiston kartassa ikäluokkapisteet ja sukupuolipisteet ovat pakkautuneet
maapisteitä tiiviimmin origon ympärille. Ikäluokkapisteiden (koko aineiston
keskiarvot) selvä kontrasti on vanhimman (a6) ja toiseksi
nuorimman välillä 1. dimension suuntaan.</p>
<p>Ikäluokkapisteet ovat koko aineiston keskiarvopisteitä, niiden sijaintia voi
tulkita pistejoukko kerrallaan kuten maapisteidenkin. Naispiste on tiukassa
nipussa ikäluokkien a3 ja a4 kanssa aivan origon vasemmalla puolella. Miesten
keskiarvopiste on hieman origosta oikealle, yhdessä ikäluokan a5 kanssa.</p>
<p>Lisäpisteet on hyvin esitetty, niiden etäisyyksiä voi luotettavasti arvioida
kuvasta. Poikkeus on nuorin ikäluokka (a1, qlt = 501). Inertian osuudet (inr)
ovat yhtä vaatimattomia kuin Belgian (28) ja Saksan (29),
(m =20, f = 17, a2 = 40, a6 = 83), samoin kontribuutiot akseleiden inertiaan.
1. dimension kontribuutio (ctr) on suuri (&gt;800) kaikilla paitsi nuorimmalla
ikäryhmällä (a1) jolla 2. dimension selittää lähes puolet sen inertiasta (470).
En esitä numeerisia tuloksia tarkemmin.</p>
<p>Karttaa <a href="#fig:concat1map1">7.2</a> voi verrata karttaan <a href="#fig:gaCA1map">5.1</a> jossa on esitetty iän ja sukupuolen yhteisvaikutusmuuttuja. Pinottu taulu on vaihtoehtoinen tapa, ja kartasta
<a href="#fig:concat1map1">7.2</a> voi päätellä samat asiat: miehet ovat konservatiivisempia
kuin naiset, iäkkäämmät ovat konservatiivisempia kuin nuoret. Nuorin ikäluokka
poikkeaa muista.</p>
<div class="figure" style="text-align: center"><span id="fig:concat1map2"></span>
<img src="JH_capaper_files/figure-html/concat1map2-1.png" alt="Q1b: Lapsi kärsii jos äiti käy työssä" width="90%" />
<p class="caption">
Kuva 7.3: Q1b: Lapsi kärsii jos äiti käy työssä
</p>
</div>
<p>Kontribuutionkartan sarakkeista E-sarake (täysin eri mieltä) määrittää akseleita
vahvasti, kontrastina kaksi konservatiivista vastausta (S ja s) ja myös
neutraali vaihtoehto (e). Numeeriset tulokset kertovat, että ikäluokat
vaikuttavat juuri ensimmäiseen tärkeimpään dimensioon.</p>
<p>Belgian ja Saksan pisteet on esitetty kartassa huonosti, samoin nuorin ikäluokka.
Muiden pisteiden sijaintia voidaan arvioida myös sarakkeiden ja rivipisteiden
välillä. Ikäluokkien kontrasti on selvä toiseksi nuorimman (a2) ja vanhimman (a6)
välillä.</p>
<p>Kontribuutiokartalla voi arvioida hieman tarkemmin ikäluokkien ja vastausvaihtoehtojen
yhteyttä sarake kerrallaan. Maltillisesti eri mieltä olevien osuus on suhteellisesti
suurin nuorimmassa ikäluokassa. Jos a1 - pisteen projisoi konservatiivisen
S-vastauksen janalle se ei ikäluokista konservatiivisin. Ikäluokat a2 ja a6 ovat
ääripäitä, muut ikäluokat sijoittuvat lähelle toisiaan mutta liberaalille puolelle.</p>
<p>Esimerkkiaineistossa ei ole puuttuvia tietoja. Ne olisivatkin
pulmallisia, varianssin dekomponointi ei onnistu, jos reunajakaumat ovat
alitaulukoissa selvästi erilaisia.</p>
<p>Matriisien yhdistely on monipuolinen laajennus. Eräs kiinnostava malli on
ABBA, kahden rakenteeltaan samanlaisen matriisin yhdistäminen lohkoina. Nimi
kertoo yhdistetyn matriisin rakenteen (block circulant matrix),
päällekkäin pinotut A ja B liitetään toiseen pinottuun matriisiin B ja A.
Matriiseilla on samat rivit ja sarakkeet, esimerkiksi miesten ja naisten
vastausprofiilit yhteen kysymykseen maittain luokiteltuina. Kokonaisinertia
saadaan dekomponoitua ryhmien sisäiseen ja väliseen hajontaan kahdelle kartalle.
Toinen kuvaa maiden välisiä eroja ja toinen maiden sisäisiä sukupuolten välisiä
eroja (CAiP ss. 177-)</p>
</div>
<div id="monimuuttujakorrespondenssianalyysi-mca-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Monimuuttujakorrespondenssianalyysi (MCA)</h2>
<p>MCA on yhdistettyjen (”pinottujen”) taulukoiden erikoistapaus, samantyyppiset
muuttujat taulukoidaan keskenään. Tulos riippuu siis vain muuttujien
parittaisista yhteyksistä.</p>
<p>Tätä ”supertaulukkoa” kutsutaan <em>Burtin matriisiksi</em>.
<em>Indikaattorimatriisi</em> on toinen tapa esittää data. Indikaattorimatriisin
sarakkeet ovat luokittelumuuttujan arvoja (kategorioita) ja rivit yksittäisiä
vastausprofiileja. Profiilissa on rivi nollia ja ykkösiä, 1 valitun vaihtoehdon
sarakkeessa.</p>
<p>En tässä jaksossa esitä numeerisia tuloksia, niiden tutkimisella voi jatkaa
analyysiä.</p>
<p>Tavoite on tutkia seitsemän kysymyksen vastausvaihtoehtojen yhteyksiä,
miten ne asettuvat kaksiulotteiselle kartalle. Aikaisemmissa jaksoissa etsittiin
yhteyksistä uusia piirteitä ja tarkennettiin analyysiä. Nyt hahmotetaan ison
aineiston muuttujien välisiä yhteyksiä ja erityisesti puuttuvien tietojen ongelmaa.</p>
<p>Koko datassa (kts. luku 2) on 32823 havaintoa 25 maasta. Niistä täydellisiä on
71 prosenttia. Jos valitaan kuusi taustamuuttujaa (edu, sosta, urbru,
maa, ika, sp) ja seitsemän kysymystä, täydellinen havaintoja on 81 prosenttia.</p>
<p>Pelkissä kysymyksissä (Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b) puuttuvia tietoja on
14 prosentissa havaintoja (4554). Kaikkien puutteellisten havaintojen poistamien
(”listwise delete”) on sitä huonompi vaihtoehto mitä enemmän muuttujia on.</p>
<p>Kaikissa kysymyksissä on viisi vastausvaihtoehtoa ja kuudes kategoria puuttuvalle
tiedolle.</p>
<div class="figure" style="text-align: center"><span id="fig:MCA1map1"></span>
<img src="JH_capaper_files/figure-html/MCA1map1-1.png" alt="MCA: Seitsemän kysymystä - 25 maata, kartta 1" width="90%" />
<p class="caption">
Kuva 7.4: MCA: Seitsemän kysymystä - 25 maata, kartta 1
</p>
</div>
<p>Inertian selitysosuudet ovat paljon pienempiä, ja ratkaisu
on selvästi kaksiulotteinen. Puuttuvat vastaukset erottuvat omana ryhmänä, ja
varsinaiset vastaukset ovat pakkautuneet y-akselin oikealle puolelle. Niiden erot
näkyvät vain toisessa dimensiossa. Ensimmäinen dimensio kuvaa vastaamattomuutta,
kontrastina kaikki vastauskategoriat. Kokonaisinertiaa on korjattu
pienemmäksi (ns. adjusted inetia, kts. liite 1).</p>
<p>Pystyakselin suuntaan kontrasti näyttäisi olevan konservatiiviset ylhäällä,
modernit ja liberaalimmat alhaalla. Pisteitä on vaikea erottaa toisistaan.</p>
<p>Karttaa voi parantaa lisäämällä siihen vastaajien pisteet.</p>
<div class="figure" style="text-align: center"><span id="fig:MCA1map2"></span>
<img src="JH_capaper_files/figure-html/MCA1map2-1.png" alt="MCA: Seitsemän kysymystä - 25 maata, kartta 2" width="90%" />
<p class="caption">
Kuva 7.5: MCA: Seitsemän kysymystä - 25 maata, kartta 2
</p>
</div>
<p>Jokainen havainto on sarakevektoreiden keskiarvopiste. Sarakevektoreita ei voi
tulkita yhtä selkeästi kuin yksinkertaisessa korrespondenssianalyysissä. Ne eivät
edusta kysymystä vaan kysymyksen yhtä vastauskategoriaa.</p>
<p>Pistepilven muoto näyttää, miten pienenevä joukko vastaajia lähestyy kiilana
puuttuvien tietojen pisteitä. Kaikkiin kysymyksiin vastanneet ovat massana kuvan
oikeassa laidassa. Pistepilvet oikealta vasemmalle kuvaavat kuinka moneen
kysymykseen on jätetty vastaamatta.</p>
<p><strong>Osajoukon MCA</strong></p>
<p>Osajoukon MCA sopii hyvin sekä puuttuvien tietojen että täydellisten vastausten
analyysiin. Asymmetrisessä kartassa sarakkeet skaalautuvat pois origosta, ja
näkyvät paremmin. Kuvaan on piirretty havaintopisteet, joista voi hahmottaa
havaintojen sijoittumista kartalla.</p>
<div class="figure" style="text-align: center"><span id="fig:subsetMCA1map3"></span>
<img src="JH_capaper_files/figure-html/subsetMCA1map3-1.png" alt="MCA: Seitsemän kysymystä - 25 maata, kartta 3" width="90%" />
<p class="caption">
Kuva 7.6: MCA: Seitsemän kysymystä - 25 maata, kartta 3
</p>
</div>
<p>Kontrasti on “ääripäiden” välillä, vahvat mielipiteet (S ja E) hallitsevat vasenta
alakulmaa ja oikeaa laitaa x-akselin tuntumassa. Maltilliset vastaukset ja
neutraali vaihtoehto ovat ylhäällä vasemmalla. Liberaalit vastaukset ovat oikealla
ylhäällä ja jokaiselle löytää vastinparin vasemmalta alhaalta, konservatiivien
kulmasta. Konservatiivisten vastausten joukosta lähimpänä liberaalia ryvästä on
“e1S” (“Kotirouvana oleminen on aivan yhtä antoisaa kuin ansiotyön tekeminen”
- täysin samaa mieltä). Vastaavasti “a2S” (“Sekä miehen että naisen tulee
osallistua perheen toimeentulon hankkimiseen” - täysin samaa mieltä) on lähimpänä
konservatiivista kulmaa. Molemmat “ääripäiden maltilliset” pisteet ovat myös
omassa ryhmässään lähimpänä maltillisten ja neutraalien vastausten ryhmää.</p>
<p>Karttaan voi hahmotella diagonaalin suuntaisen
akselin vahvojen mielipiteiden ryppäiden välille. Muut vastaukset ovat
mukaisesti näiden välisellä kaarevalla linjalla (Guttman-efekti).</p>
<p><span class="citation">Greenacre (<a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d7c" role="doc-biblioref">2010</a>)</span> (s. 139-) analysoi lähes samoja kysymyksiä
ISSP-datalla 2002. Tulokset ovat hyvin samantapaisia. Karttaa (fig:subsetMCA1map3)
vastaavan kuvan jatkoanalyysi on vasemman yläkulman pisteiden tarkempi analyysi.
Greenacre havaitsee, että nämä neutraalit ja maltilliset vastaukset eivät ole
hyvin esitettyjä kaksiulotteisella kartalla, vaan ne karkaavat korkeampiin
ulottuvuuksiin (“dimensions of middleness”).</p>
<p>Tässä aineistossa kolmiulotteinen MCA antaa samantapaisia viitteitä, mutta vain osa
keskikategorioista on huonosti esitetty myös siinä. Huono kvaliteetti on vain
osalla sarakkeita (e1? 475, c1? 71 ja b1? 573).</p>

</div>
</div>
<div id="yhteenveto" class="section level1">
<h1><span class="header-section-number">Luku 8</span> Yhteenveto</h1>
<p>Tutkielman data-analyysi päättyi vaiheeseen, josta voi jatkaa laajan aineiston
analyysiä. Analyysin kysymykset näyttävät erottelevan hyvin ja johdonmukaisesti
vastaajat konservatiivisen ja liberaalimman modernimman mielipiteen välillä.
Neutraali vaihtoehto ja ”dimensios of middleness” kannattaa huomioida.
Puuttuvat tiedot voi korrespondenssianalyysissä analysoida omana osajoukkona
ja päättää miten menettelee.</p>
<p>Korrespondenssianalyysi sopii hyvin yksinkertaisen kahden luokittelumuuttujan
riippuvuuksien visualisointiin. Kuvan oikea analyysi onnistuu pienellä
harjoittelulla. Tämä ei ole mitätön asia, taulukoita on kaikkialla. Menetelmä
laajenee joustavasti myös mutkikkaampiin tutkimusasetelmiin.</p>
<p>Useiden muuttujien samanaikainen analyysi onnistuu kahdella tavalla, taulukoita
yhdistelemällä tai monimuuttujakorrespondenssianalyysillä (MCA). Tulkinta muuttuu
vaativammaksi, mutta MCA-esimerkki luvussa 7 esittää myös menetelmän pätevyyden.</p>
<p>Aineiston sisällöllisesti tärkeät muuttujat ovat järjestysasteikon muuttujia.
Tutkimusasetelmissa vertailtiin eri ryhmiä ja kuvattiin niiden yhteyksiä
vastauskategorioihin. Korrespondenssianalyysi on luokitteluasteikon muuttujille
sopiva menetelmä, järjestysasteikon muuttujien ”oikeita etäisyyksiä” voidaan
arvioida.</p>
<p>Data-analyysi osoitti, että maiden tai muiden ryhmien vertailu ei ole niin
yksinkertaista kuin ehkä luullaan. <span class="citation">Blasius ja Thiessen (<a href="#ref-RefWorks:doc:5b15542ee4b0e2616bc42dca" role="doc-biblioref">2006</a>)</span>
tutkivat MCA-menetelmällä ISSP:n 1994 kerättyä aineistoa. He osoittavat, että
datan laatu ja rakenne vaihtelee paljon maiden välillä (”…both the quality of
the data, as well as its underlying structure - and therefore meaning - vary
considerably between countries.”).</p>
<p>Datan laadun ja rakenteen lisäksi järjestysasteikon käyttöön yleisempi ongelma.
Voiko vastaajien ryhmiä vertailla keskenään järjestysasteikollisen muuttujan
jonkinlaisilla keskiarvoilla? <span class="citation">Bond ja Lang (<a href="#ref-RefWorks:doc:5c223412e4b0508a6674dec0" role="doc-biblioref">2018</a>)</span> osoittavat
että tämä onnistuu vain harvoin. “Our goal is not to provide a litany of
concerns – which can be done for most social scientific metrics – but rather to
establish that standard happiness measures cannot rank the average happiness of
two groups without strong additional assumptions about the underlying distribution
of happiness. We expect that even if we achieve consensus on these assumptions,
many comparisons will remain unranked.” Korrespondenssianalyysillä vertailun
voi tehdä ilman jakaumaoletuksia, katsoa miltä data näyttää.</p>

</div>
<div id="lähteet" class="section level1 unnumbered">
<h1>Lähteet</h1>
<div id="refs">
<div id="ref-RefWorks:doc:5b15542ee4b0e2616bc42dca">
<p>Blasius, Jörg, ja Victor Thiessen. 2006. ”Assessing Data Quality and Construct Comparability in Cross-National Surveys”. <em>European Sociological Review</em> 22 (3): 229–42. <a href="http://www.jstor.org/stable/3806519">http://www.jstor.org/stable/3806519</a>.</p>
</div>
<div id="ref-RefWorks:doc:5c223412e4b0508a6674dec0">
<p>Bond, Timothy N., ja Kevin Lang. 2018. ”The Sad Truth About Happiness Scales”. <em>Journal of Political Economy</em> 127 (4): 1629–40. <a href="https://doi.org/10.1086/701679">https://doi.org/10.1086/701679</a>.</p>
</div>
<div id="ref-RefWorks:doc:5bd0a663e4b0c91dcf7c4be9">
<p>Ferragina, Emanuele, ja Martin Seeleib-Kaiser. 2015. ”Determinants of a Silent (R)evolution: Understanding the Expansion of Family Policy in Rich OECD Countries”. <em>Social Politics: International Studies in Gender, State and Society</em> 22 (1): 1–37. <a href="https://doi.org/10.1093/sp/jxu027">https://doi.org/10.1093/sp/jxu027</a>.</p>
</div>
<div id="ref-RefWorks:doc:5c053d69e4b0191a580d6451">
<p>Gendall, Phil, ja Martin von Randow. 2016. ”International Social Survey Programme , ISSP 2012 - Family and Changing Gender Roles IV, Study Monitoring Report”. <a href="https://dbk.gesis.org/dbksearch/sdesc2.asp?no=5900&amp;db=e&amp;doi=10.4232/1.12661">https://dbk.gesis.org/dbksearch/sdesc2.asp?no=5900&amp;db=e&amp;doi=10.4232/1.12661</a>.</p>
</div>
<div id="ref-RefWorks:doc:5bb9041be4b06677e5e61f83">
<p>GESIS. 2016. ”ISSP 2012 - Family and Changing Gender Roles IV, Variable Report”. GESIS. <a href="https://doi.org/10.4232/1.12661">https://doi.org/10.4232/1.12661</a>.</p>
</div>
<div id="ref-RefWorks:doc:5b6f159ce4b0bc0f31734b76">
<p>Greenacre, Michael. 2003. ”Singular value decomposition of matched matrices”. <em>Journal of Applied Statistics</em> 30 (10): 1101–13. <a href="https://doi.org/10.1080/0266476032000107132">https://doi.org/10.1080/0266476032000107132</a>.</p>
</div>
<div id="ref-RefWorks:doc:5c768b09e4b02df9431e950a">
<p>———. 2006. ”Tying up the loose ends in simple, multiple, joint correspondence analysis”. Teoksessa <em>Compstat 2006 - Proceedings in Computational Statistics</em>, toimittanut Alfredo Rizzi ja Maurizio Vichi, 163–85. Heidelberg: Physica-Verlag HD.</p>
</div>
<div id="ref-RefWorks:doc:5b45eab2e4b0fb23161a7ff3">
<p>———. 2013. ”Contribution Biplots”. <em>Journal of Computational and Graphical Statistics</em> 22 (1): 107–22. <a href="https://doi.org/10.1080/10618600.2012.702494">https://doi.org/10.1080/10618600.2012.702494</a>.</p>
</div>
<div id="ref-RefWorks:doc:5b6ef091e4b0984fd9b8c0ca">
<p>———. 2017. ”Multiple Correspondence Analysis (MCA): Theory and Practice, spring 2017 (University of Helsinki )”. <a href="https://moodle.helsinki.fi/course/search.php?search=correspondence+analysis">https://moodle.helsinki.fi/course/search.php?search=correspondence+analysis</a>.</p>
</div>
<div id="ref-RefWorks:doc:5ab76b43e4b003f4468d1f07">
<p>Greenacre, Michael, ja Jörg Blasius. 2006. <em>Multiple correspondence analysis and related methods</em>. Boca Raton (FL): Chapman; Hall/CRC. <a href="https://helka.finna.fi/Record/helka.2018050">https://helka.finna.fi/Record/helka.2018050</a>.</p>
</div>
<div id="ref-RefWorks:doc:5a857a44e4b0ed2d44664d84">
<p>Greenacre, Michael, ja Trevor Hastie. 1987. ”The Geometric Interpretation of Correspondence Analysis”. <em>Journal of the American Statistical Association</em> 82 (398): 437–47. <a href="https://doi.org/10.1080/01621459.1987.10478446">https://doi.org/10.1080/01621459.1987.10478446</a>.</p>
</div>
<div id="ref-RefWorks:doc:5c754c6de4b0947789165cde">
<p>Greenacre, Michael J. 1989. ”The Carroll-Green-Schaffer Scaling in Correspondence Analysis: A Theoretical and Empirical Appraisal”. <em>Journal of Marketing Research</em> 26 (3): 358–65. <a href="https://doi.org/10.1177/002224378902600310">https://doi.org/10.1177/002224378902600310</a>.</p>
</div>
<div id="ref-RefWorks:doc:5a857a43e4b0ed2d44664d7c">
<p>———. 2010. <em>Biplots in Practice</em>. Bilbao, Spain: Fundacion BBVA. <a href="https://www.fbbva.es/microsite/multivariate-statistics/biplots.html">https://www.fbbva.es/microsite/multivariate-statistics/biplots.html</a>.</p>
</div>
<div id="ref-RefWorks:doc:5a857a43e4b0ed2d44664d78">
<p>———. 2017. <em>Correspondence analysis in practice</em>. Third edition. Boca Raton, Florida: CRC Press. <a href="https://helka.finna.fi/Record/helka.3029760">https://helka.finna.fi/Record/helka.3029760</a>.</p>
</div>
<div id="ref-RefWorks:doc:5f934955e4b08d20366a5bd1">
<p>———. 2018. <em>Compositional data analysis in practice</em>. Boca Raton, Florida: CRC Press. <a href="http://bvbr.bib-bvb.de:8991/F?func=service&amp;doc_library=BVB01&amp;local_base=BVB01&amp;doc_number=030915862&amp;sequence=000001&amp;line_number=0001&amp;func_code=DB_RECORDS&amp;service_type=MEDIA">http://bvbr.bib-bvb.de:8991/F?func=service&amp;doc_library=BVB01&amp;local_base=BVB01&amp;doc_number=030915862&amp;sequence=000001&amp;line_number=0001&amp;func_code=DB_RECORDS&amp;service_type=MEDIA</a>.</p>
</div>
<div id="ref-RefWorks:doc:5a857a44e4b0ed2d44664d87">
<p>Greenacre, Michael, ja Rafael Pardo. 2006. ”Subset Correspondence Analysis: Visualizing Relationships Among a Selected Set of Response Categories From a Questionnaire Survey”. <em>Sociological Methods &amp; Research</em> 35 (2): 193–218. <a href="https://doi.org/10.1177/0049124106290316">https://doi.org/10.1177/0049124106290316</a>.</p>
</div>
<div id="ref-RefWorks:doc:5b8175eee4b08da192f99a35">
<p>Greenacre, Michael, ja Raul Primicerio. 2013. <em>Multivariate Analysis of Ecological Data</em>. Bilbao: Fundacion BBVA. <a href="https://www.fbbva.es/microsite/multivariate-statistics/maed.html">https://www.fbbva.es/microsite/multivariate-statistics/maed.html</a>.</p>
</div>
<div id="ref-RefWorks:doc:5b6c7f6ce4b0e4e15164ab1a">
<p>ISSP. 2016. ”ZA5900: International Social Survey Programme: Family and Changing Gender Roles IV - ISSP 2012 - data ja dokumentaatio (selattava versio)”. <a href="https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900">https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900</a>.</p>
</div>
<div id="ref-RefWorks:doc:5bb9044fe4b0dfeb95352229">
<p>”ISSP 2012 - Family and Changing Gender Roles IV Basic Questionnaire”. 2011. <a href="https://dbk.gesis.org/dbksearch/sdesc2.asp?no=5900&amp;db=e&amp;doi=10.4232/1.12661">https://dbk.gesis.org/dbksearch/sdesc2.asp?no=5900&amp;db=e&amp;doi=10.4232/1.12661</a>.</p>
</div>
<div id="ref-RefWorks:doc:5a857a43e4b0ed2d44664d75">
<p>LeRoux, Brigitte, ja Henry Rouanet. 2004. <em>Geometric data analysis: from correspondence analysis to structured data analysis</em>. Dordrecht: Kluwer Academic Publishers.</p>
</div>
<div id="ref-RefWorks:doc:5c3759c2e4b0085b307c82b5">
<p>McNamara, Amelia, ja Nicholas J. Horton. 2018. ”Wrangling Categorical Data in R”. <em>The American Statistician</em> 72 (1): 97–104. <a href="https://doi.org/10.1080/00031305.2017.1356375">https://doi.org/10.1080/00031305.2017.1356375</a>.</p>
</div>
<div id="ref-RefWorks:doc:5a857a44e4b0ed2d44664d95">
<p>Mustonen, Seppo. 1995. <em>Tilastolliset monimuuttujamenetelmät</em>. Helsinki: Survo Systems. <a href="http://www.survo.fi/mustonen/monim.pdf">http://www.survo.fi/mustonen/monim.pdf</a>.</p>
</div>
<div id="ref-ca2007">
<p>Nenadic, O., ja M. Greenacre. 2007. ”Correspondence Analysis in R, with two- and three-dimensional graphics: The ca package”. <em>Journal of Statistical Software</em> 20 (3): 1–13. <a href="http://www.jstatsoft.org">http://www.jstatsoft.org</a>.</p>
</div>
<div id="ref-RefWorks:doc:5f9439fde4b04741789a2187">
<p>Scholz, Evi, Regina Jutz, Jonas Edlund, Ida Öun, ja Michael Braun. 2014. ”ISSP 2012 Family and Changing Gender Roles IV: Questionnaire Development”. <a href="https://explore.openaire.eu/search/publication?articleId=od______1272::0a6c70387bf644137af3cb2bc69b0df6">https://explore.openaire.eu/search/publication?articleId=od______1272::0a6c70387bf644137af3cb2bc69b0df6</a>.</p>
</div>
<div id="ref-RefWorks:doc:5c0543a5e4b077eba1dc3cd8">
<p>Smith, Tom W. 2015. ”International Social Survey Programme”. <em>International Encyclopedia of the Social &amp; Behavioral Sciences (Second Edition)</em>. <a href="https://doi.org///doi-org.libproxy.helsinki.fi/10.1016/B978-0-08-097086-8.44080-8">https://doi.org///doi-org.libproxy.helsinki.fi/10.1016/B978-0-08-097086-8.44080-8</a>.</p>
</div>
<div id="ref-RefWorks:doc:5bb90a0ae4b018435936a488">
<p>Tilastokeskus. 2012. ”ISSP 2012 - Family and Changing Gender Roles IV Questionnaire (Finnish)”. Tilastokeskus. <a href="https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900">https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900</a>.</p>
</div>
<div id="ref-RefWorks:doc:5a857a44e4b0ed2d44664da4">
<p>Vehkalahti, Kimmo. 2008. <em>Kyselytutkimuksen mittarit ja menetelmät</em>. Helsinki: Tammi. <a href="https://helka.finna.fi/Record/helka.2120450">https://helka.finna.fi/Record/helka.2120450</a>.</p>
</div>
<div id="ref-RefWorks:doc:5bd08fb6e4b05c5447c9a9f9">
<p>Walter, Jessica. 2018. ”The adequacy of measures of gender roles attitudes: a review of current measures in omnibus surveys”. <em>Quality &amp; Quantity</em> 52 (2): 829–48. <a href="https://doi.org/10.1007/s11135-017-0491-x">https://doi.org/10.1007/s11135-017-0491-x</a>.</p>
</div>
<div id="ref-RefWorks:doc:5b6b36dde4b09b7ec442bf8b">
<p>Xie, Yihui. 2016. <em>bookdown: Authoring Books and Technical Documents with R Markdown</em>. Chapman; Hall/CRC. <a href="https://bookdown.org/yihui/bookdown/">https://bookdown.org/yihui/bookdown/</a>.</p>
</div>
</div>
</div>



<div id="liite-1-korrespondenssianalyysin-teoriaa" class="section level1 unnumbered">
<h1>Liite 1: Korrespondenssianalyysin teoriaa</h1>
<div id="korrespondenssianalyysin-perusyhtälöt-ja-kaavat" class="section level2 unnumbered">
<h2>Korrespondenssianalyysin perusyhtälöt ja kaavat</h2>
<p>Perusyhtälöt on esitetty teoksen “Correspondece Analysis in Practice”<span class="citation">(M. J. Greenacre <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d78" role="doc-biblioref">2017</a>)</span>
liitteen “Theory of Correspondece Analysis” mukaisesti.</p>
<p>Datamatriisilla <span class="math inline">\(\boldsymbol{N}\)</span> on <span class="math inline">\(I\)</span> riviä ja <span class="math inline">\(J\)</span> saraketta (<span class="math inline">\(I x J\)</span>).
Alkiot ovat ei-negatiivisia ja samassa mitta-asteikossa.
Jos mitta-asteikko on intervalli- tai suhdeasteikko, mittayksiköiden on oltava
samoja (esim. euroja, metrejä). Tietyin ehdoin myös negatiiviset luvut ovat
sallittuja <span class="citation">(LeRoux ja Rouanet <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>, 60)</span>.</p>
<p>Taulukon alkioiden summa on
<span class="math inline">\(\sum_{i} \sum_{j}n_{ij} = n\)</span>, missä <span class="math inline">\(i = 1, \dots , I\)</span> ja <span class="math inline">\(j = 1, \dots , J\)</span>.</p>
<p>Korrespondenssimatriisi <span class="math inline">\(\boldsymbol{P}\)</span> saadaan jakamalla matriisin
<span class="math inline">\(\boldsymbol{N}\)</span> alkiot niiden summalla <span class="math inline">\(n\)</span> .</p>
<p>Merkitään matriisin <span class="math inline">\(\boldsymbol{P}\)</span> rivisummien vektoria
<span class="math inline">\(\boldsymbol{r}\)</span> (= <span class="math inline">\((r_{1}, \dots, r_{I})\)</span>) ja sarakesummien vektoria
<span class="math inline">\(\boldsymbol{c}\)</span> (= <span class="math inline">\((c_{1}, \dots, c_{J})\)</span>).
Niitä vastaavat diagonaalimatriisit ovat <span class="math inline">\(\boldsymbol{D_r}\)</span> ja
<span class="math inline">\(\boldsymbol{D_c}\)</span>.</p>
<p>Matriisin transpoosi merkitään yläindeksillä <span class="math inline">\(T\)</span>, ja <span class="math inline">\(\boldsymbol{1}\)</span> on
sopivan dimension vektori, jonka alkiot ovat ykkösiä.</p>
<p>Korrespondenssianalyysin ratkaistaan singulaariarvohajotelman
(singular value decomposition, SVD) avulla.</p>
<p>Singulaariarvohajotelma tuottaa ratkaisun kun
sitä sovelletaan standardoituun residuaalimatriisiin <span class="math inline">\(\boldsymbol{S}\)</span>.</p>
<p><span class="math display" id="eq:svd1">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{D_r}^{-1/2}(\boldsymbol{P} - \boldsymbol{r}\boldsymbol{c}^T)\boldsymbol{D_c}^{-1/2} .
\tag{8.1}
\end{equation}\]</span></p>
<p>Residuaalimatriisi voidaan esittää myös ns. kontingenssi-suhdelukujen
(contingency ratio) avulla kahdella tavalla.</p>
<p><span class="math display" id="eq:contrat1">\[\begin{equation}
\boldsymbol{D_r}^{-1} \boldsymbol{P} \boldsymbol{D_c}^{-1} = \left( \frac{p_{ij}} {r_{i} c{j}} \right) ,
\tag{8.2}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:contrat2">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{D_r}^{1/2} (\boldsymbol{D_r}^{-1} \boldsymbol{P} \boldsymbol{D_c}^{-1} - \boldsymbol{1}\boldsymbol{1}^{T} ) \boldsymbol{D_c}^{-1/2}  \;\;\; .
\tag{8.3}
\end{equation}\]</span></p>
<p>Toinen esitystapa on hyödyllinen, kun tarkastellaan CA:n yhteyksiä muihin
läheisiin menetelmiin. Näitä ovat esimerkiksi “suhteellisten osuuksien datan”
analyysi (log ratio analysis of compositiona data), moniulotteinen skaalaus,
lineaarinen diskriminanttianalyysi, kanoninen korrelaatioanalyysi,
pääkomponenttianalyysi, kaksoiskuvat ja muut SVD-hajotelmaan perustuvat dimensioiden
vähentämisen menetelmät.</p>
<p>Samat kaavat voi esittää myös alkiomuodossa:</p>
<p><span class="math display" id="eq:contrat11">\[\begin{equation}
s_{ij} = \frac{p_{ij}-r_{i}c_{j}} { \sqrt{r_{i}c_{j} } } ,
\tag{8.4}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:contrat21">\[\begin{equation}
s_{ij} = \sqrt{r_{i}} \left( \frac{p_{ij}}{r_{i}c_{j}} \right) \sqrt{c_{j}} \;\;\; .
\tag{8.5}
\end{equation}\]</span></p>
<p>Alkiomuodossa esitetyistä kaavoista näkee rivi- ja sarakeratkaisujen sidoksen.
Ratkaisujen duaalisuus on teoreettinen tulos, jonka voi perustella täsmällisesti
algebrallisen geometrian avulla. Käytännössä rivi- ja sarakeongelman duaalisuus
tarkoittaa sitä, että vain toinen ongelma on ratkaistava</p>
<p>Singulaariarvohajotelma matriisille <span class="math inline">\(\boldsymbol{S}\)</span> on</p>
<p><span class="math display" id="eq:svd2">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{U} \boldsymbol{D_{\alpha}} \boldsymbol{V}^{T} ,
\tag{8.6}
\end{equation}\]</span></p>
<p>missä <span class="math inline">\(\boldsymbol{D_{\alpha}}\)</span> on diagonaalimatriisi, jonka alkiot ovat
singulaariarvot suuruusjärjestyksessä <span class="math inline">\(\alpha_{1}\geq \alpha_{1} \geq \cdots\)</span>.</p>
<p>Matriisit <span class="math inline">\(\boldsymbol{U}\)</span> ja <span class="math inline">\(\boldsymbol{V}\)</span> ovat ortogonaalisia
singulaarivektoreiden matriiseja. Singulaariarvohajotelman merkitys dimensioiden
vähentämiselle perustuu Eckart - Young - teoreemaan. Teoreema kertoo
että saamme pienimmän neliösumman <span class="math inline">\(m\)</span> - ulotteisen approksimaation matriisille
<span class="math inline">\(\boldsymbol{S}\)</span> matriisien <span class="math inline">\(\boldsymbol{U}\)</span> ja <span class="math inline">\(\boldsymbol{V}\)</span>
ensimmäisten sarakkeiden ja ensimmäisten singulaariarvojen avulla.</p>
<p><span class="math display" id="eq:svd3">\[\begin{equation}
\boldsymbol{S}_{(m)} = \boldsymbol{U}_{(m)} \boldsymbol{D}_{\alpha(m)} \boldsymbol{V}_{(m)}^{T}
\tag{8.7}
\end{equation}\]</span></p>
<p>Korrespondenssianalyysin ratkaisualgoritmissa tätä tulosta on muokattava niin,
että rivien ja sarakkeiden massat huomioidaan pienimmän neliösumman
approksimaatiossa painoina.</p>
<p>Näin saadaan standardikoordinaatit ja pääkoordinaatit riveille ja
sarakkeille.</p>
<p>Rivien standardikoordinaatit</p>
<p><span class="math display" id="eq:rivistd1">\[\begin{equation}
\boldsymbol{\Phi} = \boldsymbol{D_r}^{-\frac{1}{2}} \boldsymbol{U}
\tag{8.8}
\end{equation}\]</span></p>
<p>Sarakkeiden standardikoordinaatit</p>
<p><span class="math display" id="eq:sarakestd1">\[\begin{equation}
 \boldsymbol{\Gamma} = \boldsymbol{D_c}^{-\frac{1}{2}} \boldsymbol{V}
 \tag{8.9}
\end{equation}\]</span></p>
<p>Rivien pääkoordinaatit</p>
<p><span class="math display" id="eq:riviprinc1">\[\begin{equation}
 \boldsymbol{F} =   \boldsymbol{D_r}^{-\frac{1}{2}} \boldsymbol{U}  \boldsymbol{D_{\alpha}} = \boldsymbol{\Phi} \boldsymbol{D_{\alpha}}
\tag{8.10}
\end{equation}\]</span></p>
<p>Sarakkeiden pääkoordinaatit
<span class="math display" id="eq:sarakeprinc1">\[\begin{equation}
 \boldsymbol{G}  = \boldsymbol{D_c}^{-\frac{1}{2}} \boldsymbol{V} \boldsymbol{D_{\alpha}} = \boldsymbol{\Gamma}  \boldsymbol{D_{\alpha}}
 \tag{8.11}
\end{equation}\]</span></p>
<p>Pääakseleiden inertiat (principal inertias) <span class="math inline">\(\lambda_{k}\)</span></p>
<p><span class="math display">\[\begin{equation}
\lambda_{k} = \alpha_{k}^2, \: k = 1,\dots,K,
K = min \{ I-1, J-1 \}
\end{equation}\]</span></p>
<p>Ratkaisun dimensio on myös maksimi-inertia. Tässä aineistossa ja vastaavissa
kyselytutkimusdatoissa inertia on yleensä paljon maksimia pienempi. Asymmetrisissä
kartoissa ideaalipisteet ovat kaukana origon lähelle pakkautuneesta havaintojen
pilvestä.</p>
<p>Korrespondenssianalyysi ratkaisun akseleiden inertioita kutsutaan usein ominaisarvoiksi,
mutta periaatteessa SVD-ratkaisulla saadaan singulaariarvot. Niiden neliöt ovat
akseleiden inertioita. Ominaisarvojen ja singulaariarvojen yhteys on läheinen ja
riippuu diagonalisoitavan matriisin ominaisuuksista. Termiä “vektori” käytetään
kartoista puhuttaessa, kun viitataan esimerkiksi origosta sarakepisteeseen
piirrettyyn nuoleen. Myös janan synonyyminä käytetään yleisesti termiä vektori
(kts. esim. <span class="citation">(M. Greenacre <a href="#ref-RefWorks:doc:5b45eab2e4b0fb23161a7ff3" role="doc-biblioref">2013</a>)</span>).</p>
<p>Korrespondenssimatriisi <span class="math inline">\(\boldsymbol{P}\)</span> voidaan esittää matriisi- ja
alkiomuodossa ns. palautuskaavana (reconstitution formula).</p>
<p><span class="math display" id="eq:reconstform1">\[\begin{equation}
\boldsymbol{P} = \boldsymbol{D}_{r} \left( \boldsymbol{1}\boldsymbol{1}^{T} + \boldsymbol{\Phi}\boldsymbol{D}_{\lambda}^{\frac {1}{2}}\boldsymbol{\Gamma}^{T}\right)\boldsymbol{D}_{c}
\tag{8.12}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:reconstform2">\[\begin{equation}
p_ {ij}= r_{i}c_{j} \left(1 + \sum_{k=1}^{K} \sqrt{\lambda_{k}} \phi_{ik} \gamma_{jk} \right)
\tag{8.13}
\end{equation}\]</span></p>
<p>Rivien ja sarakkeiden riippuvuutta kuvaavat transitioyhtälöt (transition equations).</p>
<p>Pääkoordinaatit standardikoordinaattien funktiona (barysentrinen ominaisuus,
barycentric relationships):</p>
<p><span class="math display" id="eq:barysentr1">\[\begin{equation}
\boldsymbol{F} = \boldsymbol{D}_{r}^{-1} \boldsymbol{P}\boldsymbol{\Gamma}
\tag{8.14}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:barysentr2">\[\begin{equation}
\boldsymbol{G} = \boldsymbol{D}_{c}^{-1} \boldsymbol{P}^{T}\boldsymbol{\Phi}
\tag{8.15}
\end{equation}\]</span></p>
<p>Pääkoordinaatit pääkoordinaattien funktiona:</p>
<p><span class="math display" id="eq:barysentr3">\[\begin{equation}
\boldsymbol{F} = \boldsymbol{D}_{r}^{-1} \boldsymbol{P}\boldsymbol{G}\boldsymbol{D}_{\lambda}^{-\frac{1}{2}}
\tag{8.16}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:barysentr4">\[\begin{equation}
\boldsymbol{G} = \boldsymbol{D}_{c}^{-1} \boldsymbol{P}^{T}\boldsymbol{F}\boldsymbol{D}_{\lambda}^{-\frac{1}{2}}
\tag{8.17}
\end{equation}\]</span></p>
<p>Yhtälöt <a href="#eq:barysentr1">(8.14)</a> ja <a href="#eq:barysentr1">(8.14)</a> esittävät profiilipisteet ideaalipisteiden (vertex points)
painotettuina keskiarvoina, painoina profiilin elementit. Asymmetriset kartat
(rivien tai sarakkeiden suhteen) perustuvat näihin yhtälöihin. Yhtälöiden <a href="#eq:barysentr3">(8.16)</a>
ja <a href="#eq:barysentr4">(8.17)</a> kahdet pääkoordinaatit ovat perusta symmetrisille kartoille. Myös niitä
yhdistää barysentrinen painotetun keskiarvon riippuvuus, mutta mukana ovat skaalaustekijät
<span class="math inline">\(\frac{1}{\sqrt{\lambda_{i}}}\)</span>.</p>
<p><strong>Pisteet ja projektio aliavaruuteen</strong></p>
<p>Kuva on kurssimateriaaleista<span class="citation">(M. Greenacre <a href="#ref-RefWorks:doc:5b6ef091e4b0984fd9b8c0ca" role="doc-biblioref">2017</a>)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:projectionimg1"></span>
<img src="img/CAquality.png" alt="Pisteen projektio aliavaruuteen" width="70%" />
<p class="caption">
Kuva 8.1: Pisteen projektio aliavaruuteen
</p>
</div>
<p>Kuvassa on esitetty korrespondenssianalyysin ratkaisun minimointiongelma. Pisteen
projektio on sitä parempi mitä pienempi kulma on sentroidista pisteeseen
piirretyn janan ja pisteen projektion välillä. cor-tunnusluku ca-funktion
numeerisissa tuloksissa tämän kulman kosinin neliö. Pisteen kuvauksen laatu (qlt)
ca-tuloksissa on valitun approksimaation akseleiden kvaliteettien (cor) summa.</p>
<p>Kuvasta voi myös hahmottaa sen periaatteen, että projektiossa kaukana olevat
pisteet ovat kaukana myös alkuperäisessä avaruudessa. Projektiossa lähekkäin
olevat pisteet voivat olla alkuperäisessä avaruudessa kaukana toisistaan,
jos niiden projektion laatu on huono.</p>
<p><strong>Monimuuttujakorrespondenssianalyysi MCA</strong></p>
<p>Usean muuttujan korrespondenssianalyysissä tutkitaan usean muuttujan välisiä yhteyksiä.
Kartan tulkinnan apuna siihen voidaan lisätä havaintojen sijaan niiden keskiarvopisteitä
ja niille simuloituja luottamusellipsejä. Kuvien pääongelma on liian suuri määrä pisteitä,
ja analyysin tavoite on usein mahdollisimman yksinkertainen kartta.</p>
<p>Usean muuttujan analyysissä kohteena on joko indikaattorimatriisi <span class="math inline">\(\boldsymbol{Z}\)</span> tai
Burtin matriisi <span class="math inline">\(\boldsymbol{B}\)</span></p>
<p>Indikaattorimatriisissa rivit ovat havaintoja ja sarakkeet luokittelumuuttujan arvoja.
Havaintoa vastaa rivi nollia ja 1 valitun vastausvaihtoehdon kohdalla. Tästä seuraa,
että vain erilaiset vastaukset määrittävät rivien etäisyyksiä.</p>
<p>Burtin matriisi on erikoistapaus yhdistetyistä matriiseista. Siihen on koottu kaikki tutkittavien
muuttujien pareittain muodostetut taulukot. Diagonaalilla ovat muuttujien ristiintaulukoinnit
itsensä kanssa. Ratkaisu riippuu vain näistä parittaisista taulukoista. Burtin matriisi on
kätevä välivaihe matriisien yhdistelyssä.</p>
<p>Molemmat matriisit paisuttavat keinotekoisesti kokonaisinertiaa, ja esimerkiksi kaksiulotteisen kartan
selitetyn inertian osuudet jäävät melko pieniksi. Ratkaisuna on inertian oikaisu tai korjaus
(adjusted inertia), jossa mm. poistetaan kokonaisinertialaskelmista Burtin matriisin
diagonaalilla olevat alimatriisit. Näillä korjauksilla ei ole vaikutusta kartan pisteiden
sijaintiin. Tämä menetelmä on ca-paketin mjca-funktion oletus.</p>
<p>Kolmas vaihtoehto on ns. yhdistetty korrespondenssianalyysi (joint ca).</p>
<p>Greenacre on kirjoittanut useissa yhteyksissä MCA:n geometrisen tulkinnan ongelmista.
<span class="citation">Greenacre ja Hastie (<a href="#ref-RefWorks:doc:5a857a44e4b0ed2d44664d84" role="doc-biblioref">1987</a>)</span> (s. 447) sanovat asian näin:“Finally, although
we have motivated simple correspondence analysis from the geometric point of view,
the geometry of the indicator matrix in multiple correspondence analysis is
admittedly not convincing. Distances between the row profiles of an indicator
matrix and projections of articficial column vertices have less intuitive appeal.
However, the scaling interpretation remains attractive in this case; the displays
are graphical representations of optimal scale values for the categories.”</p>
<p>Greenacre jatkaa samasta aiheesta artikkelikokoelmassa
<span class="citation">(M. Greenacre ja Blasius <a href="#ref-RefWorks:doc:5ab76b43e4b003f4468d1f07" role="doc-biblioref">2006</a> , s. 41, s. 61)</span>: “Yleistys useammalle
kuin kahdelle muuttujalle ei ole ilmeinen eikä hyvin määritelty”. Silti MCA
onnistuu esittämään hyvin kiinnostavia yhteyksiä muuttujien välillä (“succesfully
recovers interesting patterns of association”). Kriittisyys ei kuitenkaan
estä häntä soveltamasta MCA-analyysiä. Tulkitsen tämän niin, että menetelmää voi
aivan hyvin soveltaa, mutta geometrista tulkintaa ei voi suoraan siirtää CA-kartoista
MCA-karttoihin. Greenacre esittelee perusteellisesti MCA-sovelluksia kaksoiskuvia
käsittelevässä kirjassaan <span class="citation">(Greenacre <a href="#ref-RefWorks:doc:5a857a43e4b0ed2d44664d7c" role="doc-biblioref">2010</a>)</span>. Ehkä
korrespondenssianalyysin matemaattinen teoria ei ole vielä täysin valmis?</p>
</div>
</div>
<div id="liite-2-tekninen-ympäristö-ja-bookdown-paketti" class="section level1 unnumbered">
<h1>Liite 2: Tekninen ympäristö ja Bookdown-paketti</h1>
<p>Analysoin aineistoa r-paketilla ca, vaihtoehdoista voi mainita ranskalaisten kehittämän
FactoMineR - paketin ja muitakin löytyy. Korrespondenssianalyysin voi tehdä myös monella
muulla ohjelmistolla (esim. Survo, SAS ja SPSS). Greenacre ei ole tyytyväinen SPSS:n
toteutukseen: “In SPSS’s CA program in the Categories module, an alternative biplot
is given that has not been illustrated in this book, called the”symmetrical normalization“,
which may be confused with the symmetric map described in this book. It is not exactly the
same thing, however,since it uses standard coordinates scaled by the square roots of the singular
values (i.e. fourth roots of the principal inertias) instead of the singular values themselves.
Curiously, the symmetric map, one of the most popular display options of
French researchers, has never been available in SPSS (module Categories),
and it is still not possible in IBM SPSS version 20 to obtain a joint map of the rows
and columns in principal coordinates”(CAiP, s. 296). En ole tarkastanut onko pitääkö kritiikki
yhä paikkansa.</p>
<p><strong>Bookdown</strong></p>
<p>Bookdown-paketti laajentaa R-ohjelmiston julkaisuominaisuuksia <span class="citation">(Xie <a href="#ref-RefWorks:doc:5b6b36dde4b09b7ec442bf8b" role="doc-biblioref">2016</a>)</span>.
Sen avulla voi tuottaa monipuolisesti julkaisuja samalla lähdekoodilla eri formaatteihin.</p>
<p>Html-formaatti sopii mainiosti data-analyysiin, taulukoita ja kuvia ei tarvitse asetella paperikoon
mukaan sivuille. PDF-formaatilla on omat etunsa, koko dokumentti on yksi tiedosto. Olen
käyttänyt bookdown-pakettia vailla suurempia ongelmia. Jos ongelmia tulee, niiden syiden
selvittämien ei ole helppoa. Kuva <a href="#fig:L3bdprocess1">8.2</a> näyttää bookdown-paketin julkaisuprosessin
vaiheet. PDF on ongelmallinen, tässä projektissa pdf-tulostus lakkasi toimimasta
kaksi kertaa. Tutkielman pdf-versio on tulostettu selaimella bookdown-paketin
tulostustvaihtoehdolla “html_book”.</p>
<p>Ongelmat ovat varmasti ratkaistavissa, ja bookdown-paketti tai sen muokatut
versiot ovat laajassa käytössä monissa yliopistoissa. Kyse on vain
LateX-osaamattomuudesta tai ymmärtämättömyydestä.</p>
<div class="figure" style="text-align: center"><span id="fig:L3bdprocess1"></span>
<img src="img/BookdownProc.png" alt="Tulostiedoston prosessointi" width="70%" />
<p class="caption">
Kuva 8.2: Tulostiedoston prosessointi
</p>
</div>
<p><strong>Git ja Github</strong></p>
<p>Käytin Github-palvelun versionhallintaa ja www-palvelua raporttien julkaisemiseen.</p>
<p>Tutkielman luonnos (<a href="https://hirjus.github.io/capaper/" class="uri">https://hirjus.github.io/capaper/</a>) ja lähdekoodi
(<a href="https://github.com/hirjus/capaper" class="uri">https://github.com/hirjus/capaper</a>) löytyvät sieltä. Data on pakattuna tiedostona.</p>
<p><strong>Käyttöjärjestelmä ja R-ympäristö</strong></p>
<p>RStudio-sovelluksen ja käyttämäni TeX-versiot ovat</p>
<p>RStudio Version 1.3.1093, latex engine xelatex</p>
<p>XeTeX, Version 3.14159265-2.6-0.999992 (TeX Live 2020/W32TeX)</p>
<p>Bookdown-asetuksissa käytin latex-muunnokseen aluksi pdflatex-valintaa ja
vaihdoin sen myöhemmin xelatex-vaihtoehtoon. Ero ei ole merkittävä.</p>
<p>TeX-jakeluna käytin bookdown-paketin kehittäjän suosittelemaa
TinyTeX - versiota (<a href="https://yihui.org/tinytex/" class="uri">https://yihui.org/tinytex/</a>) ja
r-pakettia tinytex. Niiden etu on tarvittavien LaTex-pakettien
automaattinen asentaminen.</p>
<p>R-ympäristön tarkemmat tiedot:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19041)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.1252 
## [2] LC_CTYPE=English_United Kingdom.1252   
## [3] LC_MONETARY=English_United Kingdom.1252
## [4] LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] assertthat_0.2.1  tinytex_0.27      bookdown_0.21     printr_0.1       
##  [5] reshape2_1.4.4    scales_1.1.1      furniture_1.9.7   rmarkdown_2.5    
##  [9] lubridate_1.7.9.2 forcats_0.5.0     stringr_1.4.0     purrr_0.3.4      
## [13] readr_1.4.0       tidyr_1.1.2       tibble_3.0.4      ggplot2_3.3.2    
## [17] tidyverse_1.3.0   knitr_1.30        dplyr_1.0.2       haven_2.3.1      
## [21] ca_0.71.1         rgl_0.100.54     
## 
## loaded via a namespace (and not attached):
##  [1] httr_1.4.2              jsonlite_1.7.1          modelr_0.1.8           
##  [4] shiny_1.5.0             highr_0.8               cellranger_1.1.0       
##  [7] yaml_2.2.1              pillar_1.4.6            backports_1.2.0        
## [10] glue_1.4.2              digest_0.6.27           manipulateWidget_0.10.1
## [13] promises_1.1.1          rvest_0.3.6             colorspace_2.0-0       
## [16] htmltools_0.5.0         httpuv_1.5.4            plyr_1.8.6             
## [19] pkgconfig_2.0.3         broom_0.7.2             xtable_1.8-4           
## [22] webshot_0.5.2           later_1.1.0.1           generics_0.1.0         
## [25] farver_2.0.3            ellipsis_0.3.1          withr_2.3.0            
## [28] cli_2.1.0               magrittr_1.5            crayon_1.3.4           
## [31] readxl_1.3.1            mime_0.9                evaluate_0.14          
## [34] fs_1.5.0                fansi_0.4.1             xml2_1.3.2             
## [37] tools_3.6.3             hms_0.5.3               lifecycle_0.2.0        
## [40] munsell_0.5.0           reprex_0.3.0            compiler_3.6.3         
## [43] rlang_0.4.8             grid_3.6.3              rstudioapi_0.13        
## [46] htmlwidgets_1.5.2       crosstalk_1.1.0.1       miniUI_0.1.1.1         
## [49] labeling_0.4.2          gtable_0.3.0            DBI_1.1.0              
## [52] R6_2.5.0                fastmap_1.0.1           stringi_1.4.6          
## [55] Rcpp_1.0.5              vctrs_0.3.4             dbplyr_2.0.0           
## [58] tidyselect_1.1.0        xfun_0.19</code></pre>
</div>
<div id="liite-3-r---koodi" class="section level1 unnumbered">
<h1>Liite 3: R - koodi</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># testaukseen 7.11.2020 virheilmoituksia varten arvo TRUE</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">options</span>(<span class="dt">tinytex.verbose =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># 18.10.2020</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="kw">library</span>(rgl)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">library</span>(ca)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw">library</span>(haven)</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="kw">library</span>(knitr)</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="kw">library</span>(rmarkdown)</span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="kw">library</span>(furniture)</span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="kw">library</span>(scales) <span class="co"># G_1_2 - kuva</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="kw">library</span>(reshape2)  <span class="co"># G_1_2 - kuva</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="kw">library</span>(printr) <span class="co">#19.5.18 taulukoiden ja matriisien tulostukseen</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="kw">library</span>(bookdown)</span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="kw">library</span>(tinytex)</span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="kw">library</span>(assertthat)</span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co"># eval = FALSE 24.11.2020</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co"># automatically create a bib database for R packages</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>knitr<span class="op">::</span><span class="kw">write_bib</span>(<span class="kw">c</span>(</span>
<span id="cb9-25"><a href="#cb9-25"></a>  <span class="kw">.packages</span>(), <span class="st">&#39;bookdown&#39;</span>, <span class="st">&#39;knitr&#39;</span>, <span class="st">&#39;rmarkdown&#39;</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>), <span class="st">&#39;packages.bib&#39;</span>)</span>
<span id="cb9-27"><a href="#cb9-27"></a></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co"># include FALSE: ei koodia eikä tulostusta dokumenttiin - poistettava turhia</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co"># välitulostuksia (18.10.2020)</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co"># Aineiston rajaamisen kolme vaihetta (10.2018)</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co"># </span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co"># TIEDOSTOJEN NIMEÄMINEN</span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co"># R-datatiedostot .data - tarkenteella ovat osajoukkoja koko ISSP-datasta ISSP2012.data</span></span>
<span id="cb9-35"><a href="#cb9-35"></a><span class="co"># R-datatiedostot .dat - tarkenteella: mukana alkuperäisten muuttujien muunnoksia </span></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="co"># (yleensä as_factor), alkuperäisissä muuttujissa mukana SPSS-tiedoston metadata.</span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#</span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co"># Luokittelumuuttujan tyyppi on datan lukemisen jälkeen yleensä merkkijono (char) </span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co"># ja haven_labelled. </span></span>
<span id="cb9-40"><a href="#cb9-40"></a><span class="co">#</span></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co"># Muutetaan R-datassa ordinaali- tai  nominaaliasteikon muuttujat haven-paketin </span></span>
<span id="cb9-42"><a href="#cb9-42"></a><span class="co"># as_factor - funktiolla faktoreiksi. R:n faktorityypin muuttujille voidaan tarvittaessa </span></span>
<span id="cb9-43"><a href="#cb9-43"></a><span class="co"># määritellä järjestys, toistaiseksi niin ei tehdä (25.9.2018). </span></span>
<span id="cb9-44"><a href="#cb9-44"></a><span class="co">#</span></span>
<span id="cb9-45"><a href="#cb9-45"></a><span class="co"># Muunnetun muuttujan rinnalla säilytetään SPSS-tiedostosta luettu muuttja, metatiedot säilyvät </span></span>
<span id="cb9-46"><a href="#cb9-46"></a><span class="co"># alkuperäisessä.</span></span>
<span id="cb9-47"><a href="#cb9-47"></a><span class="co">#       </span></span>
<span id="cb9-48"><a href="#cb9-48"></a><span class="co"># R-datatiedostot joiden nimen loppuosa on muotoa *esim1.dat: käytetään analyyseissä</span></span>
<span id="cb9-49"><a href="#cb9-49"></a><span class="co">#</span></span>
<span id="cb9-50"><a href="#cb9-50"></a><span class="co"># 1. VALITAAN MAAT (25) -&gt; ISSP2012jh1a.data. Muuttujat koodilohkossa datasel_vars1</span></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="co">#</span></span>
<span id="cb9-52"><a href="#cb9-52"></a><span class="co"># kolme maa-muuttujaa datassa. V3 erottelee joidenkin maiden alueita, V4 on koko </span></span>
<span id="cb9-53"><a href="#cb9-53"></a><span class="co"># maan koodi ja C_ALPHAN on maan kaksimerkkinen tunnus.</span></span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="co">#</span></span>
<span id="cb9-55"><a href="#cb9-55"></a><span class="co"># V3 - Country/ Sample ISO 3166 Code (see V4 for codes for whole nation states)</span></span>
<span id="cb9-56"><a href="#cb9-56"></a><span class="co"># V3 erot valituissa maissa</span></span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="co"># 5601 BE-FLA-Belgium/ Flanders</span></span>
<span id="cb9-58"><a href="#cb9-58"></a><span class="co"># 5602 BE-WAL-Belgium/ Wallonia</span></span>
<span id="cb9-59"><a href="#cb9-59"></a><span class="co"># 5603 BE-BRU-Belgium/ Brussels</span></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="co"># 27601 DE-W-Germany-West</span></span>
<span id="cb9-61"><a href="#cb9-61"></a><span class="co"># 27602 DE-E-Germany-East</span></span>
<span id="cb9-62"><a href="#cb9-62"></a><span class="co"># 62001 PT-Portugal 2012: first fieldwork round (main sample)</span></span>
<span id="cb9-63"><a href="#cb9-63"></a><span class="co"># 62002 PT-Portugal 2012: second fieldwork round (complementary sample)</span></span>
<span id="cb9-64"><a href="#cb9-64"></a><span class="co"># Myös tämä on erikoinen, näyttää olevan vakio kun V4 = 826:</span></span>
<span id="cb9-65"><a href="#cb9-65"></a><span class="co"># 82601 GB-GBN-Great Britain</span></span>
<span id="cb9-66"><a href="#cb9-66"></a><span class="co"># Portugalissa ainestoa täydennettiin, koska siinä oli puutteita. Jako ei siis ole oleellinen,</span></span>
<span id="cb9-67"><a href="#cb9-67"></a><span class="co"># mutta muuut ovat. Tähdellä merkityt maat valitaan johdattelevaan esimerkkiin.</span></span>
<span id="cb9-68"><a href="#cb9-68"></a><span class="co">#</span></span>
<span id="cb9-69"><a href="#cb9-69"></a><span class="co"># Maat (25)</span></span>
<span id="cb9-70"><a href="#cb9-70"></a><span class="co">#</span></span>
<span id="cb9-71"><a href="#cb9-71"></a><span class="co"># 36 AU-Australia</span></span>
<span id="cb9-72"><a href="#cb9-72"></a><span class="co"># 40 AT-Austria</span></span>
<span id="cb9-73"><a href="#cb9-73"></a><span class="co"># 56 BE-Belgium*</span></span>
<span id="cb9-74"><a href="#cb9-74"></a><span class="co"># 100 BG-Bulgaria*</span></span>
<span id="cb9-75"><a href="#cb9-75"></a><span class="co"># 124 CA-Canada</span></span>
<span id="cb9-76"><a href="#cb9-76"></a><span class="co"># 191 HR-Croatia</span></span>
<span id="cb9-77"><a href="#cb9-77"></a><span class="co"># 203 CZ-Czech Republic</span></span>
<span id="cb9-78"><a href="#cb9-78"></a><span class="co"># 208 DK-Denmark*</span></span>
<span id="cb9-79"><a href="#cb9-79"></a><span class="co"># 246 FI-Finland*</span></span>
<span id="cb9-80"><a href="#cb9-80"></a><span class="co"># 250 FR-France</span></span>
<span id="cb9-81"><a href="#cb9-81"></a><span class="co"># 276 DE-Germany*</span></span>
<span id="cb9-82"><a href="#cb9-82"></a><span class="co"># 348 HU-Hungary*</span></span>
<span id="cb9-83"><a href="#cb9-83"></a><span class="co"># 352 IS-Iceland</span></span>
<span id="cb9-84"><a href="#cb9-84"></a><span class="co"># 372 IE-Ireland</span></span>
<span id="cb9-85"><a href="#cb9-85"></a><span class="co"># 428 LV-Latvia</span></span>
<span id="cb9-86"><a href="#cb9-86"></a><span class="co"># 440 LT-Lithuania</span></span>
<span id="cb9-87"><a href="#cb9-87"></a><span class="co"># 528 NL-Netherlands</span></span>
<span id="cb9-88"><a href="#cb9-88"></a><span class="co"># 578 NO-Norway</span></span>
<span id="cb9-89"><a href="#cb9-89"></a><span class="co"># 616 PL-Poland</span></span>
<span id="cb9-90"><a href="#cb9-90"></a><span class="co"># 620 PT-Portugal</span></span>
<span id="cb9-91"><a href="#cb9-91"></a><span class="co"># 643 RU-Russia</span></span>
<span id="cb9-92"><a href="#cb9-92"></a><span class="co"># 703 SK-Slovakia</span></span>
<span id="cb9-93"><a href="#cb9-93"></a><span class="co"># 705 SI-Slovenia</span></span>
<span id="cb9-94"><a href="#cb9-94"></a><span class="co"># 752 SE-Sweden</span></span>
<span id="cb9-95"><a href="#cb9-95"></a><span class="co"># 756 CH-Switzerland</span></span>
<span id="cb9-96"><a href="#cb9-96"></a><span class="co"># 826 GB-Great Britain and/or United Kingdom - jätetään pois jotta saadaan TOPBOT </span></span>
<span id="cb9-97"><a href="#cb9-97"></a><span class="co">#                          -muuttuja mukaan (top-bottom self-placement) .(9.10.18)</span></span>
<span id="cb9-98"><a href="#cb9-98"></a><span class="co"># 840 US-United States - jätetään pois, jotta saadaan TOPBOT-muuttuja mukaan.(10.10.18)</span></span>
<span id="cb9-99"><a href="#cb9-99"></a><span class="co">#</span></span>
<span id="cb9-100"><a href="#cb9-100"></a><span class="co"># Belgian ja Saksan alueet:</span></span>
<span id="cb9-101"><a href="#cb9-101"></a><span class="co">#  V3</span></span>
<span id="cb9-102"><a href="#cb9-102"></a><span class="co">#  5601     BE-FLA-Belgium/ Flanders</span></span>
<span id="cb9-103"><a href="#cb9-103"></a><span class="co">#  5602     BE-WAL-Belgium/ Wallonia</span></span>
<span id="cb9-104"><a href="#cb9-104"></a><span class="co">#  5603     BE-BRU-Belgium/ Brussels</span></span>
<span id="cb9-105"><a href="#cb9-105"></a><span class="co"># 27601     DE-W-Germany-West</span></span>
<span id="cb9-106"><a href="#cb9-106"></a><span class="co"># 27602     DE-E-Germany-East</span></span>
<span id="cb9-107"><a href="#cb9-107"></a><span class="co">#</span></span>
<span id="cb9-108"><a href="#cb9-108"></a><span class="co"># Unkari (348) toistaiseksi mukana, mutta joissain kysymyksissä myös Unkarilla on </span></span>
<span id="cb9-109"><a href="#cb9-109"></a><span class="co"># poikkeavia vastausvaihtoehtoja(HU_V18, HU_V19,HU_V20). Jos näitä muuttujia käytetään, </span></span>
<span id="cb9-110"><a href="#cb9-110"></a><span class="co"># Unkari on parempi jättää pois. </span></span>
<span id="cb9-111"><a href="#cb9-111"></a><span class="co"># </span></span>
<span id="cb9-112"><a href="#cb9-112"></a><span class="co">#</span></span>
<span id="cb9-113"><a href="#cb9-113"></a><span class="co"># (25.4.2018) user_na  </span></span>
<span id="cb9-114"><a href="#cb9-114"></a><span class="co"># haven-paketin read_spss - funktiolla voi r-tiedostoon lukea myös SPSS:n sallimat kolme </span></span>
<span id="cb9-115"><a href="#cb9-115"></a><span class="co"># (yleensä 7, 8, 9) tarkempaa koodia puuttuvalle tiedolle.</span></span>
<span id="cb9-116"><a href="#cb9-116"></a><span class="co"># &quot;If TRUE variables with user defined missing will be read into labelled_spss objects. </span></span>
<span id="cb9-117"><a href="#cb9-117"></a><span class="co"># If FALSE, the default, user-defined missings will be converted to NA&quot;</span></span>
<span id="cb9-118"><a href="#cb9-118"></a><span class="co"># https://www.rdocumentation.org/packages/haven/versions/1.1.0/topics/read_spss</span></span>
<span id="cb9-119"><a href="#cb9-119"></a><span class="co">#</span></span>
<span id="cb9-120"><a href="#cb9-120"></a> </span>
<span id="cb9-121"><a href="#cb9-121"></a>ISSP2012jh.data &lt;-<span class="st"> </span><span class="kw">read_spss</span>(<span class="st">&quot;data/ZA5900_v4-0-0.sav&quot;</span>) <span class="co">#luetaan alkuperäinen data R- dataksi (df).</span></span>
<span id="cb9-122"><a href="#cb9-122"></a></span>
<span id="cb9-123"><a href="#cb9-123"></a><span class="co">#str(ISSP2012jh.data)</span></span>
<span id="cb9-124"><a href="#cb9-124"></a></span>
<span id="cb9-125"><a href="#cb9-125"></a>incl_countries25 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">56</span>,<span class="dv">100</span>, <span class="dv">124</span>, <span class="dv">191</span>, <span class="dv">203</span>, <span class="dv">208</span>, <span class="dv">246</span>, <span class="dv">250</span>, <span class="dv">276</span>, <span class="dv">348</span>, <span class="dv">352</span>, </span>
<span id="cb9-126"><a href="#cb9-126"></a>                      <span class="dv">372</span>, <span class="dv">428</span>, <span class="dv">440</span>, <span class="dv">528</span>, <span class="dv">578</span>, <span class="dv">616</span>, <span class="dv">620</span>, <span class="dv">643</span>, <span class="dv">703</span>, <span class="dv">705</span>, <span class="dv">752</span>, <span class="dv">756</span>)</span>
<span id="cb9-127"><a href="#cb9-127"></a></span>
<span id="cb9-128"><a href="#cb9-128"></a><span class="co">#str(ISSP2012jh.data)</span></span>
<span id="cb9-129"><a href="#cb9-129"></a><span class="co">#str(ISSP2012jh.data) #61754 obs. of  420 variables - kaikki</span></span>
<span id="cb9-130"><a href="#cb9-130"></a></span>
<span id="cb9-131"><a href="#cb9-131"></a>ISSP2012jh1a.data &lt;-<span class="st"> </span><span class="kw">filter</span>(ISSP2012jh.data, V4 <span class="op">%in%</span><span class="st"> </span>incl_countries25)</span>
<span id="cb9-132"><a href="#cb9-132"></a></span>
<span id="cb9-133"><a href="#cb9-133"></a><span class="co">#head(ISSP2012jh1a.data)</span></span>
<span id="cb9-134"><a href="#cb9-134"></a><span class="co">#str(ISSP2012jh1a.data) #34271 obs. of  420 variables, Espanja ja Iso-Britannia</span></span>
<span id="cb9-135"><a href="#cb9-135"></a><span class="co">#                       pois (9.10.2018)</span></span>
<span id="cb9-136"><a href="#cb9-136"></a><span class="co"># str(ISSP2012jh1a.data) # 32969 obs. of  420 variable, Espanja Iso-Britannia, </span></span>
<span id="cb9-137"><a href="#cb9-137"></a><span class="co">#                        USA pois (10.10.2018)</span></span>
<span id="cb9-138"><a href="#cb9-138"></a><span class="co">#</span></span>
<span id="cb9-139"><a href="#cb9-139"></a><span class="co"># names() # muuttujen nimet</span></span>
<span id="cb9-140"><a href="#cb9-140"></a><span class="co"># Maakohtaiset muuttujat (kun on poikettu ISSP2012 - vastausvaihtoehdoista tms.) </span></span>
<span id="cb9-141"><a href="#cb9-141"></a><span class="co"># on aineistossa eroteltu maatunnus-etuliitteellä (esimerkiksi ES_V7).</span></span>
<span id="cb9-142"><a href="#cb9-142"></a><span class="co"># Demografisissa ja muissa taustamuuttujissa suuri osa tiedoista on kerätty maa-</span></span>
<span id="cb9-143"><a href="#cb9-143"></a><span class="co"># kohtaisilla lomakkeilla. Vertailukelpoiset muuttujat on konstruoitu niistä.</span></span>
<span id="cb9-144"><a href="#cb9-144"></a><span class="co"># Muuttujia on 420, vain osa yhteisiä kaikille maille.</span></span>
<span id="cb9-145"><a href="#cb9-145"></a></span>
<span id="cb9-146"><a href="#cb9-146"></a><span class="co"># include FALSE: ei koodia eikä tulostusta dokumenttiin - poistettava turhia</span></span>
<span id="cb9-147"><a href="#cb9-147"></a><span class="co"># välitulostuksia (18.10.2020)</span></span>
<span id="cb9-148"><a href="#cb9-148"></a><span class="co"># 2. VALITAAN MUUTTUJAT  -&gt; ISSP2012jh1b.data. Maat valittu koodilohkossa datasel_country1</span></span>
<span id="cb9-149"><a href="#cb9-149"></a><span class="co">#</span></span>
<span id="cb9-150"><a href="#cb9-150"></a><span class="co">#</span></span>
<span id="cb9-151"><a href="#cb9-151"></a><span class="co"># Muuttujat on luokiteltu dokumentissa ZA5900_overview.pdf</span></span>
<span id="cb9-152"><a href="#cb9-152"></a><span class="co"># https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900</span></span>
<span id="cb9-153"><a href="#cb9-153"></a><span class="co"># Study Description -&gt; Other Study Description -&gt; Related Materials</span></span>
<span id="cb9-154"><a href="#cb9-154"></a><span class="co"># </span></span>
<span id="cb9-155"><a href="#cb9-155"></a><span class="co">#</span></span>
<span id="cb9-156"><a href="#cb9-156"></a></span>
<span id="cb9-157"><a href="#cb9-157"></a><span class="co"># METADATA</span></span>
<span id="cb9-158"><a href="#cb9-158"></a></span>
<span id="cb9-159"><a href="#cb9-159"></a>metavars1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V1&quot;</span>, <span class="st">&quot;V2&quot;</span>, <span class="st">&quot;DOI&quot;</span>)</span>
<span id="cb9-160"><a href="#cb9-160"></a></span>
<span id="cb9-161"><a href="#cb9-161"></a><span class="co">#MAA - maakoodit ja maan kahden merkin tunnus</span></span>
<span id="cb9-162"><a href="#cb9-162"></a></span>
<span id="cb9-163"><a href="#cb9-163"></a>countryvars1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V3&quot;</span>,<span class="st">&quot;V4&quot;</span>,<span class="st">&quot;C_ALPHAN&quot;</span>)</span>
<span id="cb9-164"><a href="#cb9-164"></a></span>
<span id="cb9-165"><a href="#cb9-165"></a><span class="co"># SUBSTANSSIMUUTTUJAT - Attitudes towards family and gender roles (9)</span></span>
<span id="cb9-166"><a href="#cb9-166"></a><span class="co">#</span></span>
<span id="cb9-167"><a href="#cb9-167"></a><span class="co"># Yhdeksän kysymystä (lyhennetyt versiot, englanniksi), vastausvaihtoehdot Q1-Q2</span></span>
<span id="cb9-168"><a href="#cb9-168"></a><span class="co">#</span></span>
<span id="cb9-169"><a href="#cb9-169"></a><span class="co"># 1 = täysin samaa mieltä, 2 = samaa mieltä, 3 = ei samaa eikä eri mieltä, </span></span>
<span id="cb9-170"><a href="#cb9-170"></a><span class="co"># 4 = eri mieltä, 5 = täysin eri mieltä</span></span>
<span id="cb9-171"><a href="#cb9-171"></a><span class="co"># </span></span>
<span id="cb9-172"><a href="#cb9-172"></a><span class="co"># Q1a Working mother can have warm relation with child</span></span>
<span id="cb9-173"><a href="#cb9-173"></a><span class="co"># Q1b Pre-school child suffers through working mother</span></span>
<span id="cb9-174"><a href="#cb9-174"></a><span class="co"># Q1c Family life suffers through working mother</span></span>
<span id="cb9-175"><a href="#cb9-175"></a><span class="co"># Q1d Women’s preference: home and children</span></span>
<span id="cb9-176"><a href="#cb9-176"></a><span class="co"># Q1e Being housewife is satisfying</span></span>
<span id="cb9-177"><a href="#cb9-177"></a><span class="co">#</span></span>
<span id="cb9-178"><a href="#cb9-178"></a><span class="co"># Q2a Both should contribute to household income</span></span>
<span id="cb9-179"><a href="#cb9-179"></a><span class="co"># Q2b Men’s job is earn money, women’s job household</span></span>
<span id="cb9-180"><a href="#cb9-180"></a><span class="co">#</span></span>
<span id="cb9-181"><a href="#cb9-181"></a><span class="co"># Q3a Should women work: Child under school age </span></span>
<span id="cb9-182"><a href="#cb9-182"></a><span class="co"># Q3b Should women work: Youngest kid at school</span></span>
<span id="cb9-183"><a href="#cb9-183"></a><span class="co"># 1= kokopäivätyö, 2 = osa-aikatyö, 3 = pysyä kotona, 8 = en osaa sanoa</span></span>
<span id="cb9-184"><a href="#cb9-184"></a><span class="co"># (can&#39;t choose), 9 = no answer</span></span>
<span id="cb9-185"><a href="#cb9-185"></a><span class="co">#</span></span>
<span id="cb9-186"><a href="#cb9-186"></a><span class="co"># Kysymysten Q3a ja Q3b eos-vastaus ei ole sama kuin &quot;en samaa enkä eri  mieltä&quot;</span></span>
<span id="cb9-187"><a href="#cb9-187"></a><span class="co"># (ns. neutraali # vaihtoehto), mutta kieltäytymisiä jne. (koodi 9) on aika</span></span>
<span id="cb9-188"><a href="#cb9-188"></a><span class="co"># vähän. Kolmessa # maassa ne on yhdistety: </span></span>
<span id="cb9-189"><a href="#cb9-189"></a><span class="co"># (8 Can&#39;t choose, CA:can&#39;t choose+no answer, KR:don&#39;t know+refused, NL:don&#39;t know).</span></span>
<span id="cb9-190"><a href="#cb9-190"></a><span class="co"># Kun SPSS-tiedostosta ei ole tuotu puuttuvan tiedon tarkempaa luokittelua,</span></span>
<span id="cb9-191"><a href="#cb9-191"></a><span class="co"># erottelua ei voi tehdä.</span></span>
<span id="cb9-192"><a href="#cb9-192"></a><span class="co">#</span></span>
<span id="cb9-193"><a href="#cb9-193"></a></span>
<span id="cb9-194"><a href="#cb9-194"></a>substvars1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;V5&quot;</span>,<span class="st">&quot;V6&quot;</span>,<span class="st">&quot;V7&quot;</span>,<span class="st">&quot;V8&quot;</span>,<span class="st">&quot;V9&quot;</span>,<span class="st">&quot;V10&quot;</span>,<span class="st">&quot;V11&quot;</span>,<span class="st">&quot;V12&quot;</span>,<span class="st">&quot;V13&quot;</span>) <span class="co"># 9 muuttujaa</span></span>
<span id="cb9-195"><a href="#cb9-195"></a></span>
<span id="cb9-196"><a href="#cb9-196"></a><span class="co"># Nämä yhteiset muuttujat pois (maaspesifien muuttujien lisäksi) :</span></span>
<span id="cb9-197"><a href="#cb9-197"></a><span class="co">#</span></span>
<span id="cb9-198"><a href="#cb9-198"></a><span class="co"># &quot;V14&quot;,&quot;V15&quot;,&quot;V16&quot;,  &quot;V17&quot;,&quot;V18&quot;,&quot;HU_V18&quot;,&quot;V19&quot;,&quot;HU_V19&quot;,&quot;V20&quot;,&quot;HU_V20&quot;,&quot;V21&quot;,</span></span>
<span id="cb9-199"><a href="#cb9-199"></a><span class="co"># &quot;V28&quot;,&quot;V29&quot;,&quot;V30&quot;,&quot;V31&quot;,&quot;V32&quot;,&quot;V33&quot;,# &quot;V34&quot;, &quot;V35&quot;, &quot;V36&quot;, &quot;V37&quot;, &quot;V38&quot;, &quot;V39&quot;,</span></span>
<span id="cb9-200"><a href="#cb9-200"></a><span class="co"># &quot;V40&quot;, &quot;V41&quot;, &quot;V42&quot;, &quot;V43&quot;, &quot;V44&quot;, &quot;V45&quot;, &quot;V46&quot;, &quot;V47&quot;, &quot;V48&quot;, &quot;V49&quot;, &quot;V50&quot;, </span></span>
<span id="cb9-201"><a href="#cb9-201"></a><span class="co"># &quot;V51&quot;, &quot;V52&quot;, &quot;V53&quot;, &quot;V54&quot;, &quot;V55&quot;, &quot;V56&quot;, &quot;V57&quot;, &quot;V58&quot;, &quot;V59&quot;, &quot;V60&quot;, &quot;V61&quot;, </span></span>
<span id="cb9-202"><a href="#cb9-202"></a><span class="co"># &quot;V62&quot;, &quot;V63&quot;, &quot;V64&quot;, &quot;V65&quot;, &quot;V65a&quot;,&quot;V66&quot;, &quot;V67&quot;</span></span>
<span id="cb9-203"><a href="#cb9-203"></a><span class="co">#</span></span>
<span id="cb9-204"><a href="#cb9-204"></a><span class="co">#</span></span>
<span id="cb9-205"><a href="#cb9-205"></a><span class="co"># DEMOGRAFISET JA MUUT TAUSTAMUUTTUJAT (8)</span></span>
<span id="cb9-206"><a href="#cb9-206"></a><span class="co">#</span></span>
<span id="cb9-207"><a href="#cb9-207"></a><span class="co"># AGE, SEX</span></span>
<span id="cb9-208"><a href="#cb9-208"></a><span class="co">#</span></span>
<span id="cb9-209"><a href="#cb9-209"></a><span class="co"># DEGREE - Highest completed degree of education: Categories for international</span></span>
<span id="cb9-210"><a href="#cb9-210"></a><span class="co"># comparison. Slightly re-arranged subset of ISCED-97</span></span>
<span id="cb9-211"><a href="#cb9-211"></a><span class="co">#</span></span>
<span id="cb9-212"><a href="#cb9-212"></a><span class="co"># 0 No formal education</span></span>
<span id="cb9-213"><a href="#cb9-213"></a><span class="co"># 1 Primary school (elementary school)</span></span>
<span id="cb9-214"><a href="#cb9-214"></a><span class="co"># 2 Lower secondary (secondary completed does not allow entry to university:</span></span>
<span id="cb9-215"><a href="#cb9-215"></a><span class="co">#  obligatory school)</span></span>
<span id="cb9-216"><a href="#cb9-216"></a><span class="co"># 3 Upper secondary (programs that allow entry to university or programs that</span></span>
<span id="cb9-217"><a href="#cb9-217"></a><span class="co">#  allow to entry other ISCED level 3 programs - designed to prepare students for</span></span>
<span id="cb9-218"><a href="#cb9-218"></a><span class="co">#  direct entry into the labour market)</span></span>
<span id="cb9-219"><a href="#cb9-219"></a><span class="co"># 4 Post secondary, non-tertiary (other upper secondary programs toward labour</span></span>
<span id="cb9-220"><a href="#cb9-220"></a><span class="co">#  market or technical formation)</span></span>
<span id="cb9-221"><a href="#cb9-221"></a><span class="co"># 5 Lower level tertiary, first stage (also technical schools at a tertiary level)</span></span>
<span id="cb9-222"><a href="#cb9-222"></a><span class="co"># 6 Upper level tertiary (Master, Dr.)</span></span>
<span id="cb9-223"><a href="#cb9-223"></a><span class="co"># 9 No answer, CH: don&#39;t know</span></span>
<span id="cb9-224"><a href="#cb9-224"></a><span class="co"># HUOM! R-factor - muunnoksessa koodaus on 1-7</span></span>
<span id="cb9-225"><a href="#cb9-225"></a><span class="co">#</span></span>
<span id="cb9-226"><a href="#cb9-226"></a><span class="co"># MAINSTAT - main status: Which of the following best describes your current situation?</span></span>
<span id="cb9-227"><a href="#cb9-227"></a><span class="co">#</span></span>
<span id="cb9-228"><a href="#cb9-228"></a><span class="co"># 1 In paid work</span></span>
<span id="cb9-229"><a href="#cb9-229"></a><span class="co"># 2 Unemployed and looking for a job, HR: incl never had a job</span></span>
<span id="cb9-230"><a href="#cb9-230"></a><span class="co"># 3 In education</span></span>
<span id="cb9-231"><a href="#cb9-231"></a><span class="co"># 4 Apprentice or trainee</span></span>
<span id="cb9-232"><a href="#cb9-232"></a><span class="co"># 5 Permanently sick or disabled</span></span>
<span id="cb9-233"><a href="#cb9-233"></a><span class="co"># 6 Retired</span></span>
<span id="cb9-234"><a href="#cb9-234"></a><span class="co"># 7 Domestic work</span></span>
<span id="cb9-235"><a href="#cb9-235"></a><span class="co"># 8 In compulsory military service or community service</span></span>
<span id="cb9-236"><a href="#cb9-236"></a><span class="co"># 9 Other</span></span>
<span id="cb9-237"><a href="#cb9-237"></a><span class="co"># 99 No answer</span></span>
<span id="cb9-238"><a href="#cb9-238"></a><span class="co"># Armeijassa tai yhdyskuntapalvelussa muutamia, muutamissa maissa.Kategoriassa 9 </span></span>
<span id="cb9-239"><a href="#cb9-239"></a><span class="co"># on hieman väkeä. Yhdistetään 8 ja 9. Huom! Esim Puolassa ei yhtään eläkeläistä</span></span>
<span id="cb9-240"><a href="#cb9-240"></a><span class="co"># eikä kategoriaa 9, Saksassa ei ketään kategoriassa 9.</span></span>
<span id="cb9-241"><a href="#cb9-241"></a><span class="co">#</span></span>
<span id="cb9-242"><a href="#cb9-242"></a><span class="co"># TOPBOT - Top-Bottom self-placement (10 pt scale)</span></span>
<span id="cb9-243"><a href="#cb9-243"></a><span class="co">#</span></span>
<span id="cb9-244"><a href="#cb9-244"></a><span class="co"># &quot;In our society, there are groups which tend to be towards the top and groups </span></span>
<span id="cb9-245"><a href="#cb9-245"></a><span class="co"># which tend to be towards the bottom. Below is a scale that runs</span></span>
<span id="cb9-246"><a href="#cb9-246"></a><span class="co"># from the top to the bottom. Where would you put yourself on this scale?&quot;</span></span>
<span id="cb9-247"><a href="#cb9-247"></a><span class="co"># Eri maissa hieman erilaisia kysymyksiä. </span></span>
<span id="cb9-248"><a href="#cb9-248"></a><span class="co">#</span></span>
<span id="cb9-249"><a href="#cb9-249"></a><span class="co"># HHCHILDR - How many children in household: children between [school age] and</span></span>
<span id="cb9-250"><a href="#cb9-250"></a><span class="co"># 17 years of age</span></span>
<span id="cb9-251"><a href="#cb9-251"></a><span class="co">#</span></span>
<span id="cb9-252"><a href="#cb9-252"></a><span class="co"># 0 No children</span></span>
<span id="cb9-253"><a href="#cb9-253"></a><span class="co"># 1 One child</span></span>
<span id="cb9-254"><a href="#cb9-254"></a><span class="co"># 2 2 children</span></span>
<span id="cb9-255"><a href="#cb9-255"></a><span class="co"># 21 21 children</span></span>
<span id="cb9-256"><a href="#cb9-256"></a><span class="co"># 96 NAP (Code 0 in HOMPOP)</span></span>
<span id="cb9-257"><a href="#cb9-257"></a><span class="co"># 97 Refused</span></span>
<span id="cb9-258"><a href="#cb9-258"></a><span class="co"># 99 No answer</span></span>
<span id="cb9-259"><a href="#cb9-259"></a><span class="co">#</span></span>
<span id="cb9-260"><a href="#cb9-260"></a><span class="co"># Voisi koodata dummymuuttujaksi lapsia (1) - ei lapsia (0).</span></span>
<span id="cb9-261"><a href="#cb9-261"></a><span class="co"># Ranskan datassa on erittäin iso osa puuttuvia tietoja (yli 20 %), Sama tilanne</span></span>
<span id="cb9-262"><a href="#cb9-262"></a><span class="co"># myös  muissa perheen kokoon liittyvissä kysymyksissä.  Myös Austarlialla aika</span></span>
<span id="cb9-263"><a href="#cb9-263"></a><span class="co"># paljon puuttuvia vastauksia.</span></span>
<span id="cb9-264"><a href="#cb9-264"></a><span class="co">#</span></span>
<span id="cb9-265"><a href="#cb9-265"></a><span class="co"># MARITAL - Legal partnership status </span></span>
<span id="cb9-266"><a href="#cb9-266"></a><span class="co">#</span></span>
<span id="cb9-267"><a href="#cb9-267"></a><span class="co"># What is your current legal marital status?</span></span>
<span id="cb9-268"><a href="#cb9-268"></a><span class="co"># The aim of this variable is to measure the current &#39;legal&#39; marital status &#39;. </span></span>
<span id="cb9-269"><a href="#cb9-269"></a><span class="co"># PARTLIV - muuttujassa on &#39;de facto&#39; - tilanteen tieto parisuhteesta</span></span>
<span id="cb9-270"><a href="#cb9-270"></a><span class="co">#</span></span>
<span id="cb9-271"><a href="#cb9-271"></a><span class="co"># 1 Married</span></span>
<span id="cb9-272"><a href="#cb9-272"></a><span class="co"># 2 Civil partnership</span></span>
<span id="cb9-273"><a href="#cb9-273"></a><span class="co"># 3 Separated from spouse/ civil partner (still legally married/ still legally </span></span>
<span id="cb9-274"><a href="#cb9-274"></a><span class="co">#   in a civil partnership)</span></span>
<span id="cb9-275"><a href="#cb9-275"></a><span class="co"># 4 Divorced from spouse/ legally separated from civil partner</span></span>
<span id="cb9-276"><a href="#cb9-276"></a><span class="co"># 5 Widowed/ civil partner died</span></span>
<span id="cb9-277"><a href="#cb9-277"></a><span class="co"># 6 Never married/ never in a civil partnership, single</span></span>
<span id="cb9-278"><a href="#cb9-278"></a><span class="co"># 7 Refused</span></span>
<span id="cb9-279"><a href="#cb9-279"></a><span class="co"># 8 Don&#39;t know</span></span>
<span id="cb9-280"><a href="#cb9-280"></a><span class="co"># 9 No answer</span></span>
<span id="cb9-281"><a href="#cb9-281"></a><span class="co">#</span></span>
<span id="cb9-282"><a href="#cb9-282"></a><span class="co"># URBRURAL - Place of living: urban - rural</span></span>
<span id="cb9-283"><a href="#cb9-283"></a><span class="co">#</span></span>
<span id="cb9-284"><a href="#cb9-284"></a><span class="co"># 1 A big city</span></span>
<span id="cb9-285"><a href="#cb9-285"></a><span class="co"># 2 The suburbs or outskirts of a big city</span></span>
<span id="cb9-286"><a href="#cb9-286"></a><span class="co"># 3 A town or a small city</span></span>
<span id="cb9-287"><a href="#cb9-287"></a><span class="co"># 4 A country village</span></span>
<span id="cb9-288"><a href="#cb9-288"></a><span class="co"># 5 A farm or home in the country</span></span>
<span id="cb9-289"><a href="#cb9-289"></a><span class="co"># 7 Other answer</span></span>
<span id="cb9-290"><a href="#cb9-290"></a><span class="co"># 9 No answer</span></span>
<span id="cb9-291"><a href="#cb9-291"></a><span class="co"># 1 ja 2 vaihtelevat aika paljon maittain, parempi laskea yhteen. Unkarista puuttuu </span></span>
<span id="cb9-292"><a href="#cb9-292"></a><span class="co"># jostain syystä kokonaan vaihtoehto 5.  Vaihotehdon 7 on valinnut vain 4</span></span>
<span id="cb9-293"><a href="#cb9-293"></a><span class="co"># vastaajaa Ranskasta.</span></span>
<span id="cb9-294"><a href="#cb9-294"></a><span class="co">#</span></span>
<span id="cb9-295"><a href="#cb9-295"></a></span>
<span id="cb9-296"><a href="#cb9-296"></a>bgvars1 &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="st">&quot;SEX&quot;</span>,<span class="st">&quot;AGE&quot;</span>,<span class="st">&quot;DEGREE&quot;</span>, <span class="st">&quot;MAINSTAT&quot;</span>, <span class="st">&quot;TOPBOT&quot;</span>,</span>
<span id="cb9-297"><a href="#cb9-297"></a>              <span class="st">&quot;HHCHILDR&quot;</span>, <span class="st">&quot;MARITAL&quot;</span>, <span class="st">&quot;URBRURAL&quot;</span>)</span>
<span id="cb9-298"><a href="#cb9-298"></a></span>
<span id="cb9-299"><a href="#cb9-299"></a><span class="co">#Valitaan muuttujat</span></span>
<span id="cb9-300"><a href="#cb9-300"></a></span>
<span id="cb9-301"><a href="#cb9-301"></a>jhvars1 &lt;-<span class="st"> </span><span class="kw">c</span>(metavars1,countryvars1, substvars1,bgvars1)</span>
<span id="cb9-302"><a href="#cb9-302"></a></span>
<span id="cb9-303"><a href="#cb9-303"></a><span class="co">#jhvars1</span></span>
<span id="cb9-304"><a href="#cb9-304"></a>ISSP2012jh1b.data &lt;-<span class="st"> </span><span class="kw">select</span>(ISSP2012jh1a.data, <span class="kw">all_of</span>(jhvars1)) </span>
<span id="cb9-305"><a href="#cb9-305"></a></span>
<span id="cb9-306"><a href="#cb9-306"></a><span class="co"># laaja aineisto - mukana havainnot joissa puuttuvia tietoja</span></span>
<span id="cb9-307"><a href="#cb9-307"></a><span class="co"># str(ISSP2012jh1b.data) #32969 obs. of  23 variables </span></span>
<span id="cb9-308"><a href="#cb9-308"></a><span class="co"># </span></span>
<span id="cb9-309"><a href="#cb9-309"></a><span class="co"># SUBSTANSSIMUUTTUJAT</span></span>
<span id="cb9-310"><a href="#cb9-310"></a><span class="co">#</span></span>
<span id="cb9-311"><a href="#cb9-311"></a><span class="co"># $ V5      : &#39;haven_labelled&#39; num  5 1 2 2 1 NA 2 4 2 2 ...</span></span>
<span id="cb9-312"><a href="#cb9-312"></a><span class="co">#  ..- attr(*, &quot;label&quot;)= chr &quot;Q1a Working mom: warm relationship with children</span></span>
<span id="cb9-313"><a href="#cb9-313"></a><span class="co">#       as a not working mom&quot;</span></span>
<span id="cb9-314"><a href="#cb9-314"></a><span class="co">#  ..- attr(*, &quot;labels&quot;)= Named num  0 1 2 3 4 5 8 9</span></span>
<span id="cb9-315"><a href="#cb9-315"></a><span class="co">#</span></span>
<span id="cb9-316"><a href="#cb9-316"></a><span class="co"># ISSP2012jh1b.data$V5 näyttää tarkemmin rakenteen</span></span>
<span id="cb9-317"><a href="#cb9-317"></a><span class="co">#</span></span>
<span id="cb9-318"><a href="#cb9-318"></a><span class="co"># glimpse(ISSP2012jh1b.data)</span></span>
<span id="cb9-319"><a href="#cb9-319"></a></span>
<span id="cb9-320"><a href="#cb9-320"></a><span class="co"># Poistetaan havainnot, joissa ikä (AGE) tai sukupuolitieto puuttuu (5.7.2019)</span></span>
<span id="cb9-321"><a href="#cb9-321"></a></span>
<span id="cb9-322"><a href="#cb9-322"></a>ISSP2012jh1c.data &lt;-<span class="st"> </span><span class="kw">filter</span>(ISSP2012jh1b.data, (<span class="op">!</span><span class="kw">is.na</span>(SEX) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(AGE)))</span>
<span id="cb9-323"><a href="#cb9-323"></a></span>
<span id="cb9-324"><a href="#cb9-324"></a><span class="co"># str(ISSP2012jh1c.data) # 32823 obs. of  23 variables, 32969-32823 = 146</span></span>
<span id="cb9-325"><a href="#cb9-325"></a><span class="co"># TARKISTUS 8.6.20 dplyr 1.0.0-päivitys: havaintojen ja muuttujien määrä ok.</span></span>
<span id="cb9-326"><a href="#cb9-326"></a></span>
<span id="cb9-327"><a href="#cb9-327"></a><span class="co"># VAIHE 1 - muuttujat joissa ei ole puuttuvia tietoja</span></span>
<span id="cb9-328"><a href="#cb9-328"></a></span>
<span id="cb9-329"><a href="#cb9-329"></a><span class="co"># vaihe 1.1 haven_labelled ja chr -&gt; as_factor</span></span>
<span id="cb9-330"><a href="#cb9-330"></a></span>
<span id="cb9-331"><a href="#cb9-331"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1c.data <span class="op">%&gt;%</span></span>
<span id="cb9-332"><a href="#cb9-332"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">maa =</span> <span class="kw">as_factor</span>(C_ALPHAN), <span class="co"># ei puuttuvia, ei tyhjiä leveleitä</span></span>
<span id="cb9-333"><a href="#cb9-333"></a>           <span class="dt">maa3 =</span> <span class="kw">as_factor</span>(V3),  <span class="co"># maakoodi, jossa aluejako joillan mailla</span></span>
<span id="cb9-334"><a href="#cb9-334"></a>           <span class="dt">sp1 =</span> <span class="kw">as_factor</span>(SEX), <span class="co"># ei puuttuvia, tyhjä level &quot;no answer&quot; 999</span></span>
<span id="cb9-335"><a href="#cb9-335"></a>         )</span>
<span id="cb9-336"><a href="#cb9-336"></a></span>
<span id="cb9-337"><a href="#cb9-337"></a></span>
<span id="cb9-338"><a href="#cb9-338"></a><span class="co"># C_ALPHAN - maa - maa3 tarkistuksia</span></span>
<span id="cb9-339"><a href="#cb9-339"></a></span>
<span id="cb9-340"><a href="#cb9-340"></a><span class="co"># V3</span></span>
<span id="cb9-341"><a href="#cb9-341"></a><span class="co"># &quot;Pulma&quot; on järjestys. C_ALPHAN (&quot;chr&quot;) on aakkosjärjestyksessä, kun luodaan</span></span>
<span id="cb9-342"><a href="#cb9-342"></a><span class="co"># maa = as_factor(C_ALPHAN) järjestys muuttuu (esiintymisjärjestys datassa?)</span></span>
<span id="cb9-343"><a href="#cb9-343"></a><span class="co"># maa3 muunnetaan maakoodista (haven_labelled&#39; num), jonka</span></span>
<span id="cb9-344"><a href="#cb9-344"></a></span>
<span id="cb9-345"><a href="#cb9-345"></a><span class="co"># str(ISSP2012jh1d.dat$maa) #Country Prefix ISO 3166 Code - alphanumeric</span></span>
<span id="cb9-346"><a href="#cb9-346"></a><span class="co"># attributes(ISSP2012jh1d.dat$maa) # ei tyhiä levels-arvoja, 25 levels</span></span>
<span id="cb9-347"><a href="#cb9-347"></a><span class="co"># ISSP2012jh1d.dat$maa %&gt;% fct_unique()</span></span>
<span id="cb9-348"><a href="#cb9-348"></a><span class="co"># ISSP2012jh1d.dat$maa %&gt;% fct_count() # summary kertoo samat tiedot (20.2.20)</span></span>
<span id="cb9-349"><a href="#cb9-349"></a><span class="co"># sum(is.na(ISSP2012jh1d.dat$maa)) # ei puuttuvia tietoja</span></span>
<span id="cb9-350"><a href="#cb9-350"></a><span class="co"># ISSP2012jh1d.dat$maa %&gt;% summary() # mukana vain valitut 25 maata</span></span>
<span id="cb9-351"><a href="#cb9-351"></a></span>
<span id="cb9-352"><a href="#cb9-352"></a><span class="co"># str(ISSP2012jh1d.dat$maa3)  #&quot;Country/ Sample ISO 3166 Code</span></span>
<span id="cb9-353"><a href="#cb9-353"></a>                            <span class="co">#(see V4 for codes for whole nation states)&quot;</span></span>
<span id="cb9-354"><a href="#cb9-354"></a>                            <span class="co"># 29 levels</span></span>
<span id="cb9-355"><a href="#cb9-355"></a><span class="co"># str(ISSP2012jh1d.dat$V3)</span></span>
<span id="cb9-356"><a href="#cb9-356"></a></span>
<span id="cb9-357"><a href="#cb9-357"></a><span class="co"># attributes(ISSP2012jh1d.dat$maa3) # ei tyhiä levels-arvoja, 29 levels</span></span>
<span id="cb9-358"><a href="#cb9-358"></a><span class="co"># sum(is.na(ISSP2012jh1d.dat$maa3)) # nolla ei ole puuttuva tieto! (3.2.20)</span></span>
<span id="cb9-359"><a href="#cb9-359"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% fct_unique()</span></span>
<span id="cb9-360"><a href="#cb9-360"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% fct_count()</span></span>
<span id="cb9-361"><a href="#cb9-361"></a><span class="co"># Vain näissä on jaettu maan havainnot (3.2.20)</span></span>
<span id="cb9-362"><a href="#cb9-362"></a><span class="co">#</span></span>
<span id="cb9-363"><a href="#cb9-363"></a><span class="co"># [38] BE-FLA-Belgium/ Flanders</span></span>
<span id="cb9-364"><a href="#cb9-364"></a><span class="co"># [39] BE-WAL-Belgium/ Wallonia</span></span>
<span id="cb9-365"><a href="#cb9-365"></a><span class="co"># [40] BE-BRU-Belgium/ Brussels</span></span>
<span id="cb9-366"><a href="#cb9-366"></a><span class="co"># [41] DE-W-Germany-West</span></span>
<span id="cb9-367"><a href="#cb9-367"></a><span class="co"># [42] DE-E-Germany-East</span></span>
<span id="cb9-368"><a href="#cb9-368"></a><span class="co"># [43] PT-Portugal 2012: first fieldwork round (main sample)</span></span>
<span id="cb9-369"><a href="#cb9-369"></a><span class="co"># [44] PT-Portugal 2012: second fieldwork round (complementary sample)</span></span>
<span id="cb9-370"><a href="#cb9-370"></a></span>
<span id="cb9-371"><a href="#cb9-371"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% fct_count() #miksi ei tulosta mitään? (3.2.2020)</span></span>
<span id="cb9-372"><a href="#cb9-372"></a></span>
<span id="cb9-373"><a href="#cb9-373"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% summary()</span></span>
<span id="cb9-374"><a href="#cb9-374"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% fct_unique()</span></span>
<span id="cb9-375"><a href="#cb9-375"></a><span class="co"># maa3: 25 maata, havaintojen määrä. Poisjätetyissä havaintoja 0.</span></span>
<span id="cb9-376"><a href="#cb9-376"></a><span class="co"># glimpse(ISSP2012jh1d.dat$maa3)</span></span>
<span id="cb9-377"><a href="#cb9-377"></a><span class="co"># head(ISSP2012jh1d.dat$maa3)</span></span>
<span id="cb9-378"><a href="#cb9-378"></a><span class="co"># length(levels(ISSP2012jh1d.dat$maa3))</span></span>
<span id="cb9-379"><a href="#cb9-379"></a></span>
<span id="cb9-380"><a href="#cb9-380"></a><span class="co"># C_ALPHAN alkuperäinen järjestys, maa aakkosjärjestyssä  (2.2.20)</span></span>
<span id="cb9-381"><a href="#cb9-381"></a><span class="co">#</span></span>
<span id="cb9-382"><a href="#cb9-382"></a><span class="co"># Huom1: Myös merkkijonomuuttujaa C_ALPHAN tarvitaan jatkossa.</span></span>
<span id="cb9-383"><a href="#cb9-383"></a><span class="co">#</span></span>
<span id="cb9-384"><a href="#cb9-384"></a><span class="co"># Huom2: kun dataa rajataan, on tarkistettava ja tarvittaessa poistettava</span></span>
<span id="cb9-385"><a href="#cb9-385"></a><span class="co"># &quot;tyhjät&quot; R-factor - muuttujan &quot;maa&quot; luokat (3.2.2020)</span></span>
<span id="cb9-386"><a href="#cb9-386"></a></span>
<span id="cb9-387"><a href="#cb9-387"></a></span>
<span id="cb9-388"><a href="#cb9-388"></a><span class="co"># vaihe 1.2 tyhjät luokat (levels) pois faktoreista</span></span>
<span id="cb9-389"><a href="#cb9-389"></a></span>
<span id="cb9-390"><a href="#cb9-390"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-391"><a href="#cb9-391"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">sp =</span> <span class="kw">fct_drop</span>(sp1),</span>
<span id="cb9-392"><a href="#cb9-392"></a>           <span class="dt">maa3 =</span> <span class="kw">fct_drop</span>(maa3)</span>
<span id="cb9-393"><a href="#cb9-393"></a>           )</span>
<span id="cb9-394"><a href="#cb9-394"></a></span>
<span id="cb9-395"><a href="#cb9-395"></a><span class="co">#  maa3 - tarkistuksia</span></span>
<span id="cb9-396"><a href="#cb9-396"></a></span>
<span id="cb9-397"><a href="#cb9-397"></a><span class="co"># str(ISSP2012jh1d.dat$maa3)  # 29 levels</span></span>
<span id="cb9-398"><a href="#cb9-398"></a><span class="co"># attributes(ISSP2012jh1d.dat$maa3)</span></span>
<span id="cb9-399"><a href="#cb9-399"></a><span class="co">#sum(is.na(ISSP2012jh1d.dat$maa3)) # nolla ei ole puuttuva tieto! (3.2.20)</span></span>
<span id="cb9-400"><a href="#cb9-400"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% summary()</span></span>
<span id="cb9-401"><a href="#cb9-401"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% fct_unique()</span></span>
<span id="cb9-402"><a href="#cb9-402"></a><span class="co"># ISSP2012jh1d.dat$maa3 %&gt;% fct_count()</span></span>
<span id="cb9-403"><a href="#cb9-403"></a><span class="co">#</span></span>
<span id="cb9-404"><a href="#cb9-404"></a><span class="co"># str(ISSP2012jh1d.dat$C_ALPHAN)</span></span>
<span id="cb9-405"><a href="#cb9-405"></a><span class="co"># attributes(ISSP2012jh1d.dat$C_ALPHAN)</span></span>
<span id="cb9-406"><a href="#cb9-406"></a></span>
<span id="cb9-407"><a href="#cb9-407"></a><span class="co"># TESTAUKSIA</span></span>
<span id="cb9-408"><a href="#cb9-408"></a><span class="co"># </span></span>
<span id="cb9-409"><a href="#cb9-409"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(C_ALPHAN, maa)</span></span>
<span id="cb9-410"><a href="#cb9-410"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(C_ALPHAN, maa3)</span></span>
<span id="cb9-411"><a href="#cb9-411"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(maa, maa3)</span></span>
<span id="cb9-412"><a href="#cb9-412"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(V3, maa3)</span></span>
<span id="cb9-413"><a href="#cb9-413"></a></span>
<span id="cb9-414"><a href="#cb9-414"></a><span class="co"># sp, sp1, SEX - tarkistuksia</span></span>
<span id="cb9-415"><a href="#cb9-415"></a><span class="co"># </span></span>
<span id="cb9-416"><a href="#cb9-416"></a><span class="co"># ISSP2012jh1d.dat$sp %&gt;% fct_count()</span></span>
<span id="cb9-417"><a href="#cb9-417"></a><span class="co"># ISSP2012jh1d.dat$sp %&gt;% fct_count()</span></span>
<span id="cb9-418"><a href="#cb9-418"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(SEX,sp1)</span></span>
<span id="cb9-419"><a href="#cb9-419"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(SEX,sp)</span></span>
<span id="cb9-420"><a href="#cb9-420"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(sp1,sp)</span></span>
<span id="cb9-421"><a href="#cb9-421"></a></span>
<span id="cb9-422"><a href="#cb9-422"></a><span class="co"># vaihe 1.3 uudet &quot;faktorilabelit&quot;</span></span>
<span id="cb9-423"><a href="#cb9-423"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-424"><a href="#cb9-424"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">sp =</span></span>
<span id="cb9-425"><a href="#cb9-425"></a>          <span class="kw">fct_recode</span>(sp,</span>
<span id="cb9-426"><a href="#cb9-426"></a>            <span class="st">&quot;m&quot;</span> =<span class="st"> &quot;Male&quot;</span>,</span>
<span id="cb9-427"><a href="#cb9-427"></a>            <span class="st">&quot;f&quot;</span> =<span class="st"> &quot;Female&quot;</span>)</span>
<span id="cb9-428"><a href="#cb9-428"></a>            )</span>
<span id="cb9-429"><a href="#cb9-429"></a></span>
<span id="cb9-430"><a href="#cb9-430"></a><span class="co"># Tarkistuksia</span></span>
<span id="cb9-431"><a href="#cb9-431"></a></span>
<span id="cb9-432"><a href="#cb9-432"></a><span class="co"># ISSP2012jh1d.dat$sp %&gt;% fct_unique()</span></span>
<span id="cb9-433"><a href="#cb9-433"></a><span class="co"># ISSP2012jh1d.dat$sp %&gt;% fct_count()</span></span>
<span id="cb9-434"><a href="#cb9-434"></a><span class="co"># ISSP2012jh1d.dat$sp %&gt;% summary()</span></span>
<span id="cb9-435"><a href="#cb9-435"></a></span>
<span id="cb9-436"><a href="#cb9-436"></a><span class="co"># AGE -&gt; ika</span></span>
<span id="cb9-437"><a href="#cb9-437"></a>ISSP2012jh1d.dat<span class="op">$</span>ika &lt;-<span class="st"> </span>ISSP2012jh1d.dat<span class="op">$</span>AGE</span>
<span id="cb9-438"><a href="#cb9-438"></a></span>
<span id="cb9-439"><a href="#cb9-439"></a><span class="co"># Tarkistuksia</span></span>
<span id="cb9-440"><a href="#cb9-440"></a><span class="kw">attributes</span>(ISSP2012jh1d.dat<span class="op">$</span>ika) <span class="co"># tyhjä level &quot;No answer&quot;</span></span>
<span id="cb9-441"><a href="#cb9-441"></a><span class="co"># str(ISSP2012jh1d.dat$ika)</span></span>
<span id="cb9-442"><a href="#cb9-442"></a>ISSP2012jh1d.dat<span class="op">$</span>ika <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>()</span>
<span id="cb9-443"><a href="#cb9-443"></a></span>
<span id="cb9-444"><a href="#cb9-444"></a>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-445"><a href="#cb9-445"></a><span class="kw">tableC</span>(AGE, ika,<span class="dt">cor_type =</span> <span class="st">&quot;pearson&quot;</span>, <span class="dt">na.rm =</span> <span class="ot">FALSE</span>, <span class="dt">rounding =</span> <span class="dv">5</span>,</span>
<span id="cb9-446"><a href="#cb9-446"></a>       <span class="dt">output =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">caption =</span> <span class="ot">NULL</span>, <span class="dt">align =</span> <span class="ot">NULL</span>,</span>
<span id="cb9-447"><a href="#cb9-447"></a>       <span class="dt">float =</span> <span class="st">&quot;htb&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</span>
<span id="cb9-448"><a href="#cb9-448"></a></span>
<span id="cb9-449"><a href="#cb9-449"></a><span class="co"># Ikäjakauma - ei tarvita (18.10.2020)</span></span>
<span id="cb9-450"><a href="#cb9-450"></a><span class="co">#</span></span>
<span id="cb9-451"><a href="#cb9-451"></a><span class="co"># ISSP2012jh1d.dat$ika %&gt;% hist(main = &quot;ISSP 2012: vastaajan ikä&quot;)</span></span>
<span id="cb9-452"><a href="#cb9-452"></a></span>
<span id="cb9-453"><a href="#cb9-453"></a><span class="co"># Substanssi- ja taustamuuttujat R-faktoreiksi</span></span>
<span id="cb9-454"><a href="#cb9-454"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-455"><a href="#cb9-455"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Q1a1 =</span> <span class="kw">as_factor</span>(V5), <span class="co">#labels</span></span>
<span id="cb9-456"><a href="#cb9-456"></a>            <span class="dt">Q1b1 =</span> <span class="kw">as_factor</span>(V6),</span>
<span id="cb9-457"><a href="#cb9-457"></a>            <span class="dt">Q1c1 =</span> <span class="kw">as_factor</span>(V7),</span>
<span id="cb9-458"><a href="#cb9-458"></a>            <span class="dt">Q1d1 =</span> <span class="kw">as_factor</span>(V8),</span>
<span id="cb9-459"><a href="#cb9-459"></a>            <span class="dt">Q1e1 =</span> <span class="kw">as_factor</span>(V9),</span>
<span id="cb9-460"><a href="#cb9-460"></a>            <span class="dt">Q2a1 =</span> <span class="kw">as_factor</span>(V10),</span>
<span id="cb9-461"><a href="#cb9-461"></a>            <span class="dt">Q2b1 =</span> <span class="kw">as_factor</span>(V11),</span>
<span id="cb9-462"><a href="#cb9-462"></a>            <span class="dt">Q3a1 =</span> <span class="kw">as_factor</span>(V12), <span class="co">#labels = vastQ3_labels (W,w,H)</span></span>
<span id="cb9-463"><a href="#cb9-463"></a>            <span class="dt">Q3b1 =</span> <span class="kw">as_factor</span>(V13), <span class="co">#labels = vastQ3_labels</span></span>
<span id="cb9-464"><a href="#cb9-464"></a>            <span class="dt">edu1 =</span> <span class="kw">as_factor</span>(DEGREE),</span>
<span id="cb9-465"><a href="#cb9-465"></a>            <span class="dt">msta1 =</span> <span class="kw">as_factor</span>(MAINSTAT),</span>
<span id="cb9-466"><a href="#cb9-466"></a>            <span class="dt">sosta1 =</span> <span class="kw">as_factor</span>(TOPBOT),</span>
<span id="cb9-467"><a href="#cb9-467"></a>            <span class="dt">nchild1 =</span> <span class="kw">as_factor</span>(HHCHILDR),</span>
<span id="cb9-468"><a href="#cb9-468"></a>            <span class="dt">lifsta1 =</span> <span class="kw">as_factor</span>(MARITAL),</span>
<span id="cb9-469"><a href="#cb9-469"></a>            <span class="dt">urbru1 =</span> <span class="kw">as_factor</span>(URBRURAL)</span>
<span id="cb9-470"><a href="#cb9-470"></a>           )</span>
<span id="cb9-471"><a href="#cb9-471"></a></span>
<span id="cb9-472"><a href="#cb9-472"></a><span class="co"># Muuttujat Q1a1...urbru1 ovat apumuuttujia, joissa on periaatteessa kaikki SPSS-</span></span>
<span id="cb9-473"><a href="#cb9-473"></a><span class="co"># tiedostosta siirtyvä metatieto. Poikkeus on SPSS:n kolme tarkentavaa koodia</span></span>
<span id="cb9-474"><a href="#cb9-474"></a><span class="co"># puuttuvalle tiedolle, ne saisi mukaan read_spss - parametrin avulla (user_na=TRUE)</span></span>
<span id="cb9-475"><a href="#cb9-475"></a><span class="co">#</span></span>
<span id="cb9-476"><a href="#cb9-476"></a></span>
<span id="cb9-477"><a href="#cb9-477"></a><span class="co"># Tarkistusksia</span></span>
<span id="cb9-478"><a href="#cb9-478"></a><span class="co"># ISSP2012jh1d.dat %&gt;% summary()</span></span>
<span id="cb9-479"><a href="#cb9-479"></a></span>
<span id="cb9-480"><a href="#cb9-480"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-481"><a href="#cb9-481"></a><span class="co">#    select(Q1a1, Q1b1, Q1c1,Q1d1,Q1e1, Q2a1, Q2b1, Q3a1,Q3b1) %&gt;%</span></span>
<span id="cb9-482"><a href="#cb9-482"></a><span class="co">#    summary()</span></span>
<span id="cb9-483"><a href="#cb9-483"></a><span class="co">#</span></span>
<span id="cb9-484"><a href="#cb9-484"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-485"><a href="#cb9-485"></a><span class="co">#    select(edu1,msta1, sosta1, nchild1, lifsta1, urbru1) %&gt;%</span></span>
<span id="cb9-486"><a href="#cb9-486"></a><span class="co">#    summary()</span></span>
<span id="cb9-487"><a href="#cb9-487"></a></span>
<span id="cb9-488"><a href="#cb9-488"></a></span>
<span id="cb9-489"><a href="#cb9-489"></a><span class="co"># Substanssimuuttujat - ristiintaulukoinnit riittävät (6.2.20)</span></span>
<span id="cb9-490"><a href="#cb9-490"></a></span>
<span id="cb9-491"><a href="#cb9-491"></a><span class="co"># ISSP2012jh1d.dat$Q1a1 %&gt;% fct_count()</span></span>
<span id="cb9-492"><a href="#cb9-492"></a><span class="co"># ISSP2012jh1d.dat$Q1b1 %&gt;% fct_count()</span></span>
<span id="cb9-493"><a href="#cb9-493"></a><span class="co"># ISSP2012jh1d.dat$Q1c1 %&gt;% fct_count()</span></span>
<span id="cb9-494"><a href="#cb9-494"></a><span class="co"># ISSP2012jh1d.dat$Q1d1 %&gt;% fct_count()</span></span>
<span id="cb9-495"><a href="#cb9-495"></a><span class="co"># ISSP2012jh1d.dat$Q1e1 %&gt;% fct_count()</span></span>
<span id="cb9-496"><a href="#cb9-496"></a><span class="co"># ISSP2012jh1d.dat$Q2a1 %&gt;% fct_count()</span></span>
<span id="cb9-497"><a href="#cb9-497"></a><span class="co"># ISSP2012jh1d.dat$Q2b1 %&gt;% fct_count()</span></span>
<span id="cb9-498"><a href="#cb9-498"></a><span class="co"># ISSP2012jh1d.dat$Q3a1 %&gt;% fct_count()</span></span>
<span id="cb9-499"><a href="#cb9-499"></a><span class="co">#ISSP2012jh1d.dat$Q3b1 %&gt;% fct_count()</span></span>
<span id="cb9-500"><a href="#cb9-500"></a></span>
<span id="cb9-501"><a href="#cb9-501"></a><span class="co"># Taustamuuttujat - ristiintaulukoinnit riittävät (6.2.20)</span></span>
<span id="cb9-502"><a href="#cb9-502"></a></span>
<span id="cb9-503"><a href="#cb9-503"></a><span class="co"># ISSP2012jh1d.dat$edu1 %&gt;% fct_count()</span></span>
<span id="cb9-504"><a href="#cb9-504"></a><span class="co"># ISSP2012jh1d.dat$msta1 %&gt;% fct_count()</span></span>
<span id="cb9-505"><a href="#cb9-505"></a><span class="co"># ISSP2012jh1d.dat$sosta1 %&gt;% fct_count()</span></span>
<span id="cb9-506"><a href="#cb9-506"></a><span class="co"># ISSP2012jh1d.dat$nchild1 %&gt;% fct_count()</span></span>
<span id="cb9-507"><a href="#cb9-507"></a><span class="co"># ISSP2012jh1d.dat$lifsta1 %&gt;% fct_count()</span></span>
<span id="cb9-508"><a href="#cb9-508"></a><span class="co"># ISSP2012jh1d.dat$urbru1 %&gt;% fct_count()</span></span>
<span id="cb9-509"><a href="#cb9-509"></a></span>
<span id="cb9-510"><a href="#cb9-510"></a><span class="co"># Poistetaan tyhjät luokat muuttujista</span></span>
<span id="cb9-511"><a href="#cb9-511"></a></span>
<span id="cb9-512"><a href="#cb9-512"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-513"><a href="#cb9-513"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Q1a =</span> <span class="kw">fct_drop</span>(Q1a1),</span>
<span id="cb9-514"><a href="#cb9-514"></a>           <span class="dt">Q1b =</span> <span class="kw">fct_drop</span>(Q1b1),</span>
<span id="cb9-515"><a href="#cb9-515"></a>           <span class="dt">Q1c =</span> <span class="kw">fct_drop</span>(Q1c1),</span>
<span id="cb9-516"><a href="#cb9-516"></a>           <span class="dt">Q1d =</span> <span class="kw">fct_drop</span>(Q1d1),</span>
<span id="cb9-517"><a href="#cb9-517"></a>           <span class="dt">Q1e =</span> <span class="kw">fct_drop</span>(Q1e1),</span>
<span id="cb9-518"><a href="#cb9-518"></a>           <span class="dt">Q2a =</span> <span class="kw">fct_drop</span>(Q2a1),</span>
<span id="cb9-519"><a href="#cb9-519"></a>           <span class="dt">Q2b =</span> <span class="kw">fct_drop</span>(Q2b1),</span>
<span id="cb9-520"><a href="#cb9-520"></a>           <span class="dt">Q3a =</span> <span class="kw">fct_drop</span>(Q3a1),</span>
<span id="cb9-521"><a href="#cb9-521"></a>           <span class="dt">Q3b =</span> <span class="kw">fct_drop</span>(Q3b1),</span>
<span id="cb9-522"><a href="#cb9-522"></a>           <span class="dt">edu =</span> <span class="kw">fct_drop</span>(edu1),</span>
<span id="cb9-523"><a href="#cb9-523"></a>           <span class="dt">msta =</span> <span class="kw">fct_drop</span>(msta1),</span>
<span id="cb9-524"><a href="#cb9-524"></a>           <span class="dt">sosta =</span> <span class="kw">fct_drop</span>(sosta1),</span>
<span id="cb9-525"><a href="#cb9-525"></a>           <span class="dt">nchild =</span> <span class="kw">fct_drop</span>(nchild1),</span>
<span id="cb9-526"><a href="#cb9-526"></a>           <span class="dt">lifsta =</span> <span class="kw">fct_drop</span>(lifsta1),</span>
<span id="cb9-527"><a href="#cb9-527"></a>           <span class="dt">urbru =</span> <span class="kw">fct_drop</span>(urbru1)</span>
<span id="cb9-528"><a href="#cb9-528"></a></span>
<span id="cb9-529"><a href="#cb9-529"></a>    )</span>
<span id="cb9-530"><a href="#cb9-530"></a><span class="co"># Tarkistuksia 1</span></span>
<span id="cb9-531"><a href="#cb9-531"></a></span>
<span id="cb9-532"><a href="#cb9-532"></a><span class="co"># ISSP2012jh1d.dat %&gt;% summary()</span></span>
<span id="cb9-533"><a href="#cb9-533"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-534"><a href="#cb9-534"></a><span class="co">#    select(Q1a, Q1b, Q1c, Q1d, Q1e,Q2a,Q2b,Q3a, Q3b) %&gt;%</span></span>
<span id="cb9-535"><a href="#cb9-535"></a><span class="co">#    str()</span></span>
<span id="cb9-536"><a href="#cb9-536"></a><span class="co">#ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-537"><a href="#cb9-537"></a><span class="co">#    select(Q1a1, Q1b1, Q1c1, Q1d1, Q1e1,Q2a1,Q2b1,Q3a1, Q3b1) %&gt;%</span></span>
<span id="cb9-538"><a href="#cb9-538"></a><span class="co">#    str()</span></span>
<span id="cb9-539"><a href="#cb9-539"></a><span class="co">#ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-540"><a href="#cb9-540"></a><span class="co">#    select(edu, msta, sosta, nchild,lifsta, urbru) %&gt;%</span></span>
<span id="cb9-541"><a href="#cb9-541"></a><span class="co">#    str()</span></span>
<span id="cb9-542"><a href="#cb9-542"></a><span class="co">#ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-543"><a href="#cb9-543"></a><span class="co">#    select(edu1, msta1, sosta1, nchild1,lifsta1, urbru1) %&gt;%</span></span>
<span id="cb9-544"><a href="#cb9-544"></a><span class="co">#    str()</span></span>
<span id="cb9-545"><a href="#cb9-545"></a></span>
<span id="cb9-546"><a href="#cb9-546"></a><span class="co"># Tarkistuksia 2 - ristiintaulukointeja</span></span>
<span id="cb9-547"><a href="#cb9-547"></a><span class="co"># Substanssimuuttujat</span></span>
<span id="cb9-548"><a href="#cb9-548"></a></span>
<span id="cb9-549"><a href="#cb9-549"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q1a,Q1a1)</span></span>
<span id="cb9-550"><a href="#cb9-550"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q1b,Q1b1)</span></span>
<span id="cb9-551"><a href="#cb9-551"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q1c,Q1c1)</span></span>
<span id="cb9-552"><a href="#cb9-552"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q1d,Q1d1)</span></span>
<span id="cb9-553"><a href="#cb9-553"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q1e,Q1e1)</span></span>
<span id="cb9-554"><a href="#cb9-554"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q2a,Q2a1)</span></span>
<span id="cb9-555"><a href="#cb9-555"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q2b,Q2b1)</span></span>
<span id="cb9-556"><a href="#cb9-556"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q3a,Q3a1)</span></span>
<span id="cb9-557"><a href="#cb9-557"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(Q3b,Q3b1)</span></span>
<span id="cb9-558"><a href="#cb9-558"></a></span>
<span id="cb9-559"><a href="#cb9-559"></a><span class="co"># Taustamuuttujat</span></span>
<span id="cb9-560"><a href="#cb9-560"></a></span>
<span id="cb9-561"><a href="#cb9-561"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(edu,edu1)</span></span>
<span id="cb9-562"><a href="#cb9-562"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(msta,msta1)</span></span>
<span id="cb9-563"><a href="#cb9-563"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(sosta,sosta1)</span></span>
<span id="cb9-564"><a href="#cb9-564"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(nchild,nchild1)</span></span>
<span id="cb9-565"><a href="#cb9-565"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(lifsta,lifsta1)</span></span>
<span id="cb9-566"><a href="#cb9-566"></a><span class="co"># ISSP2012jh1d.dat %&gt;% tableX(urbru,urbru1)</span></span>
<span id="cb9-567"><a href="#cb9-567"></a></span>
<span id="cb9-568"><a href="#cb9-568"></a><span class="co"># Uusi muuttuja, jossa NA-arvot ovat mukana muuttujan uutena luokkana. Muuttujat</span></span>
<span id="cb9-569"><a href="#cb9-569"></a><span class="co"># nimetään Q1a -&gt; Q1am.</span></span>
<span id="cb9-570"><a href="#cb9-570"></a></span>
<span id="cb9-571"><a href="#cb9-571"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-572"><a href="#cb9-572"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Q1am =</span> <span class="kw">fct_explicit_na</span>(Q1a, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-573"><a href="#cb9-573"></a>           <span class="dt">Q1bm =</span> <span class="kw">fct_explicit_na</span>(Q1b, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-574"><a href="#cb9-574"></a>           <span class="dt">Q1cm =</span> <span class="kw">fct_explicit_na</span>(Q1c, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-575"><a href="#cb9-575"></a>           <span class="dt">Q1dm =</span> <span class="kw">fct_explicit_na</span>(Q1d, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-576"><a href="#cb9-576"></a>           <span class="dt">Q1em =</span> <span class="kw">fct_explicit_na</span>(Q1e, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-577"><a href="#cb9-577"></a>           <span class="dt">Q2am =</span> <span class="kw">fct_explicit_na</span>(Q2a, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-578"><a href="#cb9-578"></a>           <span class="dt">Q2bm =</span> <span class="kw">fct_explicit_na</span>(Q2b, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-579"><a href="#cb9-579"></a>           <span class="dt">Q3am =</span> <span class="kw">fct_explicit_na</span>(Q3a, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-580"><a href="#cb9-580"></a>           <span class="dt">Q3bm =</span> <span class="kw">fct_explicit_na</span>(Q3b, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-581"><a href="#cb9-581"></a>           <span class="dt">edum =</span> <span class="kw">fct_explicit_na</span>(edu, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-582"><a href="#cb9-582"></a>           <span class="dt">mstam =</span> <span class="kw">fct_explicit_na</span>(msta, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-583"><a href="#cb9-583"></a>           <span class="dt">sostam =</span> <span class="kw">fct_explicit_na</span>(sosta, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-584"><a href="#cb9-584"></a>           <span class="dt">nchildm =</span> <span class="kw">fct_explicit_na</span>(nchild, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-585"><a href="#cb9-585"></a>           <span class="dt">lifstam =</span> <span class="kw">fct_explicit_na</span>(lifsta, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-586"><a href="#cb9-586"></a>           <span class="dt">urbrum =</span> <span class="kw">fct_explicit_na</span>(urbru, <span class="dt">na_level =</span> <span class="st">&quot;missing&quot;</span>),</span>
<span id="cb9-587"><a href="#cb9-587"></a>           )</span>
<span id="cb9-588"><a href="#cb9-588"></a><span class="co"># Tarkistuksia 3</span></span>
<span id="cb9-589"><a href="#cb9-589"></a></span>
<span id="cb9-590"><a href="#cb9-590"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-591"><a href="#cb9-591"></a><span class="co">#    select(Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm) %&gt;%</span></span>
<span id="cb9-592"><a href="#cb9-592"></a><span class="co">#    summary()</span></span>
<span id="cb9-593"><a href="#cb9-593"></a><span class="co">#</span></span>
<span id="cb9-594"><a href="#cb9-594"></a><span class="co">#ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-595"><a href="#cb9-595"></a><span class="co">#    select(edum,mstam, sostam,nchildm,lifstam, urbrum) %&gt;%</span></span>
<span id="cb9-596"><a href="#cb9-596"></a><span class="co">#    summary()</span></span>
<span id="cb9-597"><a href="#cb9-597"></a><span class="co">#</span></span>
<span id="cb9-598"><a href="#cb9-598"></a><span class="co">#ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-599"><a href="#cb9-599"></a><span class="co">#    select(Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm) %&gt;%</span></span>
<span id="cb9-600"><a href="#cb9-600"></a><span class="co">#    str()</span></span>
<span id="cb9-601"><a href="#cb9-601"></a><span class="co">#</span></span>
<span id="cb9-602"><a href="#cb9-602"></a><span class="co">#ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-603"><a href="#cb9-603"></a><span class="co">#    select(edum,mstam, sostam,nchildm,lifstam, urbrum) %&gt;%</span></span>
<span id="cb9-604"><a href="#cb9-604"></a><span class="co">#    str()</span></span>
<span id="cb9-605"><a href="#cb9-605"></a></span>
<span id="cb9-606"><a href="#cb9-606"></a><span class="co"># Taustamuuttuja, puuttuva tieto mukana - ristiintaulkointeja</span></span>
<span id="cb9-607"><a href="#cb9-607"></a></span>
<span id="cb9-608"><a href="#cb9-608"></a><span class="co"># ISSP2012jh1d.dat$edum %&gt;% fct_count()</span></span>
<span id="cb9-609"><a href="#cb9-609"></a><span class="co"># ISSP2012jh1d.dat$mstam %&gt;% fct_count()</span></span>
<span id="cb9-610"><a href="#cb9-610"></a><span class="co"># ISSP2012jh1d.dat$sostam %&gt;% fct_count()</span></span>
<span id="cb9-611"><a href="#cb9-611"></a><span class="co"># ISSP2012jh1d.dat$nchildm %&gt;% fct_count()</span></span>
<span id="cb9-612"><a href="#cb9-612"></a><span class="co"># ISSP2012jh1d.dat$lifstam %&gt;% fct_count()</span></span>
<span id="cb9-613"><a href="#cb9-613"></a><span class="co"># ISSP2012jh1d.dat$urbrum %&gt;% fct_count()</span></span>
<span id="cb9-614"><a href="#cb9-614"></a></span>
<span id="cb9-615"><a href="#cb9-615"></a><span class="co"># Substanssimuuttujat, puuttuva tieto mukana  - ristiintaulkointeja</span></span>
<span id="cb9-616"><a href="#cb9-616"></a></span>
<span id="cb9-617"><a href="#cb9-617"></a><span class="co"># ISSP2012jh1d.dat$Q1am %&gt;% fct_count()</span></span>
<span id="cb9-618"><a href="#cb9-618"></a><span class="co"># ISSP2012jh1d.dat$Q1bm %&gt;% fct_count()</span></span>
<span id="cb9-619"><a href="#cb9-619"></a><span class="co"># ISSP2012jh1d.dat$Q1cm %&gt;% fct_count()</span></span>
<span id="cb9-620"><a href="#cb9-620"></a><span class="co"># ISSP2012jh1d.dat$Q1dm %&gt;% fct_count()</span></span>
<span id="cb9-621"><a href="#cb9-621"></a><span class="co"># ISSP2012jh1d.dat$Q1em %&gt;% fct_count()</span></span>
<span id="cb9-622"><a href="#cb9-622"></a><span class="co"># ISSP2012jh1d.dat$Q2am %&gt;% fct_count()</span></span>
<span id="cb9-623"><a href="#cb9-623"></a><span class="co"># ISSP2012jh1d.dat$Q2bm %&gt;% fct_count()</span></span>
<span id="cb9-624"><a href="#cb9-624"></a><span class="co"># ISSP2012jh1d.dat$Q3am %&gt;% fct_count()</span></span>
<span id="cb9-625"><a href="#cb9-625"></a><span class="co"># ISSP2012jh1d.dat$Q3bm %&gt;% fct_count()</span></span>
<span id="cb9-626"><a href="#cb9-626"></a></span>
<span id="cb9-627"><a href="#cb9-627"></a><span class="co"># Vaihe 2.4.1</span></span>
<span id="cb9-628"><a href="#cb9-628"></a></span>
<span id="cb9-629"><a href="#cb9-629"></a><span class="co"># Q1a - Q1e,Q2a, Q2b  Viisi vastausvaihtoehtoa - ei eksplisiittistä NA-tietoa(&quot;missing&quot;)</span></span>
<span id="cb9-630"><a href="#cb9-630"></a><span class="co"># Q3a - Q3b  kolme vastausvaihtoehtoa</span></span>
<span id="cb9-631"><a href="#cb9-631"></a></span>
<span id="cb9-632"><a href="#cb9-632"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-633"><a href="#cb9-633"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Q1a =</span> <span class="kw">fct_recode</span>(Q1a,</span>
<span id="cb9-634"><a href="#cb9-634"></a>                        <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-635"><a href="#cb9-635"></a>                        <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-636"><a href="#cb9-636"></a>                        <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-637"><a href="#cb9-637"></a>                        <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-638"><a href="#cb9-638"></a>                        <span class="st">&quot;E&quot;</span>=<span class="st"> &quot;Strongly disagree&quot;</span>),</span>
<span id="cb9-639"><a href="#cb9-639"></a>            <span class="dt">Q1b =</span> <span class="kw">fct_recode</span>(Q1b,</span>
<span id="cb9-640"><a href="#cb9-640"></a>                      <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-641"><a href="#cb9-641"></a>                      <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-642"><a href="#cb9-642"></a>                      <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-643"><a href="#cb9-643"></a>                      <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-644"><a href="#cb9-644"></a>                      <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>),</span>
<span id="cb9-645"><a href="#cb9-645"></a>           <span class="dt">Q1c =</span> <span class="kw">fct_recode</span>(Q1c,</span>
<span id="cb9-646"><a href="#cb9-646"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-647"><a href="#cb9-647"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-648"><a href="#cb9-648"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-649"><a href="#cb9-649"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-650"><a href="#cb9-650"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>),</span>
<span id="cb9-651"><a href="#cb9-651"></a>           <span class="dt">Q1d =</span> <span class="kw">fct_recode</span>(Q1d,</span>
<span id="cb9-652"><a href="#cb9-652"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-653"><a href="#cb9-653"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-654"><a href="#cb9-654"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-655"><a href="#cb9-655"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-656"><a href="#cb9-656"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>),</span>
<span id="cb9-657"><a href="#cb9-657"></a>           <span class="dt">Q1e =</span> <span class="kw">fct_recode</span>(Q1e,</span>
<span id="cb9-658"><a href="#cb9-658"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-659"><a href="#cb9-659"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-660"><a href="#cb9-660"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-661"><a href="#cb9-661"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-662"><a href="#cb9-662"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>),</span>
<span id="cb9-663"><a href="#cb9-663"></a>          <span class="dt">Q2a =</span> <span class="kw">fct_recode</span>(Q2a,</span>
<span id="cb9-664"><a href="#cb9-664"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-665"><a href="#cb9-665"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-666"><a href="#cb9-666"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-667"><a href="#cb9-667"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-668"><a href="#cb9-668"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span> ),</span>
<span id="cb9-669"><a href="#cb9-669"></a>          <span class="dt">Q2b =</span> <span class="kw">fct_recode</span>(Q2b,</span>
<span id="cb9-670"><a href="#cb9-670"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-671"><a href="#cb9-671"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-672"><a href="#cb9-672"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-673"><a href="#cb9-673"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-674"><a href="#cb9-674"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>),</span>
<span id="cb9-675"><a href="#cb9-675"></a>          <span class="dt">Q3a =</span> <span class="kw">fct_recode</span>(Q3a,</span>
<span id="cb9-676"><a href="#cb9-676"></a>                          <span class="st">&quot;W&quot;</span> =<span class="st"> &quot;Work full-time&quot;</span>,</span>
<span id="cb9-677"><a href="#cb9-677"></a>                          <span class="st">&quot;w&quot;</span> =<span class="st"> &quot;Work part-time&quot;</span>,</span>
<span id="cb9-678"><a href="#cb9-678"></a>                          <span class="st">&quot;H&quot;</span> =<span class="st"> &quot;Stay at home&quot;</span> ),</span>
<span id="cb9-679"><a href="#cb9-679"></a>          <span class="dt">Q3b =</span> <span class="kw">fct_recode</span>(Q3b,</span>
<span id="cb9-680"><a href="#cb9-680"></a>                           <span class="st">&quot;W&quot;</span> =<span class="st"> &quot;Work full-time&quot;</span>,</span>
<span id="cb9-681"><a href="#cb9-681"></a>                           <span class="st">&quot;w&quot;</span> =<span class="st"> &quot;Work part-time&quot;</span>,</span>
<span id="cb9-682"><a href="#cb9-682"></a>                           <span class="st">&quot;H&quot;</span> =<span class="st"> &quot;Stay at home&quot;</span> )</span>
<span id="cb9-683"><a href="#cb9-683"></a>                        )</span>
<span id="cb9-684"><a href="#cb9-684"></a></span>
<span id="cb9-685"><a href="#cb9-685"></a></span>
<span id="cb9-686"><a href="#cb9-686"></a><span class="co"># Tarkistuksia 1</span></span>
<span id="cb9-687"><a href="#cb9-687"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-688"><a href="#cb9-688"></a><span class="co">#    select(Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, Q3a, Q3b) %&gt;%</span></span>
<span id="cb9-689"><a href="#cb9-689"></a><span class="co">#    summary()</span></span>
<span id="cb9-690"><a href="#cb9-690"></a></span>
<span id="cb9-691"><a href="#cb9-691"></a></span>
<span id="cb9-692"><a href="#cb9-692"></a><span class="co"># Vaihe 2.4.2 - muuttujassa eksplisiittinen NA-tieto</span></span>
<span id="cb9-693"><a href="#cb9-693"></a>ISSP2012jh1d.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span></span>
<span id="cb9-694"><a href="#cb9-694"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Q1am =</span> <span class="kw">fct_recode</span>(Q1am,</span>
<span id="cb9-695"><a href="#cb9-695"></a>                            <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-696"><a href="#cb9-696"></a>                            <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-697"><a href="#cb9-697"></a>                            <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-698"><a href="#cb9-698"></a>                            <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-699"><a href="#cb9-699"></a>                            <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>,</span>
<span id="cb9-700"><a href="#cb9-700"></a>                            <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-701"><a href="#cb9-701"></a>           <span class="dt">Q1bm =</span> <span class="kw">fct_recode</span>(Q1bm,</span>
<span id="cb9-702"><a href="#cb9-702"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-703"><a href="#cb9-703"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-704"><a href="#cb9-704"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-705"><a href="#cb9-705"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-706"><a href="#cb9-706"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>,</span>
<span id="cb9-707"><a href="#cb9-707"></a>                           <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-708"><a href="#cb9-708"></a>           <span class="dt">Q1cm =</span> <span class="kw">fct_recode</span>(Q1cm,</span>
<span id="cb9-709"><a href="#cb9-709"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-710"><a href="#cb9-710"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-711"><a href="#cb9-711"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-712"><a href="#cb9-712"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-713"><a href="#cb9-713"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>,</span>
<span id="cb9-714"><a href="#cb9-714"></a>                           <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-715"><a href="#cb9-715"></a>           <span class="dt">Q1dm =</span> <span class="kw">fct_recode</span>(Q1dm,</span>
<span id="cb9-716"><a href="#cb9-716"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-717"><a href="#cb9-717"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-718"><a href="#cb9-718"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-719"><a href="#cb9-719"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-720"><a href="#cb9-720"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>,</span>
<span id="cb9-721"><a href="#cb9-721"></a>                           <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-722"><a href="#cb9-722"></a>           <span class="dt">Q1em =</span> <span class="kw">fct_recode</span>(Q1em,</span>
<span id="cb9-723"><a href="#cb9-723"></a>                           <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-724"><a href="#cb9-724"></a>                           <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-725"><a href="#cb9-725"></a>                           <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-726"><a href="#cb9-726"></a>                           <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-727"><a href="#cb9-727"></a>                           <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>,</span>
<span id="cb9-728"><a href="#cb9-728"></a>                           <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-729"><a href="#cb9-729"></a>           <span class="dt">Q2am =</span> <span class="kw">fct_recode</span>(Q2am,</span>
<span id="cb9-730"><a href="#cb9-730"></a>                            <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-731"><a href="#cb9-731"></a>                            <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-732"><a href="#cb9-732"></a>                            <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-733"><a href="#cb9-733"></a>                            <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-734"><a href="#cb9-734"></a>                            <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>,</span>
<span id="cb9-735"><a href="#cb9-735"></a>                            <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-736"><a href="#cb9-736"></a>           <span class="dt">Q2bm =</span> <span class="kw">fct_recode</span>(Q2bm,</span>
<span id="cb9-737"><a href="#cb9-737"></a>                            <span class="st">&quot;S&quot;</span> =<span class="st"> &quot;Strongly agree&quot;</span>,</span>
<span id="cb9-738"><a href="#cb9-738"></a>                            <span class="st">&quot;s&quot;</span> =<span class="st"> &quot;Agree&quot;</span>,</span>
<span id="cb9-739"><a href="#cb9-739"></a>                            <span class="st">&quot;?&quot;</span> =<span class="st"> &quot;Neither agree nor disagree&quot;</span>,</span>
<span id="cb9-740"><a href="#cb9-740"></a>                            <span class="st">&quot;e&quot;</span> =<span class="st"> &quot;Disagree&quot;</span>,</span>
<span id="cb9-741"><a href="#cb9-741"></a>                            <span class="st">&quot;E&quot;</span> =<span class="st"> &quot;Strongly disagree&quot;</span>,</span>
<span id="cb9-742"><a href="#cb9-742"></a>                            <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-743"><a href="#cb9-743"></a>           <span class="dt">Q3am =</span> <span class="kw">fct_recode</span>(Q3am,</span>
<span id="cb9-744"><a href="#cb9-744"></a>                            <span class="st">&quot;W&quot;</span> =<span class="st"> &quot;Work full-time&quot;</span>,</span>
<span id="cb9-745"><a href="#cb9-745"></a>                            <span class="st">&quot;w&quot;</span> =<span class="st"> &quot;Work part-time&quot;</span>,</span>
<span id="cb9-746"><a href="#cb9-746"></a>                            <span class="st">&quot;H&quot;</span> =<span class="st"> &quot;Stay at home&quot;</span>,</span>
<span id="cb9-747"><a href="#cb9-747"></a>                            <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-748"><a href="#cb9-748"></a>           <span class="dt">Q3bm =</span> <span class="kw">fct_recode</span>(Q3bm,</span>
<span id="cb9-749"><a href="#cb9-749"></a>                            <span class="st">&quot;W&quot;</span> =<span class="st"> &quot;Work full-time&quot;</span>,</span>
<span id="cb9-750"><a href="#cb9-750"></a>                            <span class="st">&quot;w&quot;</span> =<span class="st"> &quot;Work part-time&quot;</span>,</span>
<span id="cb9-751"><a href="#cb9-751"></a>                            <span class="st">&quot;H&quot;</span> =<span class="st"> &quot;Stay at home&quot;</span>,</span>
<span id="cb9-752"><a href="#cb9-752"></a>                            <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>)</span>
<span id="cb9-753"><a href="#cb9-753"></a>               )</span>
<span id="cb9-754"><a href="#cb9-754"></a></span>
<span id="cb9-755"><a href="#cb9-755"></a><span class="co"># Tarkistuksia 4</span></span>
<span id="cb9-756"><a href="#cb9-756"></a></span>
<span id="cb9-757"><a href="#cb9-757"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-758"><a href="#cb9-758"></a><span class="co">#    select(Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm) %&gt;%</span></span>
<span id="cb9-759"><a href="#cb9-759"></a><span class="co">#    summary()</span></span>
<span id="cb9-760"><a href="#cb9-760"></a></span>
<span id="cb9-761"><a href="#cb9-761"></a><span class="co"># Tarkistuksia 5</span></span>
<span id="cb9-762"><a href="#cb9-762"></a></span>
<span id="cb9-763"><a href="#cb9-763"></a><span class="co"># Substanssimuuttuja</span></span>
<span id="cb9-764"><a href="#cb9-764"></a></span>
<span id="cb9-765"><a href="#cb9-765"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-766"><a href="#cb9-766"></a><span class="co">#    tableX(Q1a,Q1am)</span></span>
<span id="cb9-767"><a href="#cb9-767"></a><span class="co">#</span></span>
<span id="cb9-768"><a href="#cb9-768"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-769"><a href="#cb9-769"></a><span class="co">#    tableX(Q1b,Q1bm)</span></span>
<span id="cb9-770"><a href="#cb9-770"></a><span class="co">#</span></span>
<span id="cb9-771"><a href="#cb9-771"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-772"><a href="#cb9-772"></a><span class="co">#    tableX(Q1c,Q1cm)</span></span>
<span id="cb9-773"><a href="#cb9-773"></a><span class="co">#</span></span>
<span id="cb9-774"><a href="#cb9-774"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-775"><a href="#cb9-775"></a><span class="co">#    tableX(Q1d,Q1dm)</span></span>
<span id="cb9-776"><a href="#cb9-776"></a><span class="co">#</span></span>
<span id="cb9-777"><a href="#cb9-777"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-778"><a href="#cb9-778"></a><span class="co">#    tableX(Q1e,Q1em)</span></span>
<span id="cb9-779"><a href="#cb9-779"></a><span class="co">#</span></span>
<span id="cb9-780"><a href="#cb9-780"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-781"><a href="#cb9-781"></a><span class="co">#    tableX(Q2a,Q2am)</span></span>
<span id="cb9-782"><a href="#cb9-782"></a><span class="co">#</span></span>
<span id="cb9-783"><a href="#cb9-783"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-784"><a href="#cb9-784"></a><span class="co">#    tableX(Q2b,Q2bm)</span></span>
<span id="cb9-785"><a href="#cb9-785"></a><span class="co">#</span></span>
<span id="cb9-786"><a href="#cb9-786"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-787"><a href="#cb9-787"></a><span class="co">#    tableX(Q3a,Q3am)</span></span>
<span id="cb9-788"><a href="#cb9-788"></a><span class="co">#</span></span>
<span id="cb9-789"><a href="#cb9-789"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-790"><a href="#cb9-790"></a><span class="co">#    tableX(Q3b,Q3bm)</span></span>
<span id="cb9-791"><a href="#cb9-791"></a><span class="co">#</span></span>
<span id="cb9-792"><a href="#cb9-792"></a><span class="co"># ISSP2012jh1d.dat %&gt;% </span></span>
<span id="cb9-793"><a href="#cb9-793"></a><span class="co">#    tableX(Q3am,Q3a)</span></span>
<span id="cb9-794"><a href="#cb9-794"></a><span class="co">#</span></span>
<span id="cb9-795"><a href="#cb9-795"></a><span class="co"># ISSP2012jh1d.dat$Q3a %&gt;% levels()</span></span>
<span id="cb9-796"><a href="#cb9-796"></a><span class="co"># ISSP2012jh1d.dat$Q3am %&gt;% levels()</span></span>
<span id="cb9-797"><a href="#cb9-797"></a></span>
<span id="cb9-798"><a href="#cb9-798"></a><span class="co"># Taustamuuttujat - ristiintaulukointeja</span></span>
<span id="cb9-799"><a href="#cb9-799"></a></span>
<span id="cb9-800"><a href="#cb9-800"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-801"><a href="#cb9-801"></a><span class="co">#    tableX(edu, edum)</span></span>
<span id="cb9-802"><a href="#cb9-802"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-803"><a href="#cb9-803"></a><span class="co">#    tableX(msta, mstam)</span></span>
<span id="cb9-804"><a href="#cb9-804"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-805"><a href="#cb9-805"></a><span class="co">#    tableX(sosta, sostam)</span></span>
<span id="cb9-806"><a href="#cb9-806"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-807"><a href="#cb9-807"></a><span class="co">#    tableX(nchild,nchildm)</span></span>
<span id="cb9-808"><a href="#cb9-808"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-809"><a href="#cb9-809"></a><span class="co">#    tableX(lifsta, lifstam)</span></span>
<span id="cb9-810"><a href="#cb9-810"></a><span class="co"># ISSP2012jh1d.dat %&gt;%</span></span>
<span id="cb9-811"><a href="#cb9-811"></a><span class="co">#    tableX(urbru, urbrum)</span></span>
<span id="cb9-812"><a href="#cb9-812"></a></span>
<span id="cb9-813"><a href="#cb9-813"></a><span class="co"># (16.9.2020) Testaus uusille muuttujille</span></span>
<span id="cb9-814"><a href="#cb9-814"></a><span class="co"># Koodilohkoissa on jo testattu taulukoimalla muuttujia. Tässä varmistetaan, että</span></span>
<span id="cb9-815"><a href="#cb9-815"></a><span class="co"># muuttujat pysyvät sellaisina millaisiksi ne on luotu.</span></span>
<span id="cb9-816"><a href="#cb9-816"></a></span>
<span id="cb9-817"><a href="#cb9-817"></a><span class="co"># ika - onpas hankala testata !</span></span>
<span id="cb9-818"><a href="#cb9-818"></a><span class="co"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max.</span></span>
<span id="cb9-819"><a href="#cb9-819"></a><span class="co"># 15.00   36.00   50.00   49.52   63.00  102.00</span></span>
<span id="cb9-820"><a href="#cb9-820"></a><span class="co"># ikatest &lt;- ISSP2012jh1d.dat$ika %&gt;% summary()</span></span>
<span id="cb9-821"><a href="#cb9-821"></a><span class="co">#   ikatest &lt;- ikatest[2,]</span></span>
<span id="cb9-822"><a href="#cb9-822"></a><span class="co">#validate_that(are_equal(ikatest, c(15, 36, 50, 49.5, 63, 102)))</span></span>
<span id="cb9-823"><a href="#cb9-823"></a><span class="co">#str(ISSP2012jh1d.dat)</span></span>
<span id="cb9-824"><a href="#cb9-824"></a><span class="co">#ISSP2012jh1d.dat %&gt;% </span></span>
<span id="cb9-825"><a href="#cb9-825"></a></span>
<span id="cb9-826"><a href="#cb9-826"></a><span class="co"># substanssimuuttujat 1</span></span>
<span id="cb9-827"><a href="#cb9-827"></a><span class="co"># Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, Q3a, Q3b (r. 423-&gt;)</span></span>
<span id="cb9-828"><a href="#cb9-828"></a></span>
<span id="cb9-829"><a href="#cb9-829"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1a)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-830"><a href="#cb9-830"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1a),</span>
<span id="cb9-831"><a href="#cb9-831"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-832"><a href="#cb9-832"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1b)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-833"><a href="#cb9-833"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1b),</span>
<span id="cb9-834"><a href="#cb9-834"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-835"><a href="#cb9-835"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1c)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-836"><a href="#cb9-836"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1c),</span>
<span id="cb9-837"><a href="#cb9-837"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-838"><a href="#cb9-838"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1d)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-839"><a href="#cb9-839"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1d),</span>
<span id="cb9-840"><a href="#cb9-840"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-841"><a href="#cb9-841"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1e)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-842"><a href="#cb9-842"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1e),</span>
<span id="cb9-843"><a href="#cb9-843"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-844"><a href="#cb9-844"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2a)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-845"><a href="#cb9-845"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2a),</span>
<span id="cb9-846"><a href="#cb9-846"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-847"><a href="#cb9-847"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2b)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-848"><a href="#cb9-848"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2b),</span>
<span id="cb9-849"><a href="#cb9-849"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-850"><a href="#cb9-850"></a></span>
<span id="cb9-851"><a href="#cb9-851"></a><span class="co"># substanssimuuttujat 2</span></span>
<span id="cb9-852"><a href="#cb9-852"></a></span>
<span id="cb9-853"><a href="#cb9-853"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3a)) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb9-854"><a href="#cb9-854"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3a),</span>
<span id="cb9-855"><a href="#cb9-855"></a>               <span class="kw">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;H&quot;</span>)))</span>
<span id="cb9-856"><a href="#cb9-856"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3b)) <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb9-857"><a href="#cb9-857"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3b),</span>
<span id="cb9-858"><a href="#cb9-858"></a>               <span class="kw">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;H&quot;</span>)))</span>
<span id="cb9-859"><a href="#cb9-859"></a></span>
<span id="cb9-860"><a href="#cb9-860"></a></span>
<span id="cb9-861"><a href="#cb9-861"></a></span>
<span id="cb9-862"><a href="#cb9-862"></a><span class="co"># substanssimuuttujat, puuttuva tieto muuttujan arvona</span></span>
<span id="cb9-863"><a href="#cb9-863"></a><span class="co"># Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm</span></span>
<span id="cb9-864"><a href="#cb9-864"></a></span>
<span id="cb9-865"><a href="#cb9-865"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1am)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-866"><a href="#cb9-866"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1am),</span>
<span id="cb9-867"><a href="#cb9-867"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-868"><a href="#cb9-868"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1bm)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-869"><a href="#cb9-869"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1bm),</span>
<span id="cb9-870"><a href="#cb9-870"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-871"><a href="#cb9-871"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1cm)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-872"><a href="#cb9-872"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1cm),</span>
<span id="cb9-873"><a href="#cb9-873"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-874"><a href="#cb9-874"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1dm)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-875"><a href="#cb9-875"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1dm),</span>
<span id="cb9-876"><a href="#cb9-876"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-877"><a href="#cb9-877"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1em)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-878"><a href="#cb9-878"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q1em),</span>
<span id="cb9-879"><a href="#cb9-879"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-880"><a href="#cb9-880"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2am)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-881"><a href="#cb9-881"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2am),</span>
<span id="cb9-882"><a href="#cb9-882"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-883"><a href="#cb9-883"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2bm)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-884"><a href="#cb9-884"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q2bm),</span>
<span id="cb9-885"><a href="#cb9-885"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-886"><a href="#cb9-886"></a></span>
<span id="cb9-887"><a href="#cb9-887"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3am)) <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb9-888"><a href="#cb9-888"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3am),</span>
<span id="cb9-889"><a href="#cb9-889"></a>               <span class="kw">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-890"><a href="#cb9-890"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3bm)) <span class="op">==</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb9-891"><a href="#cb9-891"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>Q3bm),</span>
<span id="cb9-892"><a href="#cb9-892"></a>               <span class="kw">c</span>(<span class="st">&quot;W&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;P&quot;</span>)))</span>
<span id="cb9-893"><a href="#cb9-893"></a></span>
<span id="cb9-894"><a href="#cb9-894"></a><span class="co"># taustamuuttujat puuttuvilla tiedoilla ja ilman</span></span>
<span id="cb9-895"><a href="#cb9-895"></a><span class="co"># testataan vain tasojen määrä, ei labeleita jotka ovat </span></span>
<span id="cb9-896"><a href="#cb9-896"></a><span class="co"># alkuperäisestä datasta.</span></span>
<span id="cb9-897"><a href="#cb9-897"></a></span>
<span id="cb9-898"><a href="#cb9-898"></a><span class="co"># edu, edum Huom! Koulutustasoluokitus alkuperäisessä</span></span>
<span id="cb9-899"><a href="#cb9-899"></a><span class="co"># datassa 0-6 (ei muodollista koulusta - korkeampi kolmas aste (maisteri, tohtori)</span></span>
<span id="cb9-900"><a href="#cb9-900"></a><span class="co"># R-faktorissa 1-7</span></span>
<span id="cb9-901"><a href="#cb9-901"></a></span>
<span id="cb9-902"><a href="#cb9-902"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>edu)) <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb9-903"><a href="#cb9-903"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>edum)) <span class="op">==</span><span class="st"> </span><span class="dv">8</span>)</span>
<span id="cb9-904"><a href="#cb9-904"></a></span>
<span id="cb9-905"><a href="#cb9-905"></a><span class="co"># msta, mstam</span></span>
<span id="cb9-906"><a href="#cb9-906"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>msta)) <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb9-907"><a href="#cb9-907"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>mstam)) <span class="op">==</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb9-908"><a href="#cb9-908"></a></span>
<span id="cb9-909"><a href="#cb9-909"></a><span class="co"># sosta, sostam</span></span>
<span id="cb9-910"><a href="#cb9-910"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>sosta)) <span class="op">==</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb9-911"><a href="#cb9-911"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>sostam)) <span class="op">==</span><span class="st"> </span><span class="dv">11</span>)</span>
<span id="cb9-912"><a href="#cb9-912"></a></span>
<span id="cb9-913"><a href="#cb9-913"></a><span class="co"># nchild, ncildm</span></span>
<span id="cb9-914"><a href="#cb9-914"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>nchild)) <span class="op">==</span><span class="st"> </span><span class="dv">11</span>)</span>
<span id="cb9-915"><a href="#cb9-915"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>nchildm)) <span class="op">==</span><span class="st"> </span><span class="dv">12</span>)</span>
<span id="cb9-916"><a href="#cb9-916"></a></span>
<span id="cb9-917"><a href="#cb9-917"></a><span class="co"># lifsta, lifstam</span></span>
<span id="cb9-918"><a href="#cb9-918"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>lifsta)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-919"><a href="#cb9-919"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>lifstam)) <span class="op">==</span><span class="st"> </span><span class="dv">7</span>)</span>
<span id="cb9-920"><a href="#cb9-920"></a></span>
<span id="cb9-921"><a href="#cb9-921"></a><span class="co"># urbru, urbrum</span></span>
<span id="cb9-922"><a href="#cb9-922"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>urbru)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-923"><a href="#cb9-923"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012jh1d.dat<span class="op">$</span>urbrum)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-924"><a href="#cb9-924"></a></span>
<span id="cb9-925"><a href="#cb9-925"></a>issp_docname &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Variable Report&quot;</span>, <span class="st">&quot;Study Monitoring Report&quot;</span>,<span class="st">&quot;Basic Questionnaire&quot;</span>,</span>
<span id="cb9-926"><a href="#cb9-926"></a>                  <span class="st">&quot;Contents of ISSP 2012 module&quot;</span>, <span class="st">&quot;Questionnaire Development&quot;</span>)</span>
<span id="cb9-927"><a href="#cb9-927"></a>issp_docdesc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Perusdokumentti, muuttujien kuvaukset ja taulukot&quot;</span>,</span>
<span id="cb9-928"><a href="#cb9-928"></a>                  <span class="st">&quot;tiedokeruun toteutus eri maissa&quot;</span>,</span>
<span id="cb9-929"><a href="#cb9-929"></a>                  <span class="st">&quot;Maittain sovellettava kyselylomake&quot;</span>, <span class="st">&quot;substanssikysymykset taulukkona&quot;</span>,</span>
<span id="cb9-930"><a href="#cb9-930"></a>                  <span class="st">&quot;kyselylomakkeen laatiminen&quot;</span>)</span>
<span id="cb9-931"><a href="#cb9-931"></a>issp_docfile &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ZA5900_cdb.pdf&quot;</span>, <span class="st">&quot;ZA5900_mr.pdf&quot;</span>, <span class="st">&quot;ZA5900_bq.pdf&quot;</span>,<span class="st">&quot;ZA5900_overview.pdf&quot;</span>,</span>
<span id="cb9-932"><a href="#cb9-932"></a>                  <span class="st">&quot;ssoar-2014-scholz_et_al-ISSP_2012_Family_and_Changing.pdf&quot;</span>)</span>
<span id="cb9-933"><a href="#cb9-933"></a></span>
<span id="cb9-934"><a href="#cb9-934"></a></span>
<span id="cb9-935"><a href="#cb9-935"></a>col_isspdocs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;dokumentti&quot;</span>,<span class="st">&quot;sisältö&quot;</span>,<span class="st">&quot;tiedosto&quot;</span>)</span>
<span id="cb9-936"><a href="#cb9-936"></a></span>
<span id="cb9-937"><a href="#cb9-937"></a>ISSPdocsT.tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(issp_docname, issp_docdesc, issp_docfile)</span>
<span id="cb9-938"><a href="#cb9-938"></a><span class="kw">colnames</span>(ISSPdocsT.tbl) &lt;-<span class="st"> </span>col_isspdocs</span>
<span id="cb9-939"><a href="#cb9-939"></a></span>
<span id="cb9-940"><a href="#cb9-940"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ISSPdocsT.tbl, <span class="dt">booktab =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-941"><a href="#cb9-941"></a>             <span class="dt">caption =</span> <span class="st">&#39; ISSP 2012: tärkeimmät dokumentit&#39;</span>)</span>
<span id="cb9-942"><a href="#cb9-942"></a></span>
<span id="cb9-943"><a href="#cb9-943"></a></span>
<span id="cb9-944"><a href="#cb9-944"></a><span class="co"># Muuttuja taulukkona - karkea tapa</span></span>
<span id="cb9-945"><a href="#cb9-945"></a><span class="co"># HUOM! Taulkot ovat hankalia, kun tulostus halutaan pdf- ja html- formaattiin</span></span>
<span id="cb9-946"><a href="#cb9-946"></a><span class="co"># Kysymyste pitkät versiot on siksi esitetty suomenkielisen lomakkeen kuvana.</span></span>
<span id="cb9-947"><a href="#cb9-947"></a></span>
<span id="cb9-948"><a href="#cb9-948"></a>tabVarnames &lt;-<span class="st"> </span><span class="kw">c</span>(substvars1,bgvars1) <span class="co"># muuttujanimet muuttujille</span></span>
<span id="cb9-949"><a href="#cb9-949"></a></span>
<span id="cb9-950"><a href="#cb9-950"></a><span class="co"># Kysymysten lyhyet versiot englanniksi</span></span>
<span id="cb9-951"><a href="#cb9-951"></a>tabVarDesc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Q1a Working mother can have warm relation with child &quot;</span>,</span>
<span id="cb9-952"><a href="#cb9-952"></a>                <span class="st">&quot;Q1b Pre-school child suffers through working mother&quot;</span>,</span>
<span id="cb9-953"><a href="#cb9-953"></a>                <span class="st">&quot;Q1c Family life suffers through working mother&quot;</span>,</span>
<span id="cb9-954"><a href="#cb9-954"></a>                <span class="st">&quot;Q1d Women’s preference: home and children&quot;</span>,</span>
<span id="cb9-955"><a href="#cb9-955"></a>                <span class="st">&quot;Q1e Being housewife is satisfying&quot;</span>,</span>
<span id="cb9-956"><a href="#cb9-956"></a>                <span class="st">&quot;Q2a Both should contribute to household income&quot;</span>,</span>
<span id="cb9-957"><a href="#cb9-957"></a>                <span class="st">&quot;Q2b Men’s job is earn money, women’s job household&quot;</span>,</span>
<span id="cb9-958"><a href="#cb9-958"></a>                <span class="st">&quot;Q3a Should women work: Child under school age&quot;</span>,</span>
<span id="cb9-959"><a href="#cb9-959"></a>                <span class="st">&quot;Q3b Should women work: Youngest kid at school&quot;</span>,</span>
<span id="cb9-960"><a href="#cb9-960"></a>                <span class="st">&quot;Respondents age &quot;</span>,</span>
<span id="cb9-961"><a href="#cb9-961"></a>                <span class="st">&quot;Respondents gender&quot;</span>,</span>
<span id="cb9-962"><a href="#cb9-962"></a>                <span class="st">&quot;Highest completed degree of education: Categories for international comparison&quot;</span>,</span>
<span id="cb9-963"><a href="#cb9-963"></a>                <span class="st">&quot;Main status: work, unemployed, in education...&quot;</span>,</span>
<span id="cb9-964"><a href="#cb9-964"></a>                <span class="st">&quot;Top-Bottom self-placement (10 pt scale)&quot;</span>,</span>
<span id="cb9-965"><a href="#cb9-965"></a>                <span class="st">&quot;How many children in household: children between [school age] and 17 years of age&quot;</span>,</span>
<span id="cb9-966"><a href="#cb9-966"></a>                <span class="st">&quot;Legal partnership status: married, civil partership...&quot;</span>,</span>
<span id="cb9-967"><a href="#cb9-967"></a>                <span class="st">&quot;Place of living: urban - rural&quot;</span></span>
<span id="cb9-968"><a href="#cb9-968"></a>              )</span>
<span id="cb9-969"><a href="#cb9-969"></a><span class="co">#tabVarDesc</span></span>
<span id="cb9-970"><a href="#cb9-970"></a></span>
<span id="cb9-971"><a href="#cb9-971"></a><span class="co"># Taulukko</span></span>
<span id="cb9-972"><a href="#cb9-972"></a></span>
<span id="cb9-973"><a href="#cb9-973"></a><span class="co"># luodaan df - varoitus: data_frame() is deprecated, use tibble” (4.2.20),</span></span>
<span id="cb9-974"><a href="#cb9-974"></a><span class="co"># vaihdetaan tibbleen (21.2.20)</span></span>
<span id="cb9-975"><a href="#cb9-975"></a></span>
<span id="cb9-976"><a href="#cb9-976"></a><span class="co"># jhVarTable1.df &lt;- data_frame(tabVarnames,tabVarDesc) OLD</span></span>
<span id="cb9-977"><a href="#cb9-977"></a>jhVarTable1.tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(tabVarnames,tabVarDesc)</span>
<span id="cb9-978"><a href="#cb9-978"></a>cols_jhVarTable1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;muuttuja&quot;</span>,<span class="st">&quot;kysymyksen tunnus, lyhennetty kysymys&quot;</span>)</span>
<span id="cb9-979"><a href="#cb9-979"></a><span class="kw">colnames</span>(jhVarTable1.tbl) &lt;-<span class="st"> </span>cols_jhVarTable1</span>
<span id="cb9-980"><a href="#cb9-980"></a><span class="co">#str(jhVarTable1.tbl)</span></span>
<span id="cb9-981"><a href="#cb9-981"></a><span class="co"># Lyhyet kysymykset englanniksi</span></span>
<span id="cb9-982"><a href="#cb9-982"></a></span>
<span id="cb9-983"><a href="#cb9-983"></a>knitr<span class="op">::</span><span class="kw">kable</span>(jhVarTable1.tbl, <span class="dt">booktab =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-984"><a href="#cb9-984"></a>               <span class="dt">caption =</span> <span class="st">&quot;ISSP2012:Työelämä ja perhearvot - kysymykset&quot;</span>)</span>
<span id="cb9-985"><a href="#cb9-985"></a></span>
<span id="cb9-986"><a href="#cb9-986"></a></span>
<span id="cb9-987"><a href="#cb9-987"></a></span>
<span id="cb9-988"><a href="#cb9-988"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/substvar_fi_Q1Q2.png&#39;</span>)</span>
<span id="cb9-989"><a href="#cb9-989"></a></span>
<span id="cb9-990"><a href="#cb9-990"></a><span class="co"># UUSI DATA 30.1.20</span></span>
<span id="cb9-991"><a href="#cb9-991"></a><span class="co">#</span></span>
<span id="cb9-992"><a href="#cb9-992"></a><span class="co"># LUETAAN DATA G1_1_data2.Rmd - tiedostossa, luodaan faktorimuuttujat</span></span>
<span id="cb9-993"><a href="#cb9-993"></a><span class="co"># G1_1_data_fct1.Rmd-tiedostossa -&gt; ISSP2012jh1d.dat (df)</span></span>
<span id="cb9-994"><a href="#cb9-994"></a><span class="co"># 23 muuttujaa (9 substanssimuuttujaa, 8 taustamuuttujaa, 3 maa-muuttujaa, 3 metadatamuuttujaa)</span></span>
<span id="cb9-995"><a href="#cb9-995"></a><span class="co"># 25 maata.</span></span>
<span id="cb9-996"><a href="#cb9-996"></a><span class="co"># Poistettu 146 havaintoa, joilla SEX tai AGE puuttuu</span></span>
<span id="cb9-997"><a href="#cb9-997"></a><span class="co"># Johdattelevassa esimerkissä kuusi maata, kaksi taustamuuttujaa ja yksi kysymys</span></span>
<span id="cb9-998"><a href="#cb9-998"></a><span class="co"># (V6/Q1b)</span></span>
<span id="cb9-999"><a href="#cb9-999"></a></span>
<span id="cb9-1000"><a href="#cb9-1000"></a></span>
<span id="cb9-1001"><a href="#cb9-1001"></a><span class="co"># Kuusi maata</span></span>
<span id="cb9-1002"><a href="#cb9-1002"></a></span>
<span id="cb9-1003"><a href="#cb9-1003"></a>countries_esim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">56</span>, <span class="dv">100</span>, <span class="dv">208</span>, <span class="dv">246</span>, <span class="dv">276</span>, <span class="dv">348</span>) <span class="co">#BE,BG,DK,FI,DE,HU</span></span>
<span id="cb9-1004"><a href="#cb9-1004"></a>ISSP2012esim3.dat &lt;-<span class="st"> </span><span class="kw">filter</span>(ISSP2012jh1d.dat, V4 <span class="op">%in%</span><span class="st"> </span>countries_esim1)</span>
<span id="cb9-1005"><a href="#cb9-1005"></a><span class="co"># str(ISSP2012esim3.dat) - pitkä listaus pois (24.2.20)</span></span>
<span id="cb9-1006"><a href="#cb9-1006"></a></span>
<span id="cb9-1007"><a href="#cb9-1007"></a><span class="co">#neljä maamuuttujaa, kysymys Q1b, ikä ja sukupuoli</span></span>
<span id="cb9-1008"><a href="#cb9-1008"></a></span>
<span id="cb9-1009"><a href="#cb9-1009"></a>vars_esim1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;C_ALPHAN&quot;</span>, <span class="st">&quot;V3&quot;</span>, <span class="st">&quot;maa&quot;</span>,<span class="st">&quot;maa3&quot;</span>, <span class="st">&quot;Q1b&quot;</span>, <span class="st">&quot;sp&quot;</span>, <span class="st">&quot;ika&quot;</span>)</span>
<span id="cb9-1010"><a href="#cb9-1010"></a>ISSP2012esim2.dat &lt;-<span class="st"> </span><span class="kw">select</span>(ISSP2012esim3.dat, <span class="kw">all_of</span>(vars_esim1))</span>
<span id="cb9-1011"><a href="#cb9-1011"></a></span>
<span id="cb9-1012"><a href="#cb9-1012"></a><span class="kw">str</span>(ISSP2012esim2.dat) <span class="co"># 8542 obs. of  7 variables, ja sama 8.6.2020</span></span>
<span id="cb9-1013"><a href="#cb9-1013"></a><span class="co"># C_ALPHAN: chr, maa: Factor w/ 25</span></span>
<span id="cb9-1014"><a href="#cb9-1014"></a></span>
<span id="cb9-1015"><a href="#cb9-1015"></a><span class="co"># Poistetaan havainnot, joilla Q1b - muuttujassa puuttuva tieto &#39;NA&#39;</span></span>
<span id="cb9-1016"><a href="#cb9-1016"></a><span class="co"># sum(is.na(ISSP2012esim2.dat$Q1b)) = 399</span></span>
<span id="cb9-1017"><a href="#cb9-1017"></a></span>
<span id="cb9-1018"><a href="#cb9-1018"></a>ISSP2012esim1.dat &lt;-<span class="st"> </span><span class="kw">filter</span>(ISSP2012esim2.dat, <span class="op">!</span><span class="kw">is.na</span>(Q1b))</span>
<span id="cb9-1019"><a href="#cb9-1019"></a></span>
<span id="cb9-1020"><a href="#cb9-1020"></a><span class="co">#str(ISSP2012esim1.dat) # 8143 obs. of  6 variable</span></span>
<span id="cb9-1021"><a href="#cb9-1021"></a></span>
<span id="cb9-1022"><a href="#cb9-1022"></a><span class="co"># Tarkistuksia (3.2.20)</span></span>
<span id="cb9-1023"><a href="#cb9-1023"></a><span class="co">#</span></span>
<span id="cb9-1024"><a href="#cb9-1024"></a><span class="co">#fct_count(ISSP2012esim1.dat$sp)</span></span>
<span id="cb9-1025"><a href="#cb9-1025"></a><span class="co">#fct_count(ISSP2012esim1.dat$Q1b)</span></span>
<span id="cb9-1026"><a href="#cb9-1026"></a><span class="co">#fct_count(ISSP2012esim1.dat$maa)</span></span>
<span id="cb9-1027"><a href="#cb9-1027"></a><span class="co">#fct_count(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1028"><a href="#cb9-1028"></a><span class="co">#</span></span>
<span id="cb9-1029"><a href="#cb9-1029"></a><span class="co">#summary(ISSP2012esim1.dat$sp)</span></span>
<span id="cb9-1030"><a href="#cb9-1030"></a><span class="co">#sp: 3799 + 4344 = 8143</span></span>
<span id="cb9-1031"><a href="#cb9-1031"></a><span class="co">#summary(ISSP2012esim1.dat$Q1b)</span></span>
<span id="cb9-1032"><a href="#cb9-1032"></a><span class="co">#  S      s      ?     e      E</span></span>
<span id="cb9-1033"><a href="#cb9-1033"></a><span class="co"># 810 + 1935 + 1367 + 2125 + 1906 = 8143</span></span>
<span id="cb9-1034"><a href="#cb9-1034"></a><span class="co">#</span></span>
<span id="cb9-1035"><a href="#cb9-1035"></a><span class="co"># EDELLINEN DATA - havaintojen määrät samat kuin uudella datalla (31.1.20)</span></span>
<span id="cb9-1036"><a href="#cb9-1036"></a><span class="co">#</span></span>
<span id="cb9-1037"><a href="#cb9-1037"></a><span class="co"># 8557 obs. ennen kuin sexagemissing poistettiin, nyt 8542, 8557-8542 = 15</span></span>
<span id="cb9-1038"><a href="#cb9-1038"></a><span class="co">#</span></span>
<span id="cb9-1039"><a href="#cb9-1039"></a><span class="co"># Poistetaan havainnot joissa puuttuva tieto muuttujassa V6 (Q1b) n = 399</span></span>
<span id="cb9-1040"><a href="#cb9-1040"></a><span class="co"># 8542-399 = 8143</span></span>
<span id="cb9-1041"><a href="#cb9-1041"></a></span>
<span id="cb9-1042"><a href="#cb9-1042"></a><span class="co"># Tyhjät &quot;faktorilabelit&quot; on poistettava</span></span>
<span id="cb9-1043"><a href="#cb9-1043"></a></span>
<span id="cb9-1044"><a href="#cb9-1044"></a> ISSP2012esim1.dat &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1045"><a href="#cb9-1045"></a><span class="st">     </span><span class="kw">mutate</span>(<span class="dt">maa =</span> <span class="kw">fct_drop</span>(maa),</span>
<span id="cb9-1046"><a href="#cb9-1046"></a>            <span class="dt">maa3 =</span> <span class="kw">fct_drop</span>(maa3)</span>
<span id="cb9-1047"><a href="#cb9-1047"></a>            )</span>
<span id="cb9-1048"><a href="#cb9-1048"></a></span>
<span id="cb9-1049"><a href="#cb9-1049"></a><span class="co">#summary(ISSP2012esim1.dat$maa)</span></span>
<span id="cb9-1050"><a href="#cb9-1050"></a><span class="co">#summary(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1051"><a href="#cb9-1051"></a><span class="co">#</span></span>
<span id="cb9-1052"><a href="#cb9-1052"></a><span class="co"># str(ISSP2012esim1.dat$maa)</span></span>
<span id="cb9-1053"><a href="#cb9-1053"></a><span class="co"># attributes(ISSP2012esim1.dat$maa)</span></span>
<span id="cb9-1054"><a href="#cb9-1054"></a><span class="co">#</span></span>
<span id="cb9-1055"><a href="#cb9-1055"></a><span class="co"># str(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1056"><a href="#cb9-1056"></a><span class="co"># attributes(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1057"><a href="#cb9-1057"></a><span class="co">#</span></span>
<span id="cb9-1058"><a href="#cb9-1058"></a><span class="co">#ISSP2012esim1.dat %&gt;% tableX(maa, Q1b, type = &quot;count&quot;)</span></span>
<span id="cb9-1059"><a href="#cb9-1059"></a><span class="co">#fct_count(ISSP2012esim1.dat$Q1b)</span></span>
<span id="cb9-1060"><a href="#cb9-1060"></a><span class="co"># fct_count(ISSP2012esim1.dat$sp)</span></span>
<span id="cb9-1061"><a href="#cb9-1061"></a><span class="co"># fct_unique(ISSP2012esim1.dat$maa)</span></span>
<span id="cb9-1062"><a href="#cb9-1062"></a><span class="co"># fct_count(ISSP2012esim1.dat$maa)</span></span>
<span id="cb9-1063"><a href="#cb9-1063"></a><span class="co">#ISSP2012esim1.dat %&gt;% tableX(maa, C_ALPHAN, type = &quot;count&quot;)</span></span>
<span id="cb9-1064"><a href="#cb9-1064"></a><span class="co">#</span></span>
<span id="cb9-1065"><a href="#cb9-1065"></a><span class="co"># maa3 - siistitään &quot;faktorilabelit&quot; kaksikirjaimisiksi</span></span>
<span id="cb9-1066"><a href="#cb9-1066"></a><span class="co">#</span></span>
<span id="cb9-1067"><a href="#cb9-1067"></a><span class="co"># ISO 3166 Code V3 - maiden jaot</span></span>
<span id="cb9-1068"><a href="#cb9-1068"></a><span class="co">#  5601     BE-FLA-Belgium/ Flanders</span></span>
<span id="cb9-1069"><a href="#cb9-1069"></a><span class="co">#  5602     BE-WAL-Belgium/ Wallonia</span></span>
<span id="cb9-1070"><a href="#cb9-1070"></a><span class="co">#  5603     BE-BRU-Belgium/ Brussels</span></span>
<span id="cb9-1071"><a href="#cb9-1071"></a><span class="co"># 27601     DE-W-Germany-West</span></span>
<span id="cb9-1072"><a href="#cb9-1072"></a><span class="co"># 27602     DE-E-Germany-East</span></span>
<span id="cb9-1073"><a href="#cb9-1073"></a><span class="co"># Tähän pitäisi päästä</span></span>
<span id="cb9-1074"><a href="#cb9-1074"></a><span class="co"># levels = c(&quot;100&quot;,&quot;208&quot;,&quot;246&quot;,&quot;348&quot;,&quot;5601&quot;,&quot;5602&quot;,&quot;5603&quot;,&quot;27601&quot;,&quot;27602&quot;),</span></span>
<span id="cb9-1075"><a href="#cb9-1075"></a><span class="co"># labels = c(&quot;BG&quot;,&quot;DK&quot;,&quot;FI&quot;,&quot;HU&quot;,&quot;bF&quot;,&quot;bW&quot;,&quot;bB&quot;,&quot;dW&quot;,&quot;dE&quot;))</span></span>
<span id="cb9-1076"><a href="#cb9-1076"></a><span class="co"># levels(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1077"><a href="#cb9-1077"></a></span>
<span id="cb9-1078"><a href="#cb9-1078"></a>ISSP2012esim1.dat &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1079"><a href="#cb9-1079"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">maa3 =</span></span>
<span id="cb9-1080"><a href="#cb9-1080"></a>                <span class="kw">fct_recode</span>(maa3,</span>
<span id="cb9-1081"><a href="#cb9-1081"></a>                 <span class="st">&quot;BG&quot;</span> =<span class="st"> &quot;BG-Bulgaria&quot;</span>,</span>
<span id="cb9-1082"><a href="#cb9-1082"></a>                 <span class="st">&quot;DK&quot;</span> =<span class="st"> &quot;DK-Denmark&quot;</span>,</span>
<span id="cb9-1083"><a href="#cb9-1083"></a>                 <span class="st">&quot;FI&quot;</span> =<span class="st"> &quot;FI-Finland&quot;</span>,</span>
<span id="cb9-1084"><a href="#cb9-1084"></a>                 <span class="st">&quot;HU&quot;</span> =<span class="st"> &quot;HU-Hungary&quot;</span>,</span>
<span id="cb9-1085"><a href="#cb9-1085"></a>                 <span class="st">&quot;bF&quot;</span> =<span class="st"> &quot;BE-FLA-Belgium/ Flanders&quot;</span>,</span>
<span id="cb9-1086"><a href="#cb9-1086"></a>                 <span class="st">&quot;bW&quot;</span> =<span class="st"> &quot;BE-WAL-Belgium/ Wallonia&quot;</span>,</span>
<span id="cb9-1087"><a href="#cb9-1087"></a>                 <span class="st">&quot;bB&quot;</span> =<span class="st"> &quot;BE-BRU-Belgium/ Brussels&quot;</span>,</span>
<span id="cb9-1088"><a href="#cb9-1088"></a>                 <span class="st">&quot;dW&quot;</span> =<span class="st"> &quot;DE-W-Germany-West&quot;</span>,</span>
<span id="cb9-1089"><a href="#cb9-1089"></a>                 <span class="st">&quot;dE&quot;</span> =<span class="st"> &quot;DE-E-Germany-East&quot;</span>)</span>
<span id="cb9-1090"><a href="#cb9-1090"></a>               )</span>
<span id="cb9-1091"><a href="#cb9-1091"></a><span class="co"># tarkistuksia</span></span>
<span id="cb9-1092"><a href="#cb9-1092"></a><span class="co">#levels(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1093"><a href="#cb9-1093"></a><span class="co"># str(ISSP2012esim1.dat$maa3) # 9 levels</span></span>
<span id="cb9-1094"><a href="#cb9-1094"></a><span class="co">#summary(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1095"><a href="#cb9-1095"></a><span class="co">#</span></span>
<span id="cb9-1096"><a href="#cb9-1096"></a><span class="co"># TÄSSÄ TOISTOA! (4.2.20)</span></span>
<span id="cb9-1097"><a href="#cb9-1097"></a><span class="co"># Muutetaan muuttujien &quot;maa&quot; ja &quot;maa3&quot; arvojen (levels) järjestys samaksi kuin</span></span>
<span id="cb9-1098"><a href="#cb9-1098"></a><span class="co"># alkuperäisen muuttujan C_ALPHAN. Helpomi verrata aikaisempiin tuloksiin.</span></span>
<span id="cb9-1099"><a href="#cb9-1099"></a></span>
<span id="cb9-1100"><a href="#cb9-1100"></a><span class="co"># &quot;alkuperäinen&quot; maa talteen</span></span>
<span id="cb9-1101"><a href="#cb9-1101"></a>ISSP2012esim1.dat<span class="op">$</span>maa2 &lt;-<span class="st"> </span>ISSP2012esim1.dat<span class="op">$</span>maa</span>
<span id="cb9-1102"><a href="#cb9-1102"></a></span>
<span id="cb9-1103"><a href="#cb9-1103"></a>ISSP2012esim1.dat &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1104"><a href="#cb9-1104"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">maa =</span></span>
<span id="cb9-1105"><a href="#cb9-1105"></a>                <span class="kw">fct_relevel</span>(maa,</span>
<span id="cb9-1106"><a href="#cb9-1106"></a>                            <span class="st">&quot;BE&quot;</span>,</span>
<span id="cb9-1107"><a href="#cb9-1107"></a>                            <span class="st">&quot;BG&quot;</span>,</span>
<span id="cb9-1108"><a href="#cb9-1108"></a>                            <span class="st">&quot;DE&quot;</span>,</span>
<span id="cb9-1109"><a href="#cb9-1109"></a>                            <span class="st">&quot;DK&quot;</span>,</span>
<span id="cb9-1110"><a href="#cb9-1110"></a>                            <span class="st">&quot;FI&quot;</span>,</span>
<span id="cb9-1111"><a href="#cb9-1111"></a>                            <span class="st">&quot;HU&quot;</span>))</span>
<span id="cb9-1112"><a href="#cb9-1112"></a>ISSP2012esim1.dat &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1113"><a href="#cb9-1113"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">maa3 =</span></span>
<span id="cb9-1114"><a href="#cb9-1114"></a>                <span class="kw">fct_relevel</span>(maa3,</span>
<span id="cb9-1115"><a href="#cb9-1115"></a>                        <span class="st">&quot;bF&quot;</span>,</span>
<span id="cb9-1116"><a href="#cb9-1116"></a>                        <span class="st">&quot;bW&quot;</span>,</span>
<span id="cb9-1117"><a href="#cb9-1117"></a>                        <span class="st">&quot;bB&quot;</span>,</span>
<span id="cb9-1118"><a href="#cb9-1118"></a>                        <span class="st">&quot;BG&quot;</span>,</span>
<span id="cb9-1119"><a href="#cb9-1119"></a>                        <span class="st">&quot;dW&quot;</span>,</span>
<span id="cb9-1120"><a href="#cb9-1120"></a>                        <span class="st">&quot;dE&quot;</span>,</span>
<span id="cb9-1121"><a href="#cb9-1121"></a>                        <span class="st">&quot;DK&quot;</span>,</span>
<span id="cb9-1122"><a href="#cb9-1122"></a>                        <span class="st">&quot;FI&quot;</span>,</span>
<span id="cb9-1123"><a href="#cb9-1123"></a>                        <span class="st">&quot;HU&quot;</span>))</span>
<span id="cb9-1124"><a href="#cb9-1124"></a></span>
<span id="cb9-1125"><a href="#cb9-1125"></a><span class="co"># Tarkistus</span></span>
<span id="cb9-1126"><a href="#cb9-1126"></a><span class="co">#ISSP2012esim1.dat %&gt;% tableX(maa2,maa, type = &quot;count&quot;)</span></span>
<span id="cb9-1127"><a href="#cb9-1127"></a><span class="co"># &quot;alkuperäinen&quot; maa talteenISSP2012esim1.dat %&gt;% tableX(maa,C_ALPHAN, type = &quot;count&quot;)</span></span>
<span id="cb9-1128"><a href="#cb9-1128"></a><span class="co"># &quot;alkuperäinen&quot; maa talteenstr(ISSP2012esim1.dat)</span></span>
<span id="cb9-1129"><a href="#cb9-1129"></a></span>
<span id="cb9-1130"><a href="#cb9-1130"></a><span class="co"># Taulukoita (31.1.2020) ja tarkistuksia</span></span>
<span id="cb9-1131"><a href="#cb9-1131"></a><span class="co">#</span></span>
<span id="cb9-1132"><a href="#cb9-1132"></a><span class="co"># toinen maa-muuttuja, jossa Saksan ja Belgian jako</span></span>
<span id="cb9-1133"><a href="#cb9-1133"></a><span class="co">#  V3</span></span>
<span id="cb9-1134"><a href="#cb9-1134"></a><span class="co">#  5601     BE-FLA-Belgium/ Flanders</span></span>
<span id="cb9-1135"><a href="#cb9-1135"></a><span class="co">#  5602     BE-WAL-Belgium/ Wallonia</span></span>
<span id="cb9-1136"><a href="#cb9-1136"></a><span class="co">#  5603     BE-BRU-Belgium/ Brussels</span></span>
<span id="cb9-1137"><a href="#cb9-1137"></a><span class="co"># 27601     DE-W-Germany-West</span></span>
<span id="cb9-1138"><a href="#cb9-1138"></a><span class="co"># 27602     DE-E-Germany-East</span></span>
<span id="cb9-1139"><a href="#cb9-1139"></a></span>
<span id="cb9-1140"><a href="#cb9-1140"></a><span class="co"># Tarkastuksia</span></span>
<span id="cb9-1141"><a href="#cb9-1141"></a></span>
<span id="cb9-1142"><a href="#cb9-1142"></a><span class="co"># assert_that ehkä tarpeeton - expect_equivalet testaa levelien</span></span>
<span id="cb9-1143"><a href="#cb9-1143"></a><span class="co"># järjestyksen ja määrän (20.2.20)</span></span>
<span id="cb9-1144"><a href="#cb9-1144"></a></span>
<span id="cb9-1145"><a href="#cb9-1145"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>sp)) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb9-1146"><a href="#cb9-1146"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>sp),</span>
<span id="cb9-1147"><a href="#cb9-1147"></a>                <span class="kw">c</span>(<span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>)))</span>
<span id="cb9-1148"><a href="#cb9-1148"></a></span>
<span id="cb9-1149"><a href="#cb9-1149"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>maa)) <span class="op">==</span><span class="st"> </span><span class="dv">6</span>)</span>
<span id="cb9-1150"><a href="#cb9-1150"></a></span>
<span id="cb9-1151"><a href="#cb9-1151"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>maa),</span>
<span id="cb9-1152"><a href="#cb9-1152"></a>                  <span class="kw">c</span>(<span class="st">&quot;BE&quot;</span>, <span class="st">&quot;BG&quot;</span>, <span class="st">&quot;DE&quot;</span>, <span class="st">&quot;DK&quot;</span>, <span class="st">&quot;FI&quot;</span>, <span class="st">&quot;HU&quot;</span>)))</span>
<span id="cb9-1153"><a href="#cb9-1153"></a></span>
<span id="cb9-1154"><a href="#cb9-1154"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>maa3)) <span class="op">==</span><span class="st"> </span><span class="dv">9</span>)</span>
<span id="cb9-1155"><a href="#cb9-1155"></a></span>
<span id="cb9-1156"><a href="#cb9-1156"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>maa3),</span>
<span id="cb9-1157"><a href="#cb9-1157"></a>                 <span class="kw">c</span>(<span class="st">&quot;bF&quot;</span>,<span class="st">&quot;bW&quot;</span>,<span class="st">&quot;bB&quot;</span>, <span class="st">&quot;BG&quot;</span>,<span class="st">&quot;dW&quot;</span>,<span class="st">&quot;dE&quot;</span>,<span class="st">&quot;DK&quot;</span>, <span class="st">&quot;FI&quot;</span>, <span class="st">&quot;HU&quot;</span>)))</span>
<span id="cb9-1158"><a href="#cb9-1158"></a></span>
<span id="cb9-1159"><a href="#cb9-1159"></a><span class="kw">validate_that</span>(<span class="kw">length</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>Q1b)) <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)</span>
<span id="cb9-1160"><a href="#cb9-1160"></a><span class="kw">validate_that</span>(<span class="kw">are_equal</span>(<span class="kw">levels</span>(ISSP2012esim1.dat<span class="op">$</span>Q1b),</span>
<span id="cb9-1161"><a href="#cb9-1161"></a>               <span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)))</span>
<span id="cb9-1162"><a href="#cb9-1162"></a></span>
<span id="cb9-1163"><a href="#cb9-1163"></a><span class="co"># testthat - paketti - pois käytöstä 16.9.20</span></span>
<span id="cb9-1164"><a href="#cb9-1164"></a><span class="co"># expect_ ei anna ok-ilmoitusta, ainoastaan virheilmoituksen? (11.4.20)</span></span>
<span id="cb9-1165"><a href="#cb9-1165"></a><span class="co"># expect_equivalent(levels(ISSP2012esim1.dat$maa),</span></span>
<span id="cb9-1166"><a href="#cb9-1166"></a><span class="co">#                  c(&quot;BE&quot;, &quot;BG&quot;, &quot;DE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;))</span></span>
<span id="cb9-1167"><a href="#cb9-1167"></a><span class="co"># expect_equivalent(levels(ISSP2012esim1.dat$maa3),</span></span>
<span id="cb9-1168"><a href="#cb9-1168"></a><span class="co">#                  c(&quot;bF&quot;,&quot;bW&quot;,&quot;bB&quot;, &quot;BG&quot;,&quot;dW&quot;,&quot;dE&quot;,&quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;))</span></span>
<span id="cb9-1169"><a href="#cb9-1169"></a><span class="co"># expect_equivalent(levels(ISSP2012esim1.dat$sp), c(&quot;m&quot;, &quot;f&quot;))</span></span>
<span id="cb9-1170"><a href="#cb9-1170"></a><span class="co"># expect_equivalent(levels(ISSP2012esim1.dat$Q1b),</span></span>
<span id="cb9-1171"><a href="#cb9-1171"></a><span class="co">#                  c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))</span></span>
<span id="cb9-1172"><a href="#cb9-1172"></a><span class="co">#</span></span>
<span id="cb9-1173"><a href="#cb9-1173"></a><span class="co"># ISSP2012esim1.dat %&gt;% tableX(maa,ika,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1174"><a href="#cb9-1174"></a><span class="co">#</span></span>
<span id="cb9-1175"><a href="#cb9-1175"></a><span class="co"># Riviprofiilit</span></span>
<span id="cb9-1176"><a href="#cb9-1176"></a><span class="co">#</span></span>
<span id="cb9-1177"><a href="#cb9-1177"></a><span class="co"># ISSP2012esim1.dat %&gt;% tableX(maa,ika,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1178"><a href="#cb9-1178"></a><span class="co"># ISSP2012esim1.dat %&gt;% tableX(maa,sp ,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1179"><a href="#cb9-1179"></a><span class="co">#</span></span>
<span id="cb9-1180"><a href="#cb9-1180"></a><span class="co">#</span></span>
<span id="cb9-1181"><a href="#cb9-1181"></a><span class="co"># Kysymyksen Q1b vastaukset</span></span>
<span id="cb9-1182"><a href="#cb9-1182"></a><span class="co">#</span></span>
<span id="cb9-1183"><a href="#cb9-1183"></a><span class="co">#ISSP2012esim1.dat %&gt;% tableX(maa,Q1b,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1184"><a href="#cb9-1184"></a><span class="co">#</span></span>
<span id="cb9-1185"><a href="#cb9-1185"></a><span class="co">#ISSP2012esim1.dat %&gt;% tableX(maa3,Q1b,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1186"><a href="#cb9-1186"></a><span class="co">#</span></span>
<span id="cb9-1187"><a href="#cb9-1187"></a><span class="co"># str(ISSP2012esim1.dat) # 8143 obs. of  7 variable,</span></span>
<span id="cb9-1188"><a href="#cb9-1188"></a><span class="co"># sama kuin vanhassa Galku-koodissa.</span></span>
<span id="cb9-1189"><a href="#cb9-1189"></a><span class="co">#</span></span>
<span id="cb9-1190"><a href="#cb9-1190"></a><span class="co"># str(ISSP2012esim1.dat) # 8143 obs. of  7 variable,</span></span>
<span id="cb9-1191"><a href="#cb9-1191"></a><span class="co"># sama kuin vanhassa Galku-koodissa.</span></span>
<span id="cb9-1192"><a href="#cb9-1192"></a></span>
<span id="cb9-1193"><a href="#cb9-1193"></a>taulu2 &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tableX</span>(maa, Q1b, <span class="dt">type =</span> <span class="st">&quot;cell_perc&quot;</span>)</span>
<span id="cb9-1194"><a href="#cb9-1194"></a>knitr<span class="op">::</span><span class="kw">kable</span>(taulu2,<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-1195"><a href="#cb9-1195"></a>             <span class="dt">caption =</span> <span class="st">&quot;Kysymyksen Q1b vastaukset, suhteelliset frekvenssit&quot;</span>)</span>
<span id="cb9-1196"><a href="#cb9-1196"></a></span>
<span id="cb9-1197"><a href="#cb9-1197"></a>taulu3 &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tableX</span>(maa,Q1b,<span class="dt">type =</span> <span class="st">&quot;row_perc&quot;</span>)</span>
<span id="cb9-1198"><a href="#cb9-1198"></a></span>
<span id="cb9-1199"><a href="#cb9-1199"></a>knitr<span class="op">::</span><span class="kw">kable</span>(taulu3,<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-1200"><a href="#cb9-1200"></a>             <span class="dt">caption =</span> <span class="st">&quot;Kysymyksen Q1b vastaukset, riviprosentit&quot;</span>)</span>
<span id="cb9-1201"><a href="#cb9-1201"></a></span>
<span id="cb9-1202"><a href="#cb9-1202"></a>taulu4 &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tableX</span>(maa,Q1b,<span class="dt">type =</span> <span class="st">&quot;col_perc&quot;</span>)</span>
<span id="cb9-1203"><a href="#cb9-1203"></a></span>
<span id="cb9-1204"><a href="#cb9-1204"></a>knitr<span class="op">::</span><span class="kw">kable</span>(taulu4,<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-1205"><a href="#cb9-1205"></a>             <span class="dt">caption =</span> <span class="st">&quot;Kysymyksen Q1b vastaukset, sarakeprosentit&quot;</span>)</span>
<span id="cb9-1206"><a href="#cb9-1206"></a></span>
<span id="cb9-1207"><a href="#cb9-1207"></a><span class="co"># CA tässä, jotta saadaan rivi- ja sarakeprofiilikuvat</span></span>
<span id="cb9-1208"><a href="#cb9-1208"></a><span class="co"># Lasketaan samalla CA-ratkaisu riviprofiilitaulkolle (maille samat painot)</span></span>
<span id="cb9-1209"><a href="#cb9-1209"></a></span>
<span id="cb9-1210"><a href="#cb9-1210"></a>simpleCA1 &lt;-<span class="st"> </span><span class="kw">ca</span>(<span class="op">~</span>maa <span class="op">+</span><span class="st"> </span>Q1b,ISSP2012esim1.dat)</span>
<span id="cb9-1211"><a href="#cb9-1211"></a></span>
<span id="cb9-1212"><a href="#cb9-1212"></a><span class="co"># Maiden järjestys kääntää kuvan (1.2.20) - esimerkki on</span></span>
<span id="cb9-1213"><a href="#cb9-1213"></a><span class="co"># vähän kuriositeetti. Kartta voi tietysti &quot;flipata&quot; koordintaattien suhteen ainakin</span></span>
<span id="cb9-1214"><a href="#cb9-1214"></a><span class="co"># neljällä tavalla (? 180 astetta molempien akseleiden ympäri molempiin suuntiin?)</span></span>
<span id="cb9-1215"><a href="#cb9-1215"></a><span class="co"># (18.2.20). Tämän maa2-muuttujaa käyttävän kuvan voi jättää pois (8.4.20)</span></span>
<span id="cb9-1216"><a href="#cb9-1216"></a></span>
<span id="cb9-1217"><a href="#cb9-1217"></a><span class="co"># simpleCA2 &lt;- ca(~maa2 + Q1b,ISSP2012esim1.dat)</span></span>
<span id="cb9-1218"><a href="#cb9-1218"></a></span>
<span id="cb9-1219"><a href="#cb9-1219"></a><span class="co"># Oikeastaan maiden vertailussa pitäisi niiden massat skaalata yhtä suuriksi, tässä</span></span>
<span id="cb9-1220"><a href="#cb9-1220"></a><span class="co"># pikainen kokeilu (20.2.20)</span></span>
<span id="cb9-1221"><a href="#cb9-1221"></a><span class="co"># Riviprosentit taulukoksi, nimet sarakkeille ja riveille (ei kovin robustia...)</span></span>
<span id="cb9-1222"><a href="#cb9-1222"></a></span>
<span id="cb9-1223"><a href="#cb9-1223"></a></span>
<span id="cb9-1224"><a href="#cb9-1224"></a>johdesim1_rowproc.tab &lt;-<span class="st"> </span>simpleCA1<span class="op">$</span>N <span class="op">/</span><span class="st"> </span><span class="kw">rowSums</span>(simpleCA1<span class="op">$</span>N)</span>
<span id="cb9-1225"><a href="#cb9-1225"></a><span class="kw">colnames</span>(johdesim1_rowproc.tab) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;S&quot;</span> ,<span class="st">&quot;s&quot;</span> ,<span class="st">&quot;?&quot;</span>,<span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb9-1226"><a href="#cb9-1226"></a><span class="kw">rownames</span>(johdesim1_rowproc.tab) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BE&quot;</span>, <span class="st">&quot;BG&quot;</span>, <span class="st">&quot;DE&quot;</span>, <span class="st">&quot;DK&quot;</span>, <span class="st">&quot;FI&quot;</span>, <span class="st">&quot;HU&quot;</span>)</span>
<span id="cb9-1227"><a href="#cb9-1227"></a></span>
<span id="cb9-1228"><a href="#cb9-1228"></a><span class="co"># Miten tibblenä? Ei toimi, ei maa-muuttujaa ollenkaan</span></span>
<span id="cb9-1229"><a href="#cb9-1229"></a><span class="co"># johdesim1_rowproc.tbl &lt;- as_tibble(johdesim1_rowproc.tab)</span></span>
<span id="cb9-1230"><a href="#cb9-1230"></a><span class="co"># str(johdesim1_rowproc.tbl)</span></span>
<span id="cb9-1231"><a href="#cb9-1231"></a></span>
<span id="cb9-1232"><a href="#cb9-1232"></a><span class="co"># TARKISTUKSIA (20.2.20)</span></span>
<span id="cb9-1233"><a href="#cb9-1233"></a><span class="co"># johdesim1_rowproc.tab</span></span>
<span id="cb9-1234"><a href="#cb9-1234"></a><span class="co"># rowSums(johdesim1_rowproc.tab)</span></span>
<span id="cb9-1235"><a href="#cb9-1235"></a><span class="co"># str(johdesim1_rowproc.tab)</span></span>
<span id="cb9-1236"><a href="#cb9-1236"></a></span>
<span id="cb9-1237"><a href="#cb9-1237"></a></span>
<span id="cb9-1238"><a href="#cb9-1238"></a>simpleCA3 &lt;-<span class="st"> </span><span class="kw">ca</span>(johdesim1_rowproc.tab)</span>
<span id="cb9-1239"><a href="#cb9-1239"></a></span>
<span id="cb9-1240"><a href="#cb9-1240"></a></span>
<span id="cb9-1241"><a href="#cb9-1241"></a><span class="co"># Kartta piirretään koodilohkossa simpleCAmap1, r. 773 noin.</span></span>
<span id="cb9-1242"><a href="#cb9-1242"></a></span>
<span id="cb9-1243"><a href="#cb9-1243"></a><span class="co"># Riviprosentit tarkistusta varten</span></span>
<span id="cb9-1244"><a href="#cb9-1244"></a><span class="co">#        S  s   ?   e   E</span></span>
<span id="cb9-1245"><a href="#cb9-1245"></a><span class="co">#BE 9.49    22.40   21.76   27.42   18.93</span></span>
<span id="cb9-1246"><a href="#cb9-1246"></a><span class="co">#BG 12.81   42.89   22.26   20.63   1.41</span></span>
<span id="cb9-1247"><a href="#cb9-1247"></a><span class="co">#DE 9.63    21.88   11.55   31.39   25.55</span></span>
<span id="cb9-1248"><a href="#cb9-1248"></a><span class="co">#DK 5.04    17.15   10.95   16.71   50.14</span></span>
<span id="cb9-1249"><a href="#cb9-1249"></a><span class="co">#FI 4.23    16.94   13.42   38.11   27.30</span></span>
<span id="cb9-1250"><a href="#cb9-1250"></a><span class="co">#HU 21.97   28.89   22.57   19.06   7.52</span></span>
<span id="cb9-1251"><a href="#cb9-1251"></a><span class="co">#</span></span>
<span id="cb9-1252"><a href="#cb9-1252"></a><span class="co"># Ja datan saa leikepöydän kautta, jos on tarve pikatarkistuksiin</span></span>
<span id="cb9-1253"><a href="#cb9-1253"></a><span class="co"># read &lt;- read.table(&quot;clipboard&quot;)</span></span>
<span id="cb9-1254"><a href="#cb9-1254"></a></span>
<span id="cb9-1255"><a href="#cb9-1255"></a><span class="co">#mutkikas kuvan piirto - sarakeprofiilit vertailussa</span></span>
<span id="cb9-1256"><a href="#cb9-1256"></a><span class="co">#ggplot vaatii df-rakenteen ja &#39;long data&#39; - muotoon</span></span>
<span id="cb9-1257"><a href="#cb9-1257"></a><span class="co">##https://stackoverflow.com/questions/9563368/create-stacked-barplot</span></span>
<span id="cb9-1258"><a href="#cb9-1258"></a><span class="co"># -where-each-stack-is-scaled-to-sum-to</span></span>
<span id="cb9-1259"><a href="#cb9-1259"></a><span class="co"># Pitkä https-linkki kahdella rivillä</span></span>
<span id="cb9-1260"><a href="#cb9-1260"></a><span class="co">#</span></span>
<span id="cb9-1261"><a href="#cb9-1261"></a><span class="co"># käytetään ca - tuloksia</span></span>
<span id="cb9-1262"><a href="#cb9-1262"></a>apu1 &lt;-<span class="st"> </span>(simpleCA1<span class="op">$</span>N)</span>
<span id="cb9-1263"><a href="#cb9-1263"></a><span class="kw">colnames</span>(apu1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb9-1264"><a href="#cb9-1264"></a><span class="kw">rownames</span>(apu1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BE&quot;</span>, <span class="st">&quot;BG&quot;</span>, <span class="st">&quot;DE&quot;</span>, <span class="st">&quot;DK&quot;</span>, <span class="st">&quot;FI&quot;</span>, <span class="st">&quot;HU&quot;</span>)</span>
<span id="cb9-1265"><a href="#cb9-1265"></a>apu1_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(apu1)</span>
<span id="cb9-1266"><a href="#cb9-1266"></a><span class="co">#lasketan rivien reunajakauma</span></span>
<span id="cb9-1267"><a href="#cb9-1267"></a>apu1_df<span class="op">$</span>ka_sarake &lt;-<span class="st"> </span><span class="kw">rowSums</span>(apu1_df)</span>
<span id="cb9-1268"><a href="#cb9-1268"></a><span class="co">#muokataan &#39;long data&#39; - muotoon</span></span>
<span id="cb9-1269"><a href="#cb9-1269"></a>apu1b_df &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">cbind</span>(apu1_df, <span class="dt">ind =</span> <span class="kw">rownames</span>(apu1_df)), <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&#39;ind&#39;</span>))</span>
<span id="cb9-1270"><a href="#cb9-1270"></a></span>
<span id="cb9-1271"><a href="#cb9-1271"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(apu1b_df, <span class="kw">aes</span>(<span class="dt">x =</span> variable, <span class="dt">y =</span> value, <span class="dt">fill =</span> ind)) <span class="op">+</span></span>
<span id="cb9-1272"><a href="#cb9-1272"></a><span class="st">         </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span></span>
<span id="cb9-1273"><a href="#cb9-1273"></a><span class="st">         </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot; &quot;</span>,<span class="dt">labels =</span> <span class="kw">percent_format</span>())</span>
<span id="cb9-1274"><a href="#cb9-1274"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;maa&quot;</span>)</span>
<span id="cb9-1275"><a href="#cb9-1275"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Q1b - vastauskategoriat&quot;</span>)</span>
<span id="cb9-1276"><a href="#cb9-1276"></a><span class="co"># apu1_df</span></span>
<span id="cb9-1277"><a href="#cb9-1277"></a><span class="co"># apu1b_df</span></span>
<span id="cb9-1278"><a href="#cb9-1278"></a></span>
<span id="cb9-1279"><a href="#cb9-1279"></a></span>
<span id="cb9-1280"><a href="#cb9-1280"></a><span class="co"># riviprofiilit ja keskiarvorivi -  18.9.2018</span></span>
<span id="cb9-1281"><a href="#cb9-1281"></a>apu2_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(apu1)</span>
<span id="cb9-1282"><a href="#cb9-1282"></a>apu2_df &lt;-<span class="st"> </span><span class="kw">rbind</span>(apu2_df, <span class="dt">ka_rivi =</span> <span class="kw">colSums</span>(apu2_df))</span>
<span id="cb9-1283"><a href="#cb9-1283"></a></span>
<span id="cb9-1284"><a href="#cb9-1284"></a><span class="co">#apu2_df</span></span>
<span id="cb9-1285"><a href="#cb9-1285"></a><span class="co">#str(apu2_df)</span></span>
<span id="cb9-1286"><a href="#cb9-1286"></a><span class="co">## typeof(apu2_df) # what is it?</span></span>
<span id="cb9-1287"><a href="#cb9-1287"></a><span class="co">## class(apu2_df) # what is it? (sorry)</span></span>
<span id="cb9-1288"><a href="#cb9-1288"></a><span class="co">## storage.mode(apu2_df) # what is it? (very sorry)</span></span>
<span id="cb9-1289"><a href="#cb9-1289"></a><span class="co">## length(apu2_df) # how long is it? What about two dimensional</span></span>
<span id="cb9-1290"><a href="#cb9-1290"></a><span class="co">## objects?</span></span>
<span id="cb9-1291"><a href="#cb9-1291"></a><span class="co"># attributes(apu2_df)</span></span>
<span id="cb9-1292"><a href="#cb9-1292"></a></span>
<span id="cb9-1293"><a href="#cb9-1293"></a><span class="co"># temp1 &lt;- cbind(apu2_df, ind = rownames(apu2_df))</span></span>
<span id="cb9-1294"><a href="#cb9-1294"></a><span class="co"># temp1</span></span>
<span id="cb9-1295"><a href="#cb9-1295"></a><span class="co">##muokataan &#39;long data&#39; - muotoon</span></span>
<span id="cb9-1296"><a href="#cb9-1296"></a>apu2b_df &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="kw">cbind</span>(apu2_df, <span class="dt">ind =</span> <span class="kw">rownames</span>(apu2_df)), <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&#39;ind&#39;</span>))</span>
<span id="cb9-1297"><a href="#cb9-1297"></a><span class="co"># str(apu2b_df)</span></span>
<span id="cb9-1298"><a href="#cb9-1298"></a><span class="co"># glimpse(apu2b_df)</span></span>
<span id="cb9-1299"><a href="#cb9-1299"></a></span>
<span id="cb9-1300"><a href="#cb9-1300"></a><span class="co">#</span></span>
<span id="cb9-1301"><a href="#cb9-1301"></a><span class="co">#ggplot(apu2b_df, aes(x = value, y = ind, fill = variable)) +</span></span>
<span id="cb9-1302"><a href="#cb9-1302"></a><span class="co">#       geom_bar(position = &quot;fill&quot;, stat =&quot;identity&quot;) +</span></span>
<span id="cb9-1303"><a href="#cb9-1303"></a><span class="co">#       #coord_flip() +</span></span>
<span id="cb9-1304"><a href="#cb9-1304"></a><span class="co">#        scale_x_continuous(labels = percent_format())</span></span>
<span id="cb9-1305"><a href="#cb9-1305"></a></span>
<span id="cb9-1306"><a href="#cb9-1306"></a><span class="co">#versio2 toimii (18.9.2018)</span></span>
<span id="cb9-1307"><a href="#cb9-1307"></a></span>
<span id="cb9-1308"><a href="#cb9-1308"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(apu2b_df, <span class="kw">aes</span>(<span class="dt">x =</span> ind, <span class="dt">y =</span> value, <span class="dt">fill =</span> variable)) <span class="op">+</span></span>
<span id="cb9-1309"><a href="#cb9-1309"></a><span class="st">       </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span></span>
<span id="cb9-1310"><a href="#cb9-1310"></a><span class="st">       </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb9-1311"><a href="#cb9-1311"></a><span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot; &quot;</span>,<span class="dt">labels =</span> <span class="kw">percent_format</span>())</span>
<span id="cb9-1312"><a href="#cb9-1312"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Q1b&quot;</span>)</span>
<span id="cb9-1313"><a href="#cb9-1313"></a>p <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">name =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb9-1314"><a href="#cb9-1314"></a></span>
<span id="cb9-1315"><a href="#cb9-1315"></a></span>
<span id="cb9-1316"><a href="#cb9-1316"></a></span>
<span id="cb9-1317"><a href="#cb9-1317"></a><span class="co"># simpleCA1 luotu aikaisemmin profiilikuvia varten koodilohkossa EkaCA</span></span>
<span id="cb9-1318"><a href="#cb9-1318"></a><span class="co"># HUOM! xlab ja ylab, prosenttiosuudet ensin katsottu ja sitten kirjoitettu</span></span>
<span id="cb9-1319"><a href="#cb9-1319"></a><span class="co"># tässä. Vertaa scree-plot - tietoon!</span></span>
<span id="cb9-1320"><a href="#cb9-1320"></a></span>
<span id="cb9-1321"><a href="#cb9-1321"></a></span>
<span id="cb9-1322"><a href="#cb9-1322"></a><span class="co">#par(cex = 1)</span></span>
<span id="cb9-1323"><a href="#cb9-1323"></a><span class="kw">plot</span>(simpleCA1, <span class="dt">map =</span> <span class="st">&quot;symmetric&quot;</span>, <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb9-1324"><a href="#cb9-1324"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Dimensio 1: moderni/liberaali - perinteinen/konservatiivinen (76%)&quot;</span>,</span>
<span id="cb9-1325"><a href="#cb9-1325"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Dimensio 2: maltillinen/epävarma - radikaali/jyrkkä/varma (15.1%)&quot;</span>,</span>
<span id="cb9-1326"><a href="#cb9-1326"></a>     <span class="dt">main =</span> <span class="st">&quot;symmetrinen kartta 1&quot;</span>,</span>
<span id="cb9-1327"><a href="#cb9-1327"></a>     <span class="dt">sub =</span> <span class="st">&quot;Maiden massat eri suuruisia (otoskoko), pisteiden koko suhteessa massaan&quot;</span>)</span>
<span id="cb9-1328"><a href="#cb9-1328"></a></span>
<span id="cb9-1329"><a href="#cb9-1329"></a><span class="co"># jatkossa plot - main on kuvan tyyppi (symmetrinen, kontribuutio jne),</span></span>
<span id="cb9-1330"><a href="#cb9-1330"></a><span class="co"># koodilohkon fig.cap &quot;ylimmän tason&quot; otsikko.</span></span>
<span id="cb9-1331"><a href="#cb9-1331"></a></span>
<span id="cb9-1332"><a href="#cb9-1332"></a><span class="co"># Akseleiden tekstit (Dimensio 1....jne) asetettu käsin, ikävä kyllä myös</span></span>
<span id="cb9-1333"><a href="#cb9-1333"></a><span class="co"># selitetyn inertian osuus. CA-kartoissa tämä on niin oleellinen asia,</span></span>
<span id="cb9-1334"><a href="#cb9-1334"></a><span class="co"># että akselien nimet voi muutttaa vasta esitysgrafiikassa, ei data-analyysissä.</span></span>
<span id="cb9-1335"><a href="#cb9-1335"></a><span class="co"># Dim1 ja Dim2  kuuluvat kuviin.</span></span>
<span id="cb9-1336"><a href="#cb9-1336"></a></span>
<span id="cb9-1337"><a href="#cb9-1337"></a><span class="co"># par(cex = 1) - asetus ennen plot-komenota muuttaa valitettavasti &quot;kaiken&quot; kokoa.</span></span>
<span id="cb9-1338"><a href="#cb9-1338"></a><span class="co"># Antaa olla, kun on graafista data-analyysiä. Selkeys tärkeämpää kuin ulkoasu.</span></span>
<span id="cb9-1339"><a href="#cb9-1339"></a></span>
<span id="cb9-1340"><a href="#cb9-1340"></a></span>
<span id="cb9-1341"><a href="#cb9-1341"></a></span>
<span id="cb9-1342"><a href="#cb9-1342"></a><span class="co"># asymmetrinen kartta - rivit pc ja sarakkeet sc</span></span>
<span id="cb9-1343"><a href="#cb9-1343"></a><span class="co"># sarakkeet vektorikuvina</span></span>
<span id="cb9-1344"><a href="#cb9-1344"></a></span>
<span id="cb9-1345"><a href="#cb9-1345"></a><span class="co"># par(cex = 0.7)</span></span>
<span id="cb9-1346"><a href="#cb9-1346"></a><span class="kw">plot</span>(simpleCA1, <span class="dt">map =</span> <span class="st">&quot;rowprincipal&quot;</span>,</span>
<span id="cb9-1347"><a href="#cb9-1347"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb9-1348"><a href="#cb9-1348"></a>     <span class="dt">main =</span> <span class="st">&quot;asymmetrinen kartta 1&quot;</span></span>
<span id="cb9-1349"><a href="#cb9-1349"></a>    )</span>
<span id="cb9-1350"><a href="#cb9-1350"></a></span>
<span id="cb9-1351"><a href="#cb9-1351"></a></span>
<span id="cb9-1352"><a href="#cb9-1352"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/simpleCAasymmTulk2.png&#39;</span>)</span>
<span id="cb9-1353"><a href="#cb9-1353"></a></span>
<span id="cb9-1354"><a href="#cb9-1354"></a></span>
<span id="cb9-1355"><a href="#cb9-1355"></a><span class="co">#par(cex = 0.6)</span></span>
<span id="cb9-1356"><a href="#cb9-1356"></a><span class="kw">plot</span>(simpleCA1, <span class="dt">map =</span> <span class="st">&quot;rowgreen&quot;</span>,</span>
<span id="cb9-1357"><a href="#cb9-1357"></a>     <span class="dt">contrib =</span> <span class="kw">c</span>(<span class="st">&quot;absolute&quot;</span>, <span class="st">&quot;absolute&quot;</span>),</span>
<span id="cb9-1358"><a href="#cb9-1358"></a>     <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb9-1359"><a href="#cb9-1359"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1360"><a href="#cb9-1360"></a>     <span class="dt">main =</span> <span class="st">&quot;kontribuutiokartta 1 - pisteen koko suhteessa massaan&quot;</span>,</span>
<span id="cb9-1361"><a href="#cb9-1361"></a>     <span class="dt">sub =</span> <span class="st">&quot;sarakevektorin ja rivipisteiden värin tummuus = absoluuttinen kontribuutio&quot;</span>)</span>
<span id="cb9-1362"><a href="#cb9-1362"></a></span>
<span id="cb9-1363"><a href="#cb9-1363"></a></span>
<span id="cb9-1364"><a href="#cb9-1364"></a><span class="co">#par(cex = 0.7)</span></span>
<span id="cb9-1365"><a href="#cb9-1365"></a><span class="kw">plot</span>(simpleCA1, <span class="dt">map =</span> <span class="st">&quot;rowgreen&quot;</span>,</span>
<span id="cb9-1366"><a href="#cb9-1366"></a>     <span class="dt">contrib =</span> <span class="kw">c</span>(<span class="st">&quot;relative&quot;</span>, <span class="st">&quot;relative&quot;</span>),</span>
<span id="cb9-1367"><a href="#cb9-1367"></a>     <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb9-1368"><a href="#cb9-1368"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1369"><a href="#cb9-1369"></a>     <span class="dt">main =</span> <span class="st">&quot;kontribuutiokartta 2 - pisteen koko suhteessa massaan&quot;</span>,</span>
<span id="cb9-1370"><a href="#cb9-1370"></a>     <span class="dt">sub =</span> <span class="st">&quot;sarakevektorin ja pisteen värin tummuus = suhteellinen kontribuutio&quot;</span>)</span>
<span id="cb9-1371"><a href="#cb9-1371"></a></span>
<span id="cb9-1372"><a href="#cb9-1372"></a></span>
<span id="cb9-1373"><a href="#cb9-1373"></a><span class="co"># Sama kartta - maiden massat vakiotu - simpleCA3 luotu koodilohkossa EkaCA</span></span>
<span id="cb9-1374"><a href="#cb9-1374"></a><span class="co"># CA:n lähtötietona riviprofiilit</span></span>
<span id="cb9-1375"><a href="#cb9-1375"></a></span>
<span id="cb9-1376"><a href="#cb9-1376"></a><span class="co">#par(cex = 0.8)</span></span>
<span id="cb9-1377"><a href="#cb9-1377"></a><span class="kw">plot</span>(simpleCA3, <span class="dt">map =</span> <span class="st">&quot;symmetric&quot;</span>, <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb9-1378"><a href="#cb9-1378"></a><span class="dt">main =</span> <span class="st">&quot;symmetrinen kartta 2 &quot;</span>,</span>
<span id="cb9-1379"><a href="#cb9-1379"></a><span class="dt">sub =</span> <span class="st">&quot;Maidet massat vakioitu (riviprofiilidata)&quot;</span>)</span>
<span id="cb9-1380"><a href="#cb9-1380"></a></span>
<span id="cb9-1381"><a href="#cb9-1381"></a></span>
<span id="cb9-1382"><a href="#cb9-1382"></a><span class="kw">plot</span>(simpleCA3, <span class="dt">map =</span> <span class="st">&quot;rowgreen&quot;</span>,</span>
<span id="cb9-1383"><a href="#cb9-1383"></a>     <span class="dt">contrib =</span> <span class="kw">c</span>(<span class="st">&quot;absolute&quot;</span>, <span class="st">&quot;absolute&quot;</span>),</span>
<span id="cb9-1384"><a href="#cb9-1384"></a>     <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb9-1385"><a href="#cb9-1385"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1386"><a href="#cb9-1386"></a>     <span class="dt">main =</span> <span class="st">&quot;kontribuutiokartta 3&quot;</span>,</span>
<span id="cb9-1387"><a href="#cb9-1387"></a>     <span class="dt">sub =</span> <span class="st">&quot;sarakevektorin ja rivipisteiden värin tummuus = absoluuttinen kontribuutio, riviprofiilidata&quot;</span>)</span>
<span id="cb9-1388"><a href="#cb9-1388"></a></span>
<span id="cb9-1389"><a href="#cb9-1389"></a><span class="co"># riviprofiilitaulukko aiheuttaa virheen PDF-tulostuksessa, JH_capaper.Rmd</span></span>
<span id="cb9-1390"><a href="#cb9-1390"></a><span class="co"># tiedoston voi kuitenkin renderöidä knit-napilla RStudiossa pdf-tiedostoksi.</span></span>
<span id="cb9-1391"><a href="#cb9-1391"></a></span>
<span id="cb9-1392"><a href="#cb9-1392"></a></span>
<span id="cb9-1393"><a href="#cb9-1393"></a>BeDealueTable &lt;-<span class="st"> </span>ISSP2012esim1.dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tableX</span>(maa3, Q1b, <span class="dt">type =</span> <span class="st">&quot;row_perc&quot;</span>)</span>
<span id="cb9-1394"><a href="#cb9-1394"></a></span>
<span id="cb9-1395"><a href="#cb9-1395"></a>knitr<span class="op">::</span><span class="kw">kable</span>(BeDealueTable , <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">booktabs =</span> <span class="ot">TRUE</span>,</span>
<span id="cb9-1396"><a href="#cb9-1396"></a>           <span class="dt">caption =</span> <span class="st">&quot;Q1b vastaukset, Saksan ja Belgian alueet&quot;</span>)</span>
<span id="cb9-1397"><a href="#cb9-1397"></a></span>
<span id="cb9-1398"><a href="#cb9-1398"></a></span>
<span id="cb9-1399"><a href="#cb9-1399"></a><span class="co"># Belgian ja Saksan aluejako maa3-muuttujassa</span></span>
<span id="cb9-1400"><a href="#cb9-1400"></a><span class="co"># str(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1401"><a href="#cb9-1401"></a><span class="co"># attributes(ISSP2012esim1.dat$maa3)</span></span>
<span id="cb9-1402"><a href="#cb9-1402"></a></span>
<span id="cb9-1403"><a href="#cb9-1403"></a>suppoint1_df1 &lt;-<span class="st"> </span><span class="kw">select</span>(ISSP2012esim1.dat, maa3,Q1b)</span>
<span id="cb9-1404"><a href="#cb9-1404"></a></span>
<span id="cb9-1405"><a href="#cb9-1405"></a><span class="co"># Taulukoksi jotta saadaan lisättyä Saksan ja Belgian maa-profiilit täydentäviksi</span></span>
<span id="cb9-1406"><a href="#cb9-1406"></a><span class="co"># pisteiksi.</span></span>
<span id="cb9-1407"><a href="#cb9-1407"></a></span>
<span id="cb9-1408"><a href="#cb9-1408"></a>suppoint1_tab1 &lt;-<span class="st"> </span><span class="kw">table</span>(suppoint1_df1<span class="op">$</span>maa3, suppoint1_df1<span class="op">$</span>Q1b)</span>
<span id="cb9-1409"><a href="#cb9-1409"></a></span>
<span id="cb9-1410"><a href="#cb9-1410"></a><span class="co"># tarkistus 1</span></span>
<span id="cb9-1411"><a href="#cb9-1411"></a><span class="co"># suppoint1_tab1</span></span>
<span id="cb9-1412"><a href="#cb9-1412"></a></span>
<span id="cb9-1413"><a href="#cb9-1413"></a><span class="co"># Maaprofiilit lisäpisteiksi</span></span>
<span id="cb9-1414"><a href="#cb9-1414"></a>suppoint2_df &lt;-<span class="st"> </span><span class="kw">filter</span>(ISSP2012esim1.dat, (maa <span class="op">==</span><span class="st"> &quot;BE&quot;</span> <span class="op">|</span><span class="st"> </span>maa <span class="op">==</span><span class="st"> &quot;DE&quot;</span>))</span>
<span id="cb9-1415"><a href="#cb9-1415"></a>suppoint2_df &lt;-<span class="st"> </span><span class="kw">select</span>(suppoint2_df, maa, Q1b)</span>
<span id="cb9-1416"><a href="#cb9-1416"></a><span class="co"># Poistetaan maa-faktroin tyhjät luokat (14.11.2020)</span></span>
<span id="cb9-1417"><a href="#cb9-1417"></a>suppoint2_df &lt;-<span class="st"> </span>suppoint2_df <span class="op">%&gt;%</span></span>
<span id="cb9-1418"><a href="#cb9-1418"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">maa =</span> <span class="kw">fct_drop</span>(maa)</span>
<span id="cb9-1419"><a href="#cb9-1419"></a>    )</span>
<span id="cb9-1420"><a href="#cb9-1420"></a></span>
<span id="cb9-1421"><a href="#cb9-1421"></a></span>
<span id="cb9-1422"><a href="#cb9-1422"></a><span class="co">#glimpse(suppoint2_df)</span></span>
<span id="cb9-1423"><a href="#cb9-1423"></a>suppoint2_tab1 &lt;-<span class="st"> </span><span class="kw">table</span>(suppoint2_df<span class="op">$</span>maa, suppoint2_df<span class="op">$</span>Q1b)</span>
<span id="cb9-1424"><a href="#cb9-1424"></a></span>
<span id="cb9-1425"><a href="#cb9-1425"></a><span class="co"># tarkistus 1</span></span>
<span id="cb9-1426"><a href="#cb9-1426"></a><span class="co"># suppoint2_tab1</span></span>
<span id="cb9-1427"><a href="#cb9-1427"></a></span>
<span id="cb9-1428"><a href="#cb9-1428"></a><span class="co"># lisätään rivit maa3-muuttujan taulukkoon</span></span>
<span id="cb9-1429"><a href="#cb9-1429"></a></span>
<span id="cb9-1430"><a href="#cb9-1430"></a>suppoint1_tab1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(suppoint1_tab1, suppoint2_tab1)</span>
<span id="cb9-1431"><a href="#cb9-1431"></a></span>
<span id="cb9-1432"><a href="#cb9-1432"></a><span class="co"># suppoint1_tab1 </span></span>
<span id="cb9-1433"><a href="#cb9-1433"></a></span>
<span id="cb9-1434"><a href="#cb9-1434"></a><span class="co"># suppoint1_tab2 &lt;- read_rds(&quot;suppoint1tab1.rds&quot;) - testaus joka siirsi virheen 07-rmd-tiedostoon. Sama virheilmoitustyyppi.</span></span>
<span id="cb9-1435"><a href="#cb9-1435"></a></span>
<span id="cb9-1436"><a href="#cb9-1436"></a>suppointCA2 &lt;-<span class="st"> </span><span class="kw">ca</span>(suppoint1_tab1[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">suprow =</span> <span class="dv">10</span><span class="op">:</span><span class="dv">11</span>)</span>
<span id="cb9-1437"><a href="#cb9-1437"></a></span>
<span id="cb9-1438"><a href="#cb9-1438"></a><span class="co"># Sama kartta ilman täydentäviä pisteitä</span></span>
<span id="cb9-1439"><a href="#cb9-1439"></a></span>
<span id="cb9-1440"><a href="#cb9-1440"></a>suppointCA2b &lt;-<span class="st"> </span><span class="kw">ca</span>(suppoint1_tab1[<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb9-1441"><a href="#cb9-1441"></a></span>
<span id="cb9-1442"><a href="#cb9-1442"></a><span class="co"># par(cex = 0.6)</span></span>
<span id="cb9-1443"><a href="#cb9-1443"></a><span class="kw">plot</span>(suppointCA2, <span class="dt">main =</span> <span class="st">&quot;Symmetrinen kartta 1 &quot;</span>,</span>
<span id="cb9-1444"><a href="#cb9-1444"></a>     <span class="co"># mass = c(TRUE, TRUE),</span></span>
<span id="cb9-1445"><a href="#cb9-1445"></a>     <span class="co"># contrib = c(TRUE, FALSE),</span></span>
<span id="cb9-1446"><a href="#cb9-1446"></a>     <span class="dt">sub =</span> <span class="st">&quot;Täydentävät pisteet DE ja BE&quot;</span> )</span>
<span id="cb9-1447"><a href="#cb9-1447"></a></span>
<span id="cb9-1448"><a href="#cb9-1448"></a></span>
<span id="cb9-1449"><a href="#cb9-1449"></a></span>
<span id="cb9-1450"><a href="#cb9-1450"></a><span class="kw">plot</span>(suppointCA2b, <span class="dt">main =</span> <span class="st">&quot;kontribuutiokartta 1 - absoluuttiset kontribuutiot&quot;</span>,</span>
<span id="cb9-1451"><a href="#cb9-1451"></a>        <span class="dt">map =</span> <span class="st">&quot;rowgreen&quot;</span>,</span>
<span id="cb9-1452"><a href="#cb9-1452"></a>        <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1453"><a href="#cb9-1453"></a>        <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1454"><a href="#cb9-1454"></a>        <span class="dt">contrib =</span> <span class="kw">c</span>(<span class="st">&quot;absolute&quot;</span>,<span class="st">&quot;absolute&quot;</span>),</span>
<span id="cb9-1455"><a href="#cb9-1455"></a>        <span class="dt">sub =</span> <span class="st">&quot;Massat: pisteiden ja symbolien koko &quot;</span> )</span>
<span id="cb9-1456"><a href="#cb9-1456"></a></span>
<span id="cb9-1457"><a href="#cb9-1457"></a></span>
<span id="cb9-1458"><a href="#cb9-1458"></a><span class="kw">print</span>(suppointCA2)</span>
<span id="cb9-1459"><a href="#cb9-1459"></a></span>
<span id="cb9-1460"><a href="#cb9-1460"></a></span>
<span id="cb9-1461"><a href="#cb9-1461"></a><span class="kw">summary</span>(suppointCA2)</span>
<span id="cb9-1462"><a href="#cb9-1462"></a></span>
<span id="cb9-1463"><a href="#cb9-1463"></a>suppointCA3 &lt;-<span class="st"> </span><span class="kw">ca</span>(<span class="op">~</span>maa3 <span class="op">+</span><span class="st"> </span>Q1b,ISSP2012esim1.dat, <span class="dt">nd =</span> <span class="dv">3</span>)</span>
<span id="cb9-1464"><a href="#cb9-1464"></a></span>
<span id="cb9-1465"><a href="#cb9-1465"></a><span class="co"># summary(suppointCA3)</span></span>
<span id="cb9-1466"><a href="#cb9-1466"></a><span class="co"># Error in rsc %*% diag(sv) : non-conformable arguments</span></span>
<span id="cb9-1467"><a href="#cb9-1467"></a><span class="co"># outo juttu, ei toimi! - TÄMÄ POISTETAAN</span></span>
<span id="cb9-1468"><a href="#cb9-1468"></a></span>
<span id="cb9-1469"><a href="#cb9-1469"></a><span class="kw">plot</span>(suppointCA3, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb9-1470"><a href="#cb9-1470"></a>                <span class="dt">main =</span> <span class="st">&quot;Kolmen dimension ratkaisu&quot;</span>,</span>
<span id="cb9-1471"><a href="#cb9-1471"></a>                <span class="dt">sub =</span> <span class="st">&quot;symmetrinen kartta - 1. ja 2. dimensio&quot;</span>)</span>
<span id="cb9-1472"><a href="#cb9-1472"></a></span>
<span id="cb9-1473"><a href="#cb9-1473"></a><span class="kw">plot</span>(suppointCA3, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),</span>
<span id="cb9-1474"><a href="#cb9-1474"></a>                <span class="dt">main =</span> <span class="st">&quot;Kolmen dimension ratkaisu 1&quot;</span>,</span>
<span id="cb9-1475"><a href="#cb9-1475"></a>                <span class="dt">sub =</span> <span class="st">&quot;symmetrinen kartta - 1. ja 3. dimensio&quot;</span>)</span>
<span id="cb9-1476"><a href="#cb9-1476"></a></span>
<span id="cb9-1477"><a href="#cb9-1477"></a><span class="kw">plot</span>(suppointCA3, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb9-1478"><a href="#cb9-1478"></a>                <span class="dt">main =</span> <span class="st">&quot;Kolmen dimension ratkaisu 2&quot;</span>,</span>
<span id="cb9-1479"><a href="#cb9-1479"></a>                <span class="dt">sub =</span> <span class="st">&quot;symmetrinen kartta - 2. ja 3. dimensio&quot;</span>)</span>
<span id="cb9-1480"><a href="#cb9-1480"></a></span>
<span id="cb9-1481"><a href="#cb9-1481"></a></span>
<span id="cb9-1482"><a href="#cb9-1482"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/3dSymMap_1.PNG&#39;</span>)</span>
<span id="cb9-1483"><a href="#cb9-1483"></a></span>
<span id="cb9-1484"><a href="#cb9-1484"></a></span>
<span id="cb9-1485"><a href="#cb9-1485"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/3dSymMap_2.PNG&#39;</span>)</span>
<span id="cb9-1486"><a href="#cb9-1486"></a></span>
<span id="cb9-1487"><a href="#cb9-1487"></a><span class="co"># Iän ja sukupuolen vuorovaikutusmuuttujia</span></span>
<span id="cb9-1488"><a href="#cb9-1488"></a><span class="co">#</span></span>
<span id="cb9-1489"><a href="#cb9-1489"></a><span class="co"># Uusi R-data: ISSP2012esim1b.dat2esim1b)</span></span>
<span id="cb9-1490"><a href="#cb9-1490"></a><span class="co">#</span></span>
<span id="cb9-1491"><a href="#cb9-1491"></a><span class="co"># Ikäluokat age_cat</span></span>
<span id="cb9-1492"><a href="#cb9-1492"></a><span class="co"># AGE 1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 and older</span></span>
<span id="cb9-1493"><a href="#cb9-1493"></a><span class="co">#</span></span>
<span id="cb9-1494"><a href="#cb9-1494"></a><span class="co"># summary(ISSP2012esim1.dat$AGE)</span></span>
<span id="cb9-1495"><a href="#cb9-1495"></a><span class="co"># hist(ISSP2012esim1.dat$ika)</span></span>
<span id="cb9-1496"><a href="#cb9-1496"></a></span>
<span id="cb9-1497"><a href="#cb9-1497"></a>ISSP2012esim1b.dat &lt;-<span class="st"> </span><span class="kw">mutate</span>(ISSP2012esim1.dat,</span>
<span id="cb9-1498"><a href="#cb9-1498"></a>                      <span class="dt">age_cat =</span> <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">15</span><span class="op">:</span><span class="dv">25</span>, <span class="st">&quot;1&quot;</span>,</span>
<span id="cb9-1499"><a href="#cb9-1499"></a>                        <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">26</span><span class="op">:</span><span class="dv">35</span>, <span class="st">&quot;2&quot;</span>,</span>
<span id="cb9-1500"><a href="#cb9-1500"></a>                        <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">36</span><span class="op">:</span><span class="dv">45</span>, <span class="st">&quot;3&quot;</span>,</span>
<span id="cb9-1501"><a href="#cb9-1501"></a>                        <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">46</span><span class="op">:</span><span class="dv">55</span>, <span class="st">&quot;4&quot;</span>,</span>
<span id="cb9-1502"><a href="#cb9-1502"></a>                        <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">56</span><span class="op">:</span><span class="dv">65</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>))))))</span>
<span id="cb9-1503"><a href="#cb9-1503"></a></span>
<span id="cb9-1504"><a href="#cb9-1504"></a></span>
<span id="cb9-1505"><a href="#cb9-1505"></a>ISSP2012esim1b.dat &lt;-<span class="st"> </span>ISSP2012esim1b.dat <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb9-1506"><a href="#cb9-1506"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">age_cat =</span> <span class="kw">as_factor</span>(age_cat)) <span class="co"># järjestys omituinen!(4.2.20)</span></span>
<span id="cb9-1507"><a href="#cb9-1507"></a></span>
<span id="cb9-1508"><a href="#cb9-1508"></a><span class="co"># Tarkistuksia</span></span>
<span id="cb9-1509"><a href="#cb9-1509"></a><span class="co"># str(ISSP2012esim2.dat$age_cat)</span></span>
<span id="cb9-1510"><a href="#cb9-1510"></a><span class="co"># levels(ISSP2012esim2.dat$age_cat)</span></span>
<span id="cb9-1511"><a href="#cb9-1511"></a><span class="co"># ISSP2012esim2.dat$age_cat %&gt;% summary()</span></span>
<span id="cb9-1512"><a href="#cb9-1512"></a></span>
<span id="cb9-1513"><a href="#cb9-1513"></a><span class="co"># Järjestetään ikäluokat uudelleen</span></span>
<span id="cb9-1514"><a href="#cb9-1514"></a></span>
<span id="cb9-1515"><a href="#cb9-1515"></a>ISSP2012esim1b.dat &lt;-<span class="st"> </span>ISSP2012esim1b.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1516"><a href="#cb9-1516"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">age_cat =</span></span>
<span id="cb9-1517"><a href="#cb9-1517"></a>                <span class="kw">fct_relevel</span>(age_cat,</span>
<span id="cb9-1518"><a href="#cb9-1518"></a>                            <span class="st">&quot;1&quot;</span>,</span>
<span id="cb9-1519"><a href="#cb9-1519"></a>                            <span class="st">&quot;2&quot;</span>,</span>
<span id="cb9-1520"><a href="#cb9-1520"></a>                            <span class="st">&quot;3&quot;</span>,</span>
<span id="cb9-1521"><a href="#cb9-1521"></a>                            <span class="st">&quot;4&quot;</span>,</span>
<span id="cb9-1522"><a href="#cb9-1522"></a>                            <span class="st">&quot;5&quot;</span>,</span>
<span id="cb9-1523"><a href="#cb9-1523"></a>                            <span class="st">&quot;6&quot;</span>)</span>
<span id="cb9-1524"><a href="#cb9-1524"></a>               )</span>
<span id="cb9-1525"><a href="#cb9-1525"></a></span>
<span id="cb9-1526"><a href="#cb9-1526"></a><span class="co"># Tarkistuksia</span></span>
<span id="cb9-1527"><a href="#cb9-1527"></a></span>
<span id="cb9-1528"><a href="#cb9-1528"></a><span class="co"># Iso taulukko, voi tarkistaa että muunnos ok.</span></span>
<span id="cb9-1529"><a href="#cb9-1529"></a><span class="co"># test6 %&gt;% tableX(AGE, age_cat, type = &quot;count&quot;)</span></span>
<span id="cb9-1530"><a href="#cb9-1530"></a><span class="co"># taulu42 &lt;- ISSP2012esim2.dat %&gt;% tableX(maa,age_cat,type = &quot;count&quot;)</span></span>
<span id="cb9-1531"><a href="#cb9-1531"></a><span class="co"># kable(taulu42,digits = 2, caption = &quot;Ikäluokka age_cat&quot;)</span></span>
<span id="cb9-1532"><a href="#cb9-1532"></a><span class="co">#</span></span>
<span id="cb9-1533"><a href="#cb9-1533"></a></span>
<span id="cb9-1534"><a href="#cb9-1534"></a><span class="co"># Taulukoita (4.2.20)</span></span>
<span id="cb9-1535"><a href="#cb9-1535"></a></span>
<span id="cb9-1536"><a href="#cb9-1536"></a><span class="co">#ISSP2012esim1b.dat %&gt;%</span></span>
<span id="cb9-1537"><a href="#cb9-1537"></a><span class="co">#    tableX(maa,age_cat,type = &quot;count&quot;) %&gt;%</span></span>
<span id="cb9-1538"><a href="#cb9-1538"></a><span class="co">#    kable(digits = 2, caption = &quot;Ikäluokka age_cat&quot;)</span></span>
<span id="cb9-1539"><a href="#cb9-1539"></a><span class="co">#</span></span>
<span id="cb9-1540"><a href="#cb9-1540"></a><span class="co">#ISSP2012esim1b.dat %&gt;%</span></span>
<span id="cb9-1541"><a href="#cb9-1541"></a><span class="co">#    tableX(maa,age_cat,type = &quot;row_perc&quot;) %&gt;%</span></span>
<span id="cb9-1542"><a href="#cb9-1542"></a><span class="co">#    kable(digits = 2, caption = &quot;age_cat: suhteelliset frekvenssit&quot;)</span></span>
<span id="cb9-1543"><a href="#cb9-1543"></a></span>
<span id="cb9-1544"><a href="#cb9-1544"></a><span class="co"># ga - ikäluokka ja sukupuoli</span></span>
<span id="cb9-1545"><a href="#cb9-1545"></a></span>
<span id="cb9-1546"><a href="#cb9-1546"></a>ISSP2012esim1b.dat &lt;-<span class="st"> </span><span class="kw">mutate</span>(ISSP2012esim1b.dat,</span>
<span id="cb9-1547"><a href="#cb9-1547"></a>                        <span class="dt">ga =</span> <span class="kw">case_when</span>((age_cat <span class="op">==</span><span class="st"> &quot;1&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m1&quot;</span>,</span>
<span id="cb9-1548"><a href="#cb9-1548"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;2&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m2&quot;</span>,</span>
<span id="cb9-1549"><a href="#cb9-1549"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;3&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m3&quot;</span>,</span>
<span id="cb9-1550"><a href="#cb9-1550"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;4&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m4&quot;</span>,</span>
<span id="cb9-1551"><a href="#cb9-1551"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;5&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m5&quot;</span>,</span>
<span id="cb9-1552"><a href="#cb9-1552"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;6&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m6&quot;</span>,</span>
<span id="cb9-1553"><a href="#cb9-1553"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;1&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f1&quot;</span>,</span>
<span id="cb9-1554"><a href="#cb9-1554"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;2&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f2&quot;</span>,</span>
<span id="cb9-1555"><a href="#cb9-1555"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;3&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f3&quot;</span>,</span>
<span id="cb9-1556"><a href="#cb9-1556"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;4&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f4&quot;</span>,</span>
<span id="cb9-1557"><a href="#cb9-1557"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;4&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f4&quot;</span>,</span>
<span id="cb9-1558"><a href="#cb9-1558"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;5&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f5&quot;</span>,</span>
<span id="cb9-1559"><a href="#cb9-1559"></a>                                       (age_cat <span class="op">==</span><span class="st"> &quot;6&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f6&quot;</span>,</span>
<span id="cb9-1560"><a href="#cb9-1560"></a>                                       <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;missing&quot;</span></span>
<span id="cb9-1561"><a href="#cb9-1561"></a>                                  ))</span>
<span id="cb9-1562"><a href="#cb9-1562"></a></span>
<span id="cb9-1563"><a href="#cb9-1563"></a><span class="co">#ISSP2012esim1.dat %&gt;% tableX(ga,ga2) # tarkistus</span></span>
<span id="cb9-1564"><a href="#cb9-1564"></a><span class="co"># muuttujien tarkistuksia 19.9.2018</span></span>
<span id="cb9-1565"><a href="#cb9-1565"></a><span class="co"># str(ISSP2012esim1b.dat$ga) # chr-muuttuja, mutta toimii (4.2.20)</span></span>
<span id="cb9-1566"><a href="#cb9-1566"></a></span>
<span id="cb9-1567"><a href="#cb9-1567"></a><span class="co">#Tulostetaan taulukkoina ga - muuttuja</span></span>
<span id="cb9-1568"><a href="#cb9-1568"></a></span>
<span id="cb9-1569"><a href="#cb9-1569"></a><span class="co">#ISSP2012esim1b.dat %&gt;% tableX(maa,ga,type = &quot;count&quot;) %&gt;%</span></span>
<span id="cb9-1570"><a href="#cb9-1570"></a><span class="co">#kable(digits = 2, caption = &quot;Ikäluokka ja sukupuoli ga&quot;)</span></span>
<span id="cb9-1571"><a href="#cb9-1571"></a></span>
<span id="cb9-1572"><a href="#cb9-1572"></a><span class="co">#ISSP2012esim1b.dat %&gt;% tableX(maa,ga,type = &quot;row_perc&quot;) %&gt;%</span></span>
<span id="cb9-1573"><a href="#cb9-1573"></a><span class="co">#kable(digits = 2, caption = &quot;ga: suhteelliset frekvenssit&quot;)</span></span>
<span id="cb9-1574"><a href="#cb9-1574"></a></span>
<span id="cb9-1575"><a href="#cb9-1575"></a></span>
<span id="cb9-1576"><a href="#cb9-1576"></a>gaTestCA1 &lt;-<span class="st"> </span><span class="kw">ca</span>(<span class="op">~</span>ga <span class="op">+</span><span class="st"> </span>Q1b,ISSP2012esim1b.dat)</span>
<span id="cb9-1577"><a href="#cb9-1577"></a></span>
<span id="cb9-1578"><a href="#cb9-1578"></a></span>
<span id="cb9-1579"><a href="#cb9-1579"></a><span class="co"># Maapisteiden pääkoordinaatit janojen piirtämiseen</span></span>
<span id="cb9-1580"><a href="#cb9-1580"></a></span>
<span id="cb9-1581"><a href="#cb9-1581"></a>gaTestCA1.rpc &lt;-<span class="st"> </span>gaTestCA1<span class="op">$</span>rowcoord <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(gaTestCA1<span class="op">$</span>sv)</span>
<span id="cb9-1582"><a href="#cb9-1582"></a></span>
<span id="cb9-1583"><a href="#cb9-1583"></a><span class="co"># par(cex = 0.6)</span></span>
<span id="cb9-1584"><a href="#cb9-1584"></a><span class="kw">plot</span>(gaTestCA1, <span class="dt">main =</span> <span class="st">&quot;symmetrinen kartta, m = mies, f = nainen&quot;</span>,</span>
<span id="cb9-1585"><a href="#cb9-1585"></a>     <span class="dt">sub =</span> <span class="st">&quot;1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 tai vanhempi &quot;</span>)</span>
<span id="cb9-1586"><a href="#cb9-1586"></a><span class="co"># naiset</span></span>
<span id="cb9-1587"><a href="#cb9-1587"></a><span class="kw">lines</span>(gaTestCA1.rpc[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span>],gaTestCA1.rpc[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">2</span>])</span>
<span id="cb9-1588"><a href="#cb9-1588"></a><span class="co">#miehet</span></span>
<span id="cb9-1589"><a href="#cb9-1589"></a><span class="kw">lines</span>(gaTestCA1.rpc[<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">1</span>],gaTestCA1.rpc[<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">2</span>], <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb9-1590"><a href="#cb9-1590"></a></span>
<span id="cb9-1591"><a href="#cb9-1591"></a></span>
<span id="cb9-1592"><a href="#cb9-1592"></a></span>
<span id="cb9-1593"><a href="#cb9-1593"></a><span class="kw">summary</span>(gaTestCA1)</span>
<span id="cb9-1594"><a href="#cb9-1594"></a></span>
<span id="cb9-1595"><a href="#cb9-1595"></a>ISSP2012esim1b.dat &lt;-<span class="st"> </span><span class="kw">mutate</span>(ISSP2012esim1b.dat,</span>
<span id="cb9-1596"><a href="#cb9-1596"></a>                             <span class="dt">maaga =</span> <span class="kw">paste</span>(maa, ga, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb9-1597"><a href="#cb9-1597"></a></span>
<span id="cb9-1598"><a href="#cb9-1598"></a><span class="co"># tarkistus, muunnos ok</span></span>
<span id="cb9-1599"><a href="#cb9-1599"></a><span class="co"># ISSP2012esim1b.dat %&gt;% tableX(maa, maaga)</span></span>
<span id="cb9-1600"><a href="#cb9-1600"></a><span class="co"># head(ISSP2012esim2.dat)</span></span>
<span id="cb9-1601"><a href="#cb9-1601"></a><span class="co"># str(ISSP2012esim2.dat)</span></span>
<span id="cb9-1602"><a href="#cb9-1602"></a></span>
<span id="cb9-1603"><a href="#cb9-1603"></a></span>
<span id="cb9-1604"><a href="#cb9-1604"></a>maagaCA1 &lt;-<span class="st"> </span><span class="kw">ca</span>(<span class="op">~</span>maaga <span class="op">+</span><span class="st"> </span>Q1b,ISSP2012esim1b.dat)</span>
<span id="cb9-1605"><a href="#cb9-1605"></a></span>
<span id="cb9-1606"><a href="#cb9-1606"></a></span>
<span id="cb9-1607"><a href="#cb9-1607"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb9-1608"><a href="#cb9-1608"></a><span class="kw">plot</span>(maagaCA1, <span class="dt">main =</span> <span class="st">&quot;symmetrinen kartta 1&quot;</span>,</span>
<span id="cb9-1609"><a href="#cb9-1609"></a>                <span class="dt">sub =</span> <span class="st">&quot;cex=0.5&quot;</span>)</span>
<span id="cb9-1610"><a href="#cb9-1610"></a></span>
<span id="cb9-1611"><a href="#cb9-1611"></a></span>
<span id="cb9-1612"><a href="#cb9-1612"></a><span class="co"># print(maagaCA1)</span></span>
<span id="cb9-1613"><a href="#cb9-1613"></a></span>
<span id="cb9-1614"><a href="#cb9-1614"></a><span class="kw">summary</span>(maagaCA1)</span>
<span id="cb9-1615"><a href="#cb9-1615"></a></span>
<span id="cb9-1616"><a href="#cb9-1616"></a></span>
<span id="cb9-1617"><a href="#cb9-1617"></a><span class="co"># Osajoukon CA: Tanska, Saksa ja Suomi</span></span>
<span id="cb9-1618"><a href="#cb9-1618"></a>maagaCA2sub2 &lt;-<span class="st"> </span><span class="kw">ca</span>(<span class="op">~</span>maaga <span class="op">+</span><span class="st"> </span>Q1b,ISSP2012esim1b.dat,<span class="dt">subsetrow =</span> <span class="dv">25</span><span class="op">:</span><span class="dv">60</span>)</span>
<span id="cb9-1619"><a href="#cb9-1619"></a></span>
<span id="cb9-1620"><a href="#cb9-1620"></a></span>
<span id="cb9-1621"><a href="#cb9-1621"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb9-1622"><a href="#cb9-1622"></a><span class="kw">plot</span>(maagaCA2sub2, <span class="dt">main =</span> <span class="st">&quot;Q1b: Lapsi kärsii jos äiti käy töissä&quot;</span>,</span>
<span id="cb9-1623"><a href="#cb9-1623"></a>     <span class="dt">sub =</span> <span class="st">&quot;symmetrinen kartta - osajoukko Tanska, Saksa ja Suomi)&quot;</span></span>
<span id="cb9-1624"><a href="#cb9-1624"></a>   )</span>
<span id="cb9-1625"><a href="#cb9-1625"></a></span>
<span id="cb9-1626"><a href="#cb9-1626"></a></span>
<span id="cb9-1627"><a href="#cb9-1627"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb9-1628"><a href="#cb9-1628"></a><span class="kw">plot</span>(maagaCA2sub2, <span class="dt">map =</span> <span class="st">&quot;rowgreen&quot;</span>,</span>
<span id="cb9-1629"><a href="#cb9-1629"></a>     <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1630"><a href="#cb9-1630"></a>     <span class="dt">contrib =</span><span class="kw">c</span>(<span class="st">&quot;relative&quot;</span>, <span class="st">&quot;absolute&quot;</span>),</span>
<span id="cb9-1631"><a href="#cb9-1631"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1632"><a href="#cb9-1632"></a>     <span class="dt">main =</span> <span class="st">&quot;Kontribuutiokartta: sarakkeiden(abs.) ja rivien(rel.) värisävy&quot;</span>,</span>
<span id="cb9-1633"><a href="#cb9-1633"></a>     <span class="dt">sub =</span> <span class="st">&quot;massat pisteiden kokoina, cex=0.06&quot;</span></span>
<span id="cb9-1634"><a href="#cb9-1634"></a>      )</span>
<span id="cb9-1635"><a href="#cb9-1635"></a></span>
<span id="cb9-1636"><a href="#cb9-1636"></a><span class="co"># ca-tulosobjekti maagaCA2sub2, DK DE FI</span></span>
<span id="cb9-1637"><a href="#cb9-1637"></a></span>
<span id="cb9-1638"><a href="#cb9-1638"></a>maagaLinesDKDEFI &lt;-<span class="st"> </span><span class="kw">cacoord</span>(maagaCA2sub2, <span class="dt">type =</span> <span class="st">&quot;symmetric&quot;</span>)</span>
<span id="cb9-1639"><a href="#cb9-1639"></a>maagaLinesDKDEFI &lt;-<span class="st"> </span>maagaLinesDKDEFI<span class="op">$</span>rows[ , <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb9-1640"><a href="#cb9-1640"></a><span class="co"># maagaLinesDKDEFI # tarkistus</span></span>
<span id="cb9-1641"><a href="#cb9-1641"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb9-1642"><a href="#cb9-1642"></a><span class="kw">plot</span>(maagaCA2sub2,</span>
<span id="cb9-1643"><a href="#cb9-1643"></a>     <span class="dt">sub =</span> <span class="st">&quot;symmetrinen kartta - Tanska, Saksa ja Suomi (subset ca)&quot;</span>)</span>
<span id="cb9-1644"><a href="#cb9-1644"></a><span class="kw">lines</span>(maagaLinesDKDEFI[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span>],maagaLinesDKDEFI[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co">#DEf</span></span>
<span id="cb9-1645"><a href="#cb9-1645"></a><span class="kw">lines</span>(maagaLinesDKDEFI[<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">1</span>],maagaLinesDKDEFI[<span class="dv">7</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  <span class="co">#DEm</span></span>
<span id="cb9-1646"><a href="#cb9-1646"></a><span class="kw">lines</span>(maagaLinesDKDEFI[<span class="dv">13</span><span class="op">:</span><span class="dv">18</span>,<span class="dv">1</span>],maagaLinesDKDEFI[<span class="dv">13</span><span class="op">:</span><span class="dv">18</span>,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co">#DKf</span></span>
<span id="cb9-1647"><a href="#cb9-1647"></a><span class="kw">lines</span>(maagaLinesDKDEFI[<span class="dv">19</span><span class="op">:</span><span class="dv">24</span>,<span class="dv">1</span>],maagaLinesDKDEFI[<span class="dv">19</span><span class="op">:</span><span class="dv">24</span>,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  <span class="co">#DKm</span></span>
<span id="cb9-1648"><a href="#cb9-1648"></a><span class="kw">lines</span>(maagaLinesDKDEFI[<span class="dv">25</span><span class="op">:</span><span class="dv">30</span>,<span class="dv">1</span>],maagaLinesDKDEFI[<span class="dv">25</span><span class="op">:</span><span class="dv">30</span>,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co">#FIf</span></span>
<span id="cb9-1649"><a href="#cb9-1649"></a><span class="kw">lines</span>(maagaLinesDKDEFI[<span class="dv">31</span><span class="op">:</span><span class="dv">36</span>,<span class="dv">1</span>],maagaLinesDKDEFI[<span class="dv">31</span><span class="op">:</span><span class="dv">36</span>,<span class="dv">2</span>], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  <span class="co">#FIm</span></span>
<span id="cb9-1650"><a href="#cb9-1650"></a></span>
<span id="cb9-1651"><a href="#cb9-1651"></a></span>
<span id="cb9-1652"><a href="#cb9-1652"></a><span class="co"># Tarkastetaan numeeriset tulokset</span></span>
<span id="cb9-1653"><a href="#cb9-1653"></a><span class="kw">summary</span>(maagaCA2sub2)</span>
<span id="cb9-1654"><a href="#cb9-1654"></a></span>
<span id="cb9-1655"><a href="#cb9-1655"></a><span class="co"># Jos suhteeelinen inertia kaikilla rivelillä sama</span></span>
<span id="cb9-1656"><a href="#cb9-1656"></a><span class="co"># 1000/36 = 28</span></span>
<span id="cb9-1657"><a href="#cb9-1657"></a></span>
<span id="cb9-1658"><a href="#cb9-1658"></a></span>
<span id="cb9-1659"><a href="#cb9-1659"></a><span class="co"># Belgia, Bulgaria ja Unkari analysoidaan tiiviisti</span></span>
<span id="cb9-1660"><a href="#cb9-1660"></a><span class="co"># Belgia on vähän välitapaus Bulgarian ja Unkarin ja kolmen ensimmäisen maan</span></span>
<span id="cb9-1661"><a href="#cb9-1661"></a><span class="co"># kanssa. Kokeiluja voi tehdä neljällä maaryhmällä, kuvan lukukelpoisuus</span></span>
<span id="cb9-1662"><a href="#cb9-1662"></a><span class="co"># ratkaisee.</span></span>
<span id="cb9-1663"><a href="#cb9-1663"></a></span>
<span id="cb9-1664"><a href="#cb9-1664"></a><span class="co">#BGHUsubset &lt;- c(13:24,61:72)</span></span>
<span id="cb9-1665"><a href="#cb9-1665"></a><span class="co">#BEDEDKFIsubset &lt;- c(1:12, 25:36, 37:48, 49:60)</span></span>
<span id="cb9-1666"><a href="#cb9-1666"></a><span class="co">#DEDKFIsubset &lt;- c(25:36, 37:48, 49:60)</span></span>
<span id="cb9-1667"><a href="#cb9-1667"></a></span>
<span id="cb9-1668"><a href="#cb9-1668"></a>BEBGHUsubset &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>,<span class="dv">13</span><span class="op">:</span><span class="dv">24</span>,<span class="dv">61</span><span class="op">:</span><span class="dv">72</span>)</span>
<span id="cb9-1669"><a href="#cb9-1669"></a>maagaCA2sub3 &lt;-<span class="st"> </span><span class="kw">ca</span>(<span class="op">~</span>maaga <span class="op">+</span><span class="st"> </span>Q1b,ISSP2012esim1b.dat,<span class="dt">subsetrow =</span> BEBGHUsubset)</span>
<span id="cb9-1670"><a href="#cb9-1670"></a></span>
<span id="cb9-1671"><a href="#cb9-1671"></a></span>
<span id="cb9-1672"><a href="#cb9-1672"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb9-1673"><a href="#cb9-1673"></a><span class="kw">plot</span>(maagaCA2sub3, </span>
<span id="cb9-1674"><a href="#cb9-1674"></a>     <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1675"><a href="#cb9-1675"></a>     <span class="dt">contrib =</span><span class="kw">c</span>(<span class="st">&quot;relative&quot;</span>, <span class="st">&quot;absolute&quot;</span>),</span>
<span id="cb9-1676"><a href="#cb9-1676"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">FALSE</span>),</span>
<span id="cb9-1677"><a href="#cb9-1677"></a>     <span class="dt">main =</span> <span class="st">&quot;symmetrinen kartta: sarakkeiden ja rivien suhteelliset kontribuutiot värisävynä &quot;</span>,</span>
<span id="cb9-1678"><a href="#cb9-1678"></a>     <span class="dt">sub =</span> <span class="st">&quot;massat pisteiden kokoina, cex=0.06&quot;</span></span>
<span id="cb9-1679"><a href="#cb9-1679"></a>      )</span>
<span id="cb9-1680"><a href="#cb9-1680"></a></span>
<span id="cb9-1681"><a href="#cb9-1681"></a></span>
<span id="cb9-1682"><a href="#cb9-1682"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb9-1683"><a href="#cb9-1683"></a><span class="kw">plot</span>(maagaCA2sub3, <span class="dt">map =</span> <span class="st">&quot;rowgreen&quot;</span>,</span>
<span id="cb9-1684"><a href="#cb9-1684"></a>     <span class="dt">mass =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1685"><a href="#cb9-1685"></a>     <span class="dt">contrib =</span><span class="kw">c</span>(<span class="st">&quot;relative&quot;</span>, <span class="st">&quot;absolute&quot;</span>),</span>
<span id="cb9-1686"><a href="#cb9-1686"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1687"><a href="#cb9-1687"></a>     <span class="dt">main =</span> <span class="st">&quot;Kontribuutiokartta: sarakkeiden(abs.) ja rivien(abs.) värisävy&quot;</span>,</span>
<span id="cb9-1688"><a href="#cb9-1688"></a>     <span class="dt">sub =</span> <span class="st">&quot;massat pisteiden kokoina, cex=0.06&quot;</span></span>
<span id="cb9-1689"><a href="#cb9-1689"></a>      )</span>
<span id="cb9-1690"><a href="#cb9-1690"></a></span>
<span id="cb9-1691"><a href="#cb9-1691"></a></span>
<span id="cb9-1692"><a href="#cb9-1692"></a><span class="co"># Vilkaistaa numeerisia tuloksia, kopioidaan tekstiin jos on tarpeen</span></span>
<span id="cb9-1693"><a href="#cb9-1693"></a><span class="co"># maagaCA2sub3</span></span>
<span id="cb9-1694"><a href="#cb9-1694"></a> <span class="kw">summary</span>(maagaCA2sub3)</span>
<span id="cb9-1695"><a href="#cb9-1695"></a></span>
<span id="cb9-1696"><a href="#cb9-1696"></a><span class="co"># kahden osaratkaisun kokonaisinertia</span></span>
<span id="cb9-1697"><a href="#cb9-1697"></a></span>
<span id="cb9-1698"><a href="#cb9-1698"></a><span class="co"># 0.143551 + 0.119602 = 0.263153</span></span>
<span id="cb9-1699"><a href="#cb9-1699"></a><span class="co"># koko datalla 0.263154</span></span>
<span id="cb9-1700"><a href="#cb9-1700"></a></span>
<span id="cb9-1701"><a href="#cb9-1701"></a></span>
<span id="cb9-1702"><a href="#cb9-1702"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/stacked1.png&#39;</span>)</span>
<span id="cb9-1703"><a href="#cb9-1703"></a></span>
<span id="cb9-1704"><a href="#cb9-1704"></a></span>
<span id="cb9-1705"><a href="#cb9-1705"></a><span class="co"># Data</span></span>
<span id="cb9-1706"><a href="#cb9-1706"></a>ISSP2012Concat1jh.dat &lt;-<span class="st"> </span><span class="kw">select</span>(ISSP2012esim1b.dat, Q1b, maa,sp, age_cat)</span>
<span id="cb9-1707"><a href="#cb9-1707"></a></span>
<span id="cb9-1708"><a href="#cb9-1708"></a><span class="co"># mjca-funktiota -&gt;  Burt-matriisi</span></span>
<span id="cb9-1709"><a href="#cb9-1709"></a>Concat1jh.Burt &lt;-<span class="st"> </span><span class="kw">mjca</span>(ISSP2012Concat1jh.dat, <span class="dt">ps=</span><span class="st">&quot;&quot;</span>)<span class="op">$</span>Burt</span>
<span id="cb9-1710"><a href="#cb9-1710"></a></span>
<span id="cb9-1711"><a href="#cb9-1711"></a><span class="co"># Burt-matriisi symmetrinen</span></span>
<span id="cb9-1712"><a href="#cb9-1712"></a><span class="co">#dim(Concat1jh.Burt)</span></span>
<span id="cb9-1713"><a href="#cb9-1713"></a><span class="co"># 19 x 19</span></span>
<span id="cb9-1714"><a href="#cb9-1714"></a><span class="co">#rownames(Concat1jh.Burt)</span></span>
<span id="cb9-1715"><a href="#cb9-1715"></a><span class="co">#[1] &quot;Q1bS&quot;     &quot;Q1bs&quot;     &quot;Q1b?&quot;     &quot;Q1be&quot;     &quot;Q1bE&quot;     &quot;maaBE&quot;    &quot;maaBG&quot;    &quot;maaDE&quot;    &quot;maaDK&quot;</span></span>
<span id="cb9-1716"><a href="#cb9-1716"></a><span class="co">#[10] &quot;maaFI&quot;    &quot;maaHU&quot;    &quot;spm&quot;      &quot;spf&quot;      &quot;age_cat1&quot; &quot;age_cat2&quot; &quot;age_cat3&quot; &quot;age_cat4&quot; &quot;age_cat5&quot;</span></span>
<span id="cb9-1717"><a href="#cb9-1717"></a><span class="co">#[19] &quot;age_cat6&quot;</span></span>
<span id="cb9-1718"><a href="#cb9-1718"></a></span>
<span id="cb9-1719"><a href="#cb9-1719"></a><span class="co"># maat - vastaukset</span></span>
<span id="cb9-1720"><a href="#cb9-1720"></a>ISSP2012Concat2jh.dat &lt;-<span class="st"> </span>Concat1jh.Burt[<span class="dv">6</span><span class="op">:</span><span class="dv">11</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb9-1721"><a href="#cb9-1721"></a><span class="co"># ISSP2012Concat2jh.dat</span></span>
<span id="cb9-1722"><a href="#cb9-1722"></a><span class="co"># sukupuoli ja vastaukset</span></span>
<span id="cb9-1723"><a href="#cb9-1723"></a>ISSP2012Concat2jh.dat &lt;-<span class="st"> </span><span class="kw">rbind</span>(ISSP2012Concat2jh.dat, Concat1jh.Burt[<span class="dv">12</span><span class="op">:</span><span class="dv">13</span> ,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb9-1724"><a href="#cb9-1724"></a><span class="co"># ISSP2012Concat2jh.dat</span></span>
<span id="cb9-1725"><a href="#cb9-1725"></a><span class="co"># ikäluokka ja vastaukset</span></span>
<span id="cb9-1726"><a href="#cb9-1726"></a>ISSP2012Concat2jh.dat &lt;-<span class="st"> </span><span class="kw">rbind</span>(ISSP2012Concat2jh.dat, Concat1jh.Burt[<span class="dv">14</span><span class="op">:</span><span class="dv">19</span> ,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb9-1727"><a href="#cb9-1727"></a><span class="co"># ISSP2012Concat2jh.dat</span></span>
<span id="cb9-1728"><a href="#cb9-1728"></a></span>
<span id="cb9-1729"><a href="#cb9-1729"></a>Concat1jh.CA1 &lt;-<span class="st"> </span><span class="kw">ca</span>(ISSP2012Concat2jh.dat)</span>
<span id="cb9-1730"><a href="#cb9-1730"></a></span>
<span id="cb9-1731"><a href="#cb9-1731"></a></span>
<span id="cb9-1732"><a href="#cb9-1732"></a><span class="co"># Käännetään kuva x-akselin ympäri</span></span>
<span id="cb9-1733"><a href="#cb9-1733"></a>Concat1jh.CA1<span class="op">$</span>rowcoord[, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="op">-</span>Concat1jh.CA1<span class="op">$</span>rowcoord[, <span class="dv">2</span>]</span>
<span id="cb9-1734"><a href="#cb9-1734"></a>Concat1jh.CA1<span class="op">$</span>colcoord[, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="op">-</span>Concat1jh.CA1<span class="op">$</span>colcoord[, <span class="dv">2</span>]</span>
<span id="cb9-1735"><a href="#cb9-1735"></a></span>
<span id="cb9-1736"><a href="#cb9-1736"></a><span class="co"># Siistitään muuttujien nimet</span></span>
<span id="cb9-1737"><a href="#cb9-1737"></a>Concat1jh.CA1<span class="op">$</span>colnames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;?&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb9-1738"><a href="#cb9-1738"></a>Concat1jh.CA1<span class="op">$</span>rownames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BE&quot;</span>, <span class="st">&quot;BG&quot;</span>, <span class="st">&quot;DE&quot;</span>, <span class="st">&quot;DK&quot;</span>, <span class="st">&quot;FI&quot;</span>, <span class="st">&quot;HU&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;f&quot;</span>,</span>
<span id="cb9-1739"><a href="#cb9-1739"></a>                            <span class="st">&quot;a1&quot;</span>, <span class="st">&quot;a2&quot;</span>, <span class="st">&quot;a3&quot;</span>, <span class="st">&quot;a4&quot;</span>, <span class="st">&quot;a5&quot;</span>, <span class="st">&quot;a6&quot;</span>)</span>
<span id="cb9-1740"><a href="#cb9-1740"></a></span>
<span id="cb9-1741"><a href="#cb9-1741"></a></span>
<span id="cb9-1742"><a href="#cb9-1742"></a><span class="co"># pisteiden kasautumien haittaa haittaa tulkintaa</span></span>
<span id="cb9-1743"><a href="#cb9-1743"></a></span>
<span id="cb9-1744"><a href="#cb9-1744"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.6</span>) </span>
<span id="cb9-1745"><a href="#cb9-1745"></a><span class="kw">plot</span>(Concat1jh.CA1,</span>
<span id="cb9-1746"><a href="#cb9-1746"></a>     <span class="dt">main =</span> <span class="st">&quot;Pinottu taulukko - symmetrinen kartta&quot;</span>,</span>
<span id="cb9-1747"><a href="#cb9-1747"></a>     <span class="dt">sub =</span> <span class="st">&quot;ikäluokat a1-a6, m = miehet, f = naiset&quot;</span></span>
<span id="cb9-1748"><a href="#cb9-1748"></a>     )</span>
<span id="cb9-1749"><a href="#cb9-1749"></a></span>
<span id="cb9-1750"><a href="#cb9-1750"></a></span>
<span id="cb9-1751"><a href="#cb9-1751"></a><span class="kw">summary</span>(Concat1jh.CA1)</span>
<span id="cb9-1752"><a href="#cb9-1752"></a></span>
<span id="cb9-1753"><a href="#cb9-1753"></a><span class="co"># 14 riviä, inertiakontribuution keskiarvo</span></span>
<span id="cb9-1754"><a href="#cb9-1754"></a><span class="co"># 1000/14 = 71 </span></span>
<span id="cb9-1755"><a href="#cb9-1755"></a></span>
<span id="cb9-1756"><a href="#cb9-1756"></a></span>
<span id="cb9-1757"><a href="#cb9-1757"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb9-1758"><a href="#cb9-1758"></a><span class="kw">plot</span>(Concat1jh.CA1, <span class="dt">map =</span> <span class="st">&quot;rowgreen&quot;</span>,</span>
<span id="cb9-1759"><a href="#cb9-1759"></a>     <span class="co">#mass = c(TRUE, TRUE) ei oikein erotu kuvassa</span></span>
<span id="cb9-1760"><a href="#cb9-1760"></a>     <span class="dt">contrib =</span><span class="kw">c</span>(<span class="st">&quot;relative&quot;</span>, <span class="st">&quot;absolute&quot;</span>),</span>
<span id="cb9-1761"><a href="#cb9-1761"></a>     <span class="dt">arrows =</span> <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb9-1762"><a href="#cb9-1762"></a>     <span class="dt">main =</span> <span class="st">&quot;Pinottu taulukko, kontribuutiokartta (sarakkeet absoluutinen, rivit suhteellinen)&quot;</span>,</span>
<span id="cb9-1763"><a href="#cb9-1763"></a>     <span class="dt">sub =</span>  <span class="st">&quot;taustamuuttujat a1-a6 ikäluokat, m = miehet, f = naiset&quot;</span></span>
<span id="cb9-1764"><a href="#cb9-1764"></a>     )</span>
<span id="cb9-1765"><a href="#cb9-1765"></a></span>
<span id="cb9-1766"><a href="#cb9-1766"></a><span class="co"># Tätä dataa ei käytetä - pelkät kysymykset</span></span>
<span id="cb9-1767"><a href="#cb9-1767"></a><span class="co"># str(ISSP2012jh1d.dat) - luotu skripteissä G1_1_data2.Rmd ja G1_1_data_fct1.Rmd</span></span>
<span id="cb9-1768"><a href="#cb9-1768"></a><span class="co"># Tarkistukset näkyvät Galkussa - tässä ei tulosteta</span></span>
<span id="cb9-1769"><a href="#cb9-1769"></a><span class="co"># Kommentoidaan pois tarkistuksia (14.11.2020)</span></span>
<span id="cb9-1770"><a href="#cb9-1770"></a><span class="co">#Valitaan muuttujat joissa puuttuva tieto on koodattu muuttujan arvoksi</span></span>
<span id="cb9-1771"><a href="#cb9-1771"></a></span>
<span id="cb9-1772"><a href="#cb9-1772"></a>MCAvars1 &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;Q1am&quot;</span>,<span class="st">&quot;Q1bm&quot;</span>, <span class="st">&quot;Q1cm&quot;</span>, <span class="st">&quot;Q1dm&quot;</span>,<span class="st">&quot;Q1em&quot;</span>,<span class="st">&quot;Q2am&quot;</span>,<span class="st">&quot;Q2bm&quot;</span>,<span class="st">&quot;edum&quot;</span>,</span>
<span id="cb9-1773"><a href="#cb9-1773"></a>                 <span class="st">&quot;sostam&quot;</span>, <span class="st">&quot;urbrum&quot;</span>, <span class="st">&quot;maa&quot;</span>, <span class="st">&quot;ika&quot;</span>, <span class="st">&quot;sp&quot;</span> )</span>
<span id="cb9-1774"><a href="#cb9-1774"></a></span>
<span id="cb9-1775"><a href="#cb9-1775"></a>MCAdata1jh.dat &lt;-<span class="st"> </span>ISSP2012jh1d.dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">all_of</span>(MCAvars1))</span>
<span id="cb9-1776"><a href="#cb9-1776"></a></span>
<span id="cb9-1777"><a href="#cb9-1777"></a><span class="co">#dim(MCAdata1jh.dat)</span></span>
<span id="cb9-1778"><a href="#cb9-1778"></a><span class="co"># names(MCAdata1jh.dat)</span></span>
<span id="cb9-1779"><a href="#cb9-1779"></a></span>
<span id="cb9-1780"><a href="#cb9-1780"></a><span class="co"># luodaan ikaluokka-muuttuja ja ikäluokka-sukupuoli - muuttuja</span></span>
<span id="cb9-1781"><a href="#cb9-1781"></a><span class="co">#age_cat</span></span>
<span id="cb9-1782"><a href="#cb9-1782"></a><span class="co">#ikä 1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 and older</span></span>
<span id="cb9-1783"><a href="#cb9-1783"></a></span>
<span id="cb9-1784"><a href="#cb9-1784"></a>MCAdata1jh.dat &lt;-<span class="st"> </span><span class="kw">mutate</span>(MCAdata1jh.dat, <span class="dt">age_cat =</span> <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">15</span><span class="op">:</span><span class="dv">25</span>, <span class="st">&quot;1&quot;</span>,</span>
<span id="cb9-1785"><a href="#cb9-1785"></a>                                <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">26</span><span class="op">:</span><span class="dv">35</span>, <span class="st">&quot;2&quot;</span>,</span>
<span id="cb9-1786"><a href="#cb9-1786"></a>                                <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">36</span><span class="op">:</span><span class="dv">45</span>, <span class="st">&quot;3&quot;</span>,</span>
<span id="cb9-1787"><a href="#cb9-1787"></a>                                <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">46</span><span class="op">:</span><span class="dv">55</span>, <span class="st">&quot;4&quot;</span>,</span>
<span id="cb9-1788"><a href="#cb9-1788"></a>                                <span class="kw">ifelse</span>(ika <span class="op">%in%</span><span class="st"> </span><span class="dv">56</span><span class="op">:</span><span class="dv">65</span>, <span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>))))))</span>
<span id="cb9-1789"><a href="#cb9-1789"></a></span>
<span id="cb9-1790"><a href="#cb9-1790"></a><span class="co"># str(MCAdata1jh.dat$age_cat)</span></span>
<span id="cb9-1791"><a href="#cb9-1791"></a></span>
<span id="cb9-1792"><a href="#cb9-1792"></a>MCAdata1jh.dat &lt;-<span class="st"> </span>MCAdata1jh.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1793"><a href="#cb9-1793"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">age_cat =</span> <span class="kw">as_factor</span>(age_cat))</span>
<span id="cb9-1794"><a href="#cb9-1794"></a><span class="co">#tarkastuksia - outo järjestys</span></span>
<span id="cb9-1795"><a href="#cb9-1795"></a><span class="co">#levels(MCAdata1jh.dat$age_cat)</span></span>
<span id="cb9-1796"><a href="#cb9-1796"></a><span class="co"># str(MCAdata1jh.dat$age_cat)</span></span>
<span id="cb9-1797"><a href="#cb9-1797"></a></span>
<span id="cb9-1798"><a href="#cb9-1798"></a>MCAdata1jh.dat&lt;-<span class="st"> </span>MCAdata1jh.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1799"><a href="#cb9-1799"></a><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">age_cat =</span> <span class="kw">fct_relevel</span>(age_cat,</span>
<span id="cb9-1800"><a href="#cb9-1800"></a>                                   <span class="st">&quot;1&quot;</span>,</span>
<span id="cb9-1801"><a href="#cb9-1801"></a>                                   <span class="st">&quot;2&quot;</span>,</span>
<span id="cb9-1802"><a href="#cb9-1802"></a>                                   <span class="st">&quot;3&quot;</span>,</span>
<span id="cb9-1803"><a href="#cb9-1803"></a>                                   <span class="st">&quot;4&quot;</span>,</span>
<span id="cb9-1804"><a href="#cb9-1804"></a>                                   <span class="st">&quot;5&quot;</span>,</span>
<span id="cb9-1805"><a href="#cb9-1805"></a>                                   <span class="st">&quot;6&quot;</span>))</span>
<span id="cb9-1806"><a href="#cb9-1806"></a></span>
<span id="cb9-1807"><a href="#cb9-1807"></a><span class="co"># Tarkistuksia(16.10.20)</span></span>
<span id="cb9-1808"><a href="#cb9-1808"></a></span>
<span id="cb9-1809"><a href="#cb9-1809"></a><span class="co">#MCAdata1jh.dat %&gt;%</span></span>
<span id="cb9-1810"><a href="#cb9-1810"></a><span class="co">#        tableX(maa,age_cat,type = &quot;count&quot;) #%&gt;%</span></span>
<span id="cb9-1811"><a href="#cb9-1811"></a><span class="co">#        #kable(digits = 2, caption = &quot;Ikäluokka age_cat&quot;)</span></span>
<span id="cb9-1812"><a href="#cb9-1812"></a></span>
<span id="cb9-1813"><a href="#cb9-1813"></a><span class="co">#MCAdata1jh.dat %&gt;%</span></span>
<span id="cb9-1814"><a href="#cb9-1814"></a><span class="co">#        tableX(maa,age_cat,type = &quot;row_perc&quot;) #%&gt;%</span></span>
<span id="cb9-1815"><a href="#cb9-1815"></a><span class="co">#        #kable(digits = 2, caption = &quot;age_cat: suhteelliset frekvenssit&quot;)</span></span>
<span id="cb9-1816"><a href="#cb9-1816"></a></span>
<span id="cb9-1817"><a href="#cb9-1817"></a></span>
<span id="cb9-1818"><a href="#cb9-1818"></a><span class="co"># Ikäluokka-sukupuoli - muuttuja</span></span>
<span id="cb9-1819"><a href="#cb9-1819"></a>MCAdata1jh.dat &lt;-<span class="st"> </span><span class="kw">mutate</span>(MCAdata1jh.dat,</span>
<span id="cb9-1820"><a href="#cb9-1820"></a>                             <span class="dt">ga =</span> <span class="kw">case_when</span>((age_cat <span class="op">==</span><span class="st"> &quot;1&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m1&quot;</span>,</span>
<span id="cb9-1821"><a href="#cb9-1821"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;2&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m2&quot;</span>,</span>
<span id="cb9-1822"><a href="#cb9-1822"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;3&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m3&quot;</span>,</span>
<span id="cb9-1823"><a href="#cb9-1823"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;4&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m4&quot;</span>,</span>
<span id="cb9-1824"><a href="#cb9-1824"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;5&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m5&quot;</span>,</span>
<span id="cb9-1825"><a href="#cb9-1825"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;6&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;m&quot;</span>) <span class="op">~</span><span class="st"> &quot;m6&quot;</span>,</span>
<span id="cb9-1826"><a href="#cb9-1826"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;1&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f1&quot;</span>,</span>
<span id="cb9-1827"><a href="#cb9-1827"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;2&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f2&quot;</span>,</span>
<span id="cb9-1828"><a href="#cb9-1828"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;3&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f3&quot;</span>,</span>
<span id="cb9-1829"><a href="#cb9-1829"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;4&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f4&quot;</span>,</span>
<span id="cb9-1830"><a href="#cb9-1830"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;4&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f4&quot;</span>,</span>
<span id="cb9-1831"><a href="#cb9-1831"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;5&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f5&quot;</span>,</span>
<span id="cb9-1832"><a href="#cb9-1832"></a>                                (age_cat <span class="op">==</span><span class="st"> &quot;6&quot;</span>)<span class="op">&amp;</span>(sp <span class="op">==</span><span class="st"> &quot;f&quot;</span>) <span class="op">~</span><span class="st"> &quot;f6&quot;</span>,</span>
<span id="cb9-1833"><a href="#cb9-1833"></a>                                <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;missing&quot;</span></span>
<span id="cb9-1834"><a href="#cb9-1834"></a>                                ))</span>
<span id="cb9-1835"><a href="#cb9-1835"></a></span>
<span id="cb9-1836"><a href="#cb9-1836"></a></span>
<span id="cb9-1837"><a href="#cb9-1837"></a><span class="co">#Sosiaalinen status: oma arvio &quot;Top-Bottom self-placement&quot;</span></span>
<span id="cb9-1838"><a href="#cb9-1838"></a><span class="co">#str(ISSP2012jh1d.dat$sosta)</span></span>
<span id="cb9-1839"><a href="#cb9-1839"></a><span class="co">#str(ISSP2012jh1d.dat$urbru)</span></span>
<span id="cb9-1840"><a href="#cb9-1840"></a><span class="co">#str(ISSP2012jh1d.dat$edu)</span></span>
<span id="cb9-1841"><a href="#cb9-1841"></a><span class="co">#Koulutustaso</span></span>
<span id="cb9-1842"><a href="#cb9-1842"></a><span class="co">#str(ISSP2012jh1d.dat$edu)</span></span>
<span id="cb9-1843"><a href="#cb9-1843"></a></span>
<span id="cb9-1844"><a href="#cb9-1844"></a><span class="co">#Asuipaikka</span></span>
<span id="cb9-1845"><a href="#cb9-1845"></a><span class="co">#str(ISSP2012jh1d.dat$urbru)</span></span>
<span id="cb9-1846"><a href="#cb9-1846"></a></span>
<span id="cb9-1847"><a href="#cb9-1847"></a><span class="co"># Muunnetaan faktorimuuttujia, mahdollisimman lyhyet tunnisteet kategorioille</span></span>
<span id="cb9-1848"><a href="#cb9-1848"></a>MCAdata1jh.dat &lt;-<span class="st"> </span>MCAdata1jh.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1849"><a href="#cb9-1849"></a><span class="kw">mutate</span>(<span class="dt">E =</span> <span class="kw">fct_recode</span>(edum,</span>
<span id="cb9-1850"><a href="#cb9-1850"></a>        <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;No formal education&quot;</span>,</span>
<span id="cb9-1851"><a href="#cb9-1851"></a>        <span class="st">&quot;2&quot;</span> =<span class="st"> &quot;Primary school (elementary school)&quot;</span>,</span>
<span id="cb9-1852"><a href="#cb9-1852"></a>        <span class="st">&quot;3&quot;</span> =<span class="st"> &quot;Lower secondary (secondary completed does not allow entry to university: obligatory school)&quot;</span>,</span>
<span id="cb9-1853"><a href="#cb9-1853"></a>        <span class="st">&quot;4&quot;</span> =<span class="st"> &quot;Upper secondary (programs that allows entry to university&quot;</span>,</span>
<span id="cb9-1854"><a href="#cb9-1854"></a>        <span class="st">&quot;5&quot;</span> =<span class="st"> &quot;Post secondary, non-tertiary (other upper secondary programs toward labour market or technical formation)&quot;</span>,</span>
<span id="cb9-1855"><a href="#cb9-1855"></a>        <span class="st">&quot;6&quot;</span> =<span class="st"> &quot;Lower level tertiary, first stage (also technical schools at a tertiary level)&quot;</span>,</span>
<span id="cb9-1856"><a href="#cb9-1856"></a>        <span class="st">&quot;7&quot;</span> =<span class="st"> &quot;Upper level tertiary (Master, Dr.)&quot;</span>,</span>
<span id="cb9-1857"><a href="#cb9-1857"></a>        <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-1858"><a href="#cb9-1858"></a>       <span class="dt">S =</span> <span class="kw">fct_recode</span>(sostam,</span>
<span id="cb9-1859"><a href="#cb9-1859"></a>         <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;Lowest, Bottom, 01&quot;</span>,</span>
<span id="cb9-1860"><a href="#cb9-1860"></a>         <span class="st">&quot;2&quot;</span> =<span class="st"> &quot;02&quot;</span>,</span>
<span id="cb9-1861"><a href="#cb9-1861"></a>         <span class="st">&quot;3&quot;</span> =<span class="st"> &quot;03&quot;</span>,</span>
<span id="cb9-1862"><a href="#cb9-1862"></a>         <span class="st">&quot;4&quot;</span> =<span class="st"> &quot;04&quot;</span>,</span>
<span id="cb9-1863"><a href="#cb9-1863"></a>         <span class="st">&quot;5&quot;</span> =<span class="st"> &quot;05&quot;</span>,</span>
<span id="cb9-1864"><a href="#cb9-1864"></a>         <span class="st">&quot;6&quot;</span> =<span class="st"> &quot;06&quot;</span>,</span>
<span id="cb9-1865"><a href="#cb9-1865"></a>         <span class="st">&quot;7&quot;</span> =<span class="st"> &quot;07&quot;</span>,</span>
<span id="cb9-1866"><a href="#cb9-1866"></a>         <span class="st">&quot;8&quot;</span> =<span class="st"> &quot;08&quot;</span>,</span>
<span id="cb9-1867"><a href="#cb9-1867"></a>         <span class="st">&quot;9&quot;</span> =<span class="st"> &quot;09&quot;</span>,</span>
<span id="cb9-1868"><a href="#cb9-1868"></a>         <span class="st">&quot;10&quot;</span>=<span class="st"> &quot;Highest, Top, 10&quot;</span>,</span>
<span id="cb9-1869"><a href="#cb9-1869"></a>         <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>),</span>
<span id="cb9-1870"><a href="#cb9-1870"></a>       <span class="dt">U =</span> <span class="kw">fct_recode</span>(urbrum,</span>
<span id="cb9-1871"><a href="#cb9-1871"></a>        <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;A big city&quot;</span>,</span>
<span id="cb9-1872"><a href="#cb9-1872"></a>        <span class="st">&quot;2&quot;</span> =<span class="st"> &quot;The suburbs or outskirts of a big city&quot;</span>,</span>
<span id="cb9-1873"><a href="#cb9-1873"></a>        <span class="st">&quot;3&quot;</span> =<span class="st"> &quot;A town or a small city&quot;</span>,</span>
<span id="cb9-1874"><a href="#cb9-1874"></a>        <span class="st">&quot;4&quot;</span> =<span class="st"> &quot;A country village&quot;</span>,</span>
<span id="cb9-1875"><a href="#cb9-1875"></a>        <span class="st">&quot;5&quot;</span> =<span class="st"> &quot;A farm or home in the country&quot;</span>,</span>
<span id="cb9-1876"><a href="#cb9-1876"></a>        <span class="st">&quot;P&quot;</span> =<span class="st"> &quot;missing&quot;</span>)</span>
<span id="cb9-1877"><a href="#cb9-1877"></a>        )</span>
<span id="cb9-1878"><a href="#cb9-1878"></a></span>
<span id="cb9-1879"><a href="#cb9-1879"></a><span class="co">#names(MCAdata1jh.dat)</span></span>
<span id="cb9-1880"><a href="#cb9-1880"></a><span class="co">#dim(MCAdata1jh.dat)</span></span>
<span id="cb9-1881"><a href="#cb9-1881"></a><span class="co">#MCAdata1jh.dat$E %&gt;% levels()</span></span>
<span id="cb9-1882"><a href="#cb9-1882"></a><span class="co">#MCAdata1jh.dat$S %&gt;% levels()</span></span>
<span id="cb9-1883"><a href="#cb9-1883"></a><span class="co">#MCAdata1jh.dat$U %&gt;% levels()</span></span>
<span id="cb9-1884"><a href="#cb9-1884"></a><span class="co">#MCAdata1jh.dat$age_cat %&gt;% levels()</span></span>
<span id="cb9-1885"><a href="#cb9-1885"></a><span class="co">#str(MCAdata1jh.dat$ga) # toimiikohan - chr-muuttuja? (16.10.20)</span></span>
<span id="cb9-1886"><a href="#cb9-1886"></a></span>
<span id="cb9-1887"><a href="#cb9-1887"></a>MCAdata1jh.dat &lt;-<span class="st"> </span>MCAdata1jh.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1888"><a href="#cb9-1888"></a><span class="kw">mutate</span>(<span class="dt">gaf =</span> <span class="kw">as_factor</span>(ga))</span>
<span id="cb9-1889"><a href="#cb9-1889"></a></span>
<span id="cb9-1890"><a href="#cb9-1890"></a><span class="co">#str(MCAdata1jh.dat$gaf)</span></span>
<span id="cb9-1891"><a href="#cb9-1891"></a><span class="co">#levels(MCAdata1jh.dat$gaf) # järjestyksellä ei liene väliä? (16.10.20)</span></span>
<span id="cb9-1892"><a href="#cb9-1892"></a></span>
<span id="cb9-1893"><a href="#cb9-1893"></a><span class="co"># gaf ja ga: sama järjestys</span></span>
<span id="cb9-1894"><a href="#cb9-1894"></a></span>
<span id="cb9-1895"><a href="#cb9-1895"></a>MCAdata1jh.dat &lt;-<span class="st"> </span>MCAdata1jh.dat <span class="op">%&gt;%</span></span>
<span id="cb9-1896"><a href="#cb9-1896"></a><span class="st">       </span><span class="kw">mutate</span>(<span class="dt">gaf =</span> <span class="kw">fct_relevel</span>(gaf,</span>
<span id="cb9-1897"><a href="#cb9-1897"></a>                                 <span class="st">&quot;f1&quot;</span>,</span>
<span id="cb9-1898"><a href="#cb9-1898"></a>                                 <span class="st">&quot;f2&quot;</span>,</span>
<span id="cb9-1899"><a href="#cb9-1899"></a>                                 <span class="st">&quot;f3&quot;</span>,</span>
<span id="cb9-1900"><a href="#cb9-1900"></a>                                 <span class="st">&quot;f4&quot;</span>,</span>
<span id="cb9-1901"><a href="#cb9-1901"></a>                                 <span class="st">&quot;f5&quot;</span>,</span>
<span id="cb9-1902"><a href="#cb9-1902"></a>                                 <span class="st">&quot;f6&quot;</span>,</span>
<span id="cb9-1903"><a href="#cb9-1903"></a>                                 <span class="st">&quot;m1&quot;</span>,</span>
<span id="cb9-1904"><a href="#cb9-1904"></a>                                 <span class="st">&quot;m2&quot;</span>,</span>
<span id="cb9-1905"><a href="#cb9-1905"></a>                                 <span class="st">&quot;m3&quot;</span>,</span>
<span id="cb9-1906"><a href="#cb9-1906"></a>                                 <span class="st">&quot;m4&quot;</span>,</span>
<span id="cb9-1907"><a href="#cb9-1907"></a>                                 <span class="st">&quot;m5&quot;</span>,</span>
<span id="cb9-1908"><a href="#cb9-1908"></a>                                 <span class="st">&quot;m6&quot;</span>))</span>
<span id="cb9-1909"><a href="#cb9-1909"></a></span>
<span id="cb9-1910"><a href="#cb9-1910"></a><span class="co"># Lopuksi substanssimuuttutien nimet lyhyiksi</span></span>
<span id="cb9-1911"><a href="#cb9-1911"></a></span>
<span id="cb9-1912"><a href="#cb9-1912"></a>MCAdata1jh.dat &lt;-<span class="st"> </span>MCAdata1jh.dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">a1 =</span> Q1am,</span>
<span id="cb9-1913"><a href="#cb9-1913"></a>                                            <span class="dt">b1 =</span> Q1bm,</span>
<span id="cb9-1914"><a href="#cb9-1914"></a>                                            <span class="dt">c1 =</span> Q1cm,</span>
<span id="cb9-1915"><a href="#cb9-1915"></a>                                            <span class="dt">d1 =</span> Q1dm,</span>
<span id="cb9-1916"><a href="#cb9-1916"></a>                                            <span class="dt">e1 =</span> Q1em,</span>
<span id="cb9-1917"><a href="#cb9-1917"></a>                                            <span class="dt">a2 =</span> Q2am,</span>
<span id="cb9-1918"><a href="#cb9-1918"></a>                                            <span class="dt">b2 =</span> Q2bm)</span>
<span id="cb9-1919"><a href="#cb9-1919"></a></span>
<span id="cb9-1920"><a href="#cb9-1920"></a></span>
<span id="cb9-1921"><a href="#cb9-1921"></a></span>
<span id="cb9-1922"><a href="#cb9-1922"></a><span class="co"># Tarkistustuksia datalle</span></span>
<span id="cb9-1923"><a href="#cb9-1923"></a></span>
<span id="cb9-1924"><a href="#cb9-1924"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX (a1, Q1am)</span></span>
<span id="cb9-1925"><a href="#cb9-1925"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX (b1, Q1bm)</span></span>
<span id="cb9-1926"><a href="#cb9-1926"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX (c1, Q1cm)</span></span>
<span id="cb9-1927"><a href="#cb9-1927"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX (d1, Q1dm)</span></span>
<span id="cb9-1928"><a href="#cb9-1928"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX (e1, Q1em)</span></span>
<span id="cb9-1929"><a href="#cb9-1929"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX (a2, Q2am)</span></span>
<span id="cb9-1930"><a href="#cb9-1930"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX (b2, Q2bm)</span></span>
<span id="cb9-1931"><a href="#cb9-1931"></a><span class="co"># MCAdata1jh.dat %&gt;% tableX(gaf, ga)</span></span>
<span id="cb9-1932"><a href="#cb9-1932"></a></span>
<span id="cb9-1933"><a href="#cb9-1933"></a><span class="co"># Perustietoja - TÄSSÄ UUSI PDF-VIRHEILMOITUS 7.11.2020</span></span>
<span id="cb9-1934"><a href="#cb9-1934"></a><span class="co"># Ei tulosteta - kommentoidaan pois</span></span>
<span id="cb9-1935"><a href="#cb9-1935"></a></span>
<span id="cb9-1936"><a href="#cb9-1936"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX (maa,a1, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1937"><a href="#cb9-1937"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX (maa,b1, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1938"><a href="#cb9-1938"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX (maa,c1, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1939"><a href="#cb9-1939"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX (maa,d1, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1940"><a href="#cb9-1940"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX (maa,e1, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1941"><a href="#cb9-1941"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX (maa,a2,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1942"><a href="#cb9-1942"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX (maa,b2,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1943"><a href="#cb9-1943"></a></span>
<span id="cb9-1944"><a href="#cb9-1944"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX(gaf, ga,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1945"><a href="#cb9-1945"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX(maa, age_cat,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1946"><a href="#cb9-1946"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX(maa, gaf,type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1947"><a href="#cb9-1947"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX(maa, S, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1948"><a href="#cb9-1948"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX(maa, U, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1949"><a href="#cb9-1949"></a><span class="co">#MCAdata1jh.dat %&gt;% tableX(maa, E, type = &quot;row_perc&quot;)</span></span>
<span id="cb9-1950"><a href="#cb9-1950"></a></span>
<span id="cb9-1951"><a href="#cb9-1951"></a></span>
<span id="cb9-1952"><a href="#cb9-1952"></a><span class="co">#Puuttuvien tietojen yleiskuva</span></span>
<span id="cb9-1953"><a href="#cb9-1953"></a></span>
<span id="cb9-1954"><a href="#cb9-1954"></a><span class="co"># Puuttuvat tiedot aineistossa - viite datan dokumentointiin jossa taulukot.</span></span>
<span id="cb9-1955"><a href="#cb9-1955"></a><span class="co"># Vaihtelee maittain ja muuttujittain, paljon.</span></span>
<span id="cb9-1956"><a href="#cb9-1956"></a></span>
<span id="cb9-1957"><a href="#cb9-1957"></a><span class="co"># Koko data (G1_1_data2.Rmd - skriptissä valitut muuttujat ja 25 maata)</span></span>
<span id="cb9-1958"><a href="#cb9-1958"></a><span class="co">#</span></span>
<span id="cb9-1959"><a href="#cb9-1959"></a><span class="co">#sum(!complete.cases(ISSP2012jh1d.dat)) = 9455</span></span>
<span id="cb9-1960"><a href="#cb9-1960"></a><span class="co">#dim(ISSP2012jh1d.dat) = 32823</span></span>
<span id="cb9-1961"><a href="#cb9-1961"></a><span class="co">#9455/32823 = 0.2880602</span></span>
<span id="cb9-1962"><a href="#cb9-1962"></a></span>
<span id="cb9-1963"><a href="#cb9-1963"></a><span class="co"># Puuttuvat tiedot valitussa MCA-aineistossa</span></span>
<span id="cb9-1964"><a href="#cb9-1964"></a></span>
<span id="cb9-1965"><a href="#cb9-1965"></a><span class="co">#missingMCAvars1 &lt;-  c(&quot;Q1a&quot;,&quot;Q1b&quot;, &quot;Q1c&quot;, &quot;Q1d&quot;,&quot;Q1e&quot;,&quot;Q2a&quot;,&quot;Q2b&quot;,&quot;edu&quot;,</span></span>
<span id="cb9-1966"><a href="#cb9-1966"></a><span class="co">#                 &quot;sosta&quot;, &quot;urbru&quot;, &quot;maa&quot;, &quot;ika&quot;, &quot;sp&quot; )</span></span>
<span id="cb9-1967"><a href="#cb9-1967"></a><span class="co">#missingTestMCA1.dat &lt;- ISSP2012jh1d.dat %&gt;% select(all_of(missingMCAvars1))</span></span>
<span id="cb9-1968"><a href="#cb9-1968"></a></span>
<span id="cb9-1969"><a href="#cb9-1969"></a><span class="co">#sum(!complete.cases(missingTestMCA1.dat)) = 6101</span></span>
<span id="cb9-1970"><a href="#cb9-1970"></a><span class="co">#dim(missingTestMCA1.dat) = 32823</span></span>
<span id="cb9-1971"><a href="#cb9-1971"></a><span class="co">#6101/32823 = 0.1858758 Puuttellisten havaintojen osuus.</span></span>
<span id="cb9-1972"><a href="#cb9-1972"></a></span>
<span id="cb9-1973"><a href="#cb9-1973"></a><span class="co">#Pelkät kysymykset</span></span>
<span id="cb9-1974"><a href="#cb9-1974"></a></span>
<span id="cb9-1975"><a href="#cb9-1975"></a><span class="co">#missingMCAvars2 &lt;- c(&quot;Q1a&quot;,&quot;Q1b&quot;, &quot;Q1c&quot;, &quot;Q1d&quot;,&quot;Q1e&quot;,&quot;Q2a&quot;,&quot;Q2b&quot;)</span></span>
<span id="cb9-1976"><a href="#cb9-1976"></a><span class="co">#missingTestMCA2.dat &lt;- ISSP2012jh1d.dat %&gt;% select(all_of(missingMCAvars2))</span></span>
<span id="cb9-1977"><a href="#cb9-1977"></a><span class="co">#sum(!complete.cases(missingTestMCA2.dat))</span></span>
<span id="cb9-1978"><a href="#cb9-1978"></a><span class="co"># puuttuvia tietoja 4554</span></span>
<span id="cb9-1979"><a href="#cb9-1979"></a><span class="co"># 4553/32823 = 0.1387137</span></span>
<span id="cb9-1980"><a href="#cb9-1980"></a></span>
<span id="cb9-1981"><a href="#cb9-1981"></a></span>
<span id="cb9-1982"><a href="#cb9-1982"></a><span class="co"># Valitaan data</span></span>
<span id="cb9-1983"><a href="#cb9-1983"></a></span>
<span id="cb9-1984"><a href="#cb9-1984"></a>mcaDat11jh.dat &lt;-<span class="st"> </span>MCAdata1jh.dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(a1,b1,c1, d1, e1,a2,b2)</span>
<span id="cb9-1985"><a href="#cb9-1985"></a><span class="co"># dim(mcaDat11jh.dat)</span></span>
<span id="cb9-1986"><a href="#cb9-1986"></a></span>
<span id="cb9-1987"><a href="#cb9-1987"></a><span class="co">#glimpse(mcaDat11jh.dat)</span></span>
<span id="cb9-1988"><a href="#cb9-1988"></a></span>
<span id="cb9-1989"><a href="#cb9-1989"></a>Qmuuttujat1.mca &lt;-<span class="st"> </span><span class="kw">mjca</span>(mcaDat11jh.dat, <span class="dt">ps=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb9-1990"><a href="#cb9-1990"></a></span>
<span id="cb9-1991"><a href="#cb9-1991"></a><span class="co"># ps=&quot;&quot; muuttujan ja sen kategorian eroitinmerkki</span></span>
<span id="cb9-1992"><a href="#cb9-1992"></a></span>
<span id="cb9-1993"><a href="#cb9-1993"></a></span>
<span id="cb9-1994"><a href="#cb9-1994"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb9-1995"><a href="#cb9-1995"></a><span class="kw">plot.mjca</span>(Qmuuttujat1.mca, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb9-1996"><a href="#cb9-1996"></a>          <span class="dt">main =</span> <span class="st">&quot;Symmetrinen kartta&quot;</span>,</span>
<span id="cb9-1997"><a href="#cb9-1997"></a>          <span class="dt">sub =</span> <span class="st">&quot;Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, vastaukset S-s-?-e-E-P &quot;</span></span>
<span id="cb9-1998"><a href="#cb9-1998"></a>          )</span>
<span id="cb9-1999"><a href="#cb9-1999"></a></span>
<span id="cb9-2000"><a href="#cb9-2000"></a></span>
<span id="cb9-2001"><a href="#cb9-2001"></a></span>
<span id="cb9-2002"><a href="#cb9-2002"></a><span class="kw">par</span>(<span class="dt">cex=</span><span class="fl">0.6</span>)</span>
<span id="cb9-2003"><a href="#cb9-2003"></a><span class="kw">plot.mjca</span>(Qmuuttujat1.mca, <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;all&quot;</span>,<span class="st">&quot;all&quot;</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb9-2004"><a href="#cb9-2004"></a>          <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb9-2005"><a href="#cb9-2005"></a>           <span class="dt">main =</span> <span class="st">&quot;Symmetrinen kartta&quot;</span>,</span>
<span id="cb9-2006"><a href="#cb9-2006"></a>          <span class="dt">sub =</span> <span class="st">&quot;Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b,vastaukset S-s-?-e-E-P, havainnot (n = 32 823)&quot;</span></span>
<span id="cb9-2007"><a href="#cb9-2007"></a>          )</span>
<span id="cb9-2008"><a href="#cb9-2008"></a></span>
<span id="cb9-2009"><a href="#cb9-2009"></a></span>
<span id="cb9-2010"><a href="#cb9-2010"></a></span>
<span id="cb9-2011"><a href="#cb9-2011"></a><span class="co">#subsetcat viittaa muuttujan luokkien indeksiin</span></span>
<span id="cb9-2012"><a href="#cb9-2012"></a></span>
<span id="cb9-2013"><a href="#cb9-2013"></a>eiPvastaukset &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">42</span>)[<span class="op">-</span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>,<span class="dv">30</span>,<span class="dv">36</span>,<span class="dv">42</span>)]</span>
<span id="cb9-2014"><a href="#cb9-2014"></a><span class="co"># eiPvastaukset</span></span>
<span id="cb9-2015"><a href="#cb9-2015"></a><span class="co">#  puuttuva tieto on kuudes kategoria kaikilla kysymyksillä</span></span>
<span id="cb9-2016"><a href="#cb9-2016"></a><span class="co"># 1  2  3  4  5  7  8  9 10 11 13 14 15 16 17 19 20 21 22 23 25 26 27 28 29 31</span></span>
<span id="cb9-2017"><a href="#cb9-2017"></a><span class="co"># 32 33 34 35 37 38 39 40 41</span></span>
<span id="cb9-2018"><a href="#cb9-2018"></a></span>
<span id="cb9-2019"><a href="#cb9-2019"></a><span class="co">#mcaDat11jh.dat[1:5,]</span></span>
<span id="cb9-2020"><a href="#cb9-2020"></a></span>
<span id="cb9-2021"><a href="#cb9-2021"></a>Qmuuttujat2.mca &lt;-<span class="st"> </span><span class="kw">mjca</span>(mcaDat11jh.dat, <span class="dt">ps=</span><span class="st">&quot;&quot;</span>, <span class="dt">subsetcat=</span>eiPvastaukset)</span>
<span id="cb9-2022"><a href="#cb9-2022"></a></span>
<span id="cb9-2023"><a href="#cb9-2023"></a></span>
<span id="cb9-2024"><a href="#cb9-2024"></a></span>
<span id="cb9-2025"><a href="#cb9-2025"></a><span class="co"># subsetcat viittaa muuttujan luokkien indeksiin</span></span>
<span id="cb9-2026"><a href="#cb9-2026"></a></span>
<span id="cb9-2027"><a href="#cb9-2027"></a>eiPvastaukset &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">42</span>)[<span class="op">-</span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>,<span class="dv">30</span>,<span class="dv">36</span>,<span class="dv">42</span>)]</span>
<span id="cb9-2028"><a href="#cb9-2028"></a></span>
<span id="cb9-2029"><a href="#cb9-2029"></a><span class="co"># eiPvastaukset</span></span>
<span id="cb9-2030"><a href="#cb9-2030"></a><span class="co">#  puuttuva tieto on kuudes kategora kaikilla kysymyksillä</span></span>
<span id="cb9-2031"><a href="#cb9-2031"></a><span class="co"># 1  2  3  4  5  7  8  9 10 11 13 14 15 16 17 19 20 21 22 23 25 26 27 28 29 31</span></span>
<span id="cb9-2032"><a href="#cb9-2032"></a><span class="co"># 32 33 34 35 37 38 39 40 41</span></span>
<span id="cb9-2033"><a href="#cb9-2033"></a></span>
<span id="cb9-2034"><a href="#cb9-2034"></a><span class="co"># mcaDat11jh.dat[1:5,]</span></span>
<span id="cb9-2035"><a href="#cb9-2035"></a></span>
<span id="cb9-2036"><a href="#cb9-2036"></a>Qmuuttujat2.mca &lt;-<span class="st"> </span><span class="kw">mjca</span>(mcaDat11jh.dat, <span class="dt">ps=</span><span class="st">&quot;&quot;</span>, <span class="dt">subsetcat=</span>eiPvastaukset)</span>
<span id="cb9-2037"><a href="#cb9-2037"></a></span>
<span id="cb9-2038"><a href="#cb9-2038"></a><span class="co"># Kontribuutiokartta on tarpeeksi selkeä, muutujien tunnukset erottuvat.</span></span>
<span id="cb9-2039"><a href="#cb9-2039"></a><span class="co"># Jätetään tämä kuva pois (25.11.20)</span></span>
<span id="cb9-2040"><a href="#cb9-2040"></a><span class="co">#</span></span>
<span id="cb9-2041"><a href="#cb9-2041"></a><span class="co">#plot.mjca(Qmuuttujat2.mca,</span></span>
<span id="cb9-2042"><a href="#cb9-2042"></a><span class="co">#          main=&quot;Seitsemän kysymystä, viisi vastausvaihtoehtoa&quot;,</span></span>
<span id="cb9-2043"><a href="#cb9-2043"></a><span class="co">#          sub = &quot;subset: ei puuttuvien vastausten kategorioita(*P)&quot;)</span></span>
<span id="cb9-2044"><a href="#cb9-2044"></a></span>
<span id="cb9-2045"><a href="#cb9-2045"></a></span>
<span id="cb9-2046"><a href="#cb9-2046"></a><span class="co"># jätettään symmetrinen kartta pois, asymmetrinen on parempi (25.11.20)</span></span>
<span id="cb9-2047"><a href="#cb9-2047"></a></span>
<span id="cb9-2048"><a href="#cb9-2048"></a><span class="kw">plot.mjca</span>(Qmuuttujat2.mca,</span>
<span id="cb9-2049"><a href="#cb9-2049"></a>          <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;all&quot;</span>,<span class="st">&quot;all&quot;</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb9-2050"><a href="#cb9-2050"></a>          <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb9-2051"><a href="#cb9-2051"></a>          <span class="dt">main=</span><span class="st">&quot;Seitsemän kysymystä, viisi vastausvaihtoehtoa&quot;</span>,</span>
<span id="cb9-2052"><a href="#cb9-2052"></a>          <span class="dt">sub =</span> <span class="st">&quot;subset: ei puuttuvien vastausten kategoriaa (*P)&quot;</span>)</span>
<span id="cb9-2053"><a href="#cb9-2053"></a></span>
<span id="cb9-2054"><a href="#cb9-2054"></a></span>
<span id="cb9-2055"><a href="#cb9-2055"></a></span>
<span id="cb9-2056"><a href="#cb9-2056"></a><span class="kw">plot.mjca</span>(Qmuuttujat2.mca, <span class="dt">map =</span> <span class="st">&quot;rowprincipal&quot;</span>,</span>
<span id="cb9-2057"><a href="#cb9-2057"></a>          <span class="dt">what =</span> <span class="kw">c</span>(<span class="st">&quot;all&quot;</span>,<span class="st">&quot;all&quot;</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),</span>
<span id="cb9-2058"><a href="#cb9-2058"></a>          <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;lightblue&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb9-2059"><a href="#cb9-2059"></a>          <span class="dt">main=</span><span class="st">&quot;Asymmetrinen kartta - osajoukko: ei puuttuvia vastauksia&quot;</span>,</span>
<span id="cb9-2060"><a href="#cb9-2060"></a>          <span class="dt">sub =</span> <span class="st">&quot;Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, vastaukset S-s-?-e-E&quot;</span>)</span>
<span id="cb9-2061"><a href="#cb9-2061"></a></span>
<span id="cb9-2062"><a href="#cb9-2062"></a></span>
<span id="cb9-2063"><a href="#cb9-2063"></a></span>
<span id="cb9-2064"><a href="#cb9-2064"></a><span class="co"># pois 25.11.2020</span></span>
<span id="cb9-2065"><a href="#cb9-2065"></a><span class="kw">summary</span>(Qmuuttujat2.mca)</span>
<span id="cb9-2066"><a href="#cb9-2066"></a></span>
<span id="cb9-2067"><a href="#cb9-2067"></a><span class="co"># Pois 25.11.2020</span></span>
<span id="cb9-2068"><a href="#cb9-2068"></a>Qmuuttujat2d3  &lt;-<span class="st"> </span><span class="kw">mjca</span>(mcaDat11jh.dat, <span class="dt">ps=</span><span class="st">&quot;&quot;</span>, <span class="dt">nd =</span> <span class="dv">3</span>,<span class="dt">subsetcat=</span>eiPvastaukset)</span>
<span id="cb9-2069"><a href="#cb9-2069"></a><span class="kw">summary</span>(Qmuuttujat2d3)</span>
<span id="cb9-2070"><a href="#cb9-2070"></a></span>
<span id="cb9-2071"><a href="#cb9-2071"></a></span>
<span id="cb9-2072"><a href="#cb9-2072"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/CAquality.png&#39;</span>)</span>
<span id="cb9-2073"><a href="#cb9-2073"></a></span>
<span id="cb9-2074"><a href="#cb9-2074"></a></span>
<span id="cb9-2075"><a href="#cb9-2075"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/BookdownProc.png&#39;</span>)</span>
<span id="cb9-2076"><a href="#cb9-2076"></a></span>
<span id="cb9-2077"><a href="#cb9-2077"></a><span class="co"># pois out.width=&#39;50%&#39;,</span></span>
<span id="cb9-2078"><a href="#cb9-2078"></a></span>
<span id="cb9-2079"><a href="#cb9-2079"></a></span>
<span id="cb9-2080"><a href="#cb9-2080"></a><span class="kw">sessionInfo</span>()</span>
<span id="cb9-2081"><a href="#cb9-2081"></a></span>
<span id="cb9-2082"><a href="#cb9-2082"></a></span>
<span id="cb9-2083"><a href="#cb9-2083"></a><span class="co"># echo = FALSE toistaiseksi.</span></span>
<span id="cb9-2084"><a href="#cb9-2084"></a><span class="co">#Testataan koodilohkojen listausta, näyttää toimivan mutta vaatii vielä säätämistä.</span></span>
<span id="cb9-2085"><a href="#cb9-2085"></a><span class="co">#Ohje löytyi [Yihui Xienin blogista](https://yihui.name/en/2018/09/code-appendix/)</span></span>
<span id="cb9-2086"><a href="#cb9-2086"></a><span class="co">#(luettu 26.10.2018).</span></span></code></pre></div>

</div>
<p style="text-align: center;">
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
