# Yksinkertainen korrespondenssianalyysi

Korrespondenssianalyysin peruskäsitteet ja muuttujien yhteyden graafisen analyysin
periaatteet voi esittää kahden luokitelumuuttujan ristiintaulukoinnin eli
kontigenssitaulun analyysin avulla. Kyse ei ole pelkästään helposta esimerkistä,
vaan peruskäsitteet ja geometrisiin perusteisiin nojaava graafinen analyysi ovat
oleellisilta osin samat myös monimutkaisemmissa menetelmän sovelluksissa
[@RefWorks:doc:5a857a44e4b0ed2d44664d84].

Greenacren oppikirjat ovat hyvä esimerkki
perusteellisesta yksinkertaisen taulukon analyysin esitystavasta.
@RefWorks:doc:5a857a43e4b0ed2d44664d75 ranskalaisen perinteen mukaisesti
matemaattista teoriaperustaa, mutta menetelmän peruskäsitteet ja tulkinnat
esitellään yksinkertaisella esimerkillä. @RefWorks:doc:5a857a44e4b0ed2d44664d95
käyttää samaa Fisherin Cairness-aineistoa korrespondenssianalyysin esittelyyn

Esitän tässä jaksossa korrespondenssianalyysin peruskäsitteet intuitiivisesti,
matemaattiset yksityiskohdat löytyvät liitteestä 1. Kun taulukko on
pieni, johtopäätökset voi helposti tarkastaa datasta. Datan analyysin tärkein
väline on kuva, yleensä kaksiulotteinen kartta. Tulkinta ja erityisesti väärien
johtopäätösten välttäminen vaati kartan tulkinnan varmistamista ratkaisun
numeerisista tuloksista. Kun analysoitava taulukko, sen rivien ja sarakkeiden
riippuvuuksia kuvaava kartta ja kartan perustana olevat numeeriset tulokset
esitetään yhdessä on helpompi ymmärtää tulkinnan perussäännöt.

@RefWorks:doc:5a857a43e4b0ed2d44664d75 esittävät tulkinnan perussäännöt hieman
eri korostuksella kuin Greenacre (CAiP). Yhteistä on graafisen analyysin tärkeys,
mutta ranskalaiset tutkijat korostavat numeeristen tulosten ensisijaisuuta.
Analyysi pitää aloittaa tutkimalla numeerisen ratkaisun ominaisuuksia.
Greenacren mielestä numeerisia tuloksia tarvitaan johtopäätösten varmistamiseen,
ensin katsotaan karttaa. Eroa ei kannata liioitella, molempia tarvitaan.
Eksploratiivisessa data-analyysissä näkökulmaa muutetaan kun datan ominaisuudet
tai omituisuudet havaitaan. Kun kartat ovat aina approksimaatiota, numeerisia
tuloksia tarvitaan.

## Äiti töissä - kärsiikö lapsi?

Aineistossa on kuuden maan vastaukset kysymykseen Q1b: ”Alle kouluikäinen lapsi
todennäköisesti kärsii, jos hänen äitinsä käy työssä”. Kysymys on voimakkaasti
muotoiltu. Eräs lastensuojelun ammattilainen piti vastaamista mahdottomana,
pitäisi tietää missä lapsi on ja mitä hän tekee. Kysymykset on kuitenkin suunniteltu
kokonaisuudeksi, ja niitä analysoidaan yhdessä luvussa 7. Yhden taulukon analyysi
esittelee menetelmän, oikeassa tutkimuksessa pitää käyttää vähintään koko
kysymyssarjaa.

Havainnot joissa tieto vastauksesta puuttuu on poistettu aineistosta.
Taustamuuttujia ovat vastaajan sukupuoli ja ikä. Taulukoissa vastausvaihtoehtojen
tunnuksina käytetään samoja symboleja kuin kuvissa (E = täysin eri mielä,
e = eri mieltä ? = ei samaa eikä eri mieltä, s = samaa mieltä, S = täysin samaa
mieltä).


```{r esim1data1, echo = FALSE, include = FALSE}
# UUSI DATA 30.1.20
#
# LUETAAN DATA G1_1_data2.Rmd - tiedostossa, luodaan faktorimuuttujat
# G1_1_data_fct1.Rmd-tiedostossa -> ISSP2012jh1d.dat (df)
# 23 muuttujaa (9 substanssimuuttujaa, 8 taustamuuttujaa, 3 maa-muuttujaa, 3 metadatamuuttujaa)
# 25 maata.
# Poistettu 146 havaintoa, joilla SEX tai AGE puuttuu
# Johdattelevassa esimerkissä kuusi maata, kaksi taustamuuttujaa ja yksi kysymys
# (V6/Q1b)


# Kuusi maata

countries_esim1 <- c(56, 100, 208, 246, 276, 348) #BE,BG,DK,FI,DE,HU
ISSP2012esim3.dat <- filter(ISSP2012jh1d.dat, V4 %in% countries_esim1)
# str(ISSP2012esim3.dat) - pitkä listaus pois (24.2.20)

#neljä maamuuttujaa, kysymys Q1b, ikä ja sukupuoli

vars_esim1 <- c("C_ALPHAN", "V3", "maa","maa3", "Q1b", "sp", "ika")
ISSP2012esim2.dat <- select(ISSP2012esim3.dat, all_of(vars_esim1))

str(ISSP2012esim2.dat) # 8542 obs. of  7 variables, ja sama 8.6.2020
# C_ALPHAN: chr, maa: Factor w/ 25

# Poistetaan havainnot, joilla Q1b - muuttujassa puuttuva tieto 'NA'
# sum(is.na(ISSP2012esim2.dat$Q1b)) = 399

ISSP2012esim1.dat <- filter(ISSP2012esim2.dat, !is.na(Q1b))

#str(ISSP2012esim1.dat) # 8143 obs. of  6 variable

# Tarkistuksia (3.2.20)
#
#fct_count(ISSP2012esim1.dat$sp)
#fct_count(ISSP2012esim1.dat$Q1b)
#fct_count(ISSP2012esim1.dat$maa)
#fct_count(ISSP2012esim1.dat$maa3)
#
#summary(ISSP2012esim1.dat$sp)
#sp: 3799 + 4344 = 8143
#summary(ISSP2012esim1.dat$Q1b)
#  S      s      ?     e      E
# 810 + 1935 + 1367 + 2125 + 1906 = 8143
#
# EDELLINEN DATA - havaintojen määrät samat kuin uudella datalla (31.1.20)
#
# 8557 obs. ennen kuin sexagemissing poistettiin, nyt 8542, 8557-8542 = 15
#
# Poistetaan havainnot joissa puuttuva tieto muuttujassa V6 (Q1b) n = 399
# 8542-399 = 8143

# Tyhjät "faktorilabelit" on poistettava

 ISSP2012esim1.dat <- ISSP2012esim1.dat %>%
     mutate(maa = fct_drop(maa),
            maa3 = fct_drop(maa3)
            )

#summary(ISSP2012esim1.dat$maa)
#summary(ISSP2012esim1.dat$maa3)
#
# str(ISSP2012esim1.dat$maa)
# attributes(ISSP2012esim1.dat$maa)
#
# str(ISSP2012esim1.dat$maa3)
# attributes(ISSP2012esim1.dat$maa3)
#
#ISSP2012esim1.dat %>% tableX(maa, Q1b, type = "count")
#fct_count(ISSP2012esim1.dat$Q1b)
# fct_count(ISSP2012esim1.dat$sp)
# fct_unique(ISSP2012esim1.dat$maa)
# fct_count(ISSP2012esim1.dat$maa)
#ISSP2012esim1.dat %>% tableX(maa, C_ALPHAN, type = "count")
#
# maa3 - siistitään "faktorilabelit" kaksikirjaimisiksi
#
# ISO 3166 Code V3 - maiden jaot
#  5601     BE-FLA-Belgium/ Flanders
#  5602     BE-WAL-Belgium/ Wallonia
#  5603     BE-BRU-Belgium/ Brussels
# 27601     DE-W-Germany-West
# 27602     DE-E-Germany-East
# Tähän pitäisi päästä
# levels = c("100","208","246","348","5601","5602","5603","27601","27602"),
# labels = c("BG","DK","FI","HU","bF","bW","bB","dW","dE"))
# levels(ISSP2012esim1.dat$maa3)

ISSP2012esim1.dat <- ISSP2012esim1.dat %>%
        mutate(maa3 =
                fct_recode(maa3,
                 "BG" = "BG-Bulgaria",
                 "DK" = "DK-Denmark",
                 "FI" = "FI-Finland",
                 "HU" = "HU-Hungary",
                 "bF" = "BE-FLA-Belgium/ Flanders",
                 "bW" = "BE-WAL-Belgium/ Wallonia",
                 "bB" = "BE-BRU-Belgium/ Brussels",
                 "dW" = "DE-W-Germany-West",
                 "dE" = "DE-E-Germany-East")
               )
# tarkistuksia
#levels(ISSP2012esim1.dat$maa3)
# str(ISSP2012esim1.dat$maa3) # 9 levels
#summary(ISSP2012esim1.dat$maa3)
#
# TÄSSÄ TOISTOA! (4.2.20)
# Muutetaan muuttujien "maa" ja "maa3" arvojen (levels) järjestys samaksi kuin
# alkuperäisen muuttujan C_ALPHAN. Helpomi verrata aikaisempiin tuloksiin.

# "alkuperäinen" maa talteen
ISSP2012esim1.dat$maa2 <- ISSP2012esim1.dat$maa

ISSP2012esim1.dat <- ISSP2012esim1.dat %>%
        mutate(maa =
                fct_relevel(maa,
                            "BE",
                            "BG",
                            "DE",
                            "DK",
                            "FI",
                            "HU"))
ISSP2012esim1.dat <- ISSP2012esim1.dat %>%
        mutate(maa3 =
                fct_relevel(maa3,
                        "bF",
                        "bW",
                        "bB",
                        "BG",
                        "dW",
                        "dE",
                        "DK",
                        "FI",
                        "HU"))

# Tarkistus
#ISSP2012esim1.dat %>% tableX(maa2,maa, type = "count")
# "alkuperäinen" maa talteenISSP2012esim1.dat %>% tableX(maa,C_ALPHAN, type = "count")
# "alkuperäinen" maa talteenstr(ISSP2012esim1.dat)

```


```{r r esim1data2, echo = FALSE, include = FALSE, message=TRUE, warning=TRUE}
# Taulukoita (31.1.2020) ja tarkistuksia
#
# toinen maa-muuttuja, jossa Saksan ja Belgian jako
#  V3
#  5601     BE-FLA-Belgium/ Flanders
#  5602     BE-WAL-Belgium/ Wallonia
#  5603     BE-BRU-Belgium/ Brussels
# 27601     DE-W-Germany-West
# 27602     DE-E-Germany-East

# Tarkastuksia

# assert_that ehkä tarpeeton - expect_equivalet testaa levelien
# järjestyksen ja määrän (20.2.20)

validate_that(length(levels(ISSP2012esim1.dat$sp)) == 2)
validate_that(are_equal(levels(ISSP2012esim1.dat$sp),
                c("m", "f")))

validate_that(length(levels(ISSP2012esim1.dat$maa)) == 6)

validate_that(are_equal(levels(ISSP2012esim1.dat$maa),
                  c("BE", "BG", "DE", "DK", "FI", "HU")))

validate_that(length(levels(ISSP2012esim1.dat$maa3)) == 9)

validate_that(are_equal(levels(ISSP2012esim1.dat$maa3),
                 c("bF","bW","bB", "BG","dW","dE","DK", "FI", "HU")))

validate_that(length(levels(ISSP2012esim1.dat$Q1b)) == 5)
validate_that(are_equal(levels(ISSP2012esim1.dat$Q1b),
               c("S", "s", "?", "e", "E")))

# testthat - paketti - pois käytöstä 16.9.20
# expect_ ei anna ok-ilmoitusta, ainoastaan virheilmoituksen? (11.4.20)
# expect_equivalent(levels(ISSP2012esim1.dat$maa),
#                  c("BE", "BG", "DE", "DK", "FI", "HU"))
# expect_equivalent(levels(ISSP2012esim1.dat$maa3),
#                  c("bF","bW","bB", "BG","dW","dE","DK", "FI", "HU"))
# expect_equivalent(levels(ISSP2012esim1.dat$sp), c("m", "f"))
# expect_equivalent(levels(ISSP2012esim1.dat$Q1b),
#                  c("S", "s", "?", "e", "E"))
#
# ISSP2012esim1.dat %>% tableX(maa,ika,type = "row_perc")
#
# Riviprofiilit
#
# ISSP2012esim1.dat %>% tableX(maa,ika,type = "row_perc")
# ISSP2012esim1.dat %>% tableX(maa,sp ,type = "row_perc")
#
#
# Kysymyksen Q1b vastaukset
#
#ISSP2012esim1.dat %>% tableX(maa,Q1b,type = "row_perc")
#
#ISSP2012esim1.dat %>% tableX(maa3,Q1b,type = "row_perc")
#
# str(ISSP2012esim1.dat) # 8143 obs. of  7 variable,
# sama kuin vanhassa Galku-koodissa.
#
# str(ISSP2012esim1.dat) # 8143 obs. of  7 variable,
# sama kuin vanhassa Galku-koodissa.

```

Frekvenssitaulukossa \@ref(tab:simpeCA-frekTa1) on esitetty vastausten suhteellinen jakauma,
lukumäärät on jaettu havaintojen lukumäärällä (8143). Korrespondenssianalyysissä
kaikki on suhteellista, ja analyysi perustuu tähän taulukkoon. Taulukon
reunajakaumat kertovat jokaisen maan ja jokaisen vastausvaihtoehdon suhteellisen
osuuden. Näitä suhteellisia osuuksia kutsustaan korrespondenssianalyysissä
_rivi- ja sarakemassoiksi_.


```{r simpeCA-frekTa1, echo = FALSE}
taulu2 <- ISSP2012esim1.dat %>% tableX(maa, Q1b, type = "cell_perc")
knitr::kable(taulu2,digits = 2, booktabs = TRUE,
             caption = "Kysymyksen Q1b vastaukset, suhteelliset frekvenssit")

```

Muuttujien luonne on usein erilainen. Tähän aineistoon sopii
riviprosenttientaulukko, vertaillaan vastausten jakaumia maiden välillä. Taulukon
sarakkeet ovat muuttujia ja rivit havaintoja. Rivit on saatu summaamalla
(aggregoimalla) vastaukset maittain. Greenacre käyttää näistä yksittäisten
vastausten (havaintojen) summariveistä termiä "sample".


```{r simpeCA-rprosTa1, echo = FALSE}
taulu3 <- ISSP2012esim1.dat %>% tableX(maa,Q1b,type = "row_perc")

knitr::kable(taulu3,digits = 2, booktabs = TRUE,
             caption = "Kysymyksen Q1b vastaukset, riviprosentit")

```

Sarakeprosentit antavat toisen näkökulmaan samaan dataan.

```{r  simpeCA-cprosTa1, echo = FALSE}
taulu4 <- ISSP2012esim1.dat %>% tableX(maa,Q1b,type = "col_perc")

knitr::kable(taulu4,digits = 2, booktabs = TRUE,
             caption = "Kysymyksen Q1b vastaukset, sarakeprosentit")

```

Tavoitteena on korrespondenssianalyysin kartta, jossa rivi- ja sarakepisteet on
esitetty samassa kuvassa. Sarakeprosenttien taulukossa on esitetty sarakkeiden
suhteelliset jakaumat. Näitä suhteellisia rivejä ja sarakkeita kutsutaan
korrespondenssianalyysissä _rivi- ja sarakeprofiileiksi_.



```{r  EkaCA, echo = FALSE, include = FALSE}
# CA tässä, jotta saadaan rivi- ja sarakeprofiilikuvat
# Lasketaan samalla CA-ratkaisu riviprofiilitaulkolle (maille samat painot)

simpleCA1 <- ca(~maa + Q1b,ISSP2012esim1.dat)

# Maiden järjestys kääntää kuvan (1.2.20) - esimerkki on
# vähän kuriositeetti. Kartta voi tietysti "flipata" koordintaattien suhteen ainakin
# neljällä tavalla (? 180 astetta molempien akseleiden ympäri molempiin suuntiin?)
# (18.2.20). Tämän maa2-muuttujaa käyttävän kuvan voi jättää pois (8.4.20)

# simpleCA2 <- ca(~maa2 + Q1b,ISSP2012esim1.dat)

# Oikeastaan maiden vertailussa pitäisi niiden massat skaalata yhtä suuriksi, tässä
# pikainen kokeilu (20.2.20)
# Riviprosentit taulukoksi, nimet sarakkeille ja riveille (ei kovin robustia...)


johdesim1_rowproc.tab <- simpleCA1$N / rowSums(simpleCA1$N)
colnames(johdesim1_rowproc.tab) <- c("S" ,"s" ,"?","e", "E")
rownames(johdesim1_rowproc.tab) <- c("BE", "BG", "DE", "DK", "FI", "HU")

# Miten tibblenä? Ei toimi, ei maa-muuttujaa ollenkaan
# johdesim1_rowproc.tbl <- as_tibble(johdesim1_rowproc.tab)
# str(johdesim1_rowproc.tbl)

# TARKISTUKSIA (20.2.20)
# johdesim1_rowproc.tab
# rowSums(johdesim1_rowproc.tab)
# str(johdesim1_rowproc.tab)


simpleCA3 <- ca(johdesim1_rowproc.tab)


# Kartta piirretään koodilohkossa simpleCAmap1, r. 773 noin.

# Riviprosentit tarkistusta varten
#        S	s	?	e	E
#BE	9.49	22.40	21.76	27.42	18.93
#BG	12.81	42.89	22.26	20.63	1.41
#DE	9.63	21.88	11.55	31.39	25.55
#DK	5.04	17.15	10.95	16.71	50.14
#FI	4.23	16.94	13.42	38.11	27.30
#HU	21.97	28.89	22.57	19.06	7.52
#
# Ja datan saa leikepöydän kautta, jos on tarve pikatarkistuksiin
# read <- read.table("clipboard")

```


Korrespondenssianalyysin perusidea on analysoida rivien ja sarakkeiden yhteyttä
(korrespondenssia) rivi- tai sarakeprofiilien hajonnan avulla. Hajontaa mitataan
poikkeamilla keskiarvorivistä tai sarakkeesta, ja massat otetaan huomioon,
kun poikkeamat lasketaan yhteen.


```{r g1-2kuva1, fig.cap = "Q1b:Sarakeprofiilit ja keskiarvoprofiili", echo = FALSE, include = TRUE}
#mutkikas kuvan piirto - sarakeprofiilit vertailussa
#ggplot vaatii df-rakenteen ja 'long data' - muotoon
##https://stackoverflow.com/questions/9563368/create-stacked-barplot
# -where-each-stack-is-scaled-to-sum-to
# Pitkä https-linkki kahdella rivillä
#
# käytetään ca - tuloksia
apu1 <- (simpleCA1$N)
colnames(apu1) <- c("S", "s", "?", "e", "E")
rownames(apu1) <- c("BE", "BG", "DE", "DK", "FI", "HU")
apu1_df <- as.data.frame(apu1)
#lasketan rivien reunajakauma
apu1_df$ka_sarake <- rowSums(apu1_df)
#muokataan 'long data' - muotoon
apu1b_df <- melt(cbind(apu1_df, ind = rownames(apu1_df)), id.vars = c('ind'))

p <- ggplot(apu1b_df, aes(x = variable, y = value, fill = ind)) +
         geom_bar(position = "fill", stat = "identity") +
         scale_y_continuous(name = " ",labels = percent_format())
p <- p + labs(fill = "maa")
p + scale_x_discrete(name = "Q1b - vastauskategoriat")
# apu1_df
# apu1b_df

```

```{r g1-2kuva2, fig.cap = "Q1b: riviprofiilit ja keskiarvorivi", echo = FALSE, include = TRUE}

# riviprofiilit ja keskiarvorivi -  18.9.2018
apu2_df <- as.data.frame(apu1)
apu2_df <- rbind(apu2_df, ka_rivi = colSums(apu2_df))

#apu2_df
#str(apu2_df)
## typeof(apu2_df) # what is it?
## class(apu2_df) # what is it? (sorry)
## storage.mode(apu2_df) # what is it? (very sorry)
## length(apu2_df) # how long is it? What about two dimensional
## objects?
# attributes(apu2_df)

# temp1 <- cbind(apu2_df, ind = rownames(apu2_df))
# temp1
##muokataan 'long data' - muotoon
apu2b_df <- melt(cbind(apu2_df, ind = rownames(apu2_df)), id.vars = c('ind'))
# str(apu2b_df)
# glimpse(apu2b_df)

#
#ggplot(apu2b_df, aes(x = value, y = ind, fill = variable)) +
#       geom_bar(position = "fill", stat ="identity") +
#       #coord_flip() +
#        scale_x_continuous(labels = percent_format())

#versio2 toimii (18.9.2018)

p <- ggplot(apu2b_df, aes(x = ind, y = value, fill = variable)) +
       geom_bar(position = "fill", stat = "identity") +
       coord_flip() +
        scale_y_continuous(name = " ",labels = percent_format())
p <- p + labs(fill = "Q1b")
p + scale_x_discrete(name = " ")


```

Kuvasta \@ref(fig:g1-2kuva2) esimerkiksi näkee, että Tanska (DK) näyttäisi
poikkeava keskiarvorivistä paljon, samoin Bulgaria.
Bulgarian massa on kuitenkin aineiston pienin (11,31 %), Tanskan taas
kohtalainen (17 %).
Sarakeprofiilikuvassa \@ref(fig:g1-2kuva1) täysin eri mieltä - vastaus (E) on
selvästi erilainen ja sen massa on suuri (23%). Kaikki luvut ovat suhteellisia,
havaintojen lukumäärä ei vaikuta tulkintaan periaatteessa mitenkään.


Mikä on rivien ja sarakkeiden yhteys?

Kahden luokittelumuuttujan riippuvuutta voidaan testata  $\chi^{2}$ - testillä.
Riippumattomuushypoteesin mukainen odotettu solufrekvenssi on taulukon
\@ref(tab:simpeCA-frekTa1) reunajakaumien alkioiden tulo.

Testisuure saadaan laskemalla yhten jokaisen solun havaittujen ja odotetettujen
frekvenssien erotukset muodossa

\begin{equation}
  \chi^{2} = \frac{(havaittu - odotettu)^2} {odotettu}.
    (\#eq:khii21)
\end{equation}

Tämä voidaan esittää korrespondenssianalyysin esittelyyn sopivammalla tavalla
parilla muunnoksella, jolloin saamme riveittäin vastaavat termit rivisummalla
painotettuna.

\begin{equation}
  rivisumma \times \frac{(havaittu \: riviprofiili - odotettu \: riviprofiili)^2} {odotettu \: riviprofiili}.
    (\#eq:khii22)
\end{equation}

Kun jaamme nämä tekijät havaintojen kokonaismäärällä $n$, rivisumma muuntuu
rivin massaksi, ja niiden summa muotoon $\frac{\chi^{2}}{n}$.

\begin{equation}
 \frac{\chi^{2}}{n} = \phi^{2}.
  (\#eq:inert1)
 \end{equation}

Jakajassa ei ole vapausastekorjausta (n-1), korrespondenssianalyysi on
deskriptiivistä data-analyysiä.


Tunnusluku $\phi^{2}$ on korrespondenssianalyysissä _kokonaisinertia_ (total
inertia). Se kuvaa, kuinka paljon varianssia taulukossa on ja on riippumaton
havaintojen lukumäärästä. Tilastotieteessä tunnusluvulla on useita vaihtoehtoisia
nimiä (esim. mean square contingency coefficient) ja sen neliöjuurta kutsutaan
$\phi$ - kertoimeksi.

Korrespondenssianalyysin ratkaisussa käytetään suhteellisten frekvenssien
taulukkoa.

Frekvenssitaulukossa kahden rivin (esimerkiksi rivien 1 ja 3) euklidinen etäisyys
on

 \begin{equation}
 \sqrt{(p_{11} - p_{31})^2 + (p_{12} - p_{32})^2 + (p_{13} - _{33})^2+ (p_{14} - _{34})^2+ (p_{15} - _{35})^2}.
 (\#eq:euclid1)
 \end{equation}


Rivien $\chi^{2}$ - etäisyys  on painotettu euklidinen etäisyys, jossa painoina
ovat riviprofiilin odotetut arvot. Ne ovat riippumattomuushypoteesin mukaisesti
riviprofiilien keskiarvoprofiilin vastaavat alkioit $r_{i}$ .

\begin{equation}
 \sqrt{\frac{(p_{11} - p_{31})^2} { r_{1}} + \dots + \frac{(p_{15} - p_{35})^2} {r_{5}}}
 (\#eq:euclid2)
\end{equation}


Inertia voidaa esittää rivien ja keskiarvorivin (sentroidin) $\chi^{2}$ -etäisyyksien
neliöiden painotettuna summana, jossa painoina ovat rivien massat $m_{i}$ ja
summa lasketaan yli rivien ${i}$.

\begin{equation}
 \phi^{2} = \sum_{i} (massa \: m_{i}) \times (profiilin \: i \: \chi^{2} - etäisyys \: sentroidista)^{2}
 (\#eq:inert2)
\end{equation}

Korrespondenssianalyysin kolme peruskäsitteen "tripletti" -- _profiili_,
_massa_ ja _$\chi^{2}$ - etäisyys_ -- on esitelty. "Triplettiä" täydentää "kvartetti",
johon _inertia_ kuuluu.

Rivi- ja sarakeprofiilien taulukoista huomaa, että keskiarvoprofiilien
alkiot ovat massoja. Rivien keskiarvoprofiilin alkiot ovat sarakemassoja, ja sama
pätee sarakkeille. Tämä rivi- ja sarakeongelmien duaalisuus on yksinkertaisen
korrespondenssianalyysin keskeinen idea (CAiP, s. 57). Rivi- tai sarakeongelman
ratkaisu tuottaa saman tuloksen.

Ratkaisun dimensio on sarakkeiden tai rivien lukumäärä vähennettynä yhdellä,
pienempi kahdesta vaihtoehdosta. Se on myös kokonaisinertian teoreettinen maksimi.

Korrespondenssianalyysi on läheistä sukua pääkomponenttianalyysille. Etäisyysmitta on
khii2-etäisyys (käytän tekstissä tätä kirjoitusasua) ja ovat massat ovat mukana
painoina. Ratkaisussa etsitään haluttu yleensä kaksiulotteinen ratkaisu (taso),
joka minimoi pisteiden khii2-etäisyyksien poikkeamien summan eli
on mahdollisimman lähellä pisteitä. Alkuperäisen täyden dimension (full space)
data projisoidaan tälle tasolle.


## Symmetrinen kartta

Korrespondenssianalyysi kuvaa taulukon riippuvuudet karttana. _Symmetrinen kartta_
on yleisin ja useiden ohjelmistojen oletuskartta.

```{r simpleCA1map1, echo=FALSE, fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}

# simpleCA1 luotu aikaisemmin profiilikuvia varten koodilohkossa EkaCA
# HUOM! xlab ja ylab, prosenttiosuudet ensin katsottu ja sitten kirjoitettu
# tässä. Vertaa scree-plot - tietoon!


#par(cex = 1)
plot(simpleCA1, map = "symmetric", mass = c(TRUE,TRUE),
     xlab = "Dimensio 1: moderni/liberaali - perinteinen/konservatiivinen (76%)",
     ylab = "Dimensio 2: maltillinen/epävarma - radikaali/jyrkkä/varma (15.1%)",
     main = "symmetrinen kartta 1",
     sub = "Maiden massat eri suuruisia (otoskoko), pisteiden koko suhteessa massaan")

# jatkossa plot - main on kuvan tyyppi (symmetrinen, kontribuutio jne),
# koodilohkon fig.cap "ylimmän tason" otsikko.

# Akseleiden tekstit (Dimensio 1....jne) asetettu käsin, ikävä kyllä myös
# selitetyn inertian osuus. CA-kartoissa tämä on niin oleellinen asia,
# että akselien nimet voi muutttaa vasta esitysgrafiikassa, ei data-analyysissä.
# Dim1 ja Dim2  kuuluvat kuviin.

# par(cex = 1) - asetus ennen plot-komenota muuttaa valitettavasti "kaiken" kokoa.
# Antaa olla, kun on graafista data-analyysiä. Selkeys tärkeämpää kuin ulkoasu.


```


Akselien prosenttimerkinnät kertovat,kuinka paljon aineiston inertiasta eli
hajonnasta on kaksiulotteisesssa projektiossa saatu kuvattua akseleille.

Akselit ovat sisäkkäisiä (nested) Ensimmäinen akseli saa aina suurimman osan
inertiasta, tässä 76 prosenttia. Kun toinen akseli kuvaa 15 prosenttia koko inertiasta,
on kartalla esitetty 91 prosenttia aineiston hajonnasta. Loput 9 prosenttia jää
3. ja 4. dimensiolle. Nämä ”selitysosuudet” ovat samantapainen laskelma kuin
perinteisen regressiomallin ”selitetty” vaihtelu ja ”jäännösvaihtelu”.

Akselien tulkinta on korrespondenssianalyysin perustehtävä._Kontrastit_ määrittävät
akselien tulkinnan . Benzacrin ohjeen mukaan ([@RefWorks:doc:5a857a43e4b0ed2d44664d75], s. 49)
katsotaan mitä on oikealla ja mitä vasemmalla. Akselien tulkinta perustuu siihen,
mitä mitä yhteistä on kaikilla elementeillä jotka ovat origon vasemmalla puolella
ja vastaavasti origon oikealla puolella. Samalla tavalla tulkitaan toinen akseli,
mitä on ylhäällä ja alhaalla. Tulkinta tehdään akseleiden suuntaan. Kuvan tulkintaa
ei aloiteta pisteidein etäisyyksiä vertailemalla.

Kun taulukon rivit ovat havaintoja ja sarakkeet muuttujia, akselien tulkinta
tehdään muuttujien avulla. Vasemmalla on E ja oikealla puolella samanmieliset
vastaukset s ja S. Neutraali ”?” on s-vastausten vasemmalla puolella mutta
kuitenkin oikealla. Kuvan perusteella ei voi sanoa kuinka paljon,
kaikki erot ovat suhteellisia.

Sarakkeet  ovat oikeassa järjestyksessä, mutta niiden koordinaatit
x-akselilla eivät olen tasavälisiä. Jos muuttuja jostain syystä halutaaan
esittää välimatka- tai suhdeasteikon muuttujana koordinaatti ensimmäisellä
dimensiolla on yksi vaihtoehto.

Ensimmäisen dimenosion tulkinta on aika selkeä. Toinen akseli on kontrasti
lievemmän tai maltillisemman erimielisyyden (e) ja muiden vastausten kanssa.
Se on 1. dimension suuntaan kaikkein lähimpänä origoa. Hieman varovaisemmin
akselin voi tulkita maltillisen ja jyrkemmän tai varmemman mielipiteen kontrastiksi.

En jatkossa esitä kuvailevia akseleiden nimiä kuvissa, akseleiden tulkinta on
analyysin ensimmäinen tehtävä.

Maiden vertailu tehdään näiden akselien suuntaan. Sekä sarekepisteiden että
rivipisteiden keskinäiset välimatkat approksimoivat optimaalisesti niiden
khii2-etäisyyksiä. Sarake- ja rivipisteiden välisillä etäisyyksillä ei ole
mitään suoraa tulkintaa. Pisteiden etäisyydet samassa pistepilvessä ovat
suhteellisia, Saksa on konsevatiivisempi kuin Suomi mutta emme tiedä kuinka paljon.
Maiden järjestys oikealta vasemmalle on selkeä, Tanska on vasemmalla
liberaalina ”ääripäänä”, oikealla taas Unkari ja Bulgaria. Pystyakselin suuntaan
nähdään, että kaikkein ”maltillisin” mutta kuitenkin liberaali on Suomi,
jyrkimmät mielipiteet löytyvät Unkarista ja Tanskasta.

Näitä tulkintoja voi vertailla edellä esitettyihin kahteen kuvaan rivi- ja
sarakeprofiileista. Näkeekö niistä helposti saman riippuvuuden rakenteen? Kartta
kertoo selvästi enemmän, mutta vaati ensin tulkinnan.

Kartta on approksimaatio neliulotteisen pistepilven hajonnalle. Vain origo on
siinä tarkasti esitetty. Se on koko aineiston keskiarvopiste, ja pisteiden
hajonta sen ympärillä kuvaa poikkeamaa riippumattomuushypoteesista.

Tärkeä geometrinen periaate on se, että kaukana on kaukana myös alkuperäisessä
pistepilvessä, mutta kartalla lähellä olevat pisteet eivät välttämättä ole lähellä.
Projektio kutistaa pisteiden etäisyyksiä.

Approksimaation laatu selviää korrespondenssianalyysin numeerisista tuloksista,
samoin se miten rivi- ja sarakepisteen määrittävät akselit.

Kartoissa tärkein tekninen yksityiskohta on kuva- tai muotosuhde (aspect ratio).
Akseleiden mittayksikön pitää olla sama eli muotosuhteen yksi. Jos kuvia
tulostetaan useassa formaatissa kannattaa olla tarkkana. Kuvien on jo
analyysivaiheessa oltava lukukelpoisia, ja symbolien kokoa joutuu isoissa
aineistoissa säätämään. Tulosten esittäminen lopullisessa muodossa vaatii jo
paljon vaivannäköä, tässä tutkielmassa esitetään vain datan analysoinnin
valikoituja kuvia. Tutkielman karttojen ulkoasu ei ole paras mahdollinen, mutta
tarkoitukseen riittävän hyvä. Graafinen data-analyysi on vaivatonta vasta
sitten kun se tehty.


**Vaatimukset datalle**

Korrespondenssianalyysin sovelletaan yleisimmin frekvenssitaulujen analyysiin,
lukumäärädataan (count data). Periaatteessa mikä tahansa data sopii, kunhan se
voidaan järkevästi esittää suhteelisina lukumäärinä (relative amounts), siis
suhdeasteikon (ratio scale) muuttujana. Tässä oleellista on tulkittavuus
tutkimusongelman näkökulmasta. Välttämätön ehto on sama mittayksikkö: lukumäärä,
rahayksikkö, pituusmitta kelpaavat. (CAiP s. 15). Taulukon lukujen on oltava
ei-negatiivisia (positiivisia, nolla sallittu).

Rajat ovat joustavia, kun mukaan otetaan erilaiset uudelleenskaalaukset
ja transformaatiot. Tämä oli menetelmän perusidea jo Benzecrillä(CAiP ch 26, s. 201).

Menetelmää sovelletaan profiileihin jotka painotetaan massoilla, ja
profiilien etäisyyksiä mitataan khii2-etäisyysmitalla. Jos datan voi esittää
tässä muodossa, menetelmää voi käyttää.


## Asymmetrinen kartta ja ideaalipisteet

Symmetrisessä kartassa \@ref(fig:simpleCA1map1) molemmat pisteparvet on esitetty
pääkoordinaateissa (prinipal coordinates) ikäänkuin päällekkäin, samassa kuvassa.

Toinen vaihtoehto on asymmetrinen kartta, jossa toinen pistejoukko esitetään
standardikoordinaateissa ja toinen pääkoordinaateissa. Asymmetrisessä
kartassa \@ref(fig:G1-3asymm2) sarakkeet on esitetty standardikoordinaateissa
ja rivit pääkoordinaateissa.

Sarakepisteitä kutsutaan ideaalipisteiksi, ne edustavat kuviteellisia maita joissa
kaikki vastaukset ovat samoja. Matemaattisesti kartalle projisoidut ideaalipisteet
ovat (tässä esimerkissä) neliulotteisen avaruuden verteksin (monikulmion)
kärkipisteitä. Rivipisteet ovat tämän verteksin sisällä.


```{r G1-3asymm2,echo = FALSE, fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}

# asymmetrinen kartta - rivit pc ja sarakkeet sc
# sarakkeet vektorikuvina

# par(cex = 0.7)
plot(simpleCA1, map = "rowprincipal",
     arrows = c(FALSE,TRUE),
     main = "asymmetrinen kartta 1"
    )

```


Sarakepisteet kuvaavat maksimi-inertiaa, ja rivipisteiden paljon pienempi hajonta
kuvaa niiden poikkeamaa tästä hypoteettisesta tilanteesta. Sarakepisteet
skaalautuvat origosta ulospäin. Asymmetrisessä kartassa rivi- ja sarakepisteiden
etäisyydellä on tulkinta, samoin rivipisteiden välisellä etäisyydellä.
Sarakepisteiden välisillä etäisyyksillä ei ole tulkintaa. Sarakepisteet on
skaalattu ja mittakaavan ero symmetriseen karttaan näkyy selvästi.


Ideaalipisteiden tulkinnan voi varmistaa sarake kerrallaan, projisoimalla rivipisteet
origon kautta piirretylle janalle. Kuvassa \@ref(fig:G1-3-asymmtulk2) nähdään mikä
on maiden järjestys E-vastausvaihtoehdossa.


```{r G1-3-asymmtulk2, echo = FALSE, fig.cap= "Rivipisteiden projektiot",fig.asp = 1, out.width='90%', fig.align='center'}

knitr::include_graphics('img/simpleCAasymmTulk2.png')


```

Asymmetrinen kartta antaa toisen näkökulman rivien ja sarakkeiden suhteeseen.
Sen huono puoli on ideaalipisteiden karkaaminen kauas origosta ja rivipisteiden
pakkautuminen pieneksi parveksi. Jos rivipisteiden hajonta on suuri,
kuva on käytännöllinen. Kyselytutkimusaineistoissa näin ei yleensä ole.


## Kontribuutiot kartalla

Kartassa \@ref(fig:simpleCA1map1) on esitetty myös pisteiden massat. Tässä aineistossa
pisteiden tai sarakesymbolien kokoerot eivät kovin selvästi erotu, mutta yleiskuvan
ne kertovat.

Rivipisteiden ja sarakkeiden _kontribuutiot_ voidaan myös esittämien värisävynä.

Kun kartalla pistejoukon inertia kuvataan akseleille, on jokaisella pisteellä oma
osuutensa akseleiden kuvaamasta inertiasta. _Absoluuttinen kontribuutio_ kertoo rivin
tai  sarakkeen osuuden akselin inertiasta. Vaikutuksessa on mukana pisteen massa.

_Suhteellinen kontribuutio_ kertoo akselin osuuden pisteen inertiasta.
Tämä tunnusluku kuvaa pisteen projektion laatua, kuinka hyvin se on kartalla esitetty.

Kontribuutiokartta on asymmetrinen kartta, jossa sarakevektorit on skaalattu
kertomalla ne massojen neliöjuurilla. Näin sarakevektorit "kutistuvat" kohti
origoa mutta vektorin pituus kertoo edelleen sen suhteellisen massan.
Kartta sopii niin pienen kuin suuren inertian tilanteisiin
[@RefWorks:doc:5c768b09e4b02df9431e950a].

**Absoluuttiset kontribuutiot**

Absoluuttisten kontribuutioiden jakautumista akseleille voi varovaisesti päätellä
sarakevektorin ja akseleiden välisistä kulmista. Mitä lähempänä sarakevektori on
akselia, sitä suurempi on sen osuus akselin inertiasta. Samanlaisia päätelmiä
voi tehdä myös rivipisteistä hahmottamalla  niistä janan origoon.

Käsitteisiin palataan tarkemmin seuraavissa luvuissa ja teorialiitteessä, ja liian
tarkkaan karttaa ei kannata tutkia. Numeeriset tulokset ovat yksityiskohdissa
selkeämpiä.


```{r G1-3asymmContrib1,echo = FALSE,fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}
#par(cex = 0.6)
plot(simpleCA1, map = "rowgreen",
     contrib = c("absolute", "absolute"),
     mass = c(TRUE,TRUE),
     arrows = c(FALSE, TRUE),
     main = "kontribuutiokartta 1 - pisteen koko suhteessa massaan",
     sub = "sarakevektorin ja rivipisteiden värin tummuus = absoluuttinen kontribuutio")

```

Sarakkeista ratkaisuun vaikuttaa selvästi eniten E, ja juuri ensimmäiseen
dimensioon joka selittää suurimman osan kokonaisinertiasta. Toista dimensiota määrittää
vahviten e, mutta myös kaikki muut sarakkeet x-akselin yläpuolella. Samaa mieltä
olevien (S ja s) vaikutus näyttäisi jakautuvan selvimmin molemmille dimensioille.

Vaikka massojen suhteellisia eroja ei kovin helposti pistekoosta erota, se näkyy
epäsuorasti Saksan melko vahvana kontribuutiona. Bulgarian pieni kontribuutio
näyttäisi olevan ensimmäiselle dimensiolle. Belgian kontribuutio ratkaisuun on
pienempi kuin Saksan vaikka sen massa on hieman suurempi. Belgian ja Saksan
pisteet ovat suhteellisesti lähempänä origoa jo suuren massansa ansiosta.

**Suhteelliset kontribuutiot**

Sarakkeiden laatu näyttäisi olevan hyvä, mutta rivipisteistä Saksa ja erityisesti
Belgia erottuvat hieman heikommin esitettyinä.

```{r G1-3asymmContrib2,echo = FALSE,fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}

#par(cex = 0.7)
plot(simpleCA1, map = "rowgreen",
     contrib = c("relative", "relative"),
     mass = c(TRUE,TRUE),
     arrows = c(FALSE, TRUE),
     main = "kontribuutiokartta 2 - pisteen koko suhteessa massaan",
     sub = "sarakevektorin ja pisteen värin tummuus = suhteellinen kontribuutio")

```

Massojen ja kontribuutioiden esittäminen kartoilla näyttää selkeimmin poikkeavat
pisteet. Kontribuutioiden graafinen tarkastelu antaa myös yleiskuvan, jonka voi
varmistaa numeerisista tuloksista.


Kaikki edellä esitetyt pääättelyt perustuvat tietysti kaksiulotteideen projektioon.
Jos pisteet on esitetty hyvin eli niiden inertiasta (poikkeamasta keskiarvosta)
suuri osa on kuvattu kartalle, rivipiste on sitä lähempänä ideaalipistettä mitä
suurempi ideaalipisteen osuus on sen profiilissa.



## Massat


Massat ovat korrespondenssianalyysin keskeinen käsite, ja niiden kaksoisrooli on
menetelmässä tärkeä. Massat ovat normalisoiva muunnos khii2-etäisyysmitalle ja
profiilien painoja. 

Tässä jälkimmäisessä roolissa massat liittyvät tutkimusongelmaan,
mitä halutaan vertailla? Kun vertaillaan eri maita, ei ole kovin perusteltua
käyttää massoina eri maiden otoskokoja. Jos taas halutaan vertailla vaikkapa miesten ja
naisten vastauksia on luonnollista normalisoida miesten ja naisten massat yhtä
suuriksi. Rivi- ja sarakemassat ovat verrannollisia taulukon rivi- ja sarakesummiin,
frekvenssitaulukon reunajakaumiin. Ne voidaan tutkimusongelmaan sopivalla tavalla
skaalata uudelleen. Kun esimerkiksi vertaillaan viittä koulutustaso-ryhmää
massat skaalataan verrannollisiksi niiden väestötason osuuksiin (CAiP, s. 23).
Tällainen datan esikäsittely on normaali osa korrespondenssianalyysin soveltamista.

Jos massat halutaan vakioida osajoukoissa yhtä suuriksi, ratkaisu on yksinkertainen.
Korrespondenssianalyysin taulukoksi otetaan riviprofiilitaulukko, jossa rivien summat
ovat yksi.

Kuvassa \@ref(fig:simpleCA3map1) on tehty näin, ja kartta eroaa hämmästyttävän
vähän maiden otoskokoja massoina käyttävästä kartasta \@ref(fig:simpleCA1map1).


```{r simpleCA3map1, echo=FALSE, fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}

# Sama kartta - maiden massat vakiotu - simpleCA3 luotu koodilohkossa EkaCA
# CA:n lähtötietona riviprofiilit

#par(cex = 0.8)
plot(simpleCA3, map = "symmetric", mass = c(TRUE,TRUE),
main = "symmetrinen kartta 2 ",
sub = "Maidet massat vakioitu (riviprofiilidata)")

```

Pienimpien otosten maat (Bulgaria, Unkari) liikahtavat hieman origoa kohti,
Bulgaria hieman enemmän kohti maltillista puolta y-akselin suuntaan.


```{r simpleCA3map2, echo=FALSE, fig.cap= "Q1b: lapsi kärsii jos äiti on töissä",fig.asp = 1, out.width = "90%",fig.align = "center"}

plot(simpleCA3, map = "rowgreen",
     contrib = c("absolute", "absolute"),
     mass = c(TRUE,TRUE),
     arrows = c(FALSE, TRUE),
     main = "kontribuutiokartta 3",
     sub = "sarakevektorin ja rivipisteiden värin tummuus = absoluuttinen kontribuutio, riviprofiilidata")

```

Kontribuutiokartta \@ref(fig:simpleCA3map2) ei juuri eroa edellä esitetystä
kartasta \@ref(fig:G1-3asymmContrib1).


En ole vakioinut vertailtavien ryhmien (tässä maat) suhteellisia osuuksia. Syy on
yksinkertainen: esittelen menetelmää sen perusmuodossa ilman kovin täsmällisiä
tutkimusongelmia. Oikeiden tutkimuskymysten vastausia pitää tietysti etsiä järkevillä
massojen skaalauksella. Korrespondenssianalyysi on inertian dekomponointia,
jakamista osiin.


## Karttojen erot

Yksinkertaisen korrespondenssianalyysin peruskuva on symmetrinen kartta. Ehkä
yllättäen sen "...tulkinta on edelleen menetelmän kaikkein kiistanalaisin aspekti”
(CAiP s.295, @RefWorks:doc:5c768b09e4b02df9431e950a).


Sarake- ja rivisteet esitetään siinä ikään kuin päällekkäin, samassa koordinaatistossa.
Niiden pääkoordinaatit ovat kuitenkin eri pistejoukoista tai avaruuksista. Asymmetrisessä
kartassa pisteet ovat samassa avaruudessa, ja ero on Greenacren mukaan vain skaalaus.
Asymmetrisessä kartassa standardikoordinaateissa esitetyt ideaalipisteet skaalataan
pääakselien suunnassa vastaavilla pääakselien inertioiden neliöjuurilla. Siten pisteiden
suuntavektorit niin pääkoordinaateissa kuin standardikoordinaateissa ovat lähes samat
kun akselien inertioiden (principal inertias) neliöjuuret eivät ole liian erisuuruisia.

Jos pääinertioiden neliöjuuret ovat hyvin eri suuruisia, tulkintaongelmia voi tulla, mutta
niillä ei käytännössä ole merkitystä. Siksi hän pitää skaalausdebattia akateemisena
kiistana, käytännön sovelluksissa sillä ei ole merkitystä.
@RefWorks:doc:5c754c6de4b0947789165cde kommentoi skaalausta perusteellisesti,
kiista on ollut aika sitkeä mutta lienee laantunut.

Symmetinen kartta hyvä vaihtoehto, sillä asymmetrisessä skaalaus vie
ideaalipisteet usein kauas ja pääkoordinaateissa esitetyt pisteet pakkautuvat kuvan
keskelle. Toisaalta jos dataa tulkitaan asymmetrisesti kontribuutiokartta on
hyvä vaihtoehto. Silloin rivipisteiden khii2-etäisyydet esitetään optimaalisesti
ja sarakkeiden suuntavektoreille projisoiduilla pistellä on kaksoiskuva-tulkinta.


Greenacren mukaan kartoilla voi tavoitella kolmea eri asiaa. Kuvassa voi esittää
rivipisteiden etäisyydet, sarakepisteiden etäisyydet tai rivi- ja sarakepisteiden
etäisyydet. Jäkimmäinen on kaksoiskuvien (biplot) ns. skalaaritulo-ominaisuus.
Rivi- ja sarakepisteen skalaaritulo "palauttaa" alkuperäisen datan, tässä
tapauksessa taulukon solun.

Näistä vain kaksi voidaan optimaalisesti esittää yhtä aikaa.

_Symmetrisessä kartassa_ khii2-etäisyydet rivipisteiden välillä ja sarakepisteiden
välillä esitetään optimaalisesti. Rivi- ja sarakepisteiden välisiä etäisyyksiä ei
esitetä optimaalisesti, mutta ne voidaan tulkita kohtalaisen hyvin jos pääakselien
inertioiden neliöjuuret eivät ole liian erisuuruisia.

_Asymmetrisessä kartassa_ pääkoordinaateissa esitetyn pistejoukon etäisyydet
kuvataan optimaalisesti, standardikoordinaateissa esitetyt pisteet ovat "ääriprofiileja",
verteksin kulmapisteitä. Rivi- ja sarakepisteiden etäisyydet esitetään optimaalisesti,
mutta sarakepisteiden etäisyyksillä ei ole suoraa tulkintaa,

_Kontribuutiokartta_ on muunnelma asymmetrisestä kartasta. "Ääriprofiilit" vedetään
kohti origoa kertomalla ne massojen neliöjuurilla. Näin kuva selkenee, ja "kutistetun"
pisteen etäisyys origosta kertoo sen kontribuution pääakseleille. Näiden pisteiden
välisillä etäisyyksillä ei ole suoraa tulkintaa.

Jako standardi- ja pääkoordinaatteihin on suora seuraus korrespondenssianalyysin
matemaattisesta ratkaisusta. Greenacre esittelee kaksoiskuvia käsittelevässä
kirjassaan [@RefWorks:doc:5a857a43e4b0ed2d44664d7c] selkeästi koordinaattien
yhteyden ratkaisualgoritmiin, singulaariarvohajoitelmaan.


Koordinaattien yhteys voidaan esittää kahtena yksinkertaistettuna kaavana
( @RefWorks:doc:5b8175eee4b08da192f99a35, s.174 ):

\begin{equation}
  pääkoordinaatit = standardikoordinatit \times \sqrt{pääakselien \: inertiat}
    (\#eq:pcfromstd1)
\end{equation}

\begin{equation}
  kontribuutiokoordinaatit = \sqrt{massat} \times  standardikoordinatit
    (\#eq:kontribfromstd1)
\end{equation}
