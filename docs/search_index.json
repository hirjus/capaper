[["index.html", "Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä Alkutoimia", " Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä Jussi Hirvonen Versio 0.6, tulostettu 2020-11-16 Alkutoimia # testaukseen 7.11.2020 virheilmoituksia varten arvo TRUE options(tinytex.verbose = TRUE) PDF-tulostus oikuttelee ja kaatuu, mutta pdf-syntyy. MikTeX vaihdettu TinyTeX-engineen ja pdflatex -&gt; xelatex (15.11.20). 27.10.20 Vertailin testi-bookdownin ja capaperin asetuksia. Poistin YAML-headerista viimeisen rivin toc-depth: 2. Onko eri latex-engine? Poistin ongelmia aiheuttavan taulukon (Saksan ja Belgian aluejako). Eivät auttaneet pdf-tulostuksen ongelmaan. Dokumettiin kuuluvat Rmd-tiedostot luetellaan eksplisiittisesti _bookdown.yml-tiedostossa. RefWorksistä eksportattu bib-tiedosto kannattaa avata ensin (Atomilla), ja korjailla skandit jos niissä on vikaa. Koodi näkyy Galkun tulosteessa (https://hirjus.github.io/Galku), jossa on myös pitkiä listauksia muunnosten tarkistuksista ja kuvia eri versioina. Koodi kopiodaan Galkusta, kommentoidaan pois tarkistuksia ja muita välitulostuksia. Koodin ydinasiat koitetaan pitää samana kuin Galkussa, isommat muuutoksen ensin siellä ja sitten tähän projektiin. Raportti yhtenä html-tiedostona (https://hirjus.github.io/capaper/JH_capaper.html). 12.11.20 Raportissa on hieman liian pitkiä ca:n numeeristen tulosten listauksia, poistetaan tai lyhennetään rajusti poimimalla oleellisia rivejä. Periaatteessa vain yksi (Saksan ja Belgian jako) jää, siinä kerrotaan miten tuloksia luetaan. Gitbook-tulosteessa ei saa koodia piilotettua, asetus code_folding: hide vaatii teeman (theme). _output.yml - tiedostoon lisätty html_book - formaatti, siinä voi tarvittaessa käyttää piilotusta. Versiointi: 0.0n aloittelua, 0.n jäsentely koko paperille, 1.n.n valmiimpaa tekstiä. "],["johdanto.html", "Luku 1 Johdanto 1.1 Tutkielman tavoite 1.2 Tärkeimmät lähteet ja ohjelmistot 1.3 Korrespondenssianalyysin historiaa", " Luku 1 Johdanto edit Kirjoitetaan disposition pohjalta, keräillään kaikki yleiset ca-luonnehdinnat yhteen paikkaan eli johdantoon. johdannon ydinsisältö 1. CA:n periaatteet voi esitellä yksinkertaisen kahden luokittelumuuttujan taulukon analyysin avulla. Kun taulukko on pieni, on helppo vertailla CA:n karttoja dataan. Yksinkertainen kahden luokittelumuuttujan korrespondenssianalyysi antaa graafisen analyysin perussäännöt tulkinnalle. Kaikki muut korrespondenssianalyysin muodot ovat saman algoritmin soveltamista toisen tyyppiisiin datamatriiseihin, ja tulkintaa sovelletaan vastaavasti.((Greenacre ja Hastie 1987) s. 437). Tämä Greenacren ja Hastien artikkelissaan esittämä periaate helpottaa huomattavasti juuri graafisen data-analyysin eli korrespondenssianalyysin karttojen tulkinnan perussääntöjen oivaltamista. Juuri kartat, samassa kuvassa esitettävät havainnot ja muuttujat ovat CA:n tärkein menetelmä, mutta ei aivan helppo. 2. CA on kuitenkin vahvimmillaan isojen ja monimutkaisten aineistojen analyysissä. Siksi ns. monimuuttujakorrespondenssianalyysin lyhyessä esittelyssä aineistoa laajennetaan, sillä on erittäin vaikeaa osoittaa kotiakvaarioissa, että verkko on tehokas((Roux ja Rouanet 2004), s.15). loppuosa johdannosta vielä vanhoja tekstipätkiä (16.11.2020) 1.1 Tutkielman tavoite k Tässä kerrotaan, miksi tämä työ on kirjoitettu. Esitellään menetelmä käyttämällä oikeaa dataa. Täsmällisempi esitys sirotellaan esimerkkiaineiston analyysin tulosten esittelyn lomaan. Pitäisikö tässä tuoda esille ns. ranskalaisen koulukunnan matemaattisen perusteiden korostus, ja data-analyysin filosofia? Ehkä ei, koska sen pohdinta ei ole pääasia. Se tietysti mainitaan, ja asiaa pohditaan. ks Esitellään korrespondenssianalyysin käsitteet ja graafisen analyysin periaatteet. k -mitä ca on? - dimensioiden vähentäminen ja visualisointi mihin dataan se soveltuu: kahden luokittemuuttujan taulukon lukumäärädata (count data) tai suhdeasteikon muuttujia samassa mittayksikössä (esim. euroissa). määrittele graafinen, deskriptiivinen, eksploratiivinen data-analyysi yksinkertainen ca, useamman muuttujan ca zxy Miksi eksporatiivinen (määrittele!) ja deskriptiivinen (määrittele!) menetelmä on esitettävä in vivo, toiminnassa? Oppikirjoissa (viitteitä) erityisesti MG on havainnolistanut CA:n matemaattista ja geometristä taustaa synteettisillä aineistoilla. Turha kopioida tähän. Menetelmän ydin on yksinkertaisen graafisen esityksen  kartan  avulla tulkita monimutkaisen empiirisen aineiston muuttujien riippuvuuksia. Yhteyksiä ei tiivistetä todennäköisyyspäättelyn kriteereillä tilastolliseen malliin, vaan deskripriivisen analyysin hengessä esitellään koko aineisto. Mallin sijaan vähennetään ulottuvuuksia, ja siinä menetetään informaatiota. Tavoitteena on säilyttää yleensä kaksiulotteisessa kuvassa mahdollisimman suuri osa alkuperäisen datan vaihtelusta. Eksploratiivinen data-analyysi on vuoropuhelua aineiston kanssa. Analyysiä tarkennetaan, rajataan ja muokataan, kun aineisto paljastaa jotain kiinnostavaa tai yllättävää. Tästä saa jonkinlaisen aasinsillan matriisiyhtälöiden puolustukseksi. Saksan ja Belgian datan jakaminen on hyvä esimerkki, on osattava tarttua menetelmän tulosmatriiseihin. k esitystavan perustelu kenelle kirjoitettu? Menetelmästä kiinnostuneelle tilastotieteen ja data-analyysin perusteet tuntevalle. R-ohjelmisto ei ole rajoitus, SPSS ja SAS sopivat (SPSS - MG:llä kriittinen huomio loose ends - paperissa tai CAip-teorialiitteessä). 1.2 Tärkeimmät lähteet ja ohjelmistot Michael Greenacre luennoi lyhyen kurssin korrespondenssianalyysistä Helsingin yliopistossa keväällä 2017(M. Greenacre 2017). Luennot ja laskuharjoitukset perehdyttivät minut ensimmäistä kertaa tähän menetelmään, ja kurssin materiaaleihin olen usein palannut. Michael Greenacren kärsivällisesti kirjoitettu Correrspondence Analysis in Practice (jatkossa CAiP) (M. J. Greenacre 2017) ja sen aikasemmat versiot ovat tehneet menetelmää laajasti tunnetuksi.Biplots in Practice (jatkossa Biplots) (Greenacre 2010) esittää menetelman osana yleisempää kaksoiskuvien ideaa. Ranskalaisen lähestymistan perusoppikirja(Roux ja Rouanet 2004) (GDA-kirja?) esittelee menetelmän matemaattiset perusteet. Lyhyt historiallinen katsaus ja menetelmä soveltamisen perusajatusten esittely valaisevat ranskaa taitamattomalle data-analyysin koulukunnan ideoita. Kirjoittajat esittelevät perusteellisesti joitain empiirisiä tutkimuksia, ja lyhyt mutta naseva matriisilaskennan kritiikki on hyvä panna merkille. edit Hyvin lyhyesti, lause tai pari. On oma liite tekneisestä ympäristöstä. zxy R, ca-paketti. löytyy myös muita paketteja. Rmarkdown(Yihui Xie 2018), ja bookdown ((Xie 2016) ja toinen viite (Xie 2020)). Mikäs tuo jälkimmäinen on? PDF-lähdeluettelossa ei ole url-osoitteita. k Helposti toistettavan tutkimukset periaatteet Datastan perusmuunnokset ja muuttujatyypit tehdään kun data luetaan R-ohjelmistoon. Koodi selkeää ja dokumentoitua. Tärkeä lähde (McNamara ja Horton 2018) R, LaTeX, pandoc - versiot dokumentoidaan Tarkemmin liittessä. 1.3 Korrespondenssianalyysin historiaa k1 Tiivis esitys lähteineen. Historian voi aloittaa jo pari vuosikymmentä vallineesta tilanteesta. CA on yksi deskriptiivinen (ei-tn-teoriaan perustuvaa päättelyä) menetelmä muiden joukossa, eristyneisyys murtui hitaasti 80-luvun aikana. k2 Historialla on vain historiallista merkitystä. Kiinnostava juttu, mutta aika laaja ja lavea. k3 Peruskäsitys monessa lähteessä (vihreä kirja, GDA-kirja jne.): synty ja kukoistus Ranskassa, loistava eristys (splendid isolation), pikku hiljaa hyväksyntä. Syiksi esitetään kaksoismuuria: abstrakti matemaattinen (bourbakilainen) perusta ja esitystapa ja kieli. k4 Mitä historiasta on hyvä tietää. 1. Matemaattinen perusta on tosi, mutta onko menetelmän soveltaminen riippuvainen siitä? Ei ole ollut. Ristiriita data-analyyttisen/kuvailevan jne. lähestymistavan ja tilastollisen mallintamisen välillä - on läsnä edelleen mutta turha korostaa. Myös tilastollisen mallintamisen ja päättelyn sisällä on kiistoja, erilaisia näkemysiä ja kuiluja. Esoteerinen tieteenfilosofia? Kiinnostava aihe, ehkä. Murgtag-sitaatti. "],["data.html", "Luku 2 Data 2.1 Aineiston rajaaminen maat ja muuttujat", " Luku 2 Data Käytän tutkielmassa International Social Survey - projektin (ISSP) vuoden 2012 kyselytutkimusta Perhe , työ ja sukupuoliroolit(International Social Survey Programme: Family and Changing Gender Roles IV). Tutkielman tärkeimmissä lähteissä (esim. CAiP, Biplots) tutkimuksen aikaisemmat versiot ovat esimerkkiaineistona, samoin Greenacren luennoilla 2017. Länsi-Saksan ja USA:n tutkimuslaitosten yhteistyö vakiintui ISSP-organisaatioksi 1984 (http://www.issp.org). Vuonna 2015 neljän perustajajäsenen joukko oli kasvanut 49 maahan. Vertailevan tutkimuksen aineistoja on kerätty monista teemoista, perhearvoista ja naisten työmarkkina-asemasta neljä kertaa (1988, 1994,2002,2012). USA:n edustajana mukana ollut Tom W. Smith näkee aineistojen arvon juuri kansainvälisessä vertailevassa tutkimuksessa. Järjestön julkaisuluettelossa oli 2012 yli 5200, ja viime vuosina yli 400 vuodessa lisää. (Smith 2015). Saksalainen GESIS-tutkimuslaitos ylläpitää data-arkistoa, josta suurin osa datasta ja dokumentaatiosta on vapaasti saatavissa (https://www.gesis.org/en/issp/home). Suomessa tutkimuksen data ja dokumentaatio löytyvät Tampereen yliopiston Aila-tietoarkistosta (https://services.fsd.uta.fi/catalogue/FSD2820?tab=summary&amp;study_language=fi). GESIS-instituutin datakatalogista löytää kätevästi kaiken dokumentaation, mutta edes saksalaiset eivät voi estää www-sivustojen innokaita uudistajia. Kaikki linkit lähdeluettelossa vievät vain GESIS-arkistosivulle, josta löytää pitkän listan pdf-dokumentteja. Taulukossa @Ref(tab:ISSPdocsTable) on neljän tärkeimmän dokumentin tiedostonimi. Taulukko 2.1: ISSP 2012: tärkeimmät dokumentit dokumentti sisältö tiedosto Variable Report Perusdokumentti, muuttujien kuvaukset ja taulukot ZA5900_cdb.pdf Study Monitoring Report tiedokeruun toteutus eri maissa ZA5900_mr.pdf Basic Questionnaire Maittain sovellettava kyselylomake ZA5900_bq.pdf Contents of ISSP 2012 module substanssikysymykset taulukkona ZA5900_overview.pdf Questionnaire Development kyselylomakkeen laatiminen ssoar-2014-scholz_et_al-ISSP_2012_Family_and_Changing.pdf Tutkimuksen viitetieto, linkki vie dokumenttiluetteloon koska hanke on päättynyt. Kaksi versiota, käytetään ensimmäistä ((2016) 2016) . Data ja dokumentaatio (ml. käyttöehdot) löytyvät GESIS-instituutin datakatalogista (https://zacat.gesis.org)(ISSP 2016). Tätä kirjoittaessa (10.11.2020) tutkimuksen aineisto löytyy osoitteesta [https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900]. Datakatalogista löytää tällä hetkellä (10.11.2020) dokumetit ja datan helpoiten. Koodikirjan (Variable report) (GESIS 2016) selostaa tarkasti tietosisällön. Tutkimuksen seurantaraportti (Study Monitoring Report) (Gendall ja Randow 2016) kertoo miten tutkimus käytännössä toteutettiin. Kyselylomake (ISSP 2012 - Family and Changing Gender Roles IV Basic Questinnaire&lt;br&gt; 2011) ja suomenkielinen versio (Tilastokeskus 2012) ja myös kaikki muut kieliversiot voivat olla hyödyllisiä. Tiedonkeruun tarkoitus ja kyselyn suunnitelun ideat kerrotaan omassa raportissa (Scholz ym. 2014). 2.1 Aineiston rajaaminen maat ja muuttujat Olen valinnut laajasta aineistosta 25 maata ja joukon muuttujia. Maat on valittu niin, että ne ovat suhteellisen samankaltaisia ja valitut muuttujat ovat niissä samanlaisia. Kysymyksissä on jonkin verran pieniä eroja, mutta joissain tapauksissa ero on merkittävä. Esimerkiksi Espanja on jostain syystä jättänyt tässä käytetyistä muuttujista ns. neutraalin (en samaa enkä eri mieltä) vastausvaihtoehdon pois, joten Espanja jää pois. Substanssimuuttujat ovat yksi kysymyspatteri, jolla luodataan asenteita naisten roolista työmarkkinoilla. Aiheen pysyvää ajankohtaisuutta kuvaa hyvin The Economist - lehden artikkeli Saksojen yhdistymisen 30-vuotispäivänä (3.10.2020, A reportreveals the interplay between policy and attitudes that influences the decision to work.). Artikkeli on maksumuurin takana mutta tutkimus on vapaasti luettavissa (DIW Weekly Report 38 / 2020, S. 403-410) (https://www.diw.de/de/diw_01.c.799302.de/publikationen/weekly_reports/2020_38_1/mothers_in_eastern_and_western_germany__employment_rates_and_attitudes_are_converging__full-time_employment_is_not.html) Taulukon 2.2 kysymysten lyhyet versiot ovat datassa mukana. Sarakkeessa muuttuja on alkuperäisen aineiston muuttujanimi, kysymyksen tunnus on valittuun dataan luotu muuttujanimi. Vertailu muihin samalla aineistoilla tehtyihin tutkimuksiin on helpompaa. Taulukko 2.2: ISSP2012:Työelämä ja perhearvot - kysymykset muuttuja kysymyksen tunnus, lyhennetty kysymys V5 Q1a Working mother can have warm relation with child V6 Q1b Pre-school child suffers through working mother V7 Q1c Family life suffers through working mother V8 Q1d Womens preference: home and children V9 Q1e Being housewife is satisfying V10 Q2a Both should contribute to household income V11 Q2b Mens job is earn money, womens job household V12 Q3a Should women work: Child under school age V13 Q3b Should women work: Youngest kid at school SEX Respondents age AGE Respondents gender DEGREE Highest completed degree of education: Categories for international comparison MAINSTAT Main status: work, unemployed, in education TOPBOT Top-Bottom self-placement (10 pt scale) HHCHILDR How many children in household: children between [school age] and 17 years of age MARITAL Legal partnership status: married, civil partership URBRURAL Place of living: urban - rural k Kyselylomakkeilla kysymykset olivat hieman pidempiä, kuvassa 2.1 osa suomenkielistä lomaketta. Kuva 2.1: Suomenkielinen lomake Valituista taustamuuttujista monet on kerätty haastattelulla. Tiedonkeruu, otantamenetelmät ja yksikkövastauskadon huomioiminen on tehty joka maassa omalla tavallaan. Aineistoissa on mukana painot joilla tulokset voidaan korottaa perusjoukon tasolle, mutta kansainvälisiä vertailupainoja ei syystä tai toisesta ole. Taustamuuttujat kuten koulutustaso on harmonisoitu vertailukelpoisiksi. Tutkimuksen kohdeperusjoukko on 18-vuotiaat tai sitä vanhemmat, poikkeuksina Suomi (15 - 74 vuotiaat), Islanti, Japani, Etelä-Afrikka ja Venezuela. Jos ohitetaan pienet erot kysymyksissä ja vastausvaihtoehdoissa jäljelle jää erävastauskato, kyselytutkimusten ominaisuus. Jostain syystä joihinkin kysymyksiin ei vastata. Esimerkiksi Ranskassa yli 20 prosenttia kieltäytyi vastaamasta lasten (HHCHILDR) lukumäärää kysyttäessä, ja aika moni myös muissa perherakenteeseen liittyvissä kysymyksissä. Tässä tutkielmassa monimuuttujakorrespondenssianalyysiä käytetään tämän ongelman tai datan ominaisuuden analyysiin. Poistin aineistosta havainnot, joissa tieto iästä tai sukupuolesta puuttuu (32969-32823 = 146 havaintoa). Aineiston luokittelu- ja järjestysasteikon muuttujat muunnetaan R-ohjelmiston factor-tietotyypiksi. Teen muunnokset useammassa vaiheessa heti kun data on luettu SPSS-tiedosta. Käsittelyssä koitan noudattaa helposti toistettavan tutkimuksen periaatteita (McNamara ja Horton (McNamara ja Horton 2018) ), koodi ei saisi olla kovin virhealtista (haurasta) ja tarkistuksia tehdään paljon. Data-analyysin ja ehkä erityisesti korrespondenssianalyysin idea on kuitenkin operoida matriiseilla, lisätä ja poistaa rivejä ja sarakkeita ja rakennella mutkikkaampia matriiseja yksinkertaisemmista. Analyysivaiheessa koodi muuttuu hauraammaksi. Aineisto ja korrespondenssianalyysi Michael Greenacre on käyttänyt aineistoa eri vuosilta luentomateriaaleissa kuten Helsingissä 2017(M. Greenacre 2017) ja ainakin kahdessa oppikirjassaan((Greenacre 2010), (M. J. Greenacre 2017)). ISSP - aineisto vuodelta 1989 on käytetty myös neljän singuaariarvohajoitelmaan perustuvan menetelmän vertailuun(Greenacre 2003). Blasius ja Thiessen ((Blasius ja Thiessen 2006)) arvioivat aineiston laatua ja ja maiden vertailtavuutta vuoden 1994 aineistolla. Substanssitutkimusta en käsittele, näiden esimerkkien lisäksi ISSP:n ja GESIS-instituutin www-palveluista löytyy paljon muitankin. Sukupuoliroolien (gender roles) ja niihin liittyvien asenteiden vertailevaa kansainvälistä (cross-cultural) tutkimusta on tehty paljon. Tutkimusongelman sisällöllisten ja teoreettisen kysymysten nykytilaa kuvaa tuore artikkeli (Walter 2018). Toisessa esimerkissä (Ferragina ja Seeleib-Kaiser 2015) tutkitaan ensin 18 OECD-maan perhepolitiikan muutoksia kolmen viime vuosikymmenen ajalta. Näkökulma on työllisyyspolitiikka ja menetelmänä monimuuttuja-korrespondenssianalyysi (MCA). Havaituille kehityssuunnille etsitään toisessa vaiheessa selityksiä. Aineistona on viisi kansainväliseen vertailuun soveltuvaa aineistoa, yhtenä niistä ISSP:n data kolmelta kierrokselta (1988,1994,2002). "],["yksinkertainen-korrespondenssianalyysi.html", "Luku 3 Yksinkertainen korrespondenssianalyysi 3.1 Äiti töissä - kärsiikö lapsi? 3.2 Korrespondenssianalyysin esimerkki: symmetrinen kartta 3.3 Korrespondenssianalyysin peruskäsitteet 3.4 Kontribuutiot kartalla 3.5 Massat 3.6 Karttojen erot", " Luku 3 Yksinkertainen korrespondenssianalyysi Korrespondenssianalyysin peruskäsitteet ja muuttujien yhteyden graafisen analyysin periaatteet voi esittää kahden luokitelumuuttujan ristiintaulukoinnin eli kontigenssitaulun analyysin avulla. Kyse ei ole pelkästään helposta esimerkistä, vaan peruskäsitteet ja geometrisiin perusteisiin nojaava graafinen analyysi ovat oleellisilta osin samat myös monimutkaisemmissa menetelmän sovelluksissa. MG&amp;Hastie korostivat tätä, ja MG:n oppikirjat ovat hyvä esimerkki perusteellisesta yksinkertaisen taulukon analyysin esitystavasta. GDA-kirja (viite) korostaa ranskalaisen perinteen mukaisesti matemaattista teoriaperustaa, mutta myös siinä menetelmä peruskäsitteet ja tulkinnat esitellään yksinkertaisella esimerkillä (Fisherin Cairness-data, Mustonen (viite) käyttää samaa dataa). Esitän tässä jaksossa korrespondenssianalyysin peruskäsitteet intuitiivisesti, matemaattiset yksityiskohdat löytyvät liittestä 1. Esitystavan etu on taulukon pieni koko, johtopäätökset voi helposti tarkastaa datasta. Näin päästään nopeasti pääasiaan, graafiseen analyysiin. Tämä ei ole ainoa mahdollinen näkökulma, korrespondenssianalyysillä on useita vaihtoehtoisia tulkintoja. Se voidaan ymmärtää myös moniulotteisen varianssianalyysin kaltaiseksi hajonnan dekomponoinnin menetelmäksi. GDA-kirjassa numeeriset tulokset ovat tulkinnan lähtökohtana ja vasta sitten katsotaan graafista esitystä. CAiP (viite) pitää numeerisia tuloksia tärkeinä, niiden avulla varmistetaan kuvan tulkinnan pätevyys. 3.1 Äiti töissä - kärsiikö lapsi? Aineisto on kuuden maan vastaukset kysymykseen Q1b: Alle kouluikäinen lapsi todennäköisesti kärsii, jos hänen äitinsä käy työssä. Kysymys on voimakkaasti muotoiltu (editMG on jossain jutussa havainnut, että kyselyn kahdessa kysymyksessä on sana äiti ja niiden vastausten jakaumat poikkeavat. Jos löydän lähteen lisään sen tähän). Kysymykset on suunniteltu kokonaisuudeksi, ja niitä analysoidaan yhdessä luvussa 7, yhden taulukon analyysi esittelee menetelmän. (alaviite:Tämän havaitsi eräs lastensuojelun ammattilainen: kysymys on irrallisena monimerkityksellinen (vähintään ns. double - barreled), eikä siihen voi oikein järjevästi vastata. Pitäisi tietää missä lapsi on, mitä hän tekee). Havainnot joissa tieto vastauksesta puuttuu on poistettu aineistosta. Taustamuuttujia ovat vastaajan sukupuoli ja ikä. Frekvenssitaulukossa 3.1 on esitetty vastausten suhteellinen jakauma, lukumäärät on jaettu havaintojen lukumäärällä (8143). Korrespondenssianalyysissä kaikki on suhteellista, ja analyysi perustuu tähän taulukkoon. Taulukon reunajakaumat kertovat jokaisen maan ja jokaisen vastausvaihtoehdon suhteellisen osuuden. Näitä suhteellisia osuuksia kutsustaan korrespondenssianalyysissä rivi- ja sarakemassoiksi. Taulukko 3.1: Kysymyksen Q1b vastaukset maittain, suhteelliset frekvenssit S s ? e E Total BE 2.35 5.54 5.38 6.78 4.68 24.72 BG 1.45 4.85 2.52 2.33 0.16 11.31 DE 2.03 4.61 2.43 6.61 5.38 21.05 DK 0.86 2.92 1.87 2.85 8.55 17.05 FI 0.58 2.31 1.83 5.19 3.72 13.63 HU 2.69 3.54 2.76 2.33 0.92 12.24 Total 9.95 23.76 16.79 26.10 23.41 100.00 Muuttujien luonne on usein erilainen. Tähän aineistoon sopii riviprosenttientaulukko, vertaillaan vastausten jakaumia maiden välillä. Taulukon sarakkeet ovat muuttujia ja rivit havaintoja. Rivit on saatu summaamalla (aggregoimalla) vastaukset maittain. (viite: MG kutsuu näitä rivejä termillä samples, osajoukot). Taulukko 3.2: Kysymyksen Q1b vastaukset, riviprosentit S s ? e E Total BE 9.49 22.40 21.76 27.42 18.93 100.00 BG 12.81 42.89 22.26 20.63 1.41 100.00 DE 9.63 21.88 11.55 31.39 25.55 100.00 DK 5.04 17.15 10.95 16.71 50.14 100.00 FI 4.23 16.94 13.42 38.11 27.30 100.00 HU 21.97 28.89 22.57 19.06 7.52 100.00 All 9.95 23.76 16.79 26.10 23.41 100.00 Sarakeprosentit antavat toisen näkökulmaan samaan dataan. Taulukko 3.3: Kysymyksen Q1b vastaukset, sarakeprosentit S s ? e E All BE 23.58 23.31 32.04 25.98 19.99 24.72 BG 14.57 20.41 15.00 8.94 0.68 11.31 DE 20.37 19.38 14.48 25.32 22.98 21.05 DK 8.64 12.30 11.12 10.92 36.52 17.05 FI 5.80 9.72 10.90 19.91 15.90 13.63 HU 27.04 14.88 16.46 8.94 3.93 12.24 Total 100.00 100.00 100.00 100.00 100.00 100.00 Tavoitteena on korrespondenssianalyysin kartta, jossa rivi- ja sarakepisteet on esitetty samassa kuvassa. Sarakeprosenttien taulukossa on esitetty sarakkeiden suhteelliset jakaumat. Näitä suhteellisia rivejä ja sarakkeita kutsutaan korrespondenssianalyysissä rivi- ja sarakeprofiileiksi. k Rivit on saatu alkuperäisestä aineistosta osajoukkojen summina. MG:n terminologialla samples. Korrespondenssianalyysin perusidea on analysoida rivien ja sarakkeiden yhteyttä (korrespondenssia) rivi- tai sarakeprofiilien hajonnan avulla. Hajontaa mitataan poikkeamilla keskiarvorivistä tai sarakkeesta, ja massat otetaan huomioon, kun hajonnat lasketaan yhteen. Kuva 3.1: Q1b:Sarakeprofiilit ja keskiarvoprofiili Kuva 3.2: Q1b: riviprofiilit ja keskiarvorivi Kuvasta 3.2 3.2 esimerkiksi näkee, että Tanska (DK) näyttäisi poikkeava keskiarvorivistä paljon, samoin Bulgaria. Bulgarian massa on kuitenkin aineiston pienin (11,31 %), Tanskan taas kohtalainen (17 %). Sarakeprofiilikuvassa 3.1 täysin eri mieltä - vastaus (E) on selvästi erilainen ja sen massa on suuri (23%). Kaikki luvut ovat suhteellisia, havaintojen lukumäärä ei vaikuta tulkintaan periaatteessa mitenkään. Mikä on rivien (havaintojen) ja sarakkeiden (muuttujien) yhteys? Kahden luokittelumuuttujan riippuvuutta voidaan testata \\(\\chi^{2}\\) - testillä. Riippumattomuushypoteesin mukainen odotettu solufrekvenssi on taulukon 3.1 reunajakaumien alkioiden tulo. Testisuure saadaan laskemalla yhten jokaisen solun havaittujen ja odotetettujen frekvenssien erotukset muodossa \\[\\begin{equation} \\chi^{2} = \\frac{(havaittu - odotettu)^2} {odotettu} \\tag{3.1} \\end{equation}\\] Tämä voidaan esittää ca:han sopivammalla tavalla parilla muunnoksella, jolloin saamme riveittäin vastaavat termit rivisummalla painotettuna: \\[\\begin{equation} rivisumma \\times \\frac{(havaittu \\: riviprofiili - odotettu \\: riviprofiili)^2} {odotettu \\: riviprofiili} \\tag{3.2} \\end{equation}\\] Kun jaamme nämä tekijät havaintojen kokonaismäärällä \\(n\\), rivisumma muuntuu rivin massaksi, ja niiden summa muotoon \\(\\frac{\\chi^{2}}{n}\\). \\[\\begin{equation} \\frac{\\chi^{2}}{n} = \\phi^{2} \\tag{3.3} \\end{equation}\\] Huomaa jakajassa n, ei n-1. Tässä ei tn-päättelyä! Tunnusluku \\(\\phi^{2}\\) on korrespondenssianalyysissä kokonaisinertia (total inertia). Se kuvaa, kuinka paljon varianssia taulukossa on ja on riippumaton havaintojen lukumäärästä. Tilastotieteessä tunnusluvulla on useita vaihtoehtoisia nimiä (esim. mean square contingency coefficient), ja sen neliöjuurta kutsutaan \\(\\phi\\) - kertoimeksi. Tässä siirrytään kahden luokittelumuuttujan taulukosta suhteellisten frekvenssien taulukkoon. Kaavojen (3.1) ja (3.2) yhteyden pitäisi olla selkeä. Frekvenssitaulukossa (jossa kaikki taulukon luvut on jaettu havaintojen lukumäärällä N riviprofiilien 1 ja 3 (euklidinen) etäisyys on \\[\\begin{equation} \\sqrt{(p_{11} - p_{31})^2 + (p_{12} - p_{32})^2 + (p_{13} - _{33})^2+ (p_{14} - _{34})^2+ (p_{15} - _{35})^2} \\tag{3.4} \\end{equation}\\] Rivien \\(\\chi^{2}\\) - etäisyys on painotettu euklidinen etäisyys, jossa painoina ovat riviprofiilin odotetut arvot. Ne ovat riippumattomuushypoteesin mukaisesti riviprofiilien keskiarvoprofiilin vastaavat alkioit \\(r_{i}\\) . \\[\\begin{equation} \\sqrt{\\frac{(p_{11} - p_{31})^2} { r_{1}} + \\dots + \\frac{(p_{15} - p_{35})^2} {r_{5}}} \\tag{3.5} \\end{equation}\\] Inertia voidaa esittää rivien ja keskiarvorivin (sentroidin) \\(\\chi^{2}\\) -etäisyyksien neliöiden painotettuna summana, jossa painoina ovat rivien massat \\(m_{i}\\) ja summa lasketaan yli rivien \\({i}\\). \\[\\begin{equation} \\phi^{2} = \\sum_{i} (massa \\: m_{i}) \\times (profiilin \\: i \\: \\chi^{2} - etaisyys \\: sentroidista)^{2} \\tag{3.6} \\end{equation}\\] edit Tässä esitystavassa viite on CAiP, teorialiitteessä tarkemmin. Tarkoitus on esittää yksinkertaisesti taulukon datan analyysin käsitteet ja CA:n peruskäsitteet profiili, massa ja \\(\\chi^{2}\\) - etäisyys k ca-ratkaisu: rivi- ja sarekepilvien dimensio on sarakkeiden tai rivien lukumäärä vähennettynä yhdellä, pienempi kahdesta vaihtoehdosta. Tämä seuraa yksikertaisesti rivi- ja sarakeprofiilien suhteellisuudesta, niiden summat ovat 1. k Etsitään kaksiulotteinen ratkaisu (taso), joka minimoi pisteiden khii2-etäisyyksien poikkeamien summan eli on mahdollisimman lähellä pisteitä. K rivi- ja sarakeongelma ratkaisu johtaa saamaan lopputulokseen. Tämä duaalisuus on korrespondenssianalyysin perusominaisuuksia. 3.2 Korrespondenssianalyysin esimerkki: symmetrinen kartta Kuva 3.3: Q1b: lapsi kärsii jos äiti on töissä k Kartan tulkinta Kartassa (symmetrisessä kartassa) on jo nimetty molemmat akselit, mutta tulkinta aloitetaan prosenteista. Ne kertovat, kuinka paljon aineiston inertiasta eli hajonnasta on kaksiulotteisesssa projektiossa saatu kuvattua akseleille. Ensimmäinen akseli saa aina suurimman osan inertiasta, tässä 76 prosenttia. Kun toinen akseli kuvaa 15 prosenttia koko inertiasta, on kartalla esitetty 91 prosenttia aineiston hajonnasta. Loput 9 prosenttia jää 3. ja 4. dimensiolle. Nämä selitysosuudet ovat samantapainen laskelma kuin perinteisen regressiomallin selitetty vaihtelu ja jäännösvaihtelu. Kontrastit määrittävät akselien tulkinnan . Benzacrin ohjeen mukaan (1992, teoksessa GDA s. 49) katsotaan mitä on oikealla ja mitä vasemmalla. Akselien tulkinta perustuu siihen, mitä mitä yhteistä on kaikilla elementeillä jotka ovat origon vasemmalla puolella ja vastaavasti origon oikealla puolella. Samalla tavalla tulkitaan toinen akseli, mitä on ylhäällä ja alhaalla. editKäytän jatkossa muuttujista niiden symboleja sanallisen kuvauksen sijaan. Tässä tapauksessa taulukon rivit ovat havaintoja (samples ) ja sarakkeet muuttujia, ja akselien tulkinta tehdään muuttujien avulla. Vasemmalla on E ja oikealla puolella samanmieliset vastaukset s ja S. Neutraali ? on s-vastausten vasemmalla puolella. Kun erot ovat suhteellisia, ei kuvan perusteella voi sanoa kuinka paljon. Sarakkeet voi projisoida ensimmäiselle akselille (ts. katsoa niiden x-koordinaatin) , ja tässä ne ovat oikeassa järjestyksessä. Jos vastausvaihtoehdoille haluaisi antaa numeeriset arvot, x-akselin koordinaatti olisi ehkä parempi kun järjestysnumero? Ensimmäisen dimenosion tulkinta on aika selkeä. Toinen akseli on kontrasti lievemmän tai maltillisemman erimielisyyden ja muiden vastausten kanssa. Se on 1. dimension suuntaan kaikkein lähimpänä origoa. Hieman varoivaisemmin akselin voi tulkita maltillisen ja jyrkemmän tai varmemman mielipiteen kontrastiksi. Maiden vertailu tehdään näiden akselien suuntaan. Sekä sarekepisteiden että rivipisteiden keskinäiset välimatkat approksimoivat optimaalisesti niiden (khii2)etäisyyksiä. Sarake- ja rivipisteiden välisillä etäisyyksillä ei ole mitään suoraa tulkintaa. Pisteiden etäisyydet samassa pistepilvessä ovat suhteellisia, Saksa on konsevatiivisempi kuin Suomi mutta emme tiedä kuinka paljon. Maiden järjestys oikealta vasemmalle on selkeä, Tanska on vasemmalla liberaalina ääripäänä, oikealla taas Unkari ja Bulgaria. Pystyakselin suuntaan nähdään, että kaikkein maltillisin mutta kuitenkin liberaali on Suomi, jyrkimmät mielipiteet löytyvät Unkarista ja Tanskasta. Näitä tulkintoja voi vertailla edellä esitettyihin kahteen kuvaan rivi- ja sarakeprofiileista. Kartta kertoo aika paljon enemmän. Kartta on approksimaatio neliulotteisen pistepilven hajonnalle. Vain origo on siinä tarkasti esitetty, se on koko aineiston keskiarvopiste, ja pisteiden hajonta sen ympärillä kuvaa poikkeamaa riippumattomuushypoteesista. Tärkeä geometrinen periaate on se, että kaukana on kaukana myös alkuperäisessä pistepilvessä, mutta kartalla lähellä olevat pisteet eivät välttämättä ole lähellä. Projektio kutistaa pisteiden etäisyyksiä. Approksimaation laatu selviää korrespondenssianalyysin numeerisista tuloksista, samoin se miten rivi- ja sarakepisteen määrittävät akselit. Kartoissa tärkein tekninen yksityiskohta on kuva- tai muotosuhde (aspect ratio). Akseleiden mittayksikön pitää olla sama (eli muotosuhten 1). Jos kuvia tulostetaan useassa formaatissa kannattaa olla tarkkana. Kuvien on jo analyysivaiheessa oltava lukukelpoisia, ja symbolien kokoa joutuu isoissa aineistoissa säätämään. Tulosten esittäminen lopullisessa muodossa vaatii jo paljon vaivannäköä, tässä tutkielmassa esitetään vain datan analysoinnin valikoituja kuvia. Graafinen data-analyysi on vaivatonta vasta sitten kun se tehty. En jatkossa esitä kuvailevia akseleiden nimiä kuvissa, akseleiden nimeäminen on kuvan tulkinnan toinen askel. Liitteessä 1 on esitetty korrespondenssianalyysin matemaattisen ratkaisun periaate. k Kuva tai kartta - käytän termejä synonyymeinä - on se taso, joka parhaiten selittää neliulotteisen pisteparven hajontaa suhteessa koko aineiston keskiarvopisteeseen eli sentroidiin. Matemaattisesti ratkaisu saadaan soveltamalla singulaariarvohajoitelmaa, ja tulokseksi saadaa taso joka on lähimpänä pistepilviä. Etäisyyttä mitataan massoilla painotetulla khii2-etäisyysmitalla. k Intuitiivisesti idea on aivan sama kuin pääkomponenttianalyysissä (PCA, principal component analysis). Ratkaisu löydetään akseli kerrallaan. Ensi pistepilvestä etsitää akseli, jolle ortogonaalisesti projisoitujen pisteiden hajonta on suurin. Sitten etsitään sille kohtisuora toinen akseli samalla säännöllä, ja näin jatketaan kunnes koko pilven hajota on jaettu näille uusille akseleille. tavoitteena on muutaman dimension approksimaatio moniulotteiselle datalle, yleensä kaksiulottoinen kartta. k CA on paintotettu PCA 3.3 Korrespondenssianalyysin peruskäsitteet edit Sulava kuvaus tulkinnasta, painotus kuvien tulkinnassa. CA:n numeeriset tulokset vasta seuraavassa luvussa. Tässä mitä kuvasta näkee, ei muuta (paitsi varoitukset - mitä ei näe). Idea koko ajan taulukon sarakkeiden ja riveien yhteyksien visualisointi. edit Tärkeää selkeä kuvaus pääkoordinaattien ja standardikoordinaattien suhteesta. Tarkemmin teorialiitteessä, tässä heuristisesti jotta kuvia osaa tulkita. Korrespondenssianalyysille on vakiintunut oma käsitteistö, joista tärkeimmät on jo mainittu. Kun tulkinta perustuu ääripäihin, puhutaan kontrasteista ja distinktiosta. Luokittelumuuttujan arvot taas ovat modaliteetteja. Tärkein periaate on se, että kaikki on suhteellista. Ydinkäsitteitä ovat korrespondenssianalyysin tripletti: khii2-etäisyys, massat ja profiilit. Kolmikkoa täydentää kvartetti, neljä siitä johdettua käsitettä: inertia eli (painotettu) varianssi, sentroidi (painotettu keskiarvo, barysentrinen periaate), aliavaruus ja projektio. (CAiP, s. 49). k rivi- ja sarakeratkaisun duaalisuus: viite CAiP, jossa käydään läpi perusteellisesti. k khii2-etäisyys on profiilien painotettu euklidinen etäisyys (ja toki neliöjuuri!) jossa painoina ovat keskiarvoprofiilin elementtien käänteisluvut eli elementtien etäisyyden neliö jaetaan keskiarvoprofiilin alkiolla. edit: khii2-etäisyydestä ehkä teorialiitteeseen? k khii2-testin oletukset eivät välttämättä ole voimassa kaikissa aineistoissa, mutta etäisyysmittaa käytetään silti, sen perustelu on paljon yleisempi. k khii2-etäisyys on ainoa etäisyysmitta, joka toteuttaa distributional equivalence - periaatteen, CA:n tärkein juttu (Benzecri), avain kaikkiin CA:n ominaisuuksiin. (Viite:CAip epilogi) k normalisointi, samaan tapaan kuin PCA:ssa. Jos lukumäärätaulukko, Poisson-jakauman hajonta on sama kuin odotusarvo eli jaetaan poikkeama keskiarvosta hajonnalla. k CAiP epilogi: khii2 on yhteys Mahlanobis-etäisyyteen ja multinomijakaumaan, jonka realisaatioiksi kontingenssitaulun rivit (esim.) voidaan tulkita. (s. 301). Millaista dataa? Korrespondenssianalyysin sovelletaan yleisimmin frekvenssitaulujen analyysiin, lukumäärädataan (count data). Periaatteessa mikä tahansa data sopii, kunhan se voidaan järkevästi esittää suhteelisina lukumäärinä (relative amounts), siis suhdeasteikon (ratio scale) muuttujana. Tässä oleellista on tulkittavuus tutkimusongelman näkökulmasta. Välttämätön ehto on sama mittayksikkö: lukumäärä, rahayksikkö, pituusmitta kelpaavat. (CAiP s. 15). Toinen ehto on ei-negatiivisuus (nolla tai nollaa suurempi luku) , kts. kuitenkin GDA (tietyilllä ehdoilla myös neg. arvot. Rajat ovat melko joustavat, kun mukaan otetaan erilaiset uudelleenskaalaukset ja transformaatiot. Tämä oli menetelmän perusidea jo Benzecrillä(CAiP ch 26, s. 201). 3.3.1 Asymmetrinen kartta ja ideaalipisteet Kuva 3.4: Q1b: lapsi kärsii jos äiti on töissä Barysentrinen periaate edit kuva ei ehkä tarpeen? Tehdään vähän pienempi (out.width = 70%, muuten 90%). Kuva 3.5: Q1b: lapsi kärsii jos äiti on töissä edit Perustelu kuvalle: barysentrinen periaate on kuvien tulkinnassa ydinasioita. Akseleiden tulkinta tai tulkinnan varmistaminen akseli kerrallaan. Ortogonaaliset projektion piirretty käsin, havainnollistetaan periaatetta. 3.4 Kontribuutiot kartalla Kaksi kuvaa, joissa pisteiden massat on kuvattu pisteiden koolla (ei juuri eroa huomaa) ja rivi- ja sarekepisteiden kontribuutiot värisävyllä. Mitä tummempi sitä suurempi kontribuutio. Absoluuttiset ja suhteelliset kontribuutiot. edit Pitäisikö kuvissa olla aina toinen absolute, toinen relative? Selvitetään teorialiittessä? Toinen kuva riittää, tässä esitellään kartta jossa on eniten informaatiota. Absoluuttiset kontribuutiot Oletuspistekoko ok, mutta html- ja pdf-tulostus on erilainen! Kuva 3.6: Q1b: lapsi kärsii jos äiti on töissä Rivi- ja sarakesymbolien koko on suhteessa pisteen massaan, mutta eroja ei tässä kovin selkeästi näe.Suhteellisen värisävyn erot näyttävät absoluuttisten kontribuutioiden erot selkeästi. Suhteelliset kontribuutiot Kuva 3.7: Q1b: lapsi kärsii jos äiti on töissä 3.5 Massat edit3 Onko vakioitujen massojen kartta liian aikaisin? Tämä ei ole pääasia, vaan selvennys. Miksi tässä? Perusteltava, miksi en vakioi massoja maille, sukupuolille jne. (a) perusteltua kun tarkempi tutkimusongelma, esim. erottelut maiden ja sukupuolten välillä. Varianssianalyysin tapaan varianssin hajoittaminen ryhmisen sisäiseen ja ryhmien väliseen. Kts. teorialiitteestä esim. ABBA. (b) CA perusmuodossa, massa on yksi kolmesta tärkeimmästä käsitteestä. (c) on aika työlästä! edit4 Galkussa verrattu molempien painotusten khii2-etäisyyksiä, jos tarpeen niin teoria-liitteeseen. Kuva 3.8: Q1b: lapsi kärsii jos äiti on töissä Ei kovin isoja eroja, tässä datassa. Vilkaistaan myös absoluuttisia kontribuutioita. Kuva 3.9: Q1b: lapsi kärsii jos äiti on töissä 3.6 Karttojen erot Yksinkertaisen korrespondenssianalyysin peruskuva on symmetrinen kartta. Ehkä yllättäen sen tulkinta on edelleen menetelmän kaikkein kiistanalaisin aspekti. (M. J. Greenacre 2017) (s.295),(M. Greenacre 2006). vrt. myös, Johdanto, SPSS - kritiikki. k Miksi symmetrinen kartta on paras oletus? "],["täydentävät-pisteet.html", "Luku 4 Täydentävät pisteet 4.1 Täydentävät pisteet 4.2 Saksan ja Belgian alueet 4.3 CA:n numeeriset tulokset 4.4 Esimerkki 3d- kartasta - Saksan ja Belgian dimensiot", " Luku 4 Täydentävät pisteet edit Edellisssä luvussa selitetty barysentrinen keskiarvopiste; teorialiitteessä hieman laveammin. edit CA:n joustava käyttö vaatii matriisioperaatioita, ja muuta datan rakenteen muokkausta (rivien lisääminen input-dataan jne.). Tekstistä oma dokkari, eri käyttötapaukset lyhyesti. Edellisen luvun asymmetrisen kartan avulla perustellaan, miten pisteitä voidaaan lisätä. 4.1 Täydentävät pisteet edit Tiivisti tärkeimmät käyttötapaukset. CA:n peruskäsitteet ja numeeriset tulokset selitetty edellä. ks Passiiviset pisteet ja niiden käyttötarkoitukset 4.2 Saksan ja Belgian alueet Data ja taulukko aluejaosta # riviprofiilitaulukko aiheuttaa virheen PDF-tulostuksessa, JH_capaper.Rmd # tiedoston voi kuitenkin renderöidä knit-napilla RStudiossa pdf-tiedostoksi. # Kts. edellinen koodilohko - testailua pdf-ongelman ratkaisemiseksi # tallennetaan data tiedostoon, koodilohko BeDeAluedat1 passiviseksi # suppoint1_tab1 &lt;- read_rds(&quot;suppoint1tab1.rds&quot;) # suppoint1_tab1 # tarkistus ok BeDealueTable &lt;- ISSP2012esim1.dat %&gt;% tableX(maa3, Q1b, type = &quot;row_perc&quot;) knitr::kable(BeDealueTable , digits = 2, booktabs = TRUE, caption = &quot;Q1b vastaukset, Saksan ja Belgian alueet&quot;) Taulukko 4.1: Q1b vastaukset, Saksan ja Belgian alueet S s ? e E Total bF 5.04 23.81 25.89 30.83 14.43 100.00 bW 10.82 21.02 18.57 24.08 25.51 100.00 bB 17.03 20.94 16.63 23.87 21.53 100.00 BG 12.81 42.89 22.26 20.63 1.41 100.00 dW 11.40 26.82 11.83 32.13 17.82 100.00 dE 5.85 11.33 10.97 29.80 42.05 100.00 DK 5.04 17.15 10.95 16.71 50.14 100.00 FI 4.23 16.94 13.42 38.11 27.30 100.00 HU 21.97 28.89 22.57 19.06 7.52 100.00 All 9.95 23.76 16.79 26.10 23.41 100.00 Taulukko, Saksan ja Belgian alueet ja maaprofiilit. edit Riviprofiilitaulukko, kuvataan alueiden eroja. CA-analyysi kuitenkin koko aineiston frekfvenssitaululla, jossa rivien massat eivät ole samat. 4.2.1 Symmetrinen kartta Kuva 4.1: Q1b: Saksan ja Belgian aluejako k Maapisteet alueiden barysentrinen keskiarvo. Tulkinta. Kuva 4.2: Q1b: Saksan ja Belgian aluejako k Kontribuutiokartta, kontribuutio värisävyinä ja massat pisteiden kokona. Yleiskuvaan riittävä, ei kovin selkeä yksityiskohdissa. Motivaatio seuraavalle jaksolle.Skaalataan asymmetrisen kuvan sarakevektoreita (jotka standardikoordinaateissa) hieman lähemmäs origoa. k Kaukana on kaukana, mutta lähellä voi olla myös kaukana. 4.3 CA:n numeeriset tulokset edit Teorialiitteessä selitetään tarkemmin numeeristen tulosten tausta, tässä apuneuvo (a) kuvan tulkinnan varmistamiseen ja (b) approksimaation laadun tarkistamiseen. suppointCA2 ## ## Principal inertias (eigenvalues): ## 1 2 3 4 ## Value 0.154101 0.032489 0.014294 0.008944 ## Percentage 73.44% 15.48% 6.81% 4.26% ## ## ## Rows: ## bF bW bB BG dW dE DK ## Mass 0.124279 0.060174 0.062753 0.113103 0.143313 0.067174 0.170453 ## ChiDist 0.341469 0.096258 0.239034 0.630991 0.219094 0.505720 0.634063 ## Inertia 0.014491 0.000558 0.003586 0.045032 0.006879 0.017180 0.068528 ## Dim. 1 0.400065 -0.090631 0.216912 1.502458 0.254323 -1.262007 -1.506022 ## Dim. 2 -1.254042 0.267998 0.789358 0.236498 -0.451124 -0.226595 1.121468 ## FI HU BE (*) DE (*) ## Mass 0.136313 0.122436 NA NA ## ChiDist 0.347733 0.550404 0.157974 0.175013 ## Inertia 0.016483 0.037091 NA NA ## Dim. 1 -0.525222 1.215462 0.234127 -0.229593 ## Dim. 2 -1.500986 1.280342 -0.364834 -0.379468 ## ## ## Columns: ## S s ? e E ## Mass 0.099472 0.237627 0.167874 0.260960 0.234066 ## ChiDist 0.592824 0.354761 0.332288 0.280549 0.672594 ## Inertia 0.034959 0.029907 0.018536 0.020540 0.105887 ## Dim. 1 1.073310 0.787257 0.649789 -0.029859 -1.688108 ## Dim. 2 1.835133 0.290929 -0.119934 -1.451548 0.629110 k Lyhyt selostus - nämä aika selkeitä summary(suppointCA2) ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.154101 73.4 73.4 ****************** ## 2 0.032489 15.5 88.9 **** ## 3 0.014294 6.8 95.7 ** ## 4 0.008944 4.3 100.0 * ## -------- ----- ## Total: 0.209828 100.0 ## ## ## Rows: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | bF | 124 650 69 | 157 212 20 | -226 438 195 | ## 2 | bW | 60 388 3 | -36 137 0 | 48 252 4 | ## 3 | bB | 63 481 17 | 85 127 3 | 142 354 39 | ## 4 | BG | 113 878 215 | 590 874 255 | 43 5 6 | ## 5 | dW | 143 345 33 | 100 208 9 | -81 138 29 | ## 6 | dE | 67 966 82 | -495 960 107 | -41 7 3 | ## 7 | DK | 170 971 327 | -591 869 387 | 202 102 214 | ## 8 | FI | 136 957 79 | -206 352 38 | -271 605 307 | ## 9 | HU | 122 927 177 | 477 751 181 | 231 176 201 | ## 10 | (*)BE | &lt;NA&gt; 512 &lt;NA&gt; | 92 338 &lt;NA&gt; | -66 173 &lt;NA&gt; | ## 11 | (*)DE | &lt;NA&gt; 418 &lt;NA&gt; | -90 265 &lt;NA&gt; | -68 153 &lt;NA&gt; | ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | S | 99 816 167 | 421 505 115 | 331 311 335 | ## 2 | s | 238 781 143 | 309 759 147 | 52 22 20 | ## 3 | | 168 594 88 | 255 589 71 | -22 4 2 | ## 4 | e | 261 871 98 | -12 2 0 | -262 870 550 | ## 5 | E | 234 999 505 | -663 971 667 | 113 28 93 | k Tulosteen käsitteiden esittely - tavoite kuvan laadun varmistus, akselien tulkinnan tarkistus. Tarkemmin teorialiitteessä. Tästä pitäisi nähdä, miksi seuraavat kartat ovat sellaisia kuin ovat. 4.4 Esimerkki 3d- kartasta - Saksan ja Belgian dimensiot k Ei kovin hyviä kuvia, mutta periaate on tärkeä. Kartta on approksimaatio, pitää päättää milloin se on tarpeeksi hyvä. Tai mille pisteille hyvä, mille huonompi. edit 26.10.2020 summary-funktio ei toimi, kun dimensioita CA-ratkaisussa kolme. Numeeriset tulokset voisi laskea käsityönä. Kehno kvalitetti 2d-ratkaisussa saa kuvissa selityksen. suppointCA3 &lt;- ca(~maa3 + Q1b,ISSP2012esim1.dat, nd = 3) # summary(suppointCA3) # Error in rsc %*% diag(sv) : non-conformable arguments # outo juttu, ei toimi! - TÄMÄ POISTETAAN Kolme karttaa Kuva 4.3: Q1b: Saksan ja Belgian aluejako Kuva 4.4: Q1b: Saksan ja Belgian aluejako Kuva 4.5: Q1b: Saksan ja Belgian aluejako k Tulkinta. k kokeilu 3d-grafiikalla - toinen riittää Kuva 4.6: Saksan ja Belgian aluejako - 3d-kuva1 Kuva 4.7: Saksan ja Belgian aluejako - 3d-kuva2 "],["yhteisvaikutusmuuttujat.html", "Luku 5 Yhteisvaikutusmuuttujat 5.1 Ikä ja sukupuoli 5.2 Ikä, sukupuoli ja maa", " Luku 5 Yhteisvaikutusmuuttujat ks Interactive coding edit Yksinkertaisin tapa ottaa muita muuttujia mukaan analyysiin. k Kaksi yhteisvaikutusmuuttujaan (MG interactive coding), sukupuoli ja ikäluokka/kohortti ja tämän muuttujan yhdistäminen maa-muuttujaan. k Poikkileikkausaineistossa vastaajaan ikä kuvaa sekä ikää että mitä erilaisimipia sukupolvivaikutuksia. Ei voi oikein erottaa toisistaan. Vastaajat ovat elämänsä eri vaiheissa kohdanneet lukuisia rajuja muutoksia toisen maailmansodan jälkeen. Nähtiin jo edellisessä jaksossa! Poikkileikkausaineistossa vastaajan ikä kertoo ikäluokan (kohortin), vastaajat ovat kokeen esim. kaksi mullistusten vuotta elämänsä eri vaiheissa. Kaksin nuorinta ikäluokka on ollut 1990 alle 14-vuotiaita ja vanhin ikäluokka yli 44-vuotiaita. Finannsikriisin vuonna 2008 toiseksi nuorin ikäluokka on ollut 22-31 vuotiaita, ja kaksi vanhinta yli 51-vuotiaita. 5.1 Ikä ja sukupuoli edit Lyhyesti tämä, aineisto aggregoitu ikä- ja sukupuoliryhmiin. edit Voi myös lisätä täydentävinä pisteinä peruskarttaan, ei tehdä. Ikäluokat ovat (1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 tai vanhempi). Vuorovaikutusmuuttuja ga koodataan f1,, f6 ja m1,,m6. Muuttujien nimet kannattaa pitää mahdollisimman lyhyinä. Ikäjäkauma painottuu kaikissa maissa jonkinverran vanhempiin ikäluokkiin. Nuorempien ikäluokkien osuus on (alle 26-vuotiaat ja alle 26-35 - vuotiaat) varsinkin Bulgariassa (BG) ja Unkarissa (HU) pieni. k Ikä- ja sukupuoliryhmät yli kaikkien maiden; profiilit keskiarvoja. Ei kovin pätevää analyysiä, yleiskuva muuttujasta. Kuva 5.1: Q1b: ikäluokka ja sukupuoli ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.037448 87.0 87.0 ********************** ## 2 0.003977 9.2 96.2 ** ## 3 0.001041 2.4 98.6 * ## 4 0.000590 1.4 100.0 ## -------- ----- ## Total: 0.043055 100.0 ## ## ## Rows: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | f1 | 60 990 36 | -125 614 25 | -98 376 145 | ## 2 | f2 | 83 997 163 | -289 983 185 | 35 14 25 | ## 3 | f3 | 91 984 47 | -146 958 52 | 24 26 13 | ## 4 | f4 | 101 1000 97 | -186 836 93 | 82 164 172 | ## 5 | f5 | 98 879 4 | -35 658 3 | 20 221 10 | ## 6 | f6 | 100 951 176 | 256 866 175 | 80 85 162 | ## 7 | m1 | 57 659 32 | 42 72 3 | -120 587 205 | ## 8 | m2 | 66 977 57 | -187 946 62 | -34 30 19 | ## 9 | m3 | 78 457 5 | -31 318 2 | -20 139 8 | ## 10 | m4 | 89 674 14 | 58 482 8 | -37 192 30 | ## 11 | m5 | 89 988 90 | 189 818 85 | -86 170 166 | ## 12 | m6 | 89 978 277 | 360 963 307 | 45 15 45 | ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | S | 99 915 128 | 196 695 102 | 110 220 304 | ## 2 | s | 238 969 304 | 230 961 336 | 21 8 27 | ## 3 | | 168 777 46 | 62 330 17 | -73 447 223 | ## 4 | e | 261 897 58 | -68 473 32 | -64 424 268 | ## 5 | E | 234 997 464 | -286 962 513 | 55 35 177 | k Kommentteja Galkusta: Aika yksiuloitteinen (87 prosenttia ensimmäisellä dimensiolla!). Data on as it is, ei ole vakioitu ga-luokkien kokoja (massat max(f4 101), min (m1 57)). Miten pitäisi tulkita oikealle kaatunut U - muoto miehillä ja naisilla? Järjestys ei toimi, S s-sarakkeen vasemmalla puolella. Miehet konservatiivisempia, mutta maltillisempia? Nuorin ikäluokka on poikkeava. Epävarmoja tai maltillisesti e, sitten loikka vasemmalle ja sieltä konservatiiviseen suuntaa oikealle. Naisilla poikkeama f3 - f4. VAnhimmat ikäluokat tiukemmin konservatiivisa (f6, m6). Jos vertaa sukupuolten eroja samassa ikäluokassa, on aika samanlainen (miehet konservatiivisia, naiset liberaaleja). Naisista vain vanhin ikäluokka oikealla, miehistä nuorin ja kolme vanhinta. Tulkinnassa muistettava, että ikäluokat yli maiden. Voi verrata sekä edellisiin maa-vertailuihin että maan, ikäluokan ja sukupuolen yhteisvaikutusmuuttujan tuloksiin. MG tutkailee eri kysymyksellä tätä samaa asiaa, ja havaitsee että (a) maiden erot suuria ja sukupuolten pieniä (b) naiset liberaalimpia kuin miehet. ** Viite?** Numeeriset tulokset: nuorimpien miesten (qlt 659) ja erityisesti keski-ikäisten miestén m3 (qlt 457) pisteet huonosti esitetty kartalla. Tulkitaan myös cor ja ctr, riveille ja sarakkeille. 5.2 Ikä, sukupuoli ja maa ISSP2012esim1b.dat &lt;- mutate(ISSP2012esim1b.dat, maaga = paste(maa, ga, sep = &quot;&quot;)) # tarkistus, muunnos ok # ISSP2012esim1b.dat %&gt;% tableX(maa, maaga) # head(ISSP2012esim2.dat) # str(ISSP2012esim2.dat) edit Yksi vaikeaselkoinen kartta täynnä pisteitä, tihrustellaan. Kuva 5.2: Q1b: ikäluokka ja sukupuoli maittain # Vilkaistaan numeerisia tuloksia, kopioidaan tekstiin jos on tarpeellista summary(maagaCA1) ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.184895 70.3 70.3 ****************** ## 2 0.038751 14.7 85.0 **** ## 3 0.024006 9.1 94.1 ** ## 4 0.015502 5.9 100.0 * ## -------- ----- ## Total: 0.263154 100.0 ## ## ## Rows: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | BEf1 | 14 678 9 | -83 43 1 | -320 635 38 | ## 2 | BEf2 | 24 914 11 | -278 650 10 | -177 264 20 | ## 3 | BEf3 | 21 320 3 | -62 96 0 | -95 224 5 | ## 4 | BEf4 | 24 164 3 | -50 92 0 | -44 71 1 | ## 5 | BEf5 | 23 332 5 | 133 304 2 | -40 28 1 | ## 6 | BEf6 | 23 832 17 | 371 710 17 | 153 121 14 | ## 7 | BEm1 | 11 429 9 | 284 367 5 | -117 62 4 | ## 8 | BEm2 | 17 372 5 | -113 169 1 | -125 203 7 | ## 9 | BEm3 | 20 108 1 | 17 29 0 | -29 79 0 | ## 10 | BEm4 | 22 966 5 | 225 812 6 | -98 154 5 | ## 11 | BEm5 | 22 728 8 | 255 686 8 | -63 42 2 | ## 12 | BEm6 | 26 788 15 | 348 788 17 | -5 0 0 | ## 13 | BGf1 | 5 531 11 | 547 531 8 | -9 0 0 | ## 14 | BGf2 | 8 860 14 | 640 853 17 | 59 7 1 | ## 15 | BGf3 | 12 815 21 | 617 804 24 | 75 12 2 | ## 16 | BGf4 | 10 932 12 | 519 927 15 | -39 5 0 | ## 17 | BGf5 | 14 880 23 | 609 870 28 | 66 10 2 | ## 18 | BGf6 | 18 921 32 | 627 846 39 | 186 74 16 | ## 19 | BGm1 | 5 940 7 | 596 878 9 | 159 62 3 | ## 20 | BGm2 | 6 830 9 | 557 788 11 | -130 43 3 | ## 21 | BGm3 | 8 709 19 | 655 698 19 | 83 11 1 | ## 22 | BGm4 | 8 771 11 | 540 754 12 | -81 17 1 | ## 23 | BGm5 | 10 979 11 | 524 977 15 | 21 2 0 | ## 24 | BGm6 | 9 692 27 | 701 647 24 | 184 45 8 | ## 25 | DEf1 | 13 425 3 | -41 29 0 | -149 395 7 | ## 26 | DEf2 | 15 938 10 | -415 919 14 | -60 19 1 | ## 27 | DEf3 | 19 846 13 | -333 582 11 | -224 264 24 | ## 28 | DEf4 | 23 985 13 | -390 982 19 | -18 2 0 | ## 29 | DEf5 | 17 839 7 | -297 772 8 | -87 67 3 | ## 30 | DEf6 | 23 116 8 | -56 32 0 | 90 84 5 | ## 31 | DEm1 | 13 912 4 | 124 180 1 | -250 732 20 | ## 32 | DEm2 | 13 766 4 | 38 16 0 | -259 749 22 | ## 33 | DEm3 | 15 737 4 | -64 63 0 | -210 674 17 | ## 34 | DEm4 | 21 137 5 | -1 0 0 | -89 137 4 | ## 35 | DEm5 | 19 603 5 | 76 75 1 | -202 529 20 | ## 36 | DEm6 | 22 849 12 | 244 427 7 | 242 422 34 | ## 37 | DKf1 | 10 991 15 | -567 839 18 | 241 152 15 | ## 38 | DKf2 | 14 991 49 | -888 831 58 | 389 160 53 | ## 39 | DKf3 | 17 963 53 | -816 793 60 | 377 170 61 | ## 40 | DKf4 | 18 977 57 | -826 820 66 | 362 157 61 | ## 41 | DKf5 | 16 998 38 | -753 894 48 | 258 105 27 | ## 42 | DKf6 | 12 808 9 | -340 579 8 | 214 229 14 | ## 43 | DKm1 | 15 981 7 | -329 898 9 | 100 83 4 | ## 44 | DKm2 | 13 989 43 | -895 900 55 | 282 89 26 | ## 45 | DKm3 | 13 982 28 | -728 950 38 | 134 32 6 | ## 46 | DKm4 | 15 941 19 | -534 855 24 | 170 86 11 | ## 47 | DKm5 | 13 643 9 | -281 435 6 | 194 208 13 | ## 48 | DKm6 | 15 355 5 | 89 85 1 | 158 270 9 | ## 49 | FIf1 | 12 980 11 | -417 693 11 | -269 287 21 | ## 50 | FIf2 | 12 927 26 | -730 907 34 | -110 21 4 | ## 51 | FIf3 | 12 984 13 | -423 590 11 | -346 394 36 | ## 52 | FIf4 | 14 991 14 | -398 644 12 | -292 347 32 | ## 53 | FIf5 | 17 952 8 | -240 502 5 | -227 450 23 | ## 54 | FIf6 | 11 835 7 | 151 134 1 | -347 701 35 | ## 55 | FIm1 | 7 787 5 | -115 78 1 | -347 710 22 | ## 56 | FIm2 | 9 977 14 | -598 832 17 | -250 146 14 | ## 57 | FIm3 | 9 998 6 | -345 629 6 | -265 369 16 | ## 58 | FIm4 | 13 837 6 | 19 3 0 | -316 834 33 | ## 59 | FIm5 | 12 734 7 | 220 289 3 | -273 446 23 | ## 60 | FIm6 | 9 911 6 | 336 637 6 | -220 274 12 | ## 61 | HUf1 | 7 723 9 | 499 698 9 | 93 25 1 | ## 62 | HUf2 | 11 689 11 | 438 685 11 | -35 4 0 | ## 63 | HUf3 | 12 808 18 | 484 586 15 | 298 222 27 | ## 64 | HUf4 | 11 768 18 | 491 564 15 | 296 204 25 | ## 65 | HUf5 | 12 850 13 | 474 753 14 | 170 97 9 | ## 66 | HUf6 | 13 671 34 | 637 581 28 | 251 90 21 | ## 67 | HUm1 | 6 935 5 | 426 766 6 | 201 170 6 | ## 68 | HUm2 | 9 381 11 | 344 381 6 | -2 0 0 | ## 69 | HUm3 | 13 957 12 | 441 803 13 | 193 154 12 | ## 70 | HUm4 | 10 999 10 | 468 830 12 | 211 169 11 | ## 71 | HUm5 | 13 942 12 | 472 891 15 | 113 51 4 | ## 72 | HUm6 | 8 726 15 | 517 529 11 | 315 197 20 | ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | S | 99 653 155 | 450 492 109 | 258 162 171 | ## 2 | s | 238 741 174 | 364 687 170 | 102 54 63 | ## 3 | | 168 535 96 | 284 534 73 | -11 1 1 | ## 4 | e | 261 941 103 | -45 20 3 | -310 921 646 | ## 5 | E | 234 1000 471 | -714 962 645 | 141 37 119 | k Stabiilius - teorialiitteessä laajemmin mutta tässä lyhyt vilkaisu. Taulukko alkaa harveta, edellä kerrottiin että aineisto painottuu kaikissa maissa vanhempiin ikäluokkiin. yksinkertainen tarkistus? Löytyykö riviproviileja joilla pieni massa ja suuri kontribuutio? Ei löydy (Galkussa tuloksia), mutta jo kuvan tukkoisuus vaatii luokkien yhdistelyä. Aika työlästä! "],["osajoukon-korrespondenssianalyysi.html", "Luku 6 Osajoukon korrespondenssianalyysi", " Luku 6 Osajoukon korrespondenssianalyysi k Osajoukon korrespondenssianalyysin tarve: kuvat menevät tukkoon. Kun muuttujia on paljon kartat ovat täynnä pisteitä ja niitä on vaikea lukea. Usein myös havaitaan, että ratkaisun päädimensiot kertovat ylllätyksettömän ilmeisen tarinan, ja kiinnostavammat yhteydet ovat piilossa ylemmissä dimensioissa (MG ja Pardo, Vihreä kirja ss. 198). k Teoreettinen idea: inertian dekomoponointi (taas). Lasketaan ensin ca-ratkaisu ja rajataan aineisto. Yksinkertainen toteuttaa. Massat ja reunajakaumat säilyvä, ja siksi aineiston (pilven) kokonaisinertia voidaan jakaa osiin osajoukkojen inertiaksi. Uusia yhteyksiä näkyviin, tarkempi kuva datasta. Kuvan tukkoisuuteen voi toki vaikuttaa muillakin keinoilla. Muuttujien arvoja voi yhdistellä, kuvasta voi jättää pois pisteitä joiden kontribuutio on pieni tai kuvaa voi yksinkertaisesti suurentaa analyysivaiheessa näytöllä. Kuva-aluetta voi myös rajata johonkin osaan kuvaa. Kaikki pisteet ovat kuitenkin mukana määräämässä ratkaisun geometriaa. Rivejä tai sarakkeita voi myös muuttaa passiivisiksi, mutta silloin ei saavuteta käytännöllistä inertian dekomponointi-ominaisuutta. MCA-jaksossa osajoukon analysointi on pääasia ja mahdollisia vaihtoehtoja käsitellään hieman lisää. Lähteet MG ja Prado (2006)(M. Greenacre ja Pardo 2006), vihreä kirja (M. Greenacre ja Blasius 2006), CAiP (M. J. Greenacre 2017). k Simple CA subset k1 Täydentävät pisteet voi ottaa mukaan jos ne eivät ole rajatusta pilvestä. Esim. rivien osajoukon analyysiin voi ottaa sarakepisteitä täydeäntvinä pisteinä normaalisti. Osajoukon profiilit muuttuvat, niiden summa ei enään ole yksi, barysentristä ominaisuutta ei voi suoraan käyttää täydentävien rivipisteiden koordinaattien laskemiseen. Kuva 6.1: Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi Kuva 6.2: Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi Kuva 6.3: Ikä, sukupuoli ja maa:Tanska-Saksa-Suomi ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.107090 74.6 74.6 ******************* ## 2 0.024985 17.4 92.0 **** ## 3 0.006594 4.6 96.6 * ## 4 0.004882 3.4 100.0 * ## -------- ----- ## Total: 0.143551 100.0 ## ## ## Rows: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | DEf1 | 13 467 5 | -12 3 0 | -162 464 13 | ## 2 | DEf2 | 15 930 19 | -387 799 21 | -157 131 14 | ## 3 | DEf3 | 19 919 25 | -271 385 13 | -318 533 76 | ## 4 | DEf4 | 23 993 25 | -376 913 30 | -111 80 11 | ## 5 | DEf5 | 17 893 13 | -271 641 11 | -169 252 19 | ## 6 | DEf6 | 23 48 15 | -64 42 1 | 24 6 1 | ## 7 | DEm1 | 13 827 8 | 172 345 3 | -203 482 21 | ## 8 | DEm2 | 13 855 8 | 93 96 1 | -260 759 34 | ## 9 | DEm3 | 15 874 7 | -13 3 0 | -238 871 34 | ## 10 | DEm4 | 21 285 8 | 25 11 0 | -126 274 13 | ## 11 | DEm5 | 19 684 10 | 116 174 2 | -198 510 30 | ## 12 | DEm6 | 22 750 22 | 190 260 8 | 261 490 61 | ## 13 | DKf1 | 10 979 27 | -603 949 35 | 107 30 5 | ## 14 | DKf2 | 14 996 89 | -955 960 115 | 184 36 18 | ## 15 | DKf3 | 17 985 98 | -885 933 122 | 210 53 29 | ## 16 | DKf4 | 18 983 104 | -889 950 132 | 165 33 20 | ## 17 | DKf5 | 16 1000 69 | -792 988 92 | 86 12 5 | ## 18 | DKf6 | 12 834 17 | -386 745 17 | 133 89 9 | ## 19 | DKm1 | 15 978 13 | -342 971 17 | 30 7 1 | ## 20 | DKm2 | 13 997 79 | -938 988 104 | 90 9 4 | ## 21 | DKm3 | 13 989 52 | -743 989 69 | -14 0 0 | ## 22 | DKm4 | 15 962 36 | -563 952 45 | 57 10 2 | ## 23 | DKm5 | 13 682 16 | -314 543 12 | 159 139 13 | ## 24 | DKm6 | 15 291 9 | 45 22 0 | 158 269 15 | ## 25 | FIf1 | 12 951 20 | -346 478 13 | -345 474 55 | ## 26 | FIf2 | 12 941 48 | -680 788 50 | -300 153 42 | ## 27 | FIf3 | 12 952 24 | -335 370 12 | -420 582 82 | ## 28 | FIf4 | 14 999 25 | -323 426 14 | -375 573 82 | ## 29 | FIf5 | 17 982 14 | -185 299 6 | -280 683 55 | ## 30 | FIf6 | 11 704 13 | 217 274 5 | -271 430 33 | ## 31 | FIm1 | 7 624 8 | -40 10 0 | -323 614 30 | ## 32 | FIm2 | 9 984 26 | -525 640 22 | -385 344 52 | ## 33 | FIm3 | 9 990 12 | -279 412 6 | -331 578 38 | ## 34 | FIm4 | 13 944 11 | 90 67 1 | -324 877 54 | ## 35 | FIm5 | 12 722 14 | 267 426 8 | -222 295 23 | ## 36 | FIm6 | 9 911 11 | 373 785 12 | -150 126 8 | ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | S | 99 731 107 | 276 493 71 | 192 238 147 | ## 2 | s | 238 832 114 | 218 688 105 | 100 144 94 | ## 3 | | 168 647 88 | 208 576 68 | 73 70 35 | ## 4 | e | 261 992 135 | 85 96 17 | -258 896 697 | ## 5 | E | 234 1000 556 | -582 992 739 | 53 8 27 | Tulkintaa Kolmen maan osajoukon ratkaisussa 2. dimensiolla (maltillinen liberaali?) on inertiasta 17 prosenttia, edellä ollut paljon yksiulotteisempia ratkaisuja. Huono kvaliteetti on DEf1 (467) ja DEf6 (48!), DEm4 (285). Tanskan havainnoista vanhimmat miehet (DKm6,291) ovat kaikkein huonoimmin esitettyjä ratkaisussa, ja hieman nuoremmatkin (DKm5, 682). Suomen aineistossa vain nuoret miehet (FIm1, 624) on esitetty kartalla huonosti. Kaksi dimensiot selittävät osajoukon kokonaishajonnasta 92%, mutta muutaman ryhmän hajonta on muissa dimensioissa. Saksan naisten iäkkäin ikäluokka (DEf6) ja keski-ikäisen miehet (DEm4) vain näyttävät olevan lähekkäin origon tuntumassa, samoin muutama muu huonosti tasoon sijoitettu piste. Huonosti kuvatuista pisteistä ei kuva ei siis kerro oikeastaan mitään muuta. Sarakkeet on esitetty kohtalaisen hyvin, ja symmetrisessä kartassa tärkeimmälle dimensioille projisodut sarakepisteet ovat odotetussa järjestyksessä. Kontribuutiokartasta nähdään, että tärkein kontrasti on tiukan erimielisyyden (E) ja kaikkien muiden vastausvaihtoehtojen välillä. Epävarmojen tai maltillisten (e) kontrasti hallitsee toista dimensiota, erityisesti S- ja s- kategorioiden kanssa. Samalla kuvasta näkee (ja numeerisist tuloksista voi vahvistaa), että S-piste on on lähempänä (kulma on pienempi) pystyakselia. Kontribuutio on suurempi (147 vs. 71 x-akselille). Toisaalta x-akseli selittää selvästi suurimman osan kaikkien muiden sarakepisteiden inertiasta, ja y-akseli taas lähes täysin e-pisteen inertian. # Belgia, Bulgaria ja Unkari analysoidaan tiiviisti # Belgia on vähän välitapaus Bulgarian ja Unkarin ja kolmen ensimmäisen maan # kanssa. Kokeiluja voi tehdä neljällä maaryhmällä, kuvan lukukelpoisuus # ratkaisee. #BGHUsubset &lt;- c(13:24,61:72) #BEDEDKFIsubset &lt;- c(1:12, 25:36, 37:48, 49:60) #DEDKFIsubset &lt;- c(25:36, 37:48, 49:60) BEBGHUsubset &lt;- c(1:12,13:24,61:72) maagaCA2sub3 &lt;- ca(~maaga + Q1b,ISSP2012esim1b.dat,subsetrow = BEBGHUsubset) Kuva 6.4: Ikä, sukupuoli ja maa: Belgia-Bulgaria - Unkari # Vilkaistaa numeerisia tuloksia, kopioidaan tekstiin jos on tarpeen # maagaCA2sub3 summary(maagaCA2sub3) ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.086111 72.0 72.0 ****************** ## 2 0.018841 15.8 87.8 **** ## 3 0.011172 9.3 97.1 ** ## 4 0.003477 2.9 100.0 * ## -------- ----- ## Total: 0.119602 100.0 ## ## ## Rows: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | BEf1 | 14 152 19 | -156 152 4 | 2 0 0 | ## 2 | BEf2 | 24 826 24 | -313 824 28 | 13 1 0 | ## 3 | BEf3 | 21 623 7 | -90 201 2 | 130 422 19 | ## 4 | BEf4 | 24 556 6 | -65 155 1 | 105 401 14 | ## 5 | BEf5 | 23 355 11 | 115 227 3 | 86 128 9 | ## 6 | BEf6 | 23 810 37 | 396 810 41 | 10 0 0 | ## 7 | BEm1 | 11 288 21 | 246 274 8 | 55 14 2 | ## 8 | BEm2 | 17 333 11 | -144 271 4 | 68 61 4 | ## 9 | BEm3 | 20 531 2 | 6 4 0 | 75 528 6 | ## 10 | BEm4 | 22 620 11 | 197 618 10 | -8 1 0 | ## 11 | BEm5 | 22 917 18 | 243 620 15 | -168 297 33 | ## 12 | BEm6 | 26 977 33 | 347 782 36 | -173 195 41 | ## 13 | BGf1 | 5 979 23 | 557 549 18 | -492 430 63 | ## 14 | BGf2 | 8 974 32 | 649 875 38 | -219 99 20 | ## 15 | BGf3 | 12 1000 46 | 633 844 54 | -271 155 45 | ## 16 | BGf4 | 10 847 25 | 496 847 30 | 7 0 0 | ## 17 | BGf5 | 14 961 50 | 618 894 62 | -168 66 21 | ## 18 | BGf6 | 18 939 71 | 658 931 92 | -60 8 4 | ## 19 | BGm1 | 5 999 15 | 608 912 19 | 188 87 9 | ## 20 | BGm2 | 6 892 21 | 526 703 20 | -273 189 25 | ## 21 | BGm3 | 8 994 41 | 677 746 43 | -390 247 64 | ## 22 | BGm4 | 8 669 25 | 508 666 23 | -34 3 0 | ## 23 | BGm5 | 10 949 24 | 516 947 32 | -22 2 0 | ## 24 | BGm6 | 9 978 58 | 748 737 60 | -428 241 89 | ## 25 | HUf1 | 7 888 20 | 493 681 19 | 271 207 26 | ## 26 | HUf2 | 11 762 25 | 406 589 20 | 220 173 27 | ## 27 | HUf3 | 12 916 39 | 525 688 37 | 301 227 56 | ## 28 | HUf4 | 11 970 40 | 528 651 36 | 370 319 81 | ## 29 | HUf5 | 12 985 29 | 490 802 32 | 234 183 34 | ## 30 | HUf6 | 13 933 75 | 655 614 64 | 472 319 151 | ## 31 | HUm1 | 6 948 12 | 455 871 14 | 135 77 6 | ## 32 | HUm2 | 9 902 24 | 312 313 10 | 428 589 90 | ## 33 | HUm3 | 13 945 26 | 477 938 33 | -41 7 1 | ## 34 | HUm4 | 10 965 22 | 503 960 29 | 36 5 1 | ## 35 | HUm5 | 13 993 26 | 478 916 33 | 139 77 13 | ## 36 | HUm6 | 8 839 33 | 560 622 29 | 331 217 46 | ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | S | 99 944 214 | 351 479 142 | 346 465 630 | ## 2 | s | 238 942 247 | 297 711 244 | -169 231 362 | ## 3 | | 168 435 107 | 180 426 63 | 26 9 6 | ## 4 | e | 261 640 65 | -138 639 57 | -4 0 0 | ## 5 | E | 234 966 368 | -426 965 494 | 10 1 1 | # kahden osaratkaisun kokonaisinertia # 0.143551 + 0.119602 = 0.263153 # koko datalla 0.263154 Kahden osajoukon inertioiden summa on sama kuin koko aineiston, Selitysasteet kuitenkin nousevat, mutta vielä oleellisempaa on kahden aika erilaisen ryhmän havaitseminen. Belgian jotkun pisteet: huono kvaliteetti (BEf1, BEf5,BEm1, BEm2). Bulgaria ja Unkari hyvin esitetty. Belgia on pulmallinen tapaus, omissa dimensioissaan. "],["monimuuttuja-korrespondenssianalyysi-mca.html", "Luku 7 Monimuuttuja-korrespondenssianalyysi (MCA) 7.1 Pinotut ja yhdistetyt taulukot (stacked and concatenated tables) 7.2 Matched matrices 7.3 MCA - monimuuttujakorrespondenssianalyysi", " Luku 7 Monimuuttuja-korrespondenssianalyysi (MCA) k MG:n jäsentely CA:n tutkimusasetelmista (within - between), kokoaan myös edeltävät analyysit saman katon alle. k Idea: taulukoiden yhdistely supertaulukoksi tai matriisiksi, analysoidaan kahden muuttujan ristiintaulukoinnin laajennuksena useita kahden muuttujan ristiintaulukointeja. k MCA stacked&amp;concat - analyysin erikoistapauksena. k CA SVD:tä soveltavana ratkaisualgoritmina, jolle syötetään sopiva matriisi. Benzecri: löydettettävä vain matriisi joka dekomponoidaan. k1 kahden muuttujuajoukon väliset yhteydet k2 yhden muuttujajoukon muuttujien väliset yhteydet k3 wrt samples ja wrt variables k4 Yksinkertaisesta monimutkaisempaan 0. Täydentävät pisteet tulkinnan apuna, yleistyökaluna (jack of all trades but master of none) esitelty ensimmäisenä. Tärkeä lisä kaikissa analyyseissä. yhteisvaikutusmuuttujat K4-1 -max kolmen muuttujan yhtesivaikutusmuuttuja - taulukko harsoontuu Yksi selitettävä muuttuja, useampi selittävä K4-2\" pinotut taulukot (käytännössä matriisit, helpompi pinota R:ssä, Burtin taulun käyttö) Taulukoiden yhdistäminen yleisemmin K4-3 monta selittäjää ja selitettävää: taulukoita päällekkäin ja rinnakkain, lohkomatriisi ABBA: voidaan esim. jakaa taulukko (viite) osatauluiksi tästä hieman tarkemmin teorialiitteessä;symmetriset taulut (esim. vastaukset eri vuosina, isän ja pojan ammatti), matched matrices MCA K4-4 K-n tulkinnan tärkeimmät periaatteet kaikki erot suhteellisia eroja ca-ratkaisu approksimaatio; voi olla hyvä, mutta myös huono -CA on hajonnan (intertian) dekomponoinnin menetelmä. Toiset (esim. MG,ranskalaiset) painottavat graafista menetelmää ja kuvien oikeaa tulkintaa), voi ymmärtää myös moniulotteisenä skaalauksena (MDS: etsi skaalaus, joka maksimoi korrelaation) tai moniulotteisena varianssianalyysinä (ANOVA) tulkinnan tarkennus molemmissa alaluvuissa **edit* Tässä jaksossa korostuu data-analyyin eksplotatiivinen luonne, datan kaivelu ja näkökulmien muuntelu. Missä dimensiossa yhteydet ja riippuvuudet piileksivät? Kartta on tässä mielessä kartta(vaikka hieman outo), osoittaa yhdessä numeeristen tulosten kanssa suuntaa. 7.1 Pinotut ja yhdistetyt taulukot (stacked and concatenated tables) Pinotut taulut: perusidea knitr::include_graphics(&#39;img/stacked1.png&#39;) Kuva 7.1: Pinotut ja yhdistetyt taulut - periaate Lisättiin kuva Kun yhdistty taulu rakennetaan matriiseista, karttojen muuttujanimiä joudutaan siistimään. Kuvat voivat myös herkästi kääntyä akselien ympäri, ne kannataa kääntää vertailun helpottamiseksi samanlaisiksi kuin muut. Kuva 7.2: Q1b: Lapsi kärsii jos äiti käy työssä Kartan tulkinta; miten eroaa yhteisvaikutusmuuttujan analyysistä? Perustulkinta akseleille ei muutu, eikä maapisteiden sijoittuminenkaan. Mikä on maapisteiden ja kahden selittävän (eksogeenisen) muuttujan pisteiden yhteys sarakepisteisiin? Koko aineiston kartassa ikäluokkapisteet ja sukupuolipisteet ovat pakkautuneet maapisteitä tiiviimmin origon ympärille. Ikäluokkapisteiden (koko aineiston keskiarvot) selvä kontrasti on vanhimman (a6)ja toiseksi nuorimman välillä 1. dimenision suuntaan. Ikäluokkapisteet ovat koko aineiston keskiarvopisteitä, niiden sijantia voi tulkita pistejoukko kerrallaan kuten maapisteidenkin. Mitään yhteisvaikutuksia ei analysoida eksplisiittisesti. Karttaa voi verrata sukupuoli-ikäluokka yhteisvaikutusmuuttujan analyysin aiemmin. Naispiste on tiukassa nipussa ikäluokkien a3 ja a4 kanssa aivan origon vasemmalla puolella. Miesten keskiarvopiste on hieman origosta oikealle, yhdessä ikäluokan a5 kanssa. Taustamuuttujat: numeeristen tulosten tarkastelua Lisäpisteet on hyvin esitetty, niiden etäisyyksiä voi luotettavasti arvioida kuvasta. Poikkeus on nuorin ikäluokka (a1, qlt = 501). Inertian osuudet (inr) ovat yhtä vaatimattomia kuin Belgian (28) ja Saksan (29), (m =20, f = 17, a2 = 40, a6 = 83), samoin kontribuutiot akseleiden inertiaan. 1. dimension kontribuutio (ctr) on suuri (&gt;800) kaikilla paitsi nuorimmalla ikäryhmällä (a1) jolla 2. dimension selittää lähes puolet sen inertiasta (470). Vilkaistaan taas numeerisa tuloksia, varmistetaan tulkinta. Tämän voi poistaa lopullisesta versiosta. summary(Concat1jh.CA1) ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.056877 77.2 77.2 ******************* ## 2 0.010116 13.7 91.0 *** ## 3 0.003923 5.3 96.3 * ## 4 0.002711 3.7 100.0 * ## -------- ----- ## Total: 0.073628 100.0 ## ## ## Rows: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | BE | 82 498 28 | 86 295 11 | -71 203 41 | ## 2 | BG | 38 907 204 | 599 901 238 | 52 7 10 | ## 3 | DE | 70 498 29 | -95 298 11 | -78 200 43 | ## 4 | DK | 57 990 310 | -573 816 328 | 265 175 394 | ## 5 | FI | 45 987 75 | -225 419 40 | -262 568 309 | ## 6 | HU | 41 856 168 | 486 778 169 | 153 78 95 | ## 7 | m | 156 910 20 | 91 873 22 | -19 37 5 | ## 8 | f | 178 910 17 | -79 873 20 | 16 37 5 | ## 9 | a1 | 39 501 8 | -22 31 0 | -84 470 27 | ## 10 | a2 | 50 958 40 | -236 939 49 | -34 19 6 | ## 11 | a3 | 56 958 7 | -94 958 9 | -1 0 0 | ## 12 | a4 | 63 841 6 | -74 841 6 | -1 0 0 | ## 13 | a5 | 62 868 5 | 71 801 6 | -21 67 3 | ## 14 | a6 | 63 957 83 | 288 852 92 | 101 104 63 | ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | S | 99 786 147 | 268 661 126 | 117 125 134 | ## 2 | s | 238 843 172 | 205 787 175 | 55 56 70 | ## 3 | | 168 640 80 | 150 639 66 | -6 1 1 | ## 4 | e | 261 970 97 | -35 44 6 | -160 926 657 | ## 5 | E | 234 1000 504 | -390 962 628 | 77 38 138 | edit Galkussa myös subsetCA-kartta, josta Unkari ja Bulgaria on jätetty pois. Ei mitään oleellista lisätietoa, joten ei esitetä tässä. Ensimmäisen dimension osuus interitasta laskee ja toisen kasvaa. Kartan selkeys ei parane. Kuva 7.3: Q1b: Lapsi kärsii jos äiti käy työssä Sarekkeista E-sarake (täysin eri mieltä) määrittää akseleita vahvasti, kontrastina kaksi konservatiivista vastausta (S ja s) ja myös neutraali vaihtoehto (e). Numeerista tuloksista nähdään, että ikäluokat vaikuttavat juuri ensimmäiseen tärkeimpään dimensioon. Belgian ja Saksan pisteet on esitetty kartassa huonosti, samoin nuorin ikäluokka. Muiden pisteiden sijaintia voidaan arvioida myös sarakkeiden ja rivipisteiden välillä. Ikäluokkien kontrasti on selvä toiseksi nuorimman (a2) ja vanhimman (a6) välillä. edit Ikäluokkapisteet asymmetrisessä kontribuutiokartassa sarakkeiden keskiarvona, samoin maapisteet. Esimerkiksi vanhimmassa ikäluokassa on suhteellisesti paljon vastauksia samaa mieltä olevia ja neutraaleja ja vähän erimielisiä. Hyvin yksinkertainen esimerkki. edit Mutta tässä esimerkkiaineisto, jossa ei puuttuvia tietoja. Ne olisivatkin aika pulmallisia, varianssin dekomponointi ei onnistu jos reunajakaumat ovat alitauluissa erilaisia. 7.2 Matched matrices k lyhyesti matriisien yhdistelystä hyvin yleisenä analyysin menetelmänä. Voidaan tarkastella luonteeltaan erilaisten muuttujaryhmien tai muuttujien yhteyksiä kuten edellisessä esimerkissä. Huom! (16.10.20 Jos ja kun ei tehdä analyysiä, ei tarvitse omaa jaksoa. Kannattaa mainita, ehkävain teoriajaksossa? Idea: matriisien yhdistämisellä saadaan ote monenlaiseen tutkimusongelmaan. Benzecri: data-analyysissä on vain löydettävä oikea matriisi joka diagonalisoidaan. Ref:CAip ss. 177 (M. J. Greenacre 2017), HY2017_MCA, Greenacre JAS 2013 (sovellus ISSP 1989,4 kysymystä pitäisikö äidin olla kotona, 8 maata), tässä artikkelissa SVD-based methods,joista yksi CA (muut biplots, PCA, compositional data/log ratios). (Greenacre 2003) ABBAWe consider the joint analysis of two matched matrices which have common rows and columns, for example multivariate data observed at two time points or split according to a dichotomous variable. Methods of interest include principal components analysis for interval-scaled data, correspondence analysis for frequency data, log-ratio analysis of compositional data and linear biplots in general, all of which depend on the singular value decomposition. A simple result in matrix algebra shows that by setting up two matched matrices in a particular block format, matrix sum and difference components can be analysed using a single application of the singular value decomposition algorithm. The methodology is applied to data from the International Social Survey Program comparing male and female attitudes on working wives across eight countries. The resulting biplots optimally display the overall cross-cultural differences as well as the malefemale differences. The case of more than two matched matrices is also discussed. Edellisen menetelmän variantti, jossa ryhmien väliset ja sisäiset erot saadaan esiin. Inertian jakaminen. Samanlaisten rivien ja sarakkeiden kaksi samankokoista taulua, esimerkiksi sukupuolivaikutusten arviointi. Alkuperäinen taulukko jaetaan kahdeksi tauluksi sukupuolen mukaan. Matriisien yhdistäminen (concatenation) riveittäin tai sarakkeittain ei näytä optimaalisesti mm - matriisien eroja. Ryhmien välisen ja ryhmien sisäinen inertian erottaminen, ABBA on yksi ratkaisu (ABBA matrix, teknisesti block circular matrix). Luokittelu voi olla myös kahden indikaattorimuuttujan avulla jako neljään taulukkoon (esim. miehet vs. naiset länsieuroopassa verratuna samaan asetelmaan itä-Euroopassa). Samaa ideaa laajennetaan. Esimerkkinä Attitudes to women working in 2012. 7.3 MCA - monimuuttujakorrespondenssianalyysi k Terminologiasta: monta muuttujaa on jo ollut käytössä. MCA on monimuuttujamenetelmä samassa mielessä kuin faktorianalyysi. Analysoidaan usean statukseltaan samanlaisen muuttujan välisiä suhteita, ja myös niiden yhteyksiä tutkimusongelman kannalta eksogeenisiin taustamuuttujiin tai selittäjiin. Surveytutkimuksen kyselylomakkeen kysymyspatterit luotaavat tietoa joistain taustalla olevista asenteista. edit yksi kappale, jossa tutkimusasetelmaa verrataan tilastollisten mallien asetelmaan? Jako selittäjiin ja selitettävään, moniyhtälömallit? Faktorianalyysi tässä selkein vertailukohde k Matemaattisesti kaikki muuttuu paljon mutkikkaammaksi, ja yksinkertaisen perustapauksen selkeät tulkinnat eivät toimi. Tärkeä asia: CA:n skaalausominaisuudet ja visuaalinen tulkinta pätevät edelleen. edit Teorialiitteessä tästä enemmän, ranskalaiset hieman eri mieltä Viitteitä MG ja MG&amp;Prado ovat tutkineet ISSP-datalla tätä ongelmaa. Biplots In practice - kirja (Greenacre 2010), ss.142- dimensions of middleness. Mg ja Prado artikkelissaan (M. Greenacre ja Pardo 2006) ja samasta teemasta laajentaen kokoomateoksessa (M. Greenacre ja Blasius 2006), ss. 197-217. Aineistona jälkimmäisessä tutkimuksessa on sama kysymyssarja kuin tässä 1994 datasta. Kysymyksissä on jonkin verran eroja. Ensimmäisessä artikkelissa he kommentoivat vertaisarvioitsijoiden ehdotuksia. Kuvia voisi selkiyttää esittämällä vain osan pisteistä sarjassa karttoja, mutta ratkaisu perustuisi siinäkin koko dataan ja sitä nimenomaan ei haluta. Toinen ehdotus on yhdistää ne vastausvaihtoehdot jotka eivät ole tutkimuksen kohteena yhdeksi yhdistetyksi kategoriaksi. Tällöin osajoukon korrespondenssianalyysin kätevä inertia dekomponointi osajoukille ei toimisi. Ratkaisu ei toimi ollenkaan yleisimmissä osajoukoissa. k Data Taustamuuttujien taulukoissa on yllättävän isoja eroja, jotkut taulukoiden luokat ovat nollia tai hyvin vähän havaintoja. Luokkia pitäisi ehkä yhdistellä,jo pelkästään kuvaroskan takia. Ei tehdä. k Puuttuvat havainnot, muutama numero vain mitä listwise delete saa aikaan. #Puuttuvien tietojen yleiskuva # Puuttuvat tiedot aineistossa - viite datan dokumentointiin jossa taulukot. # Vaihtelee maittain ja muuttujittain, paljon. # Koko data (G1_1_data2.Rmd - skriptissä valitut muuttujat ja 25 maata) # #sum(!complete.cases(ISSP2012jh1d.dat)) = 9455 #dim(ISSP2012jh1d.dat) = 32823 #9455/32823 = 0.2880602 # Puuttuvat tiedot valitussa MCA-aineistossa #missingMCAvars1 &lt;- c(&quot;Q1a&quot;,&quot;Q1b&quot;, &quot;Q1c&quot;, &quot;Q1d&quot;,&quot;Q1e&quot;,&quot;Q2a&quot;,&quot;Q2b&quot;,&quot;edu&quot;, # &quot;sosta&quot;, &quot;urbru&quot;, &quot;maa&quot;, &quot;ika&quot;, &quot;sp&quot; ) #missingTestMCA1.dat &lt;- ISSP2012jh1d.dat %&gt;% select(all_of(missingMCAvars1)) #sum(!complete.cases(missingTestMCA1.dat)) = 6101 #dim(missingTestMCA1.dat) = 32823 #6101/32823 = 0.1858758 Puuttellisten havaintojen osuus. Koko tähän tutkimukseen valitussa aineistossa (25 maata ja muuttujat, poistettu havainnot joissa ikä tai sukupuoli puuttuu) 71% havainnoista on kaikki tiedot. MCA-analyyseihin valitun 7 + 3 = 10 muuttujan aineiston havainnoista 81% on vailla puuttuvia tietoja. Jos puuttuvat tiedot poistetaan (ns. listwise delete, poistetaan jos yksi tai useampi tieto puuttuu) viidesosa datasta jää pois. k lyhyt kappale - puuttuvien tietojen käsittely on laaja aihe. Otantamenetelmissä ja survey-aineistojen (kyselytutkimusten) oppaissa käsitelty monipuolisesti. k Miten liittyy tähän? CA on koko aineiston kuvailevaa analyysiä, ei päättelyä otoksesta perusjoukon tasolle. Miten puuttuvia vastauksia voisi kuvailla? Toisaalta edellisen jakson menetelmien soveltaminen on mahdotonta, jos jotain ei tehdä (reunajakaumat oltava samoja). MCA1 - seitsemän kysymystä (jokaisessa viisi vaihtoehtoa) ## [1] 32823 7 Kuva 7.4: MCA: Seitsemän kysymystä - 25 maata, kartta 1 k Perustulkinta: Inertian selitysosuudet ovat paljon pienempiä, ja ratkaisu on selvästi kaksiulotteinen. Puuttuvat vastaukset erottuvat omana ryhmänä, ja varsinaiset vastaukset ovat pakkautuneet y-akselin oikealle puolelle. Niiden erot näkyvät vain toisessa dimensiossa. Ensimmäinen dimensio kuvaa vastaamattomuutta (syystä tai toisesta) vs. kaikkia vastauksia. Pystyakselin suuntaan kontrasti näyttäisi olevan konservatiiviset ylhäällä, modernit ja liberaalimmat alhaalla. Pisteitä on vaikea erottaa toisistaan. Karttaa voi parantaa lisäämällä siihen vastaajien (n= 32 823) pisteet (viite MG - ekologiakirja, jossa vanhempi ISSP-data). Kuva 7.5: MCA: Seitsemän kysymystä - 25 maata, kartta 2 Jokainen havainto on sarakevektoreiden keskiarvopiste. Sarakevektoreita ei voi tulkita yhtä selkeästi kuin yksinkertaisessa korrespondenssianalyysissä. Ne eivät edusta kysymystä vaan kysymyksen yhtä vastauskategoriaa, pitkä jono nollia ja ykkösiä. Rivipiste on vastauksiaan vastaavien sarakepisteiden keskiarvopiste. Jos vastaaja on valinnut vaihtoehdot (a1S, a2s,, b2?) se on näiden pisteiden keskiarvopiste. Oleellista MCA-kartan tulkinnassa on kuitenkin yleiskuvan muodostaminen, geometrinen tulkinta on hieman hankala. Skaalausominaisuudet MCA kuitenkin säilyttää (Viite, teorialiitteessä hieman tarkemmin). Myös riviprofiilit ovat samanlaisia, jokaisella rivilla on kuudessa kategoriassa (vastaukset ja puuttuva tieto) nollia ja yksi ykkönen. Rivien välistä etäisyyttä määrittelevä ainoastaa erimielisyydet, ja GDA-kirjan (viite) ohjeen mukaan MCA-karttojen tulkinta pitäisi aloittaa yksilöiden pilven ääripäistä. Pistepilven muoto kertoo , kuinka pienenevä joukko vastaajia lähestyy kiilana puuttivien tietojen pisteitä. Kaikkiin kysymyksiin vastanneet ovat massana kuvan oikeassa laidassa. Pistepilvet oikealta vasemmalle kuvaavat kuinka moneen kysymykseen on jätetty vastaamatta. (MG-vastaava kuva (Greenacre 2010), luku 14. dimenisions of middleness.) Pieni joukko määrää koko kartan koordinaatiston. Osajoukon MCA k Osajoukon MCA ratkaisee ongelman tyylikkäästi. Kuva 7.6: MCA: Seitsemän kysymystä - 25 maata, kartta 3 k Tulkinta: kontrasti ääripäiden välillä, vahvat mielipiteet (S ja E) hallitsevat vasenta alakulmaa ja oikeaa laitaa x-akselin tuntumassa. Maltilliset vastaukset ja neutraali vaihtoehto ovat ylhäällä vasemmalla. k Johtopäätös: seitsemän kysymystä erottelee hyvin vastaajat liberaali - konservatiivi - aksellilla. Maltilliset ja neutraalit vastaukset sijaitsevat ääripäiden välissä. Karttaan voi hahmotella diagonaalin suuntaisen akselin vahvojen mielipiteiden ryppäiden välille. Muut vastaukset ovat ns. kaariefektin mukaisesti näiden välisellä U-muotoisella linjalla. Tämä kuuluisa Guttan efekti kertoo järjestysasteikon muuttujien korrelaatiosta, hyvä asia kun kysymyksillä luodataan asenteita naisten työssäkäyntiin. Kaariefekti on myös geometrinen välttämättömyys, tarkemmin teorialiitteessä. Kuva 7.7: MCA: Seitsemän kysymystä - 25 maata, kartta 4 Kun kartalle lisätään havainnot, nähdään selvästi kuinka suuri hajonta on havaintojen pilvessä verrattuna vastauskategorioiden pilveen. Asymmetrinen kartta näyttäisi olevan paras vaihtoehto, vastausvaihtoehdot erottuvat selvemmin. Kuva 7.8: MCA: Seitsemän kysymystä - 25 maata, kartta 5 edit1 Jostain syystä en saa toimimaan mjca-funktiossa subsecat - parametrin kanssa täydentäviä muuttujia supcol. edit2 MCA - numeeriset tulokset summary(Qmuuttujat2.mca) ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.129087 55.0 55.0 *************** ## 2 0.064296 27.4 82.4 ******* ## 3 0.014807 6.3 88.7 ** ## 4 0.008871 3.8 92.5 * ## 5 0.000538 0.2 92.7 ## 6 0.000221 0.1 92.8 ## 7 0.000156 0.1 92.9 ## 8 6.9e-050 0.0 92.9 ## 9 1e-06000 0.0 92.9 ## -------- ----- ## Total: 0.234728 ## ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | a1S | 48 975 29 | 441 916 73 | -112 59 9 | ## 2 | a1s | 54 869 20 | -117 206 6 | 210 663 37 | ## 3 | a1? | 15 653 27 | -354 626 14 | 73 26 1 | ## 4 | a1e | 18 788 29 | -451 709 28 | -150 79 6 | ## 5 | a1E | 5 884 30 | -339 113 4 | -887 771 56 | ## 6 | b1S | 12 818 37 | -367 133 12 | -831 685 128 | ## 7 | b1s | 37 696 28 | -387 689 42 | -39 7 1 | ## 8 | b1? | 26 527 25 | -194 269 8 | 189 258 14 | ## 9 | b1e | 39 555 25 | 98 67 3 | 266 488 43 | ## 10 | b1E | 24 889 43 | 821 858 126 | -156 31 9 | ## 11 | c1S | 12 826 38 | -379 141 14 | -836 685 134 | ## 12 | c1s | 36 698 29 | -393 692 43 | -35 6 1 | ## 13 | c1? | 26 517 25 | -198 282 8 | 181 235 13 | ## 14 | c1e | 38 550 26 | 79 41 2 | 281 509 46 | ## 15 | c1E | 26 890 43 | 815 865 134 | -137 24 8 | ## 16 | d1S | 12 851 34 | -247 80 6 | -768 771 112 | ## 17 | d1s | 33 751 26 | -347 744 31 | -35 8 1 | ## 18 | d1? | 32 561 23 | -157 336 6 | 129 226 8 | ## 19 | d1e | 34 620 24 | 72 47 1 | 249 572 33 | ## 20 | d1E | 22 944 38 | 791 932 106 | -91 12 3 | ## 21 | e1S | 15 910 31 | -142 44 2 | -631 866 90 | ## 22 | e1s | 36 752 23 | -263 738 19 | 35 13 1 | ## 23 | e1? | 34 350 22 | -56 70 1 | 112 279 7 | ## 24 | e1e | 32 597 23 | 56 48 1 | 189 549 18 | ## 25 | e1E | 15 1012 32 | 726 985 62 | -119 26 3 | ## 26 | a2S | 49 1005 24 | 335 870 43 | -132 134 13 | ## 27 | a2s | 59 989 19 | -154 428 11 | 176 561 28 | ## 28 | a2? | 22 584 24 | -203 582 7 | -12 2 0 | ## 29 | a2e | 8 794 26 | -338 565 7 | -215 228 6 | ## 30 | a2E | 2 870 27 | 33 1 0 | -851 869 20 | ## 31 | b2S | 12 922 33 | -345 173 11 | -718 750 94 | ## 32 | b2s | 22 783 28 | -431 736 32 | -108 46 4 | ## 33 | b2? | 27 640 25 | -281 582 16 | 89 58 3 | ## 34 | b2e | 40 711 24 | -76 53 2 | 269 658 45 | ## 35 | b2E | 39 939 37 | 630 932 119 | -55 7 2 | summary(Qmuuttujat2.mca) ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.129087 55.0 55.0 *************** ## 2 0.064296 27.4 82.4 ******* ## 3 0.014807 6.3 88.7 ** ## 4 0.008871 3.8 92.5 * ## 5 0.000538 0.2 92.7 ## 6 0.000221 0.1 92.8 ## 7 0.000156 0.1 92.9 ## 8 6.9e-050 0.0 92.9 ## 9 1e-06000 0.0 92.9 ## -------- ----- ## Total: 0.234728 ## ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr ## 1 | a1S | 48 975 29 | 441 916 73 | -112 59 9 | ## 2 | a1s | 54 869 20 | -117 206 6 | 210 663 37 | ## 3 | a1? | 15 653 27 | -354 626 14 | 73 26 1 | ## 4 | a1e | 18 788 29 | -451 709 28 | -150 79 6 | ## 5 | a1E | 5 884 30 | -339 113 4 | -887 771 56 | ## 6 | b1S | 12 818 37 | -367 133 12 | -831 685 128 | ## 7 | b1s | 37 696 28 | -387 689 42 | -39 7 1 | ## 8 | b1? | 26 527 25 | -194 269 8 | 189 258 14 | ## 9 | b1e | 39 555 25 | 98 67 3 | 266 488 43 | ## 10 | b1E | 24 889 43 | 821 858 126 | -156 31 9 | ## 11 | c1S | 12 826 38 | -379 141 14 | -836 685 134 | ## 12 | c1s | 36 698 29 | -393 692 43 | -35 6 1 | ## 13 | c1? | 26 517 25 | -198 282 8 | 181 235 13 | ## 14 | c1e | 38 550 26 | 79 41 2 | 281 509 46 | ## 15 | c1E | 26 890 43 | 815 865 134 | -137 24 8 | ## 16 | d1S | 12 851 34 | -247 80 6 | -768 771 112 | ## 17 | d1s | 33 751 26 | -347 744 31 | -35 8 1 | ## 18 | d1? | 32 561 23 | -157 336 6 | 129 226 8 | ## 19 | d1e | 34 620 24 | 72 47 1 | 249 572 33 | ## 20 | d1E | 22 944 38 | 791 932 106 | -91 12 3 | ## 21 | e1S | 15 910 31 | -142 44 2 | -631 866 90 | ## 22 | e1s | 36 752 23 | -263 738 19 | 35 13 1 | ## 23 | e1? | 34 350 22 | -56 70 1 | 112 279 7 | ## 24 | e1e | 32 597 23 | 56 48 1 | 189 549 18 | ## 25 | e1E | 15 1012 32 | 726 985 62 | -119 26 3 | ## 26 | a2S | 49 1005 24 | 335 870 43 | -132 134 13 | ## 27 | a2s | 59 989 19 | -154 428 11 | 176 561 28 | ## 28 | a2? | 22 584 24 | -203 582 7 | -12 2 0 | ## 29 | a2e | 8 794 26 | -338 565 7 | -215 228 6 | ## 30 | a2E | 2 870 27 | 33 1 0 | -851 869 20 | ## 31 | b2S | 12 922 33 | -345 173 11 | -718 750 94 | ## 32 | b2s | 22 783 28 | -431 736 32 | -108 46 4 | ## 33 | b2? | 27 640 25 | -281 582 16 | 89 58 3 | ## 34 | b2e | 40 711 24 | -76 53 2 | 269 658 45 | ## 35 | b2E | 39 939 37 | 630 932 119 | -55 7 2 | Vilkaistaan 3d-ratkaisua - onko kolmella keskimmäisellä vaihtoehdolla dimenison of middleness? edit tämä poistetaan lopullisesta versiosta. Qmuuttujat2d3 &lt;- mjca(mcaDat11jh.dat, ps=&quot;&quot;, nd = 3,subsetcat=eiPvastaukset) summary(Qmuuttujat2d3) ## ## Principal inertias (eigenvalues): ## ## dim value % cum% scree plot ## 1 0.129087 55.0 55.0 *************** ## 2 0.064296 27.4 82.4 ******* ## 3 0.014807 6.3 88.7 ** ## 4 0.008871 3.8 92.5 * ## 5 0.000538 0.2 92.7 ## 6 0.000221 0.1 92.8 ## 7 0.000156 0.1 92.9 ## 8 6.9e-050 0.0 92.9 ## 9 1e-06000 0.0 92.9 ## -------- ----- ## Total: 0.234728 ## ## ## Columns: ## name mass qlt inr k=1 cor ctr k=2 cor ctr k=3 cor ctr ## 1 | a1S | 48 976 29 | 441 916 73 | -112 59 9 | -18 1 1 | ## 2 | a1s | 54 966 20 | -117 206 6 | 210 663 37 | 81 98 24 | ## 3 | a1? | 15 786 27 | -354 626 14 | 73 26 1 | -163 133 26 | ## 4 | a1e | 18 837 29 | -451 709 28 | -150 79 6 | -119 49 17 | ## 5 | a1E | 5 935 30 | -339 113 4 | -887 771 56 | 229 51 16 | ## 6 | b1S | 12 869 37 | -367 133 12 | -831 685 128 | 226 51 41 | ## 7 | b1s | 37 798 28 | -387 689 42 | -39 7 1 | -149 102 55 | ## 8 | b1? | 26 573 25 | -194 269 8 | 189 258 14 | -80 46 11 | ## 9 | b1e | 39 836 25 | 98 67 3 | 266 488 43 | 201 281 107 | ## 10 | b1E | 24 910 43 | 821 858 126 | -156 31 9 | -129 21 27 | ## 11 | c1S | 12 876 38 | -379 141 14 | -836 685 134 | 226 50 43 | ## 12 | c1s | 36 805 29 | -393 692 43 | -35 6 1 | -155 107 58 | ## 13 | c1? | 26 571 25 | -198 282 8 | 181 235 13 | -87 54 13 | ## 14 | c1e | 38 843 26 | 79 41 2 | 281 509 46 | 213 293 116 | ## 15 | c1E | 26 908 43 | 815 865 134 | -137 24 8 | -119 18 25 | ## 16 | d1S | 12 902 34 | -247 80 6 | -768 771 112 | 197 51 32 | ## 17 | d1s | 33 828 26 | -347 744 31 | -35 8 1 | -112 77 28 | ## 18 | d1? | 32 647 23 | -157 336 6 | 129 226 8 | -80 86 14 | ## 19 | d1e | 34 896 24 | 72 47 1 | 249 572 33 | 173 276 69 | ## 20 | d1E | 22 956 38 | 791 932 106 | -91 12 3 | -90 12 12 | ## 21 | e1S | 15 949 31 | -142 44 2 | -631 866 90 | 135 40 18 | ## 22 | e1s | 36 793 23 | -263 738 19 | 35 13 1 | -62 42 10 | ## 23 | e1? | 34 475 22 | -56 70 1 | 112 279 7 | -75 126 13 | ## 24 | e1e | 32 847 23 | 56 48 1 | 189 549 18 | 128 250 35 | ## 25 | e1E | 15 1023 32 | 726 985 62 | -119 26 3 | -78 11 6 | ## 26 | a2S | 49 1005 24 | 335 870 43 | -132 134 13 | -2 0 0 | ## 27 | a2s | 59 1011 19 | -154 428 11 | 176 561 28 | 35 22 5 | ## 28 | a2? | 22 770 24 | -203 582 7 | -12 2 0 | -115 186 19 | ## 29 | a2e | 8 796 26 | -338 565 7 | -215 228 6 | 23 3 0 | ## 30 | a2E | 2 920 27 | 33 1 0 | -851 869 20 | 202 49 5 | ## 31 | b2S | 12 961 33 | -345 173 11 | -718 750 94 | 162 38 21 | ## 32 | b2s | 22 873 28 | -431 736 32 | -108 46 4 | -151 91 35 | ## 33 | b2? | 27 741 25 | -281 582 16 | 89 58 3 | -117 101 25 | ## 34 | b2e | 40 939 24 | -76 53 2 | 269 658 45 | 159 228 68 | ## 35 | b2E | 39 944 37 | 630 932 119 | -55 7 2 | -45 5 5 | "],["yhteenveto.html", "Luku 8 Yhteenveto", " Luku 8 Yhteenveto Jäsennysdokumentissa on muutama ajatus, ja viite. Kirjoitetaan tämä viimeiseksi. Blasius ja Thiessen This paper provides empirically-based criteria for selecting Items and countries to develop measures of an underlying construct of interest that are comparable in cross-national research. Using data from the 1994 International Social Survey Program and applying multiple correspondence analysis to a set of common items in each of the 24 participating countries, we show that both the quality of the data, as well as its underlying structure - and therefore meaning - vary considerably between countries. The approach we use for screening countries and items is especially useful in situations where the psychometric properties of the items have not been well established in previous research. (Blasius ja Thiessen 2006) Surullinen totuus onnellisuustutkimuksesta Bond ja Lang (2018) (ilman sulkuja) ja suluilla (Bond ja Lang 2018) Gifi-nimimerkillä kirjoittavat Jan De Leeuw jatkavat verkkokirjassaan (julkaistu bookdown-paketilla) (Leeuw, Mair, ja Groenen 2016) keskustelua konfirmatorisen ja data-analyyttisen eksploratiivisen lähestymistavan eroista. He ovat tiukasti eksploratiivisen linjan kannattajia, ja korostavat konfliktin pitkää historiaa. Nyt historia on heidän mielestään loppunut: We shall not pay much attention any more to these turf and culture wars, because basically they are over. Data analysis, in its multitude of disguises and appearances, is the winner. Classical statistics departments are gone, or on their way out. They may not have changed their name, but their curricula and hiring practices are very different from what they were 20 or even 10 years ago. "],["liitteet.html", "Liitteet Liite 1: Korrespondenssianalyysin teoriaa Liite 2: Suomenkielinen lomake (esimerkki) Liite 3: Tekninen ympäristö ja Bookdown-paketti Liite 4: R - koodi", " Liitteet Liite 1: Korrespondenssianalyysin teoriaa Korrespondenssianalyysin perusyhtälöt ja kaavat Tässä lähteenä Greenacren kirja(M. J. Greenacre 2017) (ca in practice) ja sen liite Theory of CA. edit Muistiinpanoja löytyy, joissa viitataan myös Biplots in practice - kirjaan. Kevään 2017 kurssin luentokalvoja on myös käytetty. Lisäillään vielä käsitteitä LeRouxin ja Rouanetin kirjasta, jos on tarvis. Datamatriisilla \\(\\boldsymbol{N}\\) on \\(I\\) riviä ja \\(J\\) sarakketta (\\(I x J\\) ). Alkiot ovat ei-negatiivisia (eli nollat sallittuja) ja samassa mitta-asteikossa. Jos mitta-asteikko on intervalli- tai suhdeasteikko, mittayksiköiden on oltava samoja (esim. euroja, metrejä). Taulukon alkioiden summa on \\(\\sum_{i} \\sum_{j}n_{ij} = n\\), missä \\(i = 1, \\dots , I\\) ja \\(j = 1, \\dots , J\\). GDA-kirjassa on tarkennettu tätä vaatimusta ei-negatiivisuudesta. Korrespondenssimatriisi \\(\\boldsymbol{P}\\) saadaan jakamalla matriisin \\(\\boldsymbol{N}\\) alkiot niiden summalla \\(n\\) . Merkitään matriisin \\(\\boldsymbol{P}\\) rivisummien vektoria \\(\\boldsymbol{r}\\) (= \\((r_{1}, \\dots, r_{I})\\)) ja sarakesummien vektoria \\(\\boldsymbol{c}\\) (= \\((c_{1}, \\dots, c_{J})\\)). Niitä vastaavat diagonaalimatriisit ovat \\(\\boldsymbol{D_r}\\) ja \\(\\boldsymbol{D_c}\\). Korrespondenssianalyysin ratkaistaan singluaariarvohajoitelman avulla. Hyvin yleinen tulos, jostain syystä tilastotieteessä tullu tunnetuksi melko myöhään (Mustonen 1985). Singulaariarvohajoitelma (singular value decomposition) tuottaa ratkaisun kun sitä sovelletaan standardoituun residuaalimatriisiin \\(\\boldsymbol{S}\\). \\[\\begin{equation} \\boldsymbol{S} = \\boldsymbol{D_r}^{-1/2}(\\boldsymbol{P} - \\boldsymbol{r}\\boldsymbol{c}^T)\\boldsymbol{D_c}^{-1/2} \\tag{8.1} \\end{equation}\\] Residuaalimatriisi voidaan esittää myös ns. kontingenssi-suhdelukujen (contingency ratio) avulla kahdella tavalla. \\[\\begin{equation} \\boldsymbol{D_r}^{-1} \\boldsymbol{P} \\boldsymbol{D_c}^{-1} = \\left( \\frac{p_{ij}} {r_{i} c{j}} \\right) \\tag{8.2} \\end{equation}\\] \\[\\begin{equation} \\boldsymbol{S} = \\boldsymbol{D_r}^{1/2} (\\boldsymbol{D_r}^{-1} \\boldsymbol{P} \\boldsymbol{D_c}^{-1} - \\boldsymbol{1}\\boldsymbol{1}^{T} ) \\boldsymbol{D_c}^{-1/2} \\;\\;\\; . \\tag{8.3} \\end{equation}\\] Toinen esitystapa on hyödyllinen, kun tarkastellaan CA:n yhteyksiä muihin läheisiin menetelmiin. Näitä menetelmiä kuten myös korrespondenssianalyysiä kutsutaan monilla nimillä:suhteellisten osuuksien datan analyysi (log ratio analysis of compositiona data), moniulotteinen skaalaus, lineaarinen diskriminanttianalyysi, kanoninen korrelaatioanalyysi, pääkomponettianalyysi, kaksoiskuvat ja muutä SVD-hajoitelmaan perustuvat dimensioden vähentämisen menetelmät. Samat kaavat voi esittää myös alkiomuodossa: \\[\\begin{equation} s_{ij} = \\frac{p_{ij}-r_{i}c_{j}} { \\sqrt{r_{i}c_{j} } } \\tag{8.4} \\end{equation}\\] ja toinen \\[\\begin{equation} s_{ij} = \\sqrt{r_{i}} \\left( \\frac{p_{ij}}{r_{i}c_{j}} \\right) \\sqrt{c_{j}} \\;\\;\\; . \\tag{8.5} \\end{equation}\\] Alkimuodosasa esitetyistä kaavoista näkee intuitivisesti rivi- ja sarakeratkaisujen sidoksen. Ratkaisujen duaalisuus on teoreettinen tulos, jonka voi perustella täsmällisesti algebrallisen geometrian avulla. Käytännössä rivi- ja sarekeongelman duaalisuus tarkoittaa sitä, että vain toinen ongelma on ratkaistava. Singulaariarvohajoitelma (singular value decomposition, SVD) matriisille \\(\\boldsymbol{S}\\) on \\[\\begin{equation} \\boldsymbol{S} = \\boldsymbol{U} \\boldsymbol{D_{\\alpha}} \\boldsymbol{V}^{T} \\tag{8.6} \\end{equation}\\] missä \\(\\boldsymbol{D_{\\alpha}}\\) on diagonaalimatriisi, jonka alkiot ovat singulaariarvot suuruusjärjestyksessä \\(\\alpha_{1}\\geq \\alpha_{1} \\geq \\cdots\\). Matriisit \\(\\boldsymbol{U}\\) ja \\(\\boldsymbol{V}\\) ovat ortogonaalisia singulaarivektoreiden matriiseja. Singulaariarvohajoitelman merkitys dimensioiden vähentämiselle perustuu Eckart - Young - teoreemaan. Teoreema kertoo että saamme pienimmän neliösumman \\(m\\) - ulotteisen approksimaation matriisille \\(\\boldsymbol{S}\\) (CAinP, ss. 244) matriisien \\(\\boldsymbol{U}\\) ja \\(\\boldsymbol{V}\\) ensimmäisten sarakkeiden ja ensimmäisten singulaariarvojen avulla. \\[\\begin{equation} \\boldsymbol{S}_{(m)} = \\boldsymbol{U}_{(m)} \\boldsymbol{D}_{\\alpha(m)} \\boldsymbol{V}_{(m)}^{T} \\tag{8.7} \\end{equation}\\] Korrrespondenssianalyysin ratkaisualgoritmissa tätä tulosta on muokattava niin, että rivien ja sarakkeiden massat huomioidaan pienimmän neliösumman approksimaatiossa painoina. Näin saadaan standardikoordinaatit ja principal-koordinaatit riveille ja sarakkeille. Rivien standardikoordinaatit \\[\\begin{equation} \\boldsymbol{\\Phi} = \\boldsymbol{D_r}^{-\\frac{1}{2}} \\boldsymbol{U} \\tag{8.8} \\end{equation}\\] Sarakkeiden standardikoordinaatit \\[\\begin{equation} \\boldsymbol{\\Gamma} = \\boldsymbol{D_c}^{-\\frac{1}{2}} \\boldsymbol{V} \\tag{8.9} \\end{equation}\\] Rivien pääkoordinaatit \\[\\begin{equation} \\boldsymbol{F} = \\boldsymbol{D_r}^{-\\frac{1}{2}} \\boldsymbol{U} \\boldsymbol{D_{\\alpha}} = \\boldsymbol{\\Phi} \\boldsymbol{D_{\\alpha}} \\tag{8.10} \\end{equation}\\] Sarakkeiden pääkoordinaatit \\[\\begin{equation} \\boldsymbol{G} = \\boldsymbol{D_c}^{-\\frac{1}{2}} \\boldsymbol{V} \\boldsymbol{D_{\\alpha}} = \\boldsymbol{\\Gamma} \\boldsymbol{D_{\\alpha}} \\tag{8.11} \\end{equation}\\] Pääakseleiden inertiat (principal inertias) \\(\\lambda_{k}\\) \\[\\begin{equation} \\lambda_{k} = \\alpha_{k}^2, k = 1,\\dots,K, K = min \\{ I-1, J-1 \\} \\end{equation}\\] edit 1 CA:ssa ratkaisun akseleiden inertiaa kutsutaan usein ominaisarvoksi, mutta periaatteessa SVD-ratkaisulla saadaan singulaariarvot, ja niiden neliöt ovat akseleiden inertioita. Ominaisarvojen ja sigulaariarvojen yhteys on läheinen ja riippuu diagonalisoitavan matriisin ominaisuuksista. edit 1 ratkaisun dimenisio, maksimi-inertia. Bilineaarinen korresepondenssimalli Korrespondenssimatriisi \\(\\boldsymbol{P}\\) voidaan esittää matriisi- ja alkiomuodossa ns. palautuskaavana (reconstitution formula). \\[\\begin{equation} \\boldsymbol{P} = \\boldsymbol{D}_{r} \\left( \\boldsymbol{1}\\boldsymbol{1}^{T} + \\boldsymbol{\\Phi}\\boldsymbol{D}_{\\lambda}^{\\frac {1}{2}}\\boldsymbol{\\Gamma}^{T}\\right)\\boldsymbol{D}_{c} \\tag{8.12} \\end{equation}\\] \\[\\begin{equation} p_ {ij}= r_{i}c_{j} \\left(1 + \\sum_{k=1}^{K} \\sqrt{\\lambda_{k}} \\phi_{ik} \\gamma_{jk} \\right) \\tag{8.13} \\end{equation}\\] Tässä viitataan s. 101 (13.4), 109 (14.9), ja 109-110 (14.10 ja 14.11). Palautuskavoilla on monta esitystapaa bilineaarisessa mallissa. Rivien ja sarakkeiden riippuvuus ja transitioyhtälöt. ss. 244, 108-109 skalaariversiot. Pääkoordinaatit standardikoordinaattien funktiona (ns. barysentrinen ominaisuus - barycentric relationships) \\[\\begin{equation} \\boldsymbol{F} = \\boldsymbol{D}_{r}^{-1} \\boldsymbol{P}\\boldsymbol{\\Gamma} \\tag{8.14} \\end{equation}\\] \\[\\begin{equation} \\boldsymbol{G} = \\boldsymbol{D}_{c}^{-1} \\boldsymbol{P}^{T}\\boldsymbol{\\Phi} \\tag{8.15} \\end{equation}\\] Pääkoordinaatit pääkoordinaattien funktiointa: \\[\\begin{equation} \\boldsymbol{F} = \\boldsymbol{D}_{r}^{-1} \\boldsymbol{P}\\boldsymbol{G}\\boldsymbol{D}_{\\lambda}^{-\\frac{1}{2}} \\tag{8.16} \\end{equation}\\] \\[\\begin{equation} \\boldsymbol{G} = \\boldsymbol{D}_{c}^{-1} \\boldsymbol{P}^{T}\\boldsymbol{F}\\boldsymbol{D}_{\\lambda}^{-\\frac{1}{2}} \\tag{8.17} \\end{equation}\\] Yhtälöt (8.14) ja (8.14) esittävät profiilipisteet ideaalipisteiden (vertex points) painotettuina keskiarvoina, painoina profiilin elementit. Asymmetriset kartat (rivien tai sarakkeiden suhteen) perustuvat näihin yhtälöihin. Yhtälöiden (8.16) ja (8.17) kahdet pääkoordinaatit ovat perusta symmetrisille kartoille. Myös niitä yhdistää barisentrinen painotetun keskiarvon riippuvuus, mutta mukana ovat skaalaustekijät \\(\\frac{1}{\\sqrt{\\lambda_{i}}}\\). Skaalaustekijä on jokaisessa dimensiossa sen inertia, suurimmasta pienimpään. Kokeillaan vielä kaavaviitteitä: kaavojen (3.1) ja (3.2) yhteyden pitäisi olla selkeä. Pisteet ja projektio aliavaruuteen Kuva on kurssimateriaaleista(M. Greenacre 2017). knitr::include_graphics(&#39;img/CAquality.png&#39;) Kuva 8.1: Pisteen projektio aliavaruuteen Kuvassa on esitetty korrespondenssianalyysin ratkaisun minimointiongelma. Pisteen projektio on sitä parempi mitä pienempi kulma on sentroidista pisteeseen piirtetyn janan ja pisteen projektion välillä. COR - tunnusluku ca-funktion numeerisissa tuloksissa tämän kulman kosinin neliö. Pisteen kuvauksen laatu (qlt) ca-tuloksissa on valitun approsimaation akseleiden kvaliteettien (COR) summa. Kuvasta voi myös hahmottaa sen periaatteen, että projektiossa kaukana olevat pisteet ovat kaukana myös alkuperäisessä avaruudessa. Projektiossa lähekkäin olevat pisteet voivat olla alkuperäisessä avaruudessa kaukana toisistaan, jos niiden projektion laatu on huono. Matriisit ja niiden havainnollistaminen edit Nämä tässä varalla, jos matriisikaavoja tarvitaan lisää. Ehkä ei? Korrespondenssianalyysin sovelluksissa tutkimusongelman ratkaisu on usein sopivan matriisin rakentaminen. edit: kaavaesimerkkejä \\[\\begin{equation} A = \\begin{bmatrix} a_{11} &amp; a_{12} &amp; \\dots &amp; a_{1k}\\\\ \\vdots &amp; \\ddots &amp; \\\\ \\\\ \\vdots \\\\ a_{n1} &amp; \\dots &amp; \\dots &amp; a_{nk} \\end{bmatrix} \\end{equation}\\] Ehkäpä ABBA onnistuu paremmin tällä notaatiolla? \\[\\begin{equation} A = \\begin{bmatrix} A_{11} &amp; B_{12} \\\\ B_{21} &amp; A_{22} \\end{bmatrix} \\end{equation}\\] \\[\\begin{equation} A = \\begin{bmatrix} A_{maa, Q1a} &amp; A_{maa, Q1b} \\\\ B_{gage, Q1a} &amp; B_{gage, Q1b} \\end{bmatrix} \\end{equation}\\] Pinotut tai yhdistetyt matriisit (stacked and concatenated matrices) Yksinkertainen korrespondenssianalyysi on kahden luokittelumuuttujan määrittämän taulukon analyysiä, mutta sitä voi soveltaa myös usean muuttujan analyysiin. Menetelmän matemaattinen perusta ja ratkaisualgoritmi (SVD) toimivat, tulkinta vain muuttuu. Yksinkertaisin laajennus on lisätä alkuperäisen taulukon alle toinen taulukko. Rivit ovat esimerkissä maittan summattuja vastauksia, ja niiden alle voidaan lisätä joku toinen luokittelumuuttuja. Havaintojen määrä yhditetyssä (pinotussa) taulussa kaksinkertaistuu. Taulukoiden yhdistämisen idea on inertian dekomponointi. Yhdistetyn matriisin inertia voidaan eri tavoin esittää alimatriisien inertian summana. Tällöin jokaisen alimatriisin reunajakauman tulee olla sama, ja puuttuvat tiedot vääristävät tuloksia. Merkitään edellisten analyysien kuuden maan ja viiden vastausvaihtoehdon taulukkoa matriisilla \\(\\boldsymbol{ A}_{I J}\\), missä \\(I\\) on rivien ja \\(J\\) sarakkeiden lukumäärä. Taulukoidaan ikäluokan (1 - 6) ja sukupuolen (\\(f\\) = nainen, \\(m\\) = mies) vuorovaikutusmuuttuja (\\(f1,\\dots , f6\\) ja \\(m1,\\dots , m6\\)) samojen vastausvaihtoehtojen kanssa. Jos tätä taulukkoa merkitään matriisilla \\(\\boldsymbol{ B}_{I^{`} J}\\), voimme muodostaa yhdistetyn matriisin Rivien lukumäärä on molemmissa matriiseissa sama, koska luokkia sattuu olemaan kuusi sekä maa- että ikä- ja sukupuoli - luokittelumuuttujissa. Kun matriisit ovat dimensioiltaan ja myös muuttujien sisällön kannalta samankaltaiset, niitä kutsutaan yhteensopiviksi (``matched matrix). Tällöin yksinkertaista korrespondenssianalyyisä voi soveltaa tutkimusongelmaan, jossa halutaan erotella jonkun ryhmän sisäinen vaihtelu ryhmien välisiestä vaihtelusta. (Greenacren ehdottama ABBA - analyysi). ABBA on erityistapaus yleisemmästä moniulotteisen taulukon (multiway table) analyysistä, jossa useita kahden muuttujan taulukoita ``pinotaan päällekkäin ja rinnakkain. Voimme ottaa yhden kysymyksen vastausten lisäksi analyysiin mukaan useamman kysymyksen vastaukset laajentamalla kahden päällekkäisen matriisin taulukkoa oikealle. Monimuuttuja-korrespondenssianalyysi MCA Usean muuttujan korrespondenssianalyysissä tutkitaan usean muuttujan välisiä yhteyksiä. Kartan tulkinnan apuna siihen voidaan lisätä havaintojen sijaan niiden keskiarvopisteitä ja niille simuloituja luottamusellipsejä. Kuvien pääongelma on liian suuri määärä pisteitä, ja analyysin lopputulos on usein mahdollisimman yksinkertainen kartta. Usean muuttujan analyysissä kohteena on joko indikaattorimatriisi \\(\\boldsymbol{Z}\\) tai Burtin matriisi \\(\\boldsymbol{B}\\) Indikaattorimatriisissa rivit ovat havaintoja ja sarakkeet luokittelumuuttujan arvoja. Havaintoa vastaa rivi nollia ja arvo 1 valitun vastausvaihtoehdon kohdalla. Tästä seuraa, että vain erilaiset vastaukset määrittävät rivien etäisyyksiä. Burtin matriisi on erikoistapaus yhdistetyistä matriiseista. Siihen on koottu kaikki tutkittavien muuttujien pareittan muodostetut taulukot. Diagonaalilla ovat muuttujien ristiintaulukoinnit itsensä kanssa. Ratkaisu riippuu vain näistä parittaisista taulukoista. Burtin matriisi on kätevä välivaihe matriisien yhdistelyssä. Molemmat matriisit paisuttavat keinotekoisesti kokonaisinertiaa, ja esimerkikisi kaksiulotteisen kartan selitetyn inertian osuudet jäävät melko pieniksi. Ratkaisuna on inertian oikaisu tai korjaus (adjusted inertia), jossa mm. poistetaan kokonaisinertialaskelmista Burtin matriisin diagonaalilla olevat alimatriisit. Näillä korjauksilla ei ole vaikutusta kartan pisteiden sijaintiin. Tämä menetelmä on ca-paketin mjca-funktion oletus. Kolmas vaihtoehto on ns. yhdistetty korrespondenssianalyysi (joint ca). Liite 2: Suomenkielinen lomake (esimerkki) Tämä kuva on myös tekstissä, kätevä tapa esittää siististi kysymysten pitkät versiot. knitr::include_graphics(&#39;img/substvar_fi_Q1Q2.png&#39;) Liite 3: Tekninen ympäristö ja Bookdown-paketti Muokataan tiiviimpi pätkä esimerkkireposta bookdown-testi1. Tämä kuva kertoo vain julkaisutekniikan ympäristön. knitr::include_graphics(&#39;img/BookdownProc.png&#39;) Kuva 8.2: Tulostiedoston prosessointi # pois out.width=&#39;50%&#39;, Liite 4: R - koodi # testaukseen 7.11.2020 virheilmoituksia varten arvo TRUE options(tinytex.verbose = TRUE) # 18.10.2020 library(rgl) library(ca) library(haven) library(dplyr) library(knitr) library(tidyverse) library(lubridate) library(rmarkdown) library(ggplot2) library(furniture) library(scales) # G_1_2 - kuva library(reshape2) # G_1_2 - kuva library(printr) #19.5.18 taulukoiden ja matriisien tulostukseen library(bookdown) library(tinytex) library(assertthat) # automatically create a bib database for R packages knitr::write_bib(c( .packages(), &#39;bookdown&#39;, &#39;knitr&#39;, &#39;rmarkdown&#39; ), &#39;packages.bib&#39;) # include FALSE: ei koodia eikä tulostusta dokumenttiin - poistettava turhia # välitulostuksia (18.10.2020) # Aineiston rajaamisen kolme vaihetta (10.2018) # # TIEDOSTOJEN NIMEÄMINEN # # R-datatiedostot .data - tarkenteella ovat osajoukkoja koko ISSP-datasta ISSP2012.data # R-datatiedostot .dat - tarkenteella: mukana alkuperäisten muuttujien muunnoksia # (yleensä as_factor), alkuperäisissä muuttujissa mukana SPSS-tiedoston metadata. # # Luokittelumuuttujan tyyppi on datan lukemisen jälkeen yleensä merkkijono (char) # ja haven_labelled. # # Muutetaan R-datassa ordinaali- tai nominaaliasteikon muuttujat haven-paketin # as_factor - funktiolla faktoreiksi. R:n faktorityypin muuttujille voidaan tarvittaessa # määritellä järjestys, toistaiseksi niin ei tehdä (25.9.2018). # # Muunnetun muuttujan rinnalla säilytetään SPSS-tiedostosta luettu muuttja, metatiedot säilyvät # alkuperäisessä. # # R-datatiedostot joiden nimen loppuosa on muotoa *esim1.dat: käytetään analyyseissä # # 1. VALITAAN MAAT (25) -&gt; ISSP2012jh1a.data. Muuttujat koodilohkossa datasel_vars1 # # kolme maa-muuttujaa datassa. V3 erottelee joidenkin maiden alueita, V4 on koko # maan koodi ja C_ALPHAN on maan kaksimerkkinen tunnus. # # V3 - Country/ Sample ISO 3166 Code (see V4 for codes for whole nation states) # V3 erot valituissa maissa # 5601 BE-FLA-Belgium/ Flanders # 5602 BE-WAL-Belgium/ Wallonia # 5603 BE-BRU-Belgium/ Brussels # 27601 DE-W-Germany-West # 27602 DE-E-Germany-East # 62001 PT-Portugal 2012: first fieldwork round (main sample) # 62002 PT-Portugal 2012: second fieldwork round (complementary sample) # Myös tämä on erikoinen, näyttää olevan vakio kun V4 = 826: # 82601 GB-GBN-Great Britain # Portugalissa ainestoa täydennettiin, koska siinä oli puutteita. Jako ei siis ole oleellinen, # mutta muuut ovat. Tähdellä merkityt maat valitaan johdattelevaan esimerkkiin. # # Maat (25) # # 36 AU-Australia # 40 AT-Austria # 56 BE-Belgium* # 100 BG-Bulgaria* # 124 CA-Canada # 191 HR-Croatia # 203 CZ-Czech Republic # 208 DK-Denmark* # 246 FI-Finland* # 250 FR-France # 276 DE-Germany* # 348 HU-Hungary* # 352 IS-Iceland # 372 IE-Ireland # 428 LV-Latvia # 440 LT-Lithuania # 528 NL-Netherlands # 578 NO-Norway # 616 PL-Poland # 620 PT-Portugal # 643 RU-Russia # 703 SK-Slovakia # 705 SI-Slovenia # 752 SE-Sweden # 756 CH-Switzerland # 826 GB-Great Britain and/or United Kingdom - jätetään pois jotta saadaan TOPBOT # -muuttuja mukaan (top-bottom self-placement) .(9.10.18) # 840 US-United States - jätetään pois, jotta saadaan TOPBOT-muuttuja mukaan.(10.10.18) # # Belgian ja Saksan alueet: # V3 # 5601 BE-FLA-Belgium/ Flanders # 5602 BE-WAL-Belgium/ Wallonia # 5603 BE-BRU-Belgium/ Brussels # 27601 DE-W-Germany-West # 27602 DE-E-Germany-East # # Unkari (348) toistaiseksi mukana, mutta joissain kysymyksissä myös Unkarilla on # poikkeavia vastausvaihtoehtoja(HU_V18, HU_V19,HU_V20). Jos näitä muuttujia käytetään, # Unkari on parempi jättää pois. # # # (25.4.2018) user_na # haven-paketin read_spss - funktiolla voi r-tiedostoon lukea myös SPSS:n sallimat kolme # (yleensä 7, 8, 9) tarkempaa koodia puuttuvalle tiedolle. # &quot;If TRUE variables with user defined missing will be read into labelled_spss objects. # If FALSE, the default, user-defined missings will be converted to NA&quot; # https://www.rdocumentation.org/packages/haven/versions/1.1.0/topics/read_spss # ISSP2012jh.data &lt;- read_spss(&quot;data/ZA5900_v4-0-0.sav&quot;) #luetaan alkuperäinen data R- dataksi (df). #str(ISSP2012jh.data) incl_countries25 &lt;- c(36, 40, 56,100, 124, 191, 203, 208, 246, 250, 276, 348, 352, 372, 428, 440, 528, 578, 616, 620, 643, 703, 705, 752, 756) #str(ISSP2012jh.data) #str(ISSP2012jh.data) #61754 obs. of 420 variables - kaikki ISSP2012jh1a.data &lt;- filter(ISSP2012jh.data, V4 %in% incl_countries25) #head(ISSP2012jh1a.data) #str(ISSP2012jh1a.data) #34271 obs. of 420 variables, Espanja ja Iso-Britannia # pois (9.10.2018) # str(ISSP2012jh1a.data) # 32969 obs. of 420 variable, Espanja Iso-Britannia, # USA pois (10.10.2018) # # names() # muuttujen nimet # Maakohtaiset muuttujat (kun on poikettu ISSP2012 - vastausvaihtoehdoista tms.) # on aineistossa eroteltu maatunnus-etuliitteellä (esimerkiksi ES_V7). # Demografisissa ja muissa taustamuuttujissa suuri osa tiedoista on kerätty maa- # kohtaisilla lomakkeilla. Vertailukelpoiset muuttujat on konstruoitu niistä. # Muuttujia on 420, vain osa yhteisiä kaikille maille. # include FALSE: ei koodia eikä tulostusta dokumenttiin - poistettava turhia # välitulostuksia (18.10.2020) # 2. VALITAAN MUUTTUJAT -&gt; ISSP2012jh1b.data. Maat valittu koodilohkossa datasel_country1 # # # Muuttujat on luokiteltu dokumentissa ZA5900_overview.pdf # https://zacat.gesis.org/webview/index.jsp?object=http://zacat.gesis.org/obj/fStudy/ZA5900 # Study Description -&gt; Other Study Description -&gt; Related Materials # # # METADATA metavars1 &lt;- c(&quot;V1&quot;, &quot;V2&quot;, &quot;DOI&quot;) #MAA - maakoodit ja maan kahden merkin tunnus countryvars1 &lt;- c(&quot;V3&quot;,&quot;V4&quot;,&quot;C_ALPHAN&quot;) # SUBSTANSSIMUUTTUJAT - Attitudes towards family and gender roles (9) # # Yhdeksän kysymystä (lyhennetyt versiot, englanniksi), vastausvaihtoehdot Q1-Q2 # # 1 = täysin samaa mieltä, 2 = samaa mieltä, 3 = ei samaa eikä eri mieltä, # 4 = eri mieltä, 5 = täysin eri mieltä # # Q1a Working mother can have warm relation with child # Q1b Pre-school child suffers through working mother # Q1c Family life suffers through working mother # Q1d Womens preference: home and children # Q1e Being housewife is satisfying # # Q2a Both should contribute to household income # Q2b Mens job is earn money, womens job household # # Q3a Should women work: Child under school age # Q3b Should women work: Youngest kid at school # 1= kokopäivätyö, 2 = osa-aikatyö, 3 = pysyä kotona, 8 = en osaa sanoa # (can&#39;t choose), 9 = no answer # # Kysymysten Q3a ja Q3b eos-vastaus ei ole sama kuin &quot;en samaa enkä eri mieltä&quot; # (ns. neutraali # vaihtoehto), mutta kieltäytymisiä jne. (koodi 9) on aika # vähän. Kolmessa # maassa ne on yhdistety: # (8 Can&#39;t choose, CA:can&#39;t choose+no answer, KR:don&#39;t know+refused, NL:don&#39;t know). # Kun SPSS-tiedostosta ei ole tuotu puuttuvan tiedon tarkempaa luokittelua, # erottelua ei voi tehdä. # substvars1 &lt;- c(&quot;V5&quot;,&quot;V6&quot;,&quot;V7&quot;,&quot;V8&quot;,&quot;V9&quot;,&quot;V10&quot;,&quot;V11&quot;,&quot;V12&quot;,&quot;V13&quot;) # 9 muuttujaa # Nämä yhteiset muuttujat pois (maaspesifien muuttujien lisäksi) : # # &quot;V14&quot;,&quot;V15&quot;,&quot;V16&quot;, &quot;V17&quot;,&quot;V18&quot;,&quot;HU_V18&quot;,&quot;V19&quot;,&quot;HU_V19&quot;,&quot;V20&quot;,&quot;HU_V20&quot;,&quot;V21&quot;, # &quot;V28&quot;,&quot;V29&quot;,&quot;V30&quot;,&quot;V31&quot;,&quot;V32&quot;,&quot;V33&quot;,# &quot;V34&quot;, &quot;V35&quot;, &quot;V36&quot;, &quot;V37&quot;, &quot;V38&quot;, &quot;V39&quot;, # &quot;V40&quot;, &quot;V41&quot;, &quot;V42&quot;, &quot;V43&quot;, &quot;V44&quot;, &quot;V45&quot;, &quot;V46&quot;, &quot;V47&quot;, &quot;V48&quot;, &quot;V49&quot;, &quot;V50&quot;, # &quot;V51&quot;, &quot;V52&quot;, &quot;V53&quot;, &quot;V54&quot;, &quot;V55&quot;, &quot;V56&quot;, &quot;V57&quot;, &quot;V58&quot;, &quot;V59&quot;, &quot;V60&quot;, &quot;V61&quot;, # &quot;V62&quot;, &quot;V63&quot;, &quot;V64&quot;, &quot;V65&quot;, &quot;V65a&quot;,&quot;V66&quot;, &quot;V67&quot; # # # DEMOGRAFISET JA MUUT TAUSTAMUUTTUJAT (8) # # AGE, SEX # # DEGREE - Highest completed degree of education: Categories for international # comparison. Slightly re-arranged subset of ISCED-97 # # 0 No formal education # 1 Primary school (elementary school) # 2 Lower secondary (secondary completed does not allow entry to university: # obligatory school) # 3 Upper secondary (programs that allow entry to university or programs that # allow to entry other ISCED level 3 programs - designed to prepare students for # direct entry into the labour market) # 4 Post secondary, non-tertiary (other upper secondary programs toward labour # market or technical formation) # 5 Lower level tertiary, first stage (also technical schools at a tertiary level) # 6 Upper level tertiary (Master, Dr.) # 9 No answer, CH: don&#39;t know # HUOM! R-factor - muunnoksessa koodaus on 1-7 # # MAINSTAT - main status: Which of the following best describes your current situation? # # 1 In paid work # 2 Unemployed and looking for a job, HR: incl never had a job # 3 In education # 4 Apprentice or trainee # 5 Permanently sick or disabled # 6 Retired # 7 Domestic work # 8 In compulsory military service or community service # 9 Other # 99 No answer # Armeijassa tai yhdyskuntapalvelussa muutamia, muutamissa maissa.Kategoriassa 9 # on hieman väkeä. Yhdistetään 8 ja 9. Huom! Esim Puolassa ei yhtään eläkeläistä # eikä kategoriaa 9, Saksassa ei ketään kategoriassa 9. # # TOPBOT - Top-Bottom self-placement (10 pt scale) # # &quot;In our society, there are groups which tend to be towards the top and groups # which tend to be towards the bottom. Below is a scale that runs # from the top to the bottom. Where would you put yourself on this scale?&quot; # Eri maissa hieman erilaisia kysymyksiä. # # HHCHILDR - How many children in household: children between [school age] and # 17 years of age # # 0 No children # 1 One child # 2 2 children # 21 21 children # 96 NAP (Code 0 in HOMPOP) # 97 Refused # 99 No answer # # Voisi koodata dummymuuttujaksi lapsia (1) - ei lapsia (0). # Ranskan datassa on erittäin iso osa puuttuvia tietoja (yli 20 %), Sama tilanne # myös muissa perheen kokoon liittyvissä kysymyksissä. Myös Austarlialla aika # paljon puuttuvia vastauksia. # # MARITAL - Legal partnership status # # What is your current legal marital status? # The aim of this variable is to measure the current &#39;legal&#39; marital status &#39;. # PARTLIV - muuttujassa on &#39;de facto&#39; - tilanteen tieto parisuhteesta # # 1 Married # 2 Civil partnership # 3 Separated from spouse/ civil partner (still legally married/ still legally # in a civil partnership) # 4 Divorced from spouse/ legally separated from civil partner # 5 Widowed/ civil partner died # 6 Never married/ never in a civil partnership, single # 7 Refused # 8 Don&#39;t know # 9 No answer # # URBRURAL - Place of living: urban - rural # # 1 A big city # 2 The suburbs or outskirts of a big city # 3 A town or a small city # 4 A country village # 5 A farm or home in the country # 7 Other answer # 9 No answer # 1 ja 2 vaihtelevat aika paljon maittain, parempi laskea yhteen. Unkarista puuttuu # jostain syystä kokonaan vaihtoehto 5. Vaihotehdon 7 on valinnut vain 4 # vastaajaa Ranskasta. # bgvars1 &lt;- c( &quot;SEX&quot;,&quot;AGE&quot;,&quot;DEGREE&quot;, &quot;MAINSTAT&quot;, &quot;TOPBOT&quot;, &quot;HHCHILDR&quot;, &quot;MARITAL&quot;, &quot;URBRURAL&quot;) #Valitaan muuttujat jhvars1 &lt;- c(metavars1,countryvars1, substvars1,bgvars1) #jhvars1 ISSP2012jh1b.data &lt;- select(ISSP2012jh1a.data, all_of(jhvars1)) # laaja aineisto - mukana havainnot joissa puuttuvia tietoja # str(ISSP2012jh1b.data) #32969 obs. of 23 variables # # SUBSTANSSIMUUTTUJAT # # $ V5 : &#39;haven_labelled&#39; num 5 1 2 2 1 NA 2 4 2 2 ... # ..- attr(*, &quot;label&quot;)= chr &quot;Q1a Working mom: warm relationship with children # as a not working mom&quot; # ..- attr(*, &quot;labels&quot;)= Named num 0 1 2 3 4 5 8 9 # # ISSP2012jh1b.data$V5 näyttää tarkemmin rakenteen # # glimpse(ISSP2012jh1b.data) # Poistetaan havainnot, joissa ikä (AGE) tai sukupuolitieto puuttuu (5.7.2019) ISSP2012jh1c.data &lt;- filter(ISSP2012jh1b.data, (!is.na(SEX) &amp; !is.na(AGE))) # str(ISSP2012jh1c.data) # 32823 obs. of 23 variables, 32969-32823 = 146 # TARKISTUS 8.6.20 dplyr 1.0.0-päivitys: havaintojen ja muuttujien määrä ok. # VAIHE 1 - muuttujat joissa ei ole puuttuvia tietoja # vaihe 1.1 haven_labelled ja chr -&gt; as_factor ISSP2012jh1d.dat &lt;- ISSP2012jh1c.data %&gt;% mutate(maa = as_factor(C_ALPHAN), # ei puuttuvia, ei tyhjiä leveleitä maa3 = as_factor(V3), # maakoodi, jossa aluejako joillan mailla sp1 = as_factor(SEX), # ei puuttuvia, tyhjä level &quot;no answer&quot; 999 ) # C_ALPHAN - maa - maa3 tarkistuksia # V3 # &quot;Pulma&quot; on järjestys. C_ALPHAN (&quot;chr&quot;) on aakkosjärjestyksessä, kun luodaan # maa = as_factor(C_ALPHAN) järjestys muuttuu (esiintymisjärjestys datassa?) # maa3 muunnetaan maakoodista (haven_labelled&#39; num), jonka # str(ISSP2012jh1d.dat$maa) #Country Prefix ISO 3166 Code - alphanumeric # attributes(ISSP2012jh1d.dat$maa) # ei tyhiä levels-arvoja, 25 levels # ISSP2012jh1d.dat$maa %&gt;% fct_unique() # ISSP2012jh1d.dat$maa %&gt;% fct_count() # summary kertoo samat tiedot (20.2.20) # sum(is.na(ISSP2012jh1d.dat$maa)) # ei puuttuvia tietoja # ISSP2012jh1d.dat$maa %&gt;% summary() # mukana vain valitut 25 maata # str(ISSP2012jh1d.dat$maa3) #&quot;Country/ Sample ISO 3166 Code #(see V4 for codes for whole nation states)&quot; # 29 levels # str(ISSP2012jh1d.dat$V3) # attributes(ISSP2012jh1d.dat$maa3) # ei tyhiä levels-arvoja, 29 levels # sum(is.na(ISSP2012jh1d.dat$maa3)) # nolla ei ole puuttuva tieto! (3.2.20) # ISSP2012jh1d.dat$maa3 %&gt;% fct_unique() # ISSP2012jh1d.dat$maa3 %&gt;% fct_count() # Vain näissä on jaettu maan havainnot (3.2.20) # # [38] BE-FLA-Belgium/ Flanders # [39] BE-WAL-Belgium/ Wallonia # [40] BE-BRU-Belgium/ Brussels # [41] DE-W-Germany-West # [42] DE-E-Germany-East # [43] PT-Portugal 2012: first fieldwork round (main sample) # [44] PT-Portugal 2012: second fieldwork round (complementary sample) # ISSP2012jh1d.dat$maa3 %&gt;% fct_count() #miksi ei tulosta mitään? (3.2.2020) # ISSP2012jh1d.dat$maa3 %&gt;% summary() # ISSP2012jh1d.dat$maa3 %&gt;% fct_unique() # maa3: 25 maata, havaintojen määrä. Poisjätetyissä havaintoja 0. # glimpse(ISSP2012jh1d.dat$maa3) # head(ISSP2012jh1d.dat$maa3) # length(levels(ISSP2012jh1d.dat$maa3)) # C_ALPHAN alkuperäinen järjestys, maa aakkosjärjestyssä (2.2.20) # # Huom1: Myös merkkijonomuuttujaa C_ALPHAN tarvitaan jatkossa. # # Huom2: kun dataa rajataan, on tarkistettava ja tarvittaessa poistettava # &quot;tyhjät&quot; R-factor - muuttujan &quot;maa&quot; luokat (3.2.2020) # vaihe 1.2 tyhjät luokat (levels) pois faktoreista ISSP2012jh1d.dat &lt;- ISSP2012jh1d.dat %&gt;% mutate(sp = fct_drop(sp1), maa3 = fct_drop(maa3) ) # maa3 - tarkistuksia # str(ISSP2012jh1d.dat$maa3) # 29 levels # attributes(ISSP2012jh1d.dat$maa3) #sum(is.na(ISSP2012jh1d.dat$maa3)) # nolla ei ole puuttuva tieto! (3.2.20) # ISSP2012jh1d.dat$maa3 %&gt;% summary() # ISSP2012jh1d.dat$maa3 %&gt;% fct_unique() # ISSP2012jh1d.dat$maa3 %&gt;% fct_count() # # str(ISSP2012jh1d.dat$C_ALPHAN) # attributes(ISSP2012jh1d.dat$C_ALPHAN) # TESTAUKSIA # # ISSP2012jh1d.dat %&gt;% tableX(C_ALPHAN, maa) # ISSP2012jh1d.dat %&gt;% tableX(C_ALPHAN, maa3) # ISSP2012jh1d.dat %&gt;% tableX(maa, maa3) # ISSP2012jh1d.dat %&gt;% tableX(V3, maa3) # sp, sp1, SEX - tarkistuksia # # ISSP2012jh1d.dat$sp %&gt;% fct_count() # ISSP2012jh1d.dat$sp %&gt;% fct_count() # ISSP2012jh1d.dat %&gt;% tableX(SEX,sp1) # ISSP2012jh1d.dat %&gt;% tableX(SEX,sp) # ISSP2012jh1d.dat %&gt;% tableX(sp1,sp) # vaihe 1.3 uudet &quot;faktorilabelit&quot; ISSP2012jh1d.dat &lt;- ISSP2012jh1d.dat %&gt;% mutate(sp = fct_recode(sp, &quot;m&quot; = &quot;Male&quot;, &quot;f&quot; = &quot;Female&quot;) ) # Tarkistuksia # ISSP2012jh1d.dat$sp %&gt;% fct_unique() # ISSP2012jh1d.dat$sp %&gt;% fct_count() # ISSP2012jh1d.dat$sp %&gt;% summary() # AGE -&gt; ika ISSP2012jh1d.dat$ika &lt;- ISSP2012jh1d.dat$AGE # Tarkistuksia attributes(ISSP2012jh1d.dat$ika) # tyhjä level &quot;No answer&quot; # str(ISSP2012jh1d.dat$ika) ISSP2012jh1d.dat$ika %&gt;% summary() ISSP2012jh1d.dat %&gt;% tableC(AGE, ika,cor_type = &quot;pearson&quot;, na.rm = FALSE, rounding = 5, output = &quot;text&quot;, booktabs = TRUE, caption = NULL, align = NULL, float = &quot;htb&quot;) %&gt;% kable() # Ikäjakauma - ei tarvita (18.10.2020) # # ISSP2012jh1d.dat$ika %&gt;% hist(main = &quot;ISSP 2012: vastaajan ikä&quot;) # Substanssi- ja taustamuuttujat R-faktoreiksi ISSP2012jh1d.dat &lt;- ISSP2012jh1d.dat %&gt;% mutate(Q1a1 = as_factor(V5), #labels Q1b1 = as_factor(V6), Q1c1 = as_factor(V7), Q1d1 = as_factor(V8), Q1e1 = as_factor(V9), Q2a1 = as_factor(V10), Q2b1 = as_factor(V11), Q3a1 = as_factor(V12), #labels = vastQ3_labels (W,w,H) Q3b1 = as_factor(V13), #labels = vastQ3_labels edu1 = as_factor(DEGREE), msta1 = as_factor(MAINSTAT), sosta1 = as_factor(TOPBOT), nchild1 = as_factor(HHCHILDR), lifsta1 = as_factor(MARITAL), urbru1 = as_factor(URBRURAL) ) # Muuttujat Q1a1...urbru1 ovat apumuuttujia, joissa on periaatteessa kaikki SPSS- # tiedostosta siirtyvä metatieto. Poikkeus on SPSS:n kolme tarkentavaa koodia # puuttuvalle tiedolle, ne saisi mukaan read_spss - parametrin avulla (user_na=TRUE) # # Tarkistusksia # ISSP2012jh1d.dat %&gt;% summary() # ISSP2012jh1d.dat %&gt;% # select(Q1a1, Q1b1, Q1c1,Q1d1,Q1e1, Q2a1, Q2b1, Q3a1,Q3b1) %&gt;% # summary() # # ISSP2012jh1d.dat %&gt;% # select(edu1,msta1, sosta1, nchild1, lifsta1, urbru1) %&gt;% # summary() # Substanssimuuttujat - ristiintaulukoinnit riittävät (6.2.20) # ISSP2012jh1d.dat$Q1a1 %&gt;% fct_count() # ISSP2012jh1d.dat$Q1b1 %&gt;% fct_count() # ISSP2012jh1d.dat$Q1c1 %&gt;% fct_count() # ISSP2012jh1d.dat$Q1d1 %&gt;% fct_count() # ISSP2012jh1d.dat$Q1e1 %&gt;% fct_count() # ISSP2012jh1d.dat$Q2a1 %&gt;% fct_count() # ISSP2012jh1d.dat$Q2b1 %&gt;% fct_count() # ISSP2012jh1d.dat$Q3a1 %&gt;% fct_count() #ISSP2012jh1d.dat$Q3b1 %&gt;% fct_count() # Taustamuuttujat - ristiintaulukoinnit riittävät (6.2.20) # ISSP2012jh1d.dat$edu1 %&gt;% fct_count() # ISSP2012jh1d.dat$msta1 %&gt;% fct_count() # ISSP2012jh1d.dat$sosta1 %&gt;% fct_count() # ISSP2012jh1d.dat$nchild1 %&gt;% fct_count() # ISSP2012jh1d.dat$lifsta1 %&gt;% fct_count() # ISSP2012jh1d.dat$urbru1 %&gt;% fct_count() # Poistetaan tyhjät luokat muuttujista ISSP2012jh1d.dat &lt;- ISSP2012jh1d.dat %&gt;% mutate(Q1a = fct_drop(Q1a1), Q1b = fct_drop(Q1b1), Q1c = fct_drop(Q1c1), Q1d = fct_drop(Q1d1), Q1e = fct_drop(Q1e1), Q2a = fct_drop(Q2a1), Q2b = fct_drop(Q2b1), Q3a = fct_drop(Q3a1), Q3b = fct_drop(Q3b1), edu = fct_drop(edu1), msta = fct_drop(msta1), sosta = fct_drop(sosta1), nchild = fct_drop(nchild1), lifsta = fct_drop(lifsta1), urbru = fct_drop(urbru1) ) # Tarkistuksia 1 # ISSP2012jh1d.dat %&gt;% summary() # ISSP2012jh1d.dat %&gt;% # select(Q1a, Q1b, Q1c, Q1d, Q1e,Q2a,Q2b,Q3a, Q3b) %&gt;% # str() #ISSP2012jh1d.dat %&gt;% # select(Q1a1, Q1b1, Q1c1, Q1d1, Q1e1,Q2a1,Q2b1,Q3a1, Q3b1) %&gt;% # str() #ISSP2012jh1d.dat %&gt;% # select(edu, msta, sosta, nchild,lifsta, urbru) %&gt;% # str() #ISSP2012jh1d.dat %&gt;% # select(edu1, msta1, sosta1, nchild1,lifsta1, urbru1) %&gt;% # str() # Tarkistuksia 2 - ristiintaulukointeja # Substanssimuuttujat # ISSP2012jh1d.dat %&gt;% tableX(Q1a,Q1a1) # ISSP2012jh1d.dat %&gt;% tableX(Q1b,Q1b1) # ISSP2012jh1d.dat %&gt;% tableX(Q1c,Q1c1) # ISSP2012jh1d.dat %&gt;% tableX(Q1d,Q1d1) # ISSP2012jh1d.dat %&gt;% tableX(Q1e,Q1e1) # ISSP2012jh1d.dat %&gt;% tableX(Q2a,Q2a1) # ISSP2012jh1d.dat %&gt;% tableX(Q2b,Q2b1) # ISSP2012jh1d.dat %&gt;% tableX(Q3a,Q3a1) # ISSP2012jh1d.dat %&gt;% tableX(Q3b,Q3b1) # Taustamuuttujat # ISSP2012jh1d.dat %&gt;% tableX(edu,edu1) # ISSP2012jh1d.dat %&gt;% tableX(msta,msta1) # ISSP2012jh1d.dat %&gt;% tableX(sosta,sosta1) # ISSP2012jh1d.dat %&gt;% tableX(nchild,nchild1) # ISSP2012jh1d.dat %&gt;% tableX(lifsta,lifsta1) # ISSP2012jh1d.dat %&gt;% tableX(urbru,urbru1) # Uusi muuttuja, jossa NA-arvot ovat mukana muuttujan uutena luokkana. Muuttujat # nimetään Q1a -&gt; Q1am. ISSP2012jh1d.dat &lt;- ISSP2012jh1d.dat %&gt;% mutate(Q1am = fct_explicit_na(Q1a, na_level = &quot;missing&quot;), Q1bm = fct_explicit_na(Q1b, na_level = &quot;missing&quot;), Q1cm = fct_explicit_na(Q1c, na_level = &quot;missing&quot;), Q1dm = fct_explicit_na(Q1d, na_level = &quot;missing&quot;), Q1em = fct_explicit_na(Q1e, na_level = &quot;missing&quot;), Q2am = fct_explicit_na(Q2a, na_level = &quot;missing&quot;), Q2bm = fct_explicit_na(Q2b, na_level = &quot;missing&quot;), Q3am = fct_explicit_na(Q3a, na_level = &quot;missing&quot;), Q3bm = fct_explicit_na(Q3b, na_level = &quot;missing&quot;), edum = fct_explicit_na(edu, na_level = &quot;missing&quot;), mstam = fct_explicit_na(msta, na_level = &quot;missing&quot;), sostam = fct_explicit_na(sosta, na_level = &quot;missing&quot;), nchildm = fct_explicit_na(nchild, na_level = &quot;missing&quot;), lifstam = fct_explicit_na(lifsta, na_level = &quot;missing&quot;), urbrum = fct_explicit_na(urbru, na_level = &quot;missing&quot;), ) # Tarkistuksia 3 # ISSP2012jh1d.dat %&gt;% # select(Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm) %&gt;% # summary() # #ISSP2012jh1d.dat %&gt;% # select(edum,mstam, sostam,nchildm,lifstam, urbrum) %&gt;% # summary() # #ISSP2012jh1d.dat %&gt;% # select(Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm) %&gt;% # str() # #ISSP2012jh1d.dat %&gt;% # select(edum,mstam, sostam,nchildm,lifstam, urbrum) %&gt;% # str() # Taustamuuttuja, puuttuva tieto mukana - ristiintaulkointeja # ISSP2012jh1d.dat$edum %&gt;% fct_count() # ISSP2012jh1d.dat$mstam %&gt;% fct_count() # ISSP2012jh1d.dat$sostam %&gt;% fct_count() # ISSP2012jh1d.dat$nchildm %&gt;% fct_count() # ISSP2012jh1d.dat$lifstam %&gt;% fct_count() # ISSP2012jh1d.dat$urbrum %&gt;% fct_count() # Substanssimuuttujat, puuttuva tieto mukana - ristiintaulkointeja # ISSP2012jh1d.dat$Q1am %&gt;% fct_count() # ISSP2012jh1d.dat$Q1bm %&gt;% fct_count() # ISSP2012jh1d.dat$Q1cm %&gt;% fct_count() # ISSP2012jh1d.dat$Q1dm %&gt;% fct_count() # ISSP2012jh1d.dat$Q1em %&gt;% fct_count() # ISSP2012jh1d.dat$Q2am %&gt;% fct_count() # ISSP2012jh1d.dat$Q2bm %&gt;% fct_count() # ISSP2012jh1d.dat$Q3am %&gt;% fct_count() # ISSP2012jh1d.dat$Q3bm %&gt;% fct_count() # Vaihe 2.4.1 # Q1a - Q1e,Q2a, Q2b Viisi vastausvaihtoehtoa - ei eksplisiittistä NA-tietoa(&quot;missing&quot;) # Q3a - Q3b kolme vastausvaihtoehtoa ISSP2012jh1d.dat &lt;- ISSP2012jh1d.dat %&gt;% mutate(Q1a = fct_recode(Q1a, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot;= &quot;Strongly disagree&quot;), Q1b = fct_recode(Q1b, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;), Q1c = fct_recode(Q1c, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;), Q1d = fct_recode(Q1d, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;), Q1e = fct_recode(Q1e, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;), Q2a = fct_recode(Q2a, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot; ), Q2b = fct_recode(Q2b, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;), Q3a = fct_recode(Q3a, &quot;W&quot; = &quot;Work full-time&quot;, &quot;w&quot; = &quot;Work part-time&quot;, &quot;H&quot; = &quot;Stay at home&quot; ), Q3b = fct_recode(Q3b, &quot;W&quot; = &quot;Work full-time&quot;, &quot;w&quot; = &quot;Work part-time&quot;, &quot;H&quot; = &quot;Stay at home&quot; ) ) # Tarkistuksia 1 # ISSP2012jh1d.dat %&gt;% # select(Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, Q3a, Q3b) %&gt;% # summary() # Vaihe 2.4.2 - muuttujassa eksplisiittinen NA-tieto ISSP2012jh1d.dat &lt;- ISSP2012jh1d.dat %&gt;% mutate(Q1am = fct_recode(Q1am, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;, &quot;P&quot; = &quot;missing&quot;), Q1bm = fct_recode(Q1bm, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;, &quot;P&quot; = &quot;missing&quot;), Q1cm = fct_recode(Q1cm, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;, &quot;P&quot; = &quot;missing&quot;), Q1dm = fct_recode(Q1dm, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;, &quot;P&quot; = &quot;missing&quot;), Q1em = fct_recode(Q1em, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;, &quot;P&quot; = &quot;missing&quot;), Q2am = fct_recode(Q2am, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;, &quot;P&quot; = &quot;missing&quot;), Q2bm = fct_recode(Q2bm, &quot;S&quot; = &quot;Strongly agree&quot;, &quot;s&quot; = &quot;Agree&quot;, &quot;?&quot; = &quot;Neither agree nor disagree&quot;, &quot;e&quot; = &quot;Disagree&quot;, &quot;E&quot; = &quot;Strongly disagree&quot;, &quot;P&quot; = &quot;missing&quot;), Q3am = fct_recode(Q3am, &quot;W&quot; = &quot;Work full-time&quot;, &quot;w&quot; = &quot;Work part-time&quot;, &quot;H&quot; = &quot;Stay at home&quot;, &quot;P&quot; = &quot;missing&quot;), Q3bm = fct_recode(Q3bm, &quot;W&quot; = &quot;Work full-time&quot;, &quot;w&quot; = &quot;Work part-time&quot;, &quot;H&quot; = &quot;Stay at home&quot;, &quot;P&quot; = &quot;missing&quot;) ) # Tarkistuksia 4 # ISSP2012jh1d.dat %&gt;% # select(Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm) %&gt;% # summary() # Tarkistuksia 5 # Substanssimuuttuja # ISSP2012jh1d.dat %&gt;% # tableX(Q1a,Q1am) # # ISSP2012jh1d.dat %&gt;% # tableX(Q1b,Q1bm) # # ISSP2012jh1d.dat %&gt;% # tableX(Q1c,Q1cm) # # ISSP2012jh1d.dat %&gt;% # tableX(Q1d,Q1dm) # # ISSP2012jh1d.dat %&gt;% # tableX(Q1e,Q1em) # # ISSP2012jh1d.dat %&gt;% # tableX(Q2a,Q2am) # # ISSP2012jh1d.dat %&gt;% # tableX(Q2b,Q2bm) # # ISSP2012jh1d.dat %&gt;% # tableX(Q3a,Q3am) # # ISSP2012jh1d.dat %&gt;% # tableX(Q3b,Q3bm) # # ISSP2012jh1d.dat %&gt;% # tableX(Q3am,Q3a) # # ISSP2012jh1d.dat$Q3a %&gt;% levels() # ISSP2012jh1d.dat$Q3am %&gt;% levels() # Taustamuuttujat - ristiintaulukointeja # ISSP2012jh1d.dat %&gt;% # tableX(edu, edum) # ISSP2012jh1d.dat %&gt;% # tableX(msta, mstam) # ISSP2012jh1d.dat %&gt;% # tableX(sosta, sostam) # ISSP2012jh1d.dat %&gt;% # tableX(nchild,nchildm) # ISSP2012jh1d.dat %&gt;% # tableX(lifsta, lifstam) # ISSP2012jh1d.dat %&gt;% # tableX(urbru, urbrum) # (16.9.2020) Testaus uusille muuttujille # Koodilohkoissa on jo testattu taulukoimalla muuttujia. Tässä varmistetaan, että # muuttujat pysyvät sellaisina millaisiksi ne on luotu. # ika - onpas hankala testata ! # Min. 1st Qu. Median Mean 3rd Qu. Max. # 15.00 36.00 50.00 49.52 63.00 102.00 # ikatest &lt;- ISSP2012jh1d.dat$ika %&gt;% summary() # ikatest &lt;- ikatest[2,] #validate_that(are_equal(ikatest, c(15, 36, 50, 49.5, 63, 102))) #str(ISSP2012jh1d.dat) #ISSP2012jh1d.dat %&gt;% # substanssimuuttujat 1 # Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, Q3a, Q3b (r. 423-&gt;) validate_that(length(levels(ISSP2012jh1d.dat$Q1a)) == 5) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1a), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1b)) == 5) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1b), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1c)) == 5) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1c), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1d)) == 5) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1d), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1e)) == 5) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1e), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q2a)) == 5) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q2a), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q2b)) == 5) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q2b), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) # substanssimuuttujat 2 validate_that(length(levels(ISSP2012jh1d.dat$Q3a)) == 3) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q3a), c(&quot;W&quot;, &quot;w&quot;, &quot;H&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q3b)) == 3) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q3b), c(&quot;W&quot;, &quot;w&quot;, &quot;H&quot;))) # substanssimuuttujat, puuttuva tieto muuttujan arvona # Q1am, Q1bm, Q1cm, Q1dm, Q1em, Q2am, Q2bm, Q3am, Q3bm validate_that(length(levels(ISSP2012jh1d.dat$Q1am)) == 6) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1am), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1bm)) == 6) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1bm), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1cm)) == 6) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1cm), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1dm)) == 6) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1dm), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q1em)) == 6) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q1em), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q2am)) == 6) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q2am), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q2bm)) == 6) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q2bm), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q3am)) == 4) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q3am), c(&quot;W&quot;, &quot;w&quot;, &quot;H&quot;, &quot;P&quot;))) validate_that(length(levels(ISSP2012jh1d.dat$Q3bm)) == 4) validate_that(are_equal(levels(ISSP2012jh1d.dat$Q3bm), c(&quot;W&quot;, &quot;w&quot;, &quot;H&quot;, &quot;P&quot;))) # taustamuuttujat puuttuvilla tiedoilla ja ilman # testataan vain tasojen määrä, ei labeleita jotka ovat # alkuperäisestä datasta. # edu, edum Huom! Koulutustasoluokitus alkuperäisessä # datassa 0-6 (ei muodollista koulusta - korkeampi kolmas aste (maisteri, tohtori) # R-faktorissa 1-7 validate_that(length(levels(ISSP2012jh1d.dat$edu)) == 7) validate_that(length(levels(ISSP2012jh1d.dat$edum)) == 8) # msta, mstam validate_that(length(levels(ISSP2012jh1d.dat$msta)) == 9) validate_that(length(levels(ISSP2012jh1d.dat$mstam)) == 10) # sosta, sostam validate_that(length(levels(ISSP2012jh1d.dat$sosta)) == 10) validate_that(length(levels(ISSP2012jh1d.dat$sostam)) == 11) # nchild, ncildm validate_that(length(levels(ISSP2012jh1d.dat$nchild)) == 11) validate_that(length(levels(ISSP2012jh1d.dat$nchildm)) == 12) # lifsta, lifstam validate_that(length(levels(ISSP2012jh1d.dat$lifsta)) == 6) validate_that(length(levels(ISSP2012jh1d.dat$lifstam)) == 7) # urbru, urbrum validate_that(length(levels(ISSP2012jh1d.dat$urbru)) == 5) validate_that(length(levels(ISSP2012jh1d.dat$urbrum)) == 6) issp_docname &lt;- c(&quot;Variable Report&quot;, &quot;Study Monitoring Report&quot;,&quot;Basic Questionnaire&quot;, &quot;Contents of ISSP 2012 module&quot;, &quot;Questionnaire Development&quot;) issp_docdesc &lt;- c(&quot;Perusdokumentti, muuttujien kuvaukset ja taulukot&quot;, &quot;tiedokeruun toteutus eri maissa&quot;, &quot;Maittain sovellettava kyselylomake&quot;, &quot;substanssikysymykset taulukkona&quot;, &quot;kyselylomakkeen laatiminen&quot;) issp_docfile &lt;- c(&quot;ZA5900_cdb.pdf&quot;, &quot;ZA5900_mr.pdf&quot;, &quot;ZA5900_bq.pdf&quot;,&quot;ZA5900_overview.pdf&quot;, &quot;ssoar-2014-scholz_et_al-ISSP_2012_Family_and_Changing.pdf&quot;) col_isspdocs &lt;- c(&quot;dokumentti&quot;,&quot;sisältö&quot;,&quot;tiedosto&quot;) ISSPdocsT.tbl &lt;- tibble(issp_docname, issp_docdesc, issp_docfile) colnames(ISSPdocsT.tbl) &lt;- col_isspdocs knitr::kable(ISSPdocsT.tbl, booktab = TRUE, caption = &#39; ISSP 2012: tärkeimmät dokumentit&#39;) # Muuttuja taulukkona - karkea tapa # HUOM! Taulkot ovat hankalia, kun tulostus halutaan pdf- ja html- formaattiin # Kysymyste pitkät versiot on siksi esitetty suomenkielisen lomakkeen kuvana. tabVarnames &lt;- c(substvars1,bgvars1) # muuttujanimet muuttujille # Kysymysten lyhyet versiot englanniksi tabVarDesc &lt;- c(&quot;Q1a Working mother can have warm relation with child &quot;, &quot;Q1b Pre-school child suffers through working mother&quot;, &quot;Q1c Family life suffers through working mother&quot;, &quot;Q1d Womens preference: home and children&quot;, &quot;Q1e Being housewife is satisfying&quot;, &quot;Q2a Both should contribute to household income&quot;, &quot;Q2b Mens job is earn money, womens job household&quot;, &quot;Q3a Should women work: Child under school age&quot;, &quot;Q3b Should women work: Youngest kid at school&quot;, &quot;Respondents age &quot;, &quot;Respondents gender&quot;, &quot;Highest completed degree of education: Categories for international comparison&quot;, &quot;Main status: work, unemployed, in education...&quot;, &quot;Top-Bottom self-placement (10 pt scale)&quot;, &quot;How many children in household: children between [school age] and 17 years of age&quot;, &quot;Legal partnership status: married, civil partership...&quot;, &quot;Place of living: urban - rural&quot; ) #tabVarDesc # Taulukko # luodaan df - varoitus: data_frame() is deprecated, use tibble (4.2.20), # vaihdetaan tibbleen (21.2.20) # jhVarTable1.df &lt;- data_frame(tabVarnames,tabVarDesc) OLD jhVarTable1.tbl &lt;- tibble(tabVarnames,tabVarDesc) cols_jhVarTable1 &lt;- c(&quot;muuttuja&quot;,&quot;kysymyksen tunnus, lyhennetty kysymys&quot;) colnames(jhVarTable1.tbl) &lt;- cols_jhVarTable1 #str(jhVarTable1.tbl) # Lyhyet kysymykset englanniksi knitr::kable(jhVarTable1.tbl, booktab = TRUE, caption = &quot;ISSP2012:Työelämä ja perhearvot - kysymykset&quot;) knitr::include_graphics(&#39;img/substvar_fi_Q1Q2.png&#39;) # UUSI DATA 30.1.20 # # LUETAAN DATA G1_1_data2.Rmd - tiedostossa, luodaan faktorimuuttujat # G1_1_data_fct1.Rmd-tiedostossa -&gt; ISSP2012jh1d.dat (df) # 23 muuttujaa (9 substanssimuuttujaa, 8 taustamuuttujaa, 3 maa-muuttujaa, 3 metadatamuuttujaa) # 25 maata. # Poistettu 146 havaintoa, joilla SEX tai AGE puuttuu # Johdattelevassa esimerkissä kuusi maata, kaksi taustamuuttujaa ja yksi kysymys # (V6/Q1b) # Kuusi maata countries_esim1 &lt;- c(56, 100, 208, 246, 276, 348) #BE,BG,DK,FI,DE,HU ISSP2012esim3.dat &lt;- filter(ISSP2012jh1d.dat, V4 %in% countries_esim1) # str(ISSP2012esim3.dat) - pitkä listaus pois (24.2.20) #neljä maamuuttujaa, kysymys Q1b, ikä ja sukupuoli vars_esim1 &lt;- c(&quot;C_ALPHAN&quot;, &quot;V3&quot;, &quot;maa&quot;,&quot;maa3&quot;, &quot;Q1b&quot;, &quot;sp&quot;, &quot;ika&quot;) ISSP2012esim2.dat &lt;- select(ISSP2012esim3.dat, all_of(vars_esim1)) str(ISSP2012esim2.dat) # 8542 obs. of 7 variables, ja sama 8.6.2020 # C_ALPHAN: chr, maa: Factor w/ 25 # Poistetaan havainnot, joilla Q1b - muuttujassa puuttuva tieto &#39;NA&#39; # sum(is.na(ISSP2012esim2.dat$Q1b)) = 399 ISSP2012esim1.dat &lt;- filter(ISSP2012esim2.dat, !is.na(Q1b)) #str(ISSP2012esim1.dat) # 8143 obs. of 6 variable # Tarkistuksia (3.2.20) # #fct_count(ISSP2012esim1.dat$sp) #fct_count(ISSP2012esim1.dat$Q1b) #fct_count(ISSP2012esim1.dat$maa) #fct_count(ISSP2012esim1.dat$maa3) # #summary(ISSP2012esim1.dat$sp) #sp: 3799 + 4344 = 8143 #summary(ISSP2012esim1.dat$Q1b) # S s ? e E # 810 + 1935 + 1367 + 2125 + 1906 = 8143 # # EDELLINEN DATA - havaintojen määrät samat kuin uudella datalla (31.1.20) # # 8557 obs. ennen kuin sexagemissing poistettiin, nyt 8542, 8557-8542 = 15 # # Poistetaan havainnot joissa puuttuva tieto muuttujassa V6 (Q1b) n = 399 # 8542-399 = 8143 # Tyhjät &quot;faktorilabelit&quot; on poistettava ISSP2012esim1.dat &lt;- ISSP2012esim1.dat %&gt;% mutate(maa = fct_drop(maa), maa3 = fct_drop(maa3) ) #summary(ISSP2012esim1.dat$maa) #summary(ISSP2012esim1.dat$maa3) # # str(ISSP2012esim1.dat$maa) # attributes(ISSP2012esim1.dat$maa) # # str(ISSP2012esim1.dat$maa3) # attributes(ISSP2012esim1.dat$maa3) # #ISSP2012esim1.dat %&gt;% tableX(maa, Q1b, type = &quot;count&quot;) #fct_count(ISSP2012esim1.dat$Q1b) # fct_count(ISSP2012esim1.dat$sp) # fct_unique(ISSP2012esim1.dat$maa) # fct_count(ISSP2012esim1.dat$maa) #ISSP2012esim1.dat %&gt;% tableX(maa, C_ALPHAN, type = &quot;count&quot;) # # maa3 - siistitään &quot;faktorilabelit&quot; kaksikirjaimisiksi # # ISO 3166 Code V3 - maiden jaot # 5601 BE-FLA-Belgium/ Flanders # 5602 BE-WAL-Belgium/ Wallonia # 5603 BE-BRU-Belgium/ Brussels # 27601 DE-W-Germany-West # 27602 DE-E-Germany-East # Tähän pitäisi päästä # levels = c(&quot;100&quot;,&quot;208&quot;,&quot;246&quot;,&quot;348&quot;,&quot;5601&quot;,&quot;5602&quot;,&quot;5603&quot;,&quot;27601&quot;,&quot;27602&quot;), # labels = c(&quot;BG&quot;,&quot;DK&quot;,&quot;FI&quot;,&quot;HU&quot;,&quot;bF&quot;,&quot;bW&quot;,&quot;bB&quot;,&quot;dW&quot;,&quot;dE&quot;)) # levels(ISSP2012esim1.dat$maa3) ISSP2012esim1.dat &lt;- ISSP2012esim1.dat %&gt;% mutate(maa3 = fct_recode(maa3, &quot;BG&quot; = &quot;BG-Bulgaria&quot;, &quot;DK&quot; = &quot;DK-Denmark&quot;, &quot;FI&quot; = &quot;FI-Finland&quot;, &quot;HU&quot; = &quot;HU-Hungary&quot;, &quot;bF&quot; = &quot;BE-FLA-Belgium/ Flanders&quot;, &quot;bW&quot; = &quot;BE-WAL-Belgium/ Wallonia&quot;, &quot;bB&quot; = &quot;BE-BRU-Belgium/ Brussels&quot;, &quot;dW&quot; = &quot;DE-W-Germany-West&quot;, &quot;dE&quot; = &quot;DE-E-Germany-East&quot;) ) # tarkistuksia #levels(ISSP2012esim1.dat$maa3) # str(ISSP2012esim1.dat$maa3) # 9 levels #summary(ISSP2012esim1.dat$maa3) # # TÄSSÄ TOISTOA! (4.2.20) # Muutetaan muuttujien &quot;maa&quot; ja &quot;maa3&quot; arvojen (levels) järjestys samaksi kuin # alkuperäisen muuttujan C_ALPHAN. Helpomi verrata aikaisempiin tuloksiin. # &quot;alkuperäinen&quot; maa talteen ISSP2012esim1.dat$maa2 &lt;- ISSP2012esim1.dat$maa ISSP2012esim1.dat &lt;- ISSP2012esim1.dat %&gt;% mutate(maa = fct_relevel(maa, &quot;BE&quot;, &quot;BG&quot;, &quot;DE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;)) ISSP2012esim1.dat &lt;- ISSP2012esim1.dat %&gt;% mutate(maa3 = fct_relevel(maa3, &quot;bF&quot;, &quot;bW&quot;, &quot;bB&quot;, &quot;BG&quot;, &quot;dW&quot;, &quot;dE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;)) # Tarkistus #ISSP2012esim1.dat %&gt;% tableX(maa2,maa, type = &quot;count&quot;) # &quot;alkuperäinen&quot; maa talteenISSP2012esim1.dat %&gt;% tableX(maa,C_ALPHAN, type = &quot;count&quot;) # &quot;alkuperäinen&quot; maa talteenstr(ISSP2012esim1.dat) # Taulukoita (31.1.2020) ja tarkistuksia # # toinen maa-muuttuja, jossa Saksan ja Belgian jako # V3 # 5601 BE-FLA-Belgium/ Flanders # 5602 BE-WAL-Belgium/ Wallonia # 5603 BE-BRU-Belgium/ Brussels # 27601 DE-W-Germany-West # 27602 DE-E-Germany-East # Tarkastuksia # assert_that ehkä tarpeeton - expect_equivalet testaa levelien # järjestyksen ja määrän (20.2.20) validate_that(length(levels(ISSP2012esim1.dat$sp)) == 2) validate_that(are_equal(levels(ISSP2012esim1.dat$sp), c(&quot;m&quot;, &quot;f&quot;))) validate_that(length(levels(ISSP2012esim1.dat$maa)) == 6) validate_that(are_equal(levels(ISSP2012esim1.dat$maa), c(&quot;BE&quot;, &quot;BG&quot;, &quot;DE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;))) validate_that(length(levels(ISSP2012esim1.dat$maa3)) == 9) validate_that(are_equal(levels(ISSP2012esim1.dat$maa3), c(&quot;bF&quot;,&quot;bW&quot;,&quot;bB&quot;, &quot;BG&quot;,&quot;dW&quot;,&quot;dE&quot;,&quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;))) validate_that(length(levels(ISSP2012esim1.dat$Q1b)) == 5) validate_that(are_equal(levels(ISSP2012esim1.dat$Q1b), c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;))) # testthat - paketti - pois käytöstä 16.9.20 # expect_ ei anna ok-ilmoitusta, ainoastaan virheilmoituksen? (11.4.20) # expect_equivalent(levels(ISSP2012esim1.dat$maa), # c(&quot;BE&quot;, &quot;BG&quot;, &quot;DE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;)) # expect_equivalent(levels(ISSP2012esim1.dat$maa3), # c(&quot;bF&quot;,&quot;bW&quot;,&quot;bB&quot;, &quot;BG&quot;,&quot;dW&quot;,&quot;dE&quot;,&quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;)) # expect_equivalent(levels(ISSP2012esim1.dat$sp), c(&quot;m&quot;, &quot;f&quot;)) # expect_equivalent(levels(ISSP2012esim1.dat$Q1b), # c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;)) # # ISSP2012esim1.dat %&gt;% tableX(maa,ika,type = &quot;row_perc&quot;) # # Riviprofiilit # # ISSP2012esim1.dat %&gt;% tableX(maa,ika,type = &quot;row_perc&quot;) # ISSP2012esim1.dat %&gt;% tableX(maa,sp ,type = &quot;row_perc&quot;) # # # Kysymyksen Q1b vastaukset # #ISSP2012esim1.dat %&gt;% tableX(maa,Q1b,type = &quot;row_perc&quot;) # #ISSP2012esim1.dat %&gt;% tableX(maa3,Q1b,type = &quot;row_perc&quot;) # # str(ISSP2012esim1.dat) # 8143 obs. of 7 variable, # sama kuin vanhassa Galku-koodissa. # # str(ISSP2012esim1.dat) # 8143 obs. of 7 variable, # sama kuin vanhassa Galku-koodissa. taulu2 &lt;- ISSP2012esim1.dat %&gt;% tableX(maa, Q1b, type = &quot;cell_perc&quot;) knitr::kable(taulu2,digits = 2, booktabs = TRUE, caption = &quot;Kysymyksen Q1b vastaukset maittain, suhteelliset frekvenssit&quot;) taulu3 &lt;- ISSP2012esim1.dat %&gt;% tableX(maa,Q1b,type = &quot;row_perc&quot;) knitr::kable(taulu3,digits = 2, booktabs = TRUE, caption = &quot;Kysymyksen Q1b vastaukset, riviprosentit&quot;) taulu4 &lt;- ISSP2012esim1.dat %&gt;% tableX(maa,Q1b,type = &quot;col_perc&quot;) knitr::kable(taulu4,digits = 2, booktabs = TRUE, caption = &quot;Kysymyksen Q1b vastaukset, sarakeprosentit&quot;) # CA tässä, jotta saadaan rivi- ja sarakeprofiilikuvat # Lasketaan samalla CA-ratkaisu riviprofiilitaulkolle (maille samat painot) simpleCA1 &lt;- ca(~maa + Q1b,ISSP2012esim1.dat) # Maiden järjestys kääntää kuvan (1.2.20) - esimerkki on # vähän kuriositeetti. Kartta voi tietysti &quot;flipata&quot; koordintaattien suhteen ainakin # neljällä tavalla (? 180 astetta molempien akseleiden ympäri molempiin suuntiin?) # (18.2.20). Tämän maa2-muuttujaa käyttävän kuvan voi jättää pois (8.4.20) # simpleCA2 &lt;- ca(~maa2 + Q1b,ISSP2012esim1.dat) # Oikeastaan maiden vertailussa pitäisi niiden massat skaalata yhtä suuriksi, tässä # pikainen kokeilu (20.2.20) # Riviprosentit taulukoksi, nimet sarakkeille ja riveille (ei kovin robustia...) johdesim1_rowproc.tab &lt;- simpleCA1$N / rowSums(simpleCA1$N) colnames(johdesim1_rowproc.tab) &lt;- c(&quot;S&quot; ,&quot;s&quot; ,&quot;?&quot;,&quot;e&quot;, &quot;E&quot;) rownames(johdesim1_rowproc.tab) &lt;- c(&quot;BE&quot;, &quot;BG&quot;, &quot;DE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;) # Miten tibblenä? Ei toimi, ei maa-muuttujaa ollenkaan # johdesim1_rowproc.tbl &lt;- as_tibble(johdesim1_rowproc.tab) # str(johdesim1_rowproc.tbl) # TARKISTUKSIA (20.2.20) # johdesim1_rowproc.tab # rowSums(johdesim1_rowproc.tab) # str(johdesim1_rowproc.tab) simpleCA3 &lt;- ca(johdesim1_rowproc.tab) # Kartta piirretään koodilohkossa simpleCAmap1, r. 773 noin. # Riviprosentit tarkistusta varten # S s ? e E #BE 9.49 22.40 21.76 27.42 18.93 #BG 12.81 42.89 22.26 20.63 1.41 #DE 9.63 21.88 11.55 31.39 25.55 #DK 5.04 17.15 10.95 16.71 50.14 #FI 4.23 16.94 13.42 38.11 27.30 #HU 21.97 28.89 22.57 19.06 7.52 # # Ja datan saa leikepöydän kautta, jos on tarve pikatarkistuksiin # read &lt;- read.table(&quot;clipboard&quot;) #mutkikas kuvan piirto - sarakeprofiilit vertailussa #ggplot vaatii df-rakenteen ja &#39;long data&#39; - muotoon ##https://stackoverflow.com/questions/9563368/create-stacked-barplot # -where-each-stack-is-scaled-to-sum-to # Pitkä https-linkki kahdella rivillä # # käytetään ca - tuloksia apu1 &lt;- (simpleCA1$N) colnames(apu1) &lt;- c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;) rownames(apu1) &lt;- c(&quot;BE&quot;, &quot;BG&quot;, &quot;DE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;) apu1_df &lt;- as.data.frame(apu1) #lasketan rivien reunajakauma apu1_df$ka_sarake &lt;- rowSums(apu1_df) #muokataan &#39;long data&#39; - muotoon apu1b_df &lt;- melt(cbind(apu1_df, ind = rownames(apu1_df)), id.vars = c(&#39;ind&#39;)) p &lt;- ggplot(apu1b_df, aes(x = variable, y = value, fill = ind)) + geom_bar(position = &quot;fill&quot;, stat = &quot;identity&quot;) + scale_y_continuous(name = &quot; &quot;,labels = percent_format()) p &lt;- p + labs(fill = &quot;maa&quot;) p + scale_x_discrete(name = &quot;Q1b - vastauskategoriat&quot;) # apu1_df # apu1b_df # riviprofiilit ja keskiarvorivi - 18.9.2018 apu2_df &lt;- as.data.frame(apu1) apu2_df &lt;- rbind(apu2_df, ka_rivi = colSums(apu2_df)) #apu2_df #str(apu2_df) ## typeof(apu2_df) # what is it? ## class(apu2_df) # what is it? (sorry) ## storage.mode(apu2_df) # what is it? (very sorry) ## length(apu2_df) # how long is it? What about two dimensional ## objects? # attributes(apu2_df) # temp1 &lt;- cbind(apu2_df, ind = rownames(apu2_df)) # temp1 ##muokataan &#39;long data&#39; - muotoon apu2b_df &lt;- melt(cbind(apu2_df, ind = rownames(apu2_df)), id.vars = c(&#39;ind&#39;)) # str(apu2b_df) # glimpse(apu2b_df) # #ggplot(apu2b_df, aes(x = value, y = ind, fill = variable)) + # geom_bar(position = &quot;fill&quot;, stat =&quot;identity&quot;) + # #coord_flip() + # scale_x_continuous(labels = percent_format()) #versio2 toimii (18.9.2018) p &lt;- ggplot(apu2b_df, aes(x = ind, y = value, fill = variable)) + geom_bar(position = &quot;fill&quot;, stat = &quot;identity&quot;) + coord_flip() + scale_y_continuous(name = &quot; &quot;,labels = percent_format()) p &lt;- p + labs(fill = &quot;Q1b&quot;) p + scale_x_discrete(name = &quot; &quot;) # simpleCA1 luotu aikaisemmin profiilikuvia varten koodilohkossa EkaCA # HUOM! xlab ja ylab, prosenttiosuudet ensin katsottu ja sitten kirjoitettu # tässä. Vertaa scree-plot - tietoon! #par(cex = 1) plot(simpleCA1, map = &quot;symmetric&quot;, mass = c(TRUE,TRUE), xlab = &quot;Dimensio 1: moderni/liberaali - perinteinen/konservatiivinen (76%)&quot;, ylab = &quot;Dimensio 2: maltillinen/epävarma - radikaali/jyrkkä/varma (15.1%)&quot;, main = &quot;symmetrinen kartta 1&quot;, sub = &quot;Maiden massat eri suuruisia (otoskoko), pisteiden koko suhteessa massaan&quot;) # jatkossa plot - main on kuvan tyyppi (symmetrinen, kontribuutio jne), # koodilohkon fig.cap &quot;ylimmän tason&quot; otsikko. # Akseleiden tekstit (Dimensio 1....jne) asetettu käsin, ikävä kyllä myös # selitetyn inertian osuus. CA-kartoissa tämä on niin oleellinen asia, # että akselien nimet voi muutttaa vasta esitysgrafiikassa, ei data-analyysissä. # Dim1 ja Dim2 kuuluvat kuviin. # par(cex = 1) - asetus ennen plot-komenota muuttaa valitettavasti &quot;kaiken&quot; kokoa. # Antaa olla, kun on graafista data-analyysiä. Selkeys tärkeämpää kuin ulkoasu. # asymmetrinen kartta - rivit pc ja sarakkeet sc # sarakkeet vektorikuvina # par(cex = 0.7) plot(simpleCA1, map = &quot;rowprincipal&quot;, arrows = c(FALSE,TRUE), main = &quot;asymmetrinen kartta 1&quot; ) # Piirretään Suomen riviprofiilista janat sarakepisteisiin - barysentinen keskiarvo # Rivipisteet pääkoordinaatteina (principal coordinates) simpleCA1.rpc &lt;- simpleCA1$rowcoord %*% diag(simpleCA1$sv) # X11() par(cex = 1) plot(simpleCA1, map = &quot;rowprincipal&quot;, arrows = c(FALSE,FALSE), # main = &quot;barysentrinen periaate - asymmetrinen kartta 2&quot;, sub = &quot;Suomen profiili sarakkeiden barysentrisenä keskiarvona&quot;) segments(simpleCA1.rpc[5,1],simpleCA1.rpc[5,2],simpleCA1$colcoord[, 1], simpleCA1$colcoord[, 2], col = &quot;pink&quot;) knitr::include_graphics(&#39;img/simpleCAasymmTulk2.png&#39;) #par(cex = 0.6) plot(simpleCA1, map = &quot;rowgreen&quot;, contrib = c(&quot;absolute&quot;, &quot;absolute&quot;), mass = c(TRUE,TRUE), arrows = c(FALSE, TRUE), main = &quot;kontribuutiokartta 1&quot;, sub = &quot;sarakevektorin ja rivipisteiden värin tummuus = absoluuttinen kontribuutio&quot;) #par(cex = 0.7) plot(simpleCA1, map = &quot;rowgreen&quot;, contrib = c(&quot;relative&quot;, &quot;relative&quot;), mass = c(TRUE,TRUE), arrows = c(FALSE, TRUE), main = &quot;kontribuutiokartta 2&quot;, sub = &quot;sarakevektorin ja pisteen värin tummuus = suhteellinen kontribuutio&quot;) # Sama kartta - maiden massat vakiotu - simpleCA3 luotu koodilohkossa EkaCA # CA:n lähtötietona riviprofiilit #par(cex = 0.8) plot(simpleCA3, map = &quot;symmetric&quot;, mass = c(TRUE,TRUE), main = &quot;symmetrinen kartta 2 &quot;, sub = &quot;Maidet massat vakioitu (riviprofiilidata)&quot;) plot(simpleCA3, map = &quot;rowgreen&quot;, contrib = c(&quot;absolute&quot;, &quot;absolute&quot;), mass = c(TRUE,TRUE), arrows = c(FALSE, TRUE), main = &quot;kontribuutiokartta 3&quot;, sub = &quot;sarakevektorin ja rivipisteiden värin tummuus = absoluuttinen kontribuutio, riviprofiilidata&quot;) # riviprofiilitaulukko aiheuttaa virheen PDF-tulostuksessa, JH_capaper.Rmd # tiedoston voi kuitenkin renderöidä knit-napilla RStudiossa pdf-tiedostoksi. # Kts. edellinen koodilohko - testailua pdf-ongelman ratkaisemiseksi # tallennetaan data tiedostoon, koodilohko BeDeAluedat1 passiviseksi # suppoint1_tab1 &lt;- read_rds(&quot;suppoint1tab1.rds&quot;) # suppoint1_tab1 # tarkistus ok BeDealueTable &lt;- ISSP2012esim1.dat %&gt;% tableX(maa3, Q1b, type = &quot;row_perc&quot;) knitr::kable(BeDealueTable , digits = 2, booktabs = TRUE, caption = &quot;Q1b vastaukset, Saksan ja Belgian alueet&quot;) # (26.10.20) TÄSSÄ EHKÄ VIRHE - PDF-renderöinti antaa virheilmoituksen? # Ei todennäköistä, sillä toimii html-tulostuksessa. Kokeiltiin tämän lohkon # poistamista, ei auttanut ratkaisevasti. # Belgian ja Saksan aluejako maa3-muuttujassa # str(ISSP2012esim1.dat$maa3) # attributes(ISSP2012esim1.dat$maa3) suppoint1_df1 &lt;- select(ISSP2012esim1.dat, maa3,Q1b) # Taulukoksi jotta saadaan lisättyä Saksan ja Belgian maa-profiilit täydentäviksi # pisteiksi. suppoint1_tab1 &lt;- table(suppoint1_df1$maa3, suppoint1_df1$Q1b) # tarkistus 1 # suppoint1_tab1 # Maaprofiilit lisäpisteiksi suppoint2_df &lt;- filter(ISSP2012esim1.dat, (maa == &quot;BE&quot; | maa == &quot;DE&quot;)) suppoint2_df &lt;- select(suppoint2_df, maa, Q1b) # Poistetaan maa-faktroin tyhjät luokat (14.11.2020) suppoint2_df &lt;- suppoint2_df %&gt;% mutate(maa = fct_drop(maa) ) #glimpse(suppoint2_df) suppoint2_tab1 &lt;- table(suppoint2_df$maa, suppoint2_df$Q1b) # tarkistus 1 # suppoint2_tab1 # Huom! tämä komento vain kerran - tai koko Rmd-tiedosto uudestaan (17.10.20) # Korvattu maa-faktorin tyhjien luokkien poisolla (14.11.2020) # suppoint2_tab1 &lt;- suppoint2_tab1[-c(2,4:6) ,] #suppoint2_tab1 # tarkistus 2 # lisätään rivit maa3-muuttujan taulukkoon suppoint1_tab1 &lt;- rbind(suppoint1_tab1, suppoint2_tab1) # suppoint1_tab1 # tarkistus 3 # Testailua pdf-ongelman ratkaisemiseksi - tallennetaa taulukko tiedostoksi # Ei ratkaisevasti auttanut (26.10.2020) # write_rds(suppoint1_tab1,&quot;suppoint1tab1.rds&quot;) # suppoint1_tab2 &lt;- read_rds(&quot;suppoint1tab1.rds&quot;) - testaus joka siirsi virheen 07-rmd-tiedostoon. Sama virheilmoitustyyppi. suppointCA2 &lt;- ca(suppoint1_tab1[,1:5], suprow = 10:11) # par(cex = 0.6) plot(suppointCA2, main = &quot;Symmetrinen kartta 1 &quot;, # mass = c(TRUE, TRUE), # contrib = c(TRUE, TRUE), sub = &quot;Täydentävät pisteet DE ja BE&quot; ) plot(suppointCA2, main = &quot;kontribuutiokartta 1&quot;, map = &quot;rowgreen&quot;, arrows = c(FALSE, TRUE), mass = c(TRUE, FALSE), contrib = c(&quot;absolute&quot;,&quot;absolute&quot;), sub = &quot;Täydentävät pisteet DE ja BE&quot; ) suppointCA2 summary(suppointCA2) suppointCA3 &lt;- ca(~maa3 + Q1b,ISSP2012esim1.dat, nd = 3) # summary(suppointCA3) # Error in rsc %*% diag(sv) : non-conformable arguments # outo juttu, ei toimi! - TÄMÄ POISTETAAN plot(suppointCA3, dim = c(1,2), main = &quot;Kolmen dimension ratkaisu&quot;, sub = &quot;symmetrinen kartta - 1. ja 2. dimensio&quot;) plot(suppointCA3, dim = c(1,3), main = &quot;Kolmen dimension ratkaisu&quot;, sub = &quot;symmetrinen kartta - 1. ja 3. dimensio&quot;) plot(suppointCA3, dim = c(2,3), main = &quot;Kolmen dimension ratkaisu&quot;, sub = &quot;symmetrinen kartta - 2. ja 3. dimensio&quot;) knitr::include_graphics(&#39;img/3dSymMap_1.PNG&#39;) knitr::include_graphics(&#39;img/3dSymMap_2.PNG&#39;) # Iän ja sukupuolen vuorovaikutusmuuttujia # # Uusi R-data: ISSP2012esim1b.dat2esim1b) # # Ikäluokat age_cat # AGE 1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 and older # # summary(ISSP2012esim1.dat$AGE) # hist(ISSP2012esim1.dat$ika) ISSP2012esim1b.dat &lt;- mutate(ISSP2012esim1.dat, age_cat = ifelse(ika %in% 15:25, &quot;1&quot;, ifelse(ika %in% 26:35, &quot;2&quot;, ifelse(ika %in% 36:45, &quot;3&quot;, ifelse(ika %in% 46:55, &quot;4&quot;, ifelse(ika %in% 56:65, &quot;5&quot;, &quot;6&quot;)))))) ISSP2012esim1b.dat &lt;- ISSP2012esim1b.dat %&gt;% mutate(age_cat = as_factor(age_cat)) # järjestys omituinen!(4.2.20) # Tarkistuksia # str(ISSP2012esim2.dat$age_cat) # levels(ISSP2012esim2.dat$age_cat) # ISSP2012esim2.dat$age_cat %&gt;% summary() # Järjestetään ikäluokat uudelleen ISSP2012esim1b.dat &lt;- ISSP2012esim1b.dat %&gt;% mutate(age_cat = fct_relevel(age_cat, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;) ) # Tarkistuksia # Iso taulukko, voi tarkistaa että muunnos ok. # test6 %&gt;% tableX(AGE, age_cat, type = &quot;count&quot;) # taulu42 &lt;- ISSP2012esim2.dat %&gt;% tableX(maa,age_cat,type = &quot;count&quot;) # kable(taulu42,digits = 2, caption = &quot;Ikäluokka age_cat&quot;) # # Taulukoita (4.2.20) #ISSP2012esim1b.dat %&gt;% # tableX(maa,age_cat,type = &quot;count&quot;) %&gt;% # kable(digits = 2, caption = &quot;Ikäluokka age_cat&quot;) # #ISSP2012esim1b.dat %&gt;% # tableX(maa,age_cat,type = &quot;row_perc&quot;) %&gt;% # kable(digits = 2, caption = &quot;age_cat: suhteelliset frekvenssit&quot;) # ga - ikäluokka ja sukupuoli ISSP2012esim1b.dat &lt;- mutate(ISSP2012esim1b.dat, ga = case_when((age_cat == &quot;1&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m1&quot;, (age_cat == &quot;2&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m2&quot;, (age_cat == &quot;3&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m3&quot;, (age_cat == &quot;4&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m4&quot;, (age_cat == &quot;5&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m5&quot;, (age_cat == &quot;6&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m6&quot;, (age_cat == &quot;1&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f1&quot;, (age_cat == &quot;2&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f2&quot;, (age_cat == &quot;3&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f3&quot;, (age_cat == &quot;4&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f4&quot;, (age_cat == &quot;4&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f4&quot;, (age_cat == &quot;5&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f5&quot;, (age_cat == &quot;6&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f6&quot;, TRUE ~ &quot;missing&quot; )) #ISSP2012esim1.dat %&gt;% tableX(ga,ga2) # tarkistus # muuttujien tarkistuksia 19.9.2018 # str(ISSP2012esim1b.dat$ga) # chr-muuttuja, mutta toimii (4.2.20) #Tulostetaan taulukkoina ga - muuttuja #ISSP2012esim1b.dat %&gt;% tableX(maa,ga,type = &quot;count&quot;) %&gt;% #kable(digits = 2, caption = &quot;Ikäluokka ja sukupuoli ga&quot;) #ISSP2012esim1b.dat %&gt;% tableX(maa,ga,type = &quot;row_perc&quot;) %&gt;% #kable(digits = 2, caption = &quot;ga: suhteelliset frekvenssit&quot;) gaTestCA1 &lt;- ca(~ga + Q1b,ISSP2012esim1b.dat) # Maapisteiden pääkoordinaatit janojen piirtämiseen gaTestCA1.rpc &lt;- gaTestCA1$rowcoord %*% diag(gaTestCA1$sv) # par(cex = 0.6) plot(gaTestCA1, main = &quot;symmetrinen kartta, m = mies, f = nainen&quot;, sub = &quot;1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 tai vanhempi &quot;) # naiset lines(gaTestCA1.rpc[1:6,1],gaTestCA1.rpc[1:6,2]) #miehet lines(gaTestCA1.rpc[7:12,1],gaTestCA1.rpc[7:12,2], col = &quot;red&quot;) summary(gaTestCA1) ISSP2012esim1b.dat &lt;- mutate(ISSP2012esim1b.dat, maaga = paste(maa, ga, sep = &quot;&quot;)) # tarkistus, muunnos ok # ISSP2012esim1b.dat %&gt;% tableX(maa, maaga) # head(ISSP2012esim2.dat) # str(ISSP2012esim2.dat) maagaCA1 &lt;- ca(~maaga + Q1b,ISSP2012esim1b.dat) par(cex = 0.5) plot(maagaCA1, main = &quot;symmetrinen kartta 1&quot;, sub = &quot;cex=0.5&quot;) # Vilkaistaan numeerisia tuloksia, kopioidaan tekstiin jos on tarpeellista summary(maagaCA1) # Osajoukon CA: Tanska, Saksa ja Suomi maagaCA2sub2 &lt;- ca(~maaga + Q1b,ISSP2012esim1b.dat,subsetrow = 25:60) par(cex = 0.8) plot(maagaCA2sub2, main = &quot;Q1b: Lapsi kärsii jos äiti käy töissä&quot;, sub = &quot;symmetrinen kartta - Tanska, Saksa ja Suomi (subset ca), cex = 0.7&quot;) # ca-tulosobjekti maagaCA2sub2, DK DE FI maagaLinesDKDEFI &lt;- cacoord(maagaCA2sub2, type = &quot;symmetric&quot;) maagaLinesDKDEFI &lt;- maagaLinesDKDEFI$rows[ , 1:2] # maagaLinesDKDEFI # tarkistus par(cex = 0.6) plot(maagaCA2sub2, sub = &quot;symmetrinen kartta - Tanska, Saksa ja Suomi (subset ca)&quot;) lines(maagaLinesDKDEFI[1:6,1],maagaLinesDKDEFI[1:6,2], col=&quot;blue&quot;) #DEf lines(maagaLinesDKDEFI[7:12,1],maagaLinesDKDEFI[7:12,2], col=&quot;red&quot;) #DEm lines(maagaLinesDKDEFI[13:18,1],maagaLinesDKDEFI[13:18,2], col=&quot;blue&quot;) #DKf lines(maagaLinesDKDEFI[19:24,1],maagaLinesDKDEFI[19:24,2], col=&quot;red&quot;) #DKm lines(maagaLinesDKDEFI[25:30,1],maagaLinesDKDEFI[25:30,2], col=&quot;blue&quot;) #FIf lines(maagaLinesDKDEFI[31:36,1],maagaLinesDKDEFI[31:36,2], col=&quot;red&quot;) #FIm par(cex = 0.6) plot(maagaCA2sub2, map = &quot;rowgreen&quot;, mass = c(TRUE, TRUE), contrib =c(&quot;relative&quot;, &quot;absolute&quot;), arrows = c(FALSE, TRUE), main = &quot;Kontribuutiokartta: sarakkeiden(abs.) ja rivien(rel.) värisävy&quot;, sub = &quot;massat pisteiden kokoina, cex=0.06&quot; ) # Tarkastetaan numeeriset tulokset summary(maagaCA2sub2) # Belgia, Bulgaria ja Unkari analysoidaan tiiviisti # Belgia on vähän välitapaus Bulgarian ja Unkarin ja kolmen ensimmäisen maan # kanssa. Kokeiluja voi tehdä neljällä maaryhmällä, kuvan lukukelpoisuus # ratkaisee. #BGHUsubset &lt;- c(13:24,61:72) #BEDEDKFIsubset &lt;- c(1:12, 25:36, 37:48, 49:60) #DEDKFIsubset &lt;- c(25:36, 37:48, 49:60) BEBGHUsubset &lt;- c(1:12,13:24,61:72) maagaCA2sub3 &lt;- ca(~maaga + Q1b,ISSP2012esim1b.dat,subsetrow = BEBGHUsubset) par(cex = 0.6) plot(maagaCA2sub3, map = &quot;rowgreen&quot;, mass = c(TRUE, TRUE), contrib =c(&quot;relative&quot;, &quot;absolute&quot;), arrows = c(FALSE, TRUE), main = &quot;Kontribuutiokartta: sarakkeiden(abs.) ja rivien(rel.) värisävy&quot;, sub = &quot;massat pisteiden kokoina, cex=0.06&quot; ) # Vilkaistaa numeerisia tuloksia, kopioidaan tekstiin jos on tarpeen # maagaCA2sub3 summary(maagaCA2sub3) # kahden osaratkaisun kokonaisinertia # 0.143551 + 0.119602 = 0.263153 # koko datalla 0.263154 knitr::include_graphics(&#39;img/stacked1.png&#39;) # Data ISSP2012Concat1jh.dat &lt;- select(ISSP2012esim1b.dat, Q1b, maa,sp, age_cat) # mjca-funktiota -&gt; Burt-matriisi Concat1jh.Burt &lt;- mjca(ISSP2012Concat1jh.dat, ps=&quot;&quot;)$Burt # Burt-matriisi symmetrinen #dim(Concat1jh.Burt) # 19 x 19 #rownames(Concat1jh.Burt) #[1] &quot;Q1bS&quot; &quot;Q1bs&quot; &quot;Q1b?&quot; &quot;Q1be&quot; &quot;Q1bE&quot; &quot;maaBE&quot; &quot;maaBG&quot; &quot;maaDE&quot; &quot;maaDK&quot; #[10] &quot;maaFI&quot; &quot;maaHU&quot; &quot;spm&quot; &quot;spf&quot; &quot;age_cat1&quot; &quot;age_cat2&quot; &quot;age_cat3&quot; &quot;age_cat4&quot; &quot;age_cat5&quot; #[19] &quot;age_cat6&quot; # maat - vastaukset ISSP2012Concat2jh.dat &lt;- Concat1jh.Burt[6:11, 1:5] # ISSP2012Concat2jh.dat # sukupuoli ja vastaukset ISSP2012Concat2jh.dat &lt;- rbind(ISSP2012Concat2jh.dat, Concat1jh.Burt[12:13 ,1:5]) # ISSP2012Concat2jh.dat # ikäluokka ja vastaukset ISSP2012Concat2jh.dat &lt;- rbind(ISSP2012Concat2jh.dat, Concat1jh.Burt[14:19 ,1:5]) # ISSP2012Concat2jh.dat Concat1jh.CA1 &lt;- ca(ISSP2012Concat2jh.dat) # Käännetään kuva x-akselin ympäri Concat1jh.CA1$rowcoord[, 2] &lt;- -Concat1jh.CA1$rowcoord[, 2] Concat1jh.CA1$colcoord[, 2] &lt;- -Concat1jh.CA1$colcoord[, 2] # Siistitään muuttujien nimet Concat1jh.CA1$colnames &lt;- c(&quot;S&quot;, &quot;s&quot;, &quot;?&quot;, &quot;e&quot;, &quot;E&quot;) Concat1jh.CA1$rownames &lt;- c(&quot;BE&quot;, &quot;BG&quot;, &quot;DE&quot;, &quot;DK&quot;, &quot;FI&quot;, &quot;HU&quot;, &quot;m&quot;, &quot;f&quot;, &quot;a1&quot;, &quot;a2&quot;, &quot;a3&quot;, &quot;a4&quot;, &quot;a5&quot;, &quot;a6&quot;) par(cex = 0.6) # pisteiden kasautumien haittaa plot(Concat1jh.CA1, main = &quot;Pinottu taulukko - symmetrinen kuva1&quot;, sub = &quot;a1-a6 ikäluokat, m = miehet, f = naiset, Q1b (cex=0.6)&quot; ) summary(Concat1jh.CA1) par(cex = 0.6) plot(Concat1jh.CA1, map = &quot;rowgreen&quot;, mass = c(TRUE, TRUE), contrib =c(&quot;relative&quot;, &quot;absolute&quot;), arrows = c(FALSE, TRUE), main = &quot;Pinottu taulukko, kontribuuutiokartta (suhteellinen, absoluuttinen)&quot;, sub = &quot;a1-a6 ikäluokat, m = miehet, f = naiset, massat pisteiden koko&quot; ) # str(ISSP2012jh1d.dat) - luotu skripteissä G1_1_data2.Rmd ja G1_1_data_fct1.Rmd # Tarkistukset näkyvät Galkussa - tässä ei tulosteta # Kommentoidaan pois tarkistuksia (14.11.2020) #Valitaan muuttujat joissa puuttuva tieto on koodattu muuttujan arvoksi MCAvars1 &lt;- c(&quot;Q1am&quot;,&quot;Q1bm&quot;, &quot;Q1cm&quot;, &quot;Q1dm&quot;,&quot;Q1em&quot;,&quot;Q2am&quot;,&quot;Q2bm&quot;,&quot;edum&quot;, &quot;sostam&quot;, &quot;urbrum&quot;, &quot;maa&quot;, &quot;ika&quot;, &quot;sp&quot; ) MCAdata1jh.dat &lt;- ISSP2012jh1d.dat %&gt;% select(all_of(MCAvars1)) #dim(MCAdata1jh.dat) # names(MCAdata1jh.dat) # luodaan ikaluokka-muuttuja ja ikäluokka-sukupuoli - muuttuja #age_cat #ikä 1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 and older MCAdata1jh.dat &lt;- mutate(MCAdata1jh.dat, age_cat = ifelse(ika %in% 15:25, &quot;1&quot;, ifelse(ika %in% 26:35, &quot;2&quot;, ifelse(ika %in% 36:45, &quot;3&quot;, ifelse(ika %in% 46:55, &quot;4&quot;, ifelse(ika %in% 56:65, &quot;5&quot;, &quot;6&quot;)))))) # str(MCAdata1jh.dat$age_cat) MCAdata1jh.dat &lt;- MCAdata1jh.dat %&gt;% mutate(age_cat = as_factor(age_cat)) #tarkastuksia - outo järjestys #levels(MCAdata1jh.dat$age_cat) # str(MCAdata1jh.dat$age_cat) MCAdata1jh.dat&lt;- MCAdata1jh.dat %&gt;% mutate(age_cat = fct_relevel(age_cat, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;)) # Tarkistuksia(16.10.20) #MCAdata1jh.dat %&gt;% # tableX(maa,age_cat,type = &quot;count&quot;) #%&gt;% # #kable(digits = 2, caption = &quot;Ikäluokka age_cat&quot;) #MCAdata1jh.dat %&gt;% # tableX(maa,age_cat,type = &quot;row_perc&quot;) #%&gt;% # #kable(digits = 2, caption = &quot;age_cat: suhteelliset frekvenssit&quot;) # Ikäluokka-sukupuoli - muuttuja MCAdata1jh.dat &lt;- mutate(MCAdata1jh.dat, ga = case_when((age_cat == &quot;1&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m1&quot;, (age_cat == &quot;2&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m2&quot;, (age_cat == &quot;3&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m3&quot;, (age_cat == &quot;4&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m4&quot;, (age_cat == &quot;5&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m5&quot;, (age_cat == &quot;6&quot;)&amp;(sp == &quot;m&quot;) ~ &quot;m6&quot;, (age_cat == &quot;1&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f1&quot;, (age_cat == &quot;2&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f2&quot;, (age_cat == &quot;3&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f3&quot;, (age_cat == &quot;4&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f4&quot;, (age_cat == &quot;4&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f4&quot;, (age_cat == &quot;5&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f5&quot;, (age_cat == &quot;6&quot;)&amp;(sp == &quot;f&quot;) ~ &quot;f6&quot;, TRUE ~ &quot;missing&quot; )) #Sosiaalinen status: oma arvio &quot;Top-Bottom self-placement&quot; #str(ISSP2012jh1d.dat$sosta) #str(ISSP2012jh1d.dat$urbru) #str(ISSP2012jh1d.dat$edu) #Koulutustaso #str(ISSP2012jh1d.dat$edu) #Asuipaikka #str(ISSP2012jh1d.dat$urbru) # Muunnetaan faktorimuuttujia, mahdollisimman lyhyet tunnisteet kategorioille MCAdata1jh.dat &lt;- MCAdata1jh.dat %&gt;% mutate(E = fct_recode(edum, &quot;1&quot; = &quot;No formal education&quot;, &quot;2&quot; = &quot;Primary school (elementary school)&quot;, &quot;3&quot; = &quot;Lower secondary (secondary completed does not allow entry to university: obligatory school)&quot;, &quot;4&quot; = &quot;Upper secondary (programs that allows entry to university&quot;, &quot;5&quot; = &quot;Post secondary, non-tertiary (other upper secondary programs toward labour market or technical formation)&quot;, &quot;6&quot; = &quot;Lower level tertiary, first stage (also technical schools at a tertiary level)&quot;, &quot;7&quot; = &quot;Upper level tertiary (Master, Dr.)&quot;, &quot;P&quot; = &quot;missing&quot;), S = fct_recode(sostam, &quot;1&quot; = &quot;Lowest, Bottom, 01&quot;, &quot;2&quot; = &quot;02&quot;, &quot;3&quot; = &quot;03&quot;, &quot;4&quot; = &quot;04&quot;, &quot;5&quot; = &quot;05&quot;, &quot;6&quot; = &quot;06&quot;, &quot;7&quot; = &quot;07&quot;, &quot;8&quot; = &quot;08&quot;, &quot;9&quot; = &quot;09&quot;, &quot;10&quot;= &quot;Highest, Top, 10&quot;, &quot;P&quot; = &quot;missing&quot;), U = fct_recode(urbrum, &quot;1&quot; = &quot;A big city&quot;, &quot;2&quot; = &quot;The suburbs or outskirts of a big city&quot;, &quot;3&quot; = &quot;A town or a small city&quot;, &quot;4&quot; = &quot;A country village&quot;, &quot;5&quot; = &quot;A farm or home in the country&quot;, &quot;P&quot; = &quot;missing&quot;) ) #names(MCAdata1jh.dat) #dim(MCAdata1jh.dat) #MCAdata1jh.dat$E %&gt;% levels() #MCAdata1jh.dat$S %&gt;% levels() #MCAdata1jh.dat$U %&gt;% levels() #MCAdata1jh.dat$age_cat %&gt;% levels() #str(MCAdata1jh.dat$ga) # toimiikohan - chr-muuttuja? (16.10.20) MCAdata1jh.dat &lt;- MCAdata1jh.dat %&gt;% mutate(gaf = as_factor(ga)) #str(MCAdata1jh.dat$gaf) #levels(MCAdata1jh.dat$gaf) # järjestyksellä ei liene väliä? (16.10.20) # gaf ja ga: sama järjestys MCAdata1jh.dat &lt;- MCAdata1jh.dat %&gt;% mutate(gaf = fct_relevel(gaf, &quot;f1&quot;, &quot;f2&quot;, &quot;f3&quot;, &quot;f4&quot;, &quot;f5&quot;, &quot;f6&quot;, &quot;m1&quot;, &quot;m2&quot;, &quot;m3&quot;, &quot;m4&quot;, &quot;m5&quot;, &quot;m6&quot;)) # Lopuksi substanssimuuttutien nimet lyhyiksi MCAdata1jh.dat &lt;- MCAdata1jh.dat %&gt;% mutate(a1 = Q1am, b1 = Q1bm, c1 = Q1cm, d1 = Q1dm, e1 = Q1em, a2 = Q2am, b2 = Q2bm) # TinyTeX MikTeXin tilalle, testiprojektissa toimii mutta täällä sama virheilmoitus. # Kopioidaan taulukoinnit tähän, error=TRUE nin suoritus ei katkea virheeseen. #Tarkistus # MCAdata1jh.dat %&gt;% tableX (a1, Q1am) # MCAdata1jh.dat %&gt;% tableX (b1, Q1bm) # MCAdata1jh.dat %&gt;% tableX (c1, Q1cm) # MCAdata1jh.dat %&gt;% tableX (d1, Q1dm) # MCAdata1jh.dat %&gt;% tableX (e1, Q1em) # MCAdata1jh.dat %&gt;% tableX (a2, Q2am) # MCAdata1jh.dat %&gt;% tableX (b2, Q2bm) # MCAdata1jh.dat %&gt;% tableX(gaf, ga) # Perustietoja - TÄSSÄ UUSI PDF-VIRHEILMOITUS 7.11.2020 # Ei tulosteta - kommentoidaan pois #MCAdata1jh.dat %&gt;% tableX (maa,a1, type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX (maa,b1, type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX (maa,c1, type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX (maa,d1, type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX (maa,e1, type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX (maa,a2,type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX (maa,b2,type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX(gaf, ga,type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX(maa, age_cat,type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX(maa, gaf,type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX(maa, S, type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX(maa, U, type = &quot;row_perc&quot;) #MCAdata1jh.dat %&gt;% tableX(maa, E, type = &quot;row_perc&quot;) #Puuttuvien tietojen yleiskuva # Puuttuvat tiedot aineistossa - viite datan dokumentointiin jossa taulukot. # Vaihtelee maittain ja muuttujittain, paljon. # Koko data (G1_1_data2.Rmd - skriptissä valitut muuttujat ja 25 maata) # #sum(!complete.cases(ISSP2012jh1d.dat)) = 9455 #dim(ISSP2012jh1d.dat) = 32823 #9455/32823 = 0.2880602 # Puuttuvat tiedot valitussa MCA-aineistossa #missingMCAvars1 &lt;- c(&quot;Q1a&quot;,&quot;Q1b&quot;, &quot;Q1c&quot;, &quot;Q1d&quot;,&quot;Q1e&quot;,&quot;Q2a&quot;,&quot;Q2b&quot;,&quot;edu&quot;, # &quot;sosta&quot;, &quot;urbru&quot;, &quot;maa&quot;, &quot;ika&quot;, &quot;sp&quot; ) #missingTestMCA1.dat &lt;- ISSP2012jh1d.dat %&gt;% select(all_of(missingMCAvars1)) #sum(!complete.cases(missingTestMCA1.dat)) = 6101 #dim(missingTestMCA1.dat) = 32823 #6101/32823 = 0.1858758 Puuttellisten havaintojen osuus. # Valitaan data mcaDat11jh.dat &lt;- MCAdata1jh.dat %&gt;% select(a1,b1,c1, d1, e1,a2,b2) dim(mcaDat11jh.dat) #glimpse(mcaDat11jh.dat) Qmuuttujat1.mca &lt;- mjca(mcaDat11jh.dat, ps=&quot;&quot;) # ps=&quot;&quot; muuttujan ja sen kategorian eroitinmerkki par(cex = 0.6) plot.mjca(Qmuuttujat1.mca, labels = c(1,2), main = &quot;Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b&quot;, sub = &quot;vastaukset S-s-?-e-E-P &quot; ) par(cex=0.6) plot.mjca(Qmuuttujat1.mca, what = c(&quot;all&quot;,&quot;all&quot;),labels = c(0,2), col = c(&quot;lightblue&quot;, &quot;red&quot;), main = &quot;Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b&quot;, sub = &quot;vastaukset S-s-?-e-E-P, havainnot (n = 32 823) &quot; ) #subsetcat viittaa muuttujan luokkien indeksiin eiPvastaukset &lt;- (1:42)[-c(6,12,18,24,30,36,42)] # eiPvastaukset # puuttuva tieto on kuudes kategoria kaikilla kysymyksillä # 1 2 3 4 5 7 8 9 10 11 13 14 15 16 17 19 20 21 22 23 25 26 27 28 29 31 # 32 33 34 35 37 38 39 40 41 #mcaDat11jh.dat[1:5,] Qmuuttujat2.mca &lt;- mjca(mcaDat11jh.dat, ps=&quot;&quot;, subsetcat=eiPvastaukset) #subsetcat viittaa muuttujan luokkien indeksiin eiPvastaukset &lt;- (1:42)[-c(6,12,18,24,30,36,42)] # eiPvastaukset # puuttuva tieto on kuudes kategora kaikilla kysymyksillä # 1 2 3 4 5 7 8 9 10 11 13 14 15 16 17 19 20 21 22 23 25 26 27 28 29 31 # 32 33 34 35 37 38 39 40 41 # mcaDat11jh.dat[1:5,] Qmuuttujat2.mca &lt;- mjca(mcaDat11jh.dat, ps=&quot;&quot;, subsetcat=eiPvastaukset) plot.mjca(Qmuuttujat2.mca, main=&quot;Seitsemän kysymystä, viisi vastausvaihtoehtoa&quot;, sub = &quot;subset: ei puuttuvien vastausten kategorioita(*P)&quot;) plot.mjca(Qmuuttujat2.mca, what = c(&quot;all&quot;,&quot;all&quot;),labels = c(0,2), col = c(&quot;lightblue&quot;, &quot;red&quot;), main=&quot;Seitsemän kysymystä, viisi vastausvaihtoehtoa&quot;, sub = &quot;subset: ei puuttuvien vastausten kategoriaa (*P)&quot;) plot.mjca(Qmuuttujat2.mca, map = &quot;rowprincipal&quot;, what = c(&quot;all&quot;,&quot;all&quot;),labels = c(0,2), col = c(&quot;lightblue&quot;, &quot;red&quot;), main=&quot;Seitsemän kysymystä, viisi vastausvaihtoehtoa - asymmetrinen kartta&quot;, sub = &quot;subset: ei puuttuvien vastausten kategoriaa (*P)&quot;) summary(Qmuuttujat2.mca) summary(Qmuuttujat2.mca) Qmuuttujat2d3 &lt;- mjca(mcaDat11jh.dat, ps=&quot;&quot;, nd = 3,subsetcat=eiPvastaukset) summary(Qmuuttujat2d3) knitr::include_graphics(&#39;img/CAquality.png&#39;) knitr::include_graphics(&#39;img/substvar_fi_Q1Q2.png&#39;) knitr::include_graphics(&#39;img/BookdownProc.png&#39;) # pois out.width=&#39;50%&#39;, #Testataan koodilohkojen listausta, näyttää toimivan mutta vaatii vielä säätämistä. #Ohje löytyi [Yihui Xienin blogista](https://yihui.name/en/2018/09/code-appendix/) #(luettu 26.10.2018). "],["lähteet.html", "Lähteet", " Lähteet "]]
