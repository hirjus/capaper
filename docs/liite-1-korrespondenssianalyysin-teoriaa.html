<!DOCTYPE html>
<html lang="fi" xml:lang="fi">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Liite 1: Korrespondenssianalyysin teoriaa | Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä</title>
  <meta name="description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Liite 1: Korrespondenssianalyysin teoriaa | Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä." />
  <meta name="github-repo" content="hirjus/capaper" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Liite 1: Korrespondenssianalyysin teoriaa | Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä" />
  
  <meta name="twitter:description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä." />
  

<meta name="author" content="Jussi Hirvonen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lähteet.html"/>
<link rel="next" href="liite-2-tekninen-ympäristö-ja-bookdown-paketti.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Alkutoimia</a></li>
<li class="chapter" data-level="1" data-path="johdanto.html"><a href="johdanto.html"><i class="fa fa-check"></i><b>1</b> Johdanto</a><ul>
<li class="chapter" data-level="1.1" data-path="johdanto.html"><a href="johdanto.html#tutkielman-tavoite-ja-toteutus"><i class="fa fa-check"></i><b>1.1</b> Tutkielman tavoite ja toteutus</a></li>
<li class="chapter" data-level="1.2" data-path="johdanto.html"><a href="johdanto.html#korrespondenssianalyysin-historiaa"><i class="fa fa-check"></i><b>1.2</b> Korrespondenssianalyysin historiaa</a></li>
<li class="chapter" data-level="1.3" data-path="johdanto.html"><a href="johdanto.html#tutkielman-rakenne"><i class="fa fa-check"></i><b>1.3</b> Tutkielman rakenne</a></li>
<li class="chapter" data-level="1.4" data-path="johdanto.html"><a href="johdanto.html#tärkeimmät-lähteet"><i class="fa fa-check"></i><b>1.4</b> Tärkeimmät lähteet</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a><ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#aineiston-rajaaminen"><i class="fa fa-check"></i><b>2.1</b> Aineiston rajaaminen</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html"><i class="fa fa-check"></i><b>3</b> Yksinkertainen korrespondenssianalyysi</a><ul>
<li class="chapter" data-level="3.1" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#äiti-töissä---kärsiikö-lapsi"><i class="fa fa-check"></i><b>3.1</b> Äiti töissä - kärsiikö lapsi?</a></li>
<li class="chapter" data-level="3.2" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#symmetrinen-kartta"><i class="fa fa-check"></i><b>3.2</b> Symmetrinen kartta</a></li>
<li class="chapter" data-level="3.3" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#asymmetrinen-kartta-ja-ideaalipisteet"><i class="fa fa-check"></i><b>3.3</b> Asymmetrinen kartta ja ideaalipisteet</a></li>
<li class="chapter" data-level="3.4" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#kontribuutiot-kartalla"><i class="fa fa-check"></i><b>3.4</b> Kontribuutiot kartalla</a></li>
<li class="chapter" data-level="3.5" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#massat"><i class="fa fa-check"></i><b>3.5</b> Massat</a></li>
<li class="chapter" data-level="3.6" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#karttojen-erot"><i class="fa fa-check"></i><b>3.6</b> Karttojen erot</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html"><i class="fa fa-check"></i><b>4</b> Täydentävät pisteet</a><ul>
<li class="chapter" data-level="4.1" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#saksan-ja-belgian-alueet"><i class="fa fa-check"></i><b>4.1</b> Saksan ja Belgian alueet</a></li>
<li class="chapter" data-level="4.2" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#korrespondenssianalyysin-numeeriset-tulokset"><i class="fa fa-check"></i><b>4.2</b> Korrespondenssianalyysin numeeriset tulokset</a></li>
<li class="chapter" data-level="4.3" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#esimerkki-kolmiulotteisesta-kartasta"><i class="fa fa-check"></i><b>4.3</b> Esimerkki kolmiulotteisesta kartasta</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="yhteisvaikutusmuuttujat.html"><a href="yhteisvaikutusmuuttujat.html"><i class="fa fa-check"></i><b>5</b> Yhteisvaikutusmuuttujat</a><ul>
<li class="chapter" data-level="5.1" data-path="yhteisvaikutusmuuttujat.html"><a href="yhteisvaikutusmuuttujat.html#ikä-ja-sukupuoli"><i class="fa fa-check"></i><b>5.1</b> Ikä ja sukupuoli</a></li>
<li class="chapter" data-level="5.2" data-path="yhteisvaikutusmuuttujat.html"><a href="yhteisvaikutusmuuttujat.html#ikä-sukupuoli-ja-maa"><i class="fa fa-check"></i><b>5.2</b> Ikä, sukupuoli ja maa</a></li>
<li class="chapter" data-level="5.3" data-path="yhteisvaikutusmuuttujat.html"><a href="yhteisvaikutusmuuttujat.html#stabiilisuus"><i class="fa fa-check"></i><b>5.3</b> Stabiilisuus</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="osajoukon-korrespondenssianalyysi.html"><a href="osajoukon-korrespondenssianalyysi.html"><i class="fa fa-check"></i><b>6</b> Osajoukon korrespondenssianalyysi</a></li>
<li class="chapter" data-level="7" data-path="monimuuttuja-korrespondenssianalyysi-mca.html"><a href="monimuuttuja-korrespondenssianalyysi-mca.html"><i class="fa fa-check"></i><b>7</b> Monimuuttuja-korrespondenssianalyysi (MCA)</a><ul>
<li class="chapter" data-level="7.1" data-path="monimuuttuja-korrespondenssianalyysi-mca.html"><a href="monimuuttuja-korrespondenssianalyysi-mca.html#pinotut-ja-yhdistetyt-taulukot"><i class="fa fa-check"></i><b>7.1</b> Pinotut ja yhdistetyt taulukot</a></li>
<li class="chapter" data-level="7.2" data-path="monimuuttuja-korrespondenssianalyysi-mca.html"><a href="monimuuttuja-korrespondenssianalyysi-mca.html#mca---monimuuttujakorrespondenssianalyysi"><i class="fa fa-check"></i><b>7.2</b> MCA - monimuuttujakorrespondenssianalyysi</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="yhteenveto.html"><a href="yhteenveto.html"><i class="fa fa-check"></i><b>8</b> Yhteenveto</a></li>
<li class="chapter" data-level="" data-path="lähteet.html"><a href="lähteet.html"><i class="fa fa-check"></i>Lähteet</a></li>
<li class="appendix"><span><b>Liitteet</b></span></li>
<li class="chapter" data-level="" data-path="liite-1-korrespondenssianalyysin-teoriaa.html"><a href="liite-1-korrespondenssianalyysin-teoriaa.html"><i class="fa fa-check"></i>Liite 1: Korrespondenssianalyysin teoriaa</a><ul>
<li class="chapter" data-level="" data-path="liite-1-korrespondenssianalyysin-teoriaa.html"><a href="liite-1-korrespondenssianalyysin-teoriaa.html#korrespondenssianalyysin-perusyhtälöt-ja-kaavat"><i class="fa fa-check"></i>Korrespondenssianalyysin perusyhtälöt ja kaavat</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="liite-2-tekninen-ympäristö-ja-bookdown-paketti.html"><a href="liite-2-tekninen-ympäristö-ja-bookdown-paketti.html"><i class="fa fa-check"></i>Liite 2: Tekninen ympäristö ja Bookdown-paketti</a></li>
<li class="chapter" data-level="" data-path="liite-3-r-koodi.html"><a href="liite-3-r-koodi.html"><i class="fa fa-check"></i>Liite 3: R - koodi</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="liite-1-korrespondenssianalyysin-teoriaa" class="section level1 unnumbered">
<h1>Liite 1: Korrespondenssianalyysin teoriaa</h1>
<div id="korrespondenssianalyysin-perusyhtälöt-ja-kaavat" class="section level2 unnumbered">
<h2>Korrespondenssianalyysin perusyhtälöt ja kaavat</h2>
<p>Perusyhtälöt on esitetty teoksen “Correspondece Analysis in Practice”<span class="citation">(M. J. Greenacre <a href="lähteet.html#ref-RefWorks:doc:5a857a43e4b0ed2d44664d78" role="doc-biblioref">2017</a>)</span>
liitteen “Theory of Correspondece Analysis” mukaisesti.</p>
<p>Datamatriisilla <span class="math inline">\(\boldsymbol{N}\)</span> on <span class="math inline">\(I\)</span> riviä ja <span class="math inline">\(J\)</span> sarakketta (<span class="math inline">\(I x J\)</span> ).
Alkiot ovat ei-negatiivisia (eli nollat sallittuja) ja samassa mitta-asteikossa.
Jos mitta-asteikko on intervalli- tai suhdeasteikko, mittayksiköiden on oltava
samoja (esim. euroja, metrejä). Tietyin ehdoin myös negatiiviset luvut ovat
sallittuja <span class="citation">(LeRoux ja Rouanet <a href="lähteet.html#ref-RefWorks:doc:5a857a43e4b0ed2d44664d75" role="doc-biblioref">2004</a>, 60)</span>.</p>
<p>Taulukon alkioiden summa on
<span class="math inline">\(\sum_{i} \sum_{j}n_{ij} = n\)</span>, missä <span class="math inline">\(i = 1, \dots , I\)</span> ja <span class="math inline">\(j = 1, \dots , J\)</span>.</p>
<p>Korrespondenssimatriisi <span class="math inline">\(\boldsymbol{P}\)</span> saadaan jakamalla matriisin
<span class="math inline">\(\boldsymbol{N}\)</span> alkiot niiden summalla <span class="math inline">\(n\)</span> .</p>
<p>Merkitään matriisin <span class="math inline">\(\boldsymbol{P}\)</span> rivisummien vektoria
<span class="math inline">\(\boldsymbol{r}\)</span> (= <span class="math inline">\((r_{1}, \dots, r_{I})\)</span>) ja sarakesummien vektoria
<span class="math inline">\(\boldsymbol{c}\)</span> (= <span class="math inline">\((c_{1}, \dots, c_{J})\)</span>).
Niitä vastaavat diagonaalimatriisit ovat <span class="math inline">\(\boldsymbol{D_r}\)</span> ja
<span class="math inline">\(\boldsymbol{D_c}\)</span>.</p>
<p>Matriisin transpoosi merkitään yläindeksillä <span class="math inline">\(T\)</span> , ja <span class="math inline">\(\boldsymbol{1}\)</span> on
sopivan dimension vektori jonka alkiot ovat ykkösiä.</p>
<p>Korrespondenssianalyysin ratkaistaan singluaariarvohajoitelman avulla.</p>
<p>Singulaariarvohajoitelma (singular value decomposition) tuottaa ratkaisun kun
sitä sovelletaan standardoituun residuaalimatriisiin <span class="math inline">\(\boldsymbol{S}\)</span>.</p>
<p><span class="math display" id="eq:svd1">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{D_r}^{-1/2}(\boldsymbol{P} - \boldsymbol{r}\boldsymbol{c}^T)\boldsymbol{D_c}^{-1/2} .
\tag{8.1}
\end{equation}\]</span></p>
<p>Residuaalimatriisi voidaan esittää myös ns. kontingenssi-suhdelukujen
(contingency ratio) avulla kahdella tavalla.</p>
<p><span class="math display" id="eq:contrat1">\[\begin{equation}
\boldsymbol{D_r}^{-1} \boldsymbol{P} \boldsymbol{D_c}^{-1} = \left( \frac{p_{ij}} {r_{i} c{j}} \right) ,
\tag{8.2}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:contrat2">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{D_r}^{1/2} (\boldsymbol{D_r}^{-1} \boldsymbol{P} \boldsymbol{D_c}^{-1} - \boldsymbol{1}\boldsymbol{1}^{T} ) \boldsymbol{D_c}^{-1/2}  \;\;\; .
\tag{8.3}
\end{equation}\]</span></p>
<p>Toinen esitystapa on hyödyllinen, kun tarkastellaan CA:n yhteyksiä muihin
läheisiin menetelmiin. Näitä ovat esimerkiksi “suhteellisten osuuksien datan”
analyysi (log ratio analysis of compositiona data),moniulotteinen skaalaus,
lineaarinen diskriminanttianalyysi, kanoninen korrelaatioanalyysi,
pääkomponettianalyysi, kaksoiskuvat ja muut SVD-hajoitelmaan perustuvat dimensioden
vähentämisen menetelmät.</p>
<p>Samat kaavat voi esittää myös alkiomuodossa:</p>
<p><span class="math display" id="eq:contrat11">\[\begin{equation}
s_{ij} = \frac{p_{ij}-r_{i}c_{j}} { \sqrt{r_{i}c_{j} } } ,
\tag{8.4}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:contrat21">\[\begin{equation}
s_{ij} = \sqrt{r_{i}} \left( \frac{p_{ij}}{r_{i}c_{j}} \right) \sqrt{c_{j}} \;\;\; .
\tag{8.5}
\end{equation}\]</span></p>
<p>Alkimuodosasa esitetyistä kaavoista näkee rivi- ja sarakeratkaisujen sidoksen.
Ratkaisujen duaalisuus on teoreettinen tulos, jonka voi perustella täsmällisesti
algebrallisen geometrian avulla. Käytännössä rivi- ja sarekeongelman duaalisuus
tarkoittaa sitä, että vain toinen ongelma on ratkaistava.</p>
<p>Singulaariarvohajoitelma (singular value decomposition, SVD) matriisille <span class="math inline">\(\boldsymbol{S}\)</span> on</p>
<p><span class="math display" id="eq:svd2">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{U} \boldsymbol{D_{\alpha}} \boldsymbol{V}^{T} ,
\tag{8.6}
\end{equation}\]</span></p>
<p>missä <span class="math inline">\(\boldsymbol{D_{\alpha}}\)</span> on diagonaalimatriisi, jonka alkiot ovat
singulaariarvot suuruusjärjestyksessä <span class="math inline">\(\alpha_{1}\geq \alpha_{1} \geq \cdots\)</span>.</p>
<p>Matriisit <span class="math inline">\(\boldsymbol{U}\)</span> ja <span class="math inline">\(\boldsymbol{V}\)</span> ovat ortogonaalisia
singulaarivektoreiden matriiseja. Singulaariarvohajoitelman merkitys dimensioiden
vähentämiselle perustuu Eckart - Young - teoreemaan. Teoreema kertoo
että saamme pienimmän neliösumman <span class="math inline">\(m\)</span> - ulotteisen approksimaation matriisille
<span class="math inline">\(\boldsymbol{S}\)</span> matriisien <span class="math inline">\(\boldsymbol{U}\)</span> ja <span class="math inline">\(\boldsymbol{V}\)</span>
ensimmäisten sarakkeiden ja ensimmäisten singulaariarvojen avulla.</p>
<p><span class="math display" id="eq:svd3">\[\begin{equation}
\boldsymbol{S}_{(m)} = \boldsymbol{U}_{(m)} \boldsymbol{D}_{\alpha(m)} \boldsymbol{V}_{(m)}^{T}
\tag{8.7}
\end{equation}\]</span></p>
<p>Korrrespondenssianalyysin ratkaisualgoritmissa tätä tulosta on muokattava niin,
että rivien ja sarakkeiden massat huomioidaan pienimmän neliösumman
approksimaatiossa painoina.</p>
<p>Näin saadaan standardikoordinaatit ja pääkoordinaatit riveille ja
sarakkeille.</p>
<p>Rivien standardikoordinaatit</p>
<p><span class="math display" id="eq:rivistd1">\[\begin{equation}
\boldsymbol{\Phi} = \boldsymbol{D_r}^{-\frac{1}{2}} \boldsymbol{U}
\tag{8.8}
\end{equation}\]</span></p>
<p>Sarakkeiden standardikoordinaatit</p>
<p><span class="math display" id="eq:sarakestd1">\[\begin{equation}
 \boldsymbol{\Gamma} = \boldsymbol{D_c}^{-\frac{1}{2}} \boldsymbol{V}
 \tag{8.9}
\end{equation}\]</span></p>
<p>Rivien pääkoordinaatit</p>
<p><span class="math display" id="eq:riviprinc1">\[\begin{equation}
 \boldsymbol{F} =   \boldsymbol{D_r}^{-\frac{1}{2}} \boldsymbol{U}  \boldsymbol{D_{\alpha}} = \boldsymbol{\Phi} \boldsymbol{D_{\alpha}}
\tag{8.10}
\end{equation}\]</span></p>
<p>Sarakkeiden pääkoordinaatit
<span class="math display" id="eq:sarakeprinc1">\[\begin{equation}
 \boldsymbol{G}  = \boldsymbol{D_c}^{-\frac{1}{2}} \boldsymbol{V} \boldsymbol{D_{\alpha}} = \boldsymbol{\Gamma}  \boldsymbol{D_{\alpha}}
 \tag{8.11}
\end{equation}\]</span></p>
<p>Pääakseleiden inertiat (principal inertias) <span class="math inline">\(\lambda_{k}\)</span></p>
<p><span class="math display">\[\begin{equation}
\lambda_{k} = \alpha_{k}^2, \: k = 1,\dots,K,
K = min \{ I-1, J-1 \}
\end{equation}\]</span></p>
<p>Ratkaisun dimenisio on myös maksimi-inertia. Tässä aineistossa ja vastaavissa
kyselytutkimusdatoissa inertia on yleensä paljon maksimia pienempi. Asymmetrisissä
kartoissa ideaalipisteet ovat kaukana origon lähelle pakkauteesta havaintojen
pilvestä.</p>
<p>Korespondenssianalyysi ratkaisun akseleiden inertioita kutsutaan usein ominaisarvoiksi,
mutta periaatteessa SVD-ratkaisulla saadaan singulaariarvot. Niiden neliöt ovat
akseleiden inertioita. Ominaisarvojen ja sigulaariarvojen yhteys on läheinen ja
riippuu diagonalisoitavan matriisin ominaisuuksista. Termiä “vektori” käytetään
kartoista puhuttaessa, kun viitataan esimerkiksi origosta sarakepisteeseen
piirrettyyn nuoleen. Myös janan synonyyminä käytetään yleisesti termiä vektori
(kts. esim. <span class="citation">(M. Greenacre <a href="lähteet.html#ref-RefWorks:doc:5b45eab2e4b0fb23161a7ff3" role="doc-biblioref">2013</a>)</span>).</p>
<p>Korrespondenssimatriisi <span class="math inline">\(\boldsymbol{P}\)</span> voidaan esittää matriisi- ja
alkiomuodossa ns. palautuskaavana (reconstitution formula).</p>
<p><span class="math display" id="eq:reconstform1">\[\begin{equation}
\boldsymbol{P} = \boldsymbol{D}_{r} \left( \boldsymbol{1}\boldsymbol{1}^{T} + \boldsymbol{\Phi}\boldsymbol{D}_{\lambda}^{\frac {1}{2}}\boldsymbol{\Gamma}^{T}\right)\boldsymbol{D}_{c}
\tag{8.12}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:reconstform2">\[\begin{equation}
p_ {ij}= r_{i}c_{j} \left(1 + \sum_{k=1}^{K} \sqrt{\lambda_{k}} \phi_{ik} \gamma_{jk} \right)
\tag{8.13}
\end{equation}\]</span></p>
<p>Rivien ja sarakkeiden riippuvuutta kuvaavat transitioyhtälöt (transition equations).</p>
<p>Pääkoordinaatit standardikoordinaattien funktiona (barysentrinen ominaisuus,
barycentric relationships):</p>
<p><span class="math display" id="eq:barysentr1">\[\begin{equation}
\boldsymbol{F} = \boldsymbol{D}_{r}^{-1} \boldsymbol{P}\boldsymbol{\Gamma}
\tag{8.14}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:barysentr2">\[\begin{equation}
\boldsymbol{G} = \boldsymbol{D}_{c}^{-1} \boldsymbol{P}^{T}\boldsymbol{\Phi}
\tag{8.15}
\end{equation}\]</span></p>
<p>Pääkoordinaatit pääkoordinaattien funktiona:</p>
<p><span class="math display" id="eq:barysentr3">\[\begin{equation}
\boldsymbol{F} = \boldsymbol{D}_{r}^{-1} \boldsymbol{P}\boldsymbol{G}\boldsymbol{D}_{\lambda}^{-\frac{1}{2}}
\tag{8.16}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:barysentr4">\[\begin{equation}
\boldsymbol{G} = \boldsymbol{D}_{c}^{-1} \boldsymbol{P}^{T}\boldsymbol{F}\boldsymbol{D}_{\lambda}^{-\frac{1}{2}}
\tag{8.17}
\end{equation}\]</span></p>
<p>Yhtälöt <a href="liite-1-korrespondenssianalyysin-teoriaa.html#eq:barysentr1">(8.14)</a> ja <a href="liite-1-korrespondenssianalyysin-teoriaa.html#eq:barysentr1">(8.14)</a> esittävät profiilipisteet ideaalipisteiden (vertex points)
painotettuina keskiarvoina, painoina profiilin elementit. Asymmetriset kartat
(rivien tai sarakkeiden suhteen) perustuvat näihin yhtälöihin. Yhtälöiden <a href="liite-1-korrespondenssianalyysin-teoriaa.html#eq:barysentr3">(8.16)</a>
ja <a href="liite-1-korrespondenssianalyysin-teoriaa.html#eq:barysentr4">(8.17)</a> kahdet pääkoordinaatit ovat perusta symmetrisille kartoille. Myös niitä
yhdistää barysentrinen painotetun keskiarvon riippuvuus, mutta mukana ovat skaalaustekijät
<span class="math inline">\(\frac{1}{\sqrt{\lambda_{i}}}\)</span>.</p>
<p><strong>Pisteet ja projektio aliavaruuteen</strong></p>
<p>Kuva on kurssimateriaaleista<span class="citation">(M. Greenacre <a href="lähteet.html#ref-RefWorks:doc:5b6ef091e4b0984fd9b8c0ca" role="doc-biblioref">2017</a>)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:projectionimg1"></span>
<img src="img/CAquality.png" alt="Pisteen projektio aliavaruuteen" width="70%" />
<p class="caption">
Kuva 8.1: Pisteen projektio aliavaruuteen
</p>
</div>
<p>Kuvassa on esitetty korrespondenssianalyysin ratkaisun minimointiongelma. Pisteen
projektio on sitä parempi mitä pienempi kulma on sentroidista pisteeseen
piirtetyn janan ja pisteen projektion välillä. COR - tunnusluku ca-funktion
numeerisissa tuloksissa tämän kulman kosinin neliö. Pisteen kuvauksen laatu (qlt)
ca-tuloksissa on valitun approsimaation akseleiden kvaliteettien (COR) summa.</p>
<p>Kuvasta voi myös hahmottaa sen periaatteen, että projektiossa kaukana olevat
pisteet ovat kaukana myös alkuperäisessä avaruudessa. Projektiossa lähekkäin
olevat pisteet voivat olla alkuperäisessä avaruudessa kaukana toisistaan,
jos niiden projektion laatu on huono.</p>
<p><strong>Monimuuttujakorrespondenssianalyysi MCA</strong></p>
<p>Usean muuttujan korrespondenssianalyysissä tutkitaan usean muuttujan välisiä yhteyksiä.
Kartan tulkinnan apuna siihen voidaan lisätä havaintojen sijaan niiden keskiarvopisteitä
ja niille simuloituja luottamusellipsejä. Kuvien pääongelma on liian suuri määärä pisteitä,
ja analyysin lopputulos on usein mahdollisimman yksinkertainen kartta.</p>
<p>Usean muuttujan analyysissä kohteena on joko indikaattorimatriisi <span class="math inline">\(\boldsymbol{Z}\)</span> tai
Burtin matriisi <span class="math inline">\(\boldsymbol{B}\)</span></p>
<p>Indikaattorimatriisissa rivit ovat havaintoja ja sarakkeet luokittelumuuttujan arvoja.
Havaintoa vastaa rivi nollia ja 1 valitun vastausvaihtoehdon kohdalla. Tästä seuraa,
että vain erilaiset vastaukset määrittävät rivien etäisyyksiä.</p>
<p>Burtin matriisi on erikoistapaus yhdistetyistä matriiseista. Siihen on koottu kaikki tutkittavien
muuttujien pareittan muodostetut taulukot. Diagonaalilla ovat muuttujien ristiintaulukoinnit
itsensä kanssa. Ratkaisu riippuu vain näistä parittaisista taulukoista. Burtin matriisi on
kätevä välivaihe matriisien yhdistelyssä.</p>
<p>Molemmat matriisit paisuttavat keinotekoisesti kokonaisinertiaa, ja esimerkikisi kaksiulotteisen kartan
selitetyn inertian osuudet jäävät melko pieniksi. Ratkaisuna on inertian oikaisu tai korjaus
(adjusted inertia), jossa mm. poistetaan kokonaisinertialaskelmista Burtin matriisin
diagonaalilla olevat alimatriisit. Näillä korjauksilla ei ole vaikutusta kartan pisteiden
sijaintiin. Tämä menetelmä on ca-paketin mjca-funktion oletus.</p>
<p>Kolmas vaihtoehto on ns. yhdistetty korrespondenssianalyysi (joint ca).</p>
<p>Greenacre on kirjoittanut useissa yhteyksissä MCA:n geometrisen tulkinnan ongelmista.
<span class="citation">Greenacre ja Hastie (<a href="lähteet.html#ref-RefWorks:doc:5a857a44e4b0ed2d44664d84" role="doc-biblioref">1987</a>)</span> (s. 447) sanovat asian näin:“Finally, although
we have motivated simple correspondence analysis from the geometric point of view,
the geometry of the indicator matrix in multiple correspondence analysis is
admittedly not convincing. Distances between the row profiles of an indicator
matrix and projections of articficial column vertices have less intuitive appeal.
However, the scaling interpretation remains attractive in this case; the displays
are graphical representations of optimal scale values for the categories.”</p>
<p>Greenacre jatkaa samasta aiheesta artikkelikokoelmassa
<span class="citation">(M. Greenacre ja Blasius <a href="lähteet.html#ref-RefWorks:doc:5ab76b43e4b003f4468d1f07" role="doc-biblioref">2006</a> , s. 41, s. 61)</span>: “Yleistys useammalle
kuin kahdelle muuttujalle ei ole ilmeinen eikä hyvin määritelty”. Siti MCA
onnistuu esittämään hyvin kiinnostavia yhteyksiä muuttujien välillä (“succesfully
recovers interesting patterns of association”). Kriittisyys ei kuitenkaan
estä häntä soveltamasta MCA-analyysiä. Tulkitsen tämän niin, että menetelmää voi
aivan hyvin soveltaa, mutta geometrista tulkintaa ei voi suoraan siirtää CA-kartoista
MCA.karttoihin. Greenacre esittelee perusteellisesti MCA-sovelluksia kaksoiskuvia
käsittelevässä kirjassaan <span class="citation">(Greenacre <a href="lähteet.html#ref-RefWorks:doc:5a857a43e4b0ed2d44664d7c" role="doc-biblioref">2010</a>)</span>. Ehkä
korrespondenssianalyysin matemaattinen teoria ei ole vielä täysin valmis?</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="lähteet.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="liite-2-tekninen-ympäristö-ja-bookdown-paketti.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["JH_capaper.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
