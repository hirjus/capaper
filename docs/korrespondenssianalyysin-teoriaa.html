<!DOCTYPE html>
<html lang="fi" xml:lang="fi">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A Korrespondenssianalyysin teoriaa | Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä</title>
  <meta name="description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="A Korrespondenssianalyysin teoriaa | Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä." />
  <meta name="github-repo" content="hirjus/capaper" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Korrespondenssianalyysin teoriaa | Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä" />
  
  <meta name="twitter:description" content="Tutkielma korrespondenssianalyysistä graafisena data-analyysin menetelmänä." />
  

<meta name="author" content="Jussi Hirvonen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="yhteenveto.html"/>
<link rel="next" href="suomenkielinen-lomake-esimerkki.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Alkutoimia</a></li>
<li class="chapter" data-level="1" data-path="johdanto.html"><a href="johdanto.html"><i class="fa fa-check"></i><b>1</b> Johdanto</a><ul>
<li class="chapter" data-level="1.1" data-path="johdanto.html"><a href="johdanto.html#tutkielman-tavoite"><i class="fa fa-check"></i><b>1.1</b> Tutkielman tavoite</a></li>
<li class="chapter" data-level="1.2" data-path="johdanto.html"><a href="johdanto.html#tärkeimmät-lähteet-ja-ohjelmistot"><i class="fa fa-check"></i><b>1.2</b> Tärkeimmät lähteet ja ohjelmistot</a><ul>
<li class="chapter" data-level="1.2.1" data-path="johdanto.html"><a href="johdanto.html#lähteet"><i class="fa fa-check"></i><b>1.2.1</b> Lähteet</a></li>
<li class="chapter" data-level="1.2.2" data-path="johdanto.html"><a href="johdanto.html#käytetyt-ohjelmistot"><i class="fa fa-check"></i><b>1.2.2</b> Käytetyt ohjelmistot</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="johdanto.html"><a href="johdanto.html#korrespondenssianalyysin-historiaa"><i class="fa fa-check"></i><b>1.3</b> Korrespondenssianalyysin historiaa</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a><ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#data-kuka-mitä-missä-ja-milloin"><i class="fa fa-check"></i><b>2.1</b> Data: kuka, mitä, missä ja milloin</a></li>
<li class="chapter" data-level="2.2" data-path="data.html"><a href="data.html#aineiston-rajaaminen-maat-ja-muuttujat"><i class="fa fa-check"></i><b>2.2</b> Aineiston rajaaminen maat ja muuttujat</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html"><i class="fa fa-check"></i><b>3</b> Yksinkertainen korrespondenssianalyysi</a><ul>
<li class="chapter" data-level="3.1" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#äiti-töissä--kärsiikö-lapsi"><i class="fa fa-check"></i><b>3.1</b> Äiti töissä -kärsiikö lapsi?</a></li>
<li class="chapter" data-level="3.2" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#kahden-muuttujan-frekvenssitaulukon-analyysi"><i class="fa fa-check"></i><b>3.2</b> Kahden muuttujan frekvenssitaulukon analyysi</a></li>
<li class="chapter" data-level="3.3" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#ca---esimerkki"><i class="fa fa-check"></i><b>3.3</b> CA - esimerkki</a></li>
<li class="chapter" data-level="3.4" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#korrespondenssianalyysin-peruskäsitteet"><i class="fa fa-check"></i><b>3.4</b> Korrespondenssianalyysin peruskäsitteet</a><ul>
<li class="chapter" data-level="3.4.1" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#asymmetrinen-kartta-ja-ideaalipisteet"><i class="fa fa-check"></i><b>3.4.1</b> Asymmetrinen kartta ja ideaalipisteet</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#kontribuutiot-kartalla"><i class="fa fa-check"></i><b>3.5</b> Kontribuutiot kartalla</a></li>
<li class="chapter" data-level="3.6" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#massat"><i class="fa fa-check"></i><b>3.6</b> Massat</a></li>
<li class="chapter" data-level="3.7" data-path="yksinkertainen-korrespondenssianalyysi.html"><a href="yksinkertainen-korrespondenssianalyysi.html#karttojen-erot"><i class="fa fa-check"></i><b>3.7</b> Karttojen erot</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html"><i class="fa fa-check"></i><b>4</b> Täydentävät pisteet</a><ul>
<li class="chapter" data-level="4.1" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#täydentävät-pisteet-1"><i class="fa fa-check"></i><b>4.1</b> Täydentävät pisteet</a></li>
<li class="chapter" data-level="4.2" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#saksan-ja-belgian-alueet"><i class="fa fa-check"></i><b>4.2</b> Saksan ja Belgian alueet</a><ul>
<li class="chapter" data-level="4.2.1" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#symmetrinen-kartta"><i class="fa fa-check"></i><b>4.2.1</b> Symmetrinen kartta</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#can-numeeriset-tulokset"><i class="fa fa-check"></i><b>4.3</b> CA:n numeeriset tulokset</a></li>
<li class="chapter" data-level="4.4" data-path="täydentävät-pisteet.html"><a href="täydentävät-pisteet.html#esimerkki-3d--kartasta---saksan-ja-belgian-dimensiot"><i class="fa fa-check"></i><b>4.4</b> Esimerkki 3d- kartasta - Saksan ja Belgian dimensiot</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="yhteisvaikutusmuuttujat.html"><a href="yhteisvaikutusmuuttujat.html"><i class="fa fa-check"></i><b>5</b> Yhteisvaikutusmuuttujat</a><ul>
<li class="chapter" data-level="5.1" data-path="yhteisvaikutusmuuttujat.html"><a href="yhteisvaikutusmuuttujat.html#ikä-ja-sukupuoli"><i class="fa fa-check"></i><b>5.1</b> Ikä ja sukupuoli</a></li>
<li class="chapter" data-level="5.2" data-path="yhteisvaikutusmuuttujat.html"><a href="yhteisvaikutusmuuttujat.html#ikä-sukupuoli-ja-maa"><i class="fa fa-check"></i><b>5.2</b> Ikä, sukupuoli ja maa</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="osajoukon-korrespondenssianalyysi.html"><a href="osajoukon-korrespondenssianalyysi.html"><i class="fa fa-check"></i><b>6</b> Osajoukon korrespondenssianalyysi</a></li>
<li class="chapter" data-level="7" data-path="monimuuttuja-korrespondenssianalyysi-mca.html"><a href="monimuuttuja-korrespondenssianalyysi-mca.html"><i class="fa fa-check"></i><b>7</b> Monimuuttuja-korrespondenssianalyysi (MCA)</a><ul>
<li class="chapter" data-level="7.1" data-path="monimuuttuja-korrespondenssianalyysi-mca.html"><a href="monimuuttuja-korrespondenssianalyysi-mca.html#pinotut-ja-yhdistetyt-taulukot-stacked-and-concatenated-tables"><i class="fa fa-check"></i><b>7.1</b> Pinotut ja yhdistetyt taulukot (stacked and concatenated tables)</a></li>
<li class="chapter" data-level="7.2" data-path="monimuuttuja-korrespondenssianalyysi-mca.html"><a href="monimuuttuja-korrespondenssianalyysi-mca.html#matched-matrices"><i class="fa fa-check"></i><b>7.2</b> Matched matrices</a></li>
<li class="chapter" data-level="7.3" data-path="monimuuttuja-korrespondenssianalyysi-mca.html"><a href="monimuuttuja-korrespondenssianalyysi-mca.html#mca---monimuuttujakorrespondenssianalyysi"><i class="fa fa-check"></i><b>7.3</b> MCA - monimuuttujakorrespondenssianalyysi</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="yhteenveto.html"><a href="yhteenveto.html"><i class="fa fa-check"></i><b>8</b> Yhteenveto</a></li>
<li class="appendix"><span><b>Liitteet</b></span></li>
<li class="chapter" data-level="A" data-path="korrespondenssianalyysin-teoriaa.html"><a href="korrespondenssianalyysin-teoriaa.html"><i class="fa fa-check"></i><b>A</b> Korrespondenssianalyysin teoriaa</a><ul>
<li class="chapter" data-level="A.1" data-path="korrespondenssianalyysin-teoriaa.html"><a href="korrespondenssianalyysin-teoriaa.html#korrespondenssianalyysin-perusyhtälöt-ja-kaavat"><i class="fa fa-check"></i><b>A.1</b> Korrespondenssianalyysin perusyhtälöt ja kaavat</a></li>
<li class="chapter" data-level="A.2" data-path="korrespondenssianalyysin-teoriaa.html"><a href="korrespondenssianalyysin-teoriaa.html#matriisit-ja-niiden-havainnollistaminen"><i class="fa fa-check"></i><b>A.2</b> Matriisit ja niiden havainnollistaminen</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="suomenkielinen-lomake-esimerkki.html"><a href="suomenkielinen-lomake-esimerkki.html"><i class="fa fa-check"></i><b>B</b> Suomenkielinen lomake (esimerkki)</a></li>
<li class="chapter" data-level="C" data-path="tekninen-ympäristö-ja-bookdown-paketti.html"><a href="tekninen-ympäristö-ja-bookdown-paketti.html"><i class="fa fa-check"></i><b>C</b> Tekninen ympäristö ja Bookdown-paketti</a></li>
<li class="chapter" data-level="D" data-path="r-koodi.html"><a href="r-koodi.html"><i class="fa fa-check"></i><b>D</b> R - koodi</a></li>
<li class="chapter" data-level="" data-path="lähteet-1.html"><a href="lähteet-1.html"><i class="fa fa-check"></i>Lähteet</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Korrespondenssianalyysi - graafinen ja geometrinen data-analyysin menetelmä</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="korrespondenssianalyysin-teoriaa" class="section level1">
<h1><span class="header-section-number">A</span> Korrespondenssianalyysin teoriaa</h1>
<div id="korrespondenssianalyysin-perusyhtälöt-ja-kaavat" class="section level2">
<h2><span class="header-section-number">A.1</span> Korrespondenssianalyysin perusyhtälöt ja kaavat</h2>
<p>Tässä lähteenä Greenacren kirja<span class="citation">(M. J. Greenacre <a href="lähteet-1.html#ref-RefWorks:doc:5a857a43e4b0ed2d44664d78" role="doc-biblioref">2017</a>)</span> (ca in practice) ja sen liite
“Theory of CA”.</p>
<p><strong>edit</strong> Muistiinpanoja löytyy, joissa viitataan myös Biplots in practice - kirjaan.
Kevään 2017 kurssin luentokalvoja on myös käytetty. Lisäillään vielä käsitteitä
LeRouxin ja Rouanetin kirjasta, jos on tarvis.</p>
<p>Datamatriisilla <span class="math inline">\(\boldsymbol{N}\)</span> on <span class="math inline">\(I\)</span> riviä ja <span class="math inline">\(J\)</span> sarakketta (<span class="math inline">\(I x J\)</span> ).
Alkiot ovat ei-negatiivisia (eli nollat sallittuja) ja samassa mitta-asteikossa.
Jos mitta-asteikko on intervalli- tai suhdeasteikko, mittayksiköiden on oltava
samoja (esim. euroja, metrejä). Taulukon alkioiden summa on
<span class="math inline">\(\sum_{i} \sum_{j}n_{ij} = n\)</span>, missä <span class="math inline">\(i = 1, \dots , I\)</span> ja <span class="math inline">\(j = 1, \dots , J\)</span>.
GDA-kirjassa on tarkennettu tätä vaatimusta ei-negatiivisuudesta.</p>
<p>Korrespondenssimatriisi <span class="math inline">\(\boldsymbol{P}\)</span> saadaan jakamalla matriisin
<span class="math inline">\(\boldsymbol{N}\)</span> alkiot niiden summalla <span class="math inline">\(n\)</span> .</p>
<p>Merkitään matriisin <span class="math inline">\(\boldsymbol{P}\)</span> rivisummien vektoria
<span class="math inline">\(\boldsymbol{r}\)</span> (= <span class="math inline">\((r_{1}, \dots, r_{I})\)</span>) ja sarakesummien vektoria
<span class="math inline">\(\boldsymbol{c}\)</span> (= <span class="math inline">\((c_{1}, \dots, c_{J})\)</span>).
Niitä vastaavat diagonaalimatriisit ovat <span class="math inline">\(\boldsymbol{D_r}\)</span> ja
<span class="math inline">\(\boldsymbol{D_c}\)</span>.</p>
<p>Korrespondenssianalyysin ratkaistaan singluaariarvohajoitelman avulla. Hyvin
yleinen tulos, jostain syystä tilastotieteessä tullu tunnetuksi melko myöhään
(Mustonen 1985).</p>
<p>Singulaariarvohajoitelma (singular value decomposition) tuottaa ratkaisun kun
sitä sovelletaan standardoituun residuaalimatriisiin <span class="math inline">\(\boldsymbol{S}\)</span>.</p>
<p><span class="math display" id="eq:svd1">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{D_r}^{-1/2}(\boldsymbol{P} - \boldsymbol{r}\boldsymbol{c}^T)\boldsymbol{D_c}^{-1/2} \label{A}
\tag{A.1}
\end{equation}\]</span></p>
<p>Residuaalimatriisi voidaan esittää myös ns. kontingenssi-suhdelukujen
(contingency ratio) avulla kahdella tavalla.</p>
<p><span class="math display" id="eq:contrat1">\[\begin{equation}
\boldsymbol{D_r}^{-1} \boldsymbol{P} \boldsymbol{D_c}^{-1} = \left( \frac{p_{ij}} {r_{i} c{j}} \right)
\tag{A.2}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:contrat2">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{D_r}^{1/2} (\boldsymbol{D_r}^{-1} \boldsymbol{P} \boldsymbol{D_c}^{-1} - \boldsymbol{1}\boldsymbol{1}^{T} ) \boldsymbol{D_c}^{-1/2}  \;\;\; .
\tag{A.3}
\end{equation}\]</span></p>
<p>Toinen esitystapa on hyödyllinen, kun tarkastellaan CA:n yhteyksiä muihin
läheisiin menetelmiin (log ratio analysis of compositional data, moniulotteinen
skaalaus (?), lineaarinen diskriminanttianalyysi, kanoninen korrelaatioanalyysi,
pääkomponettianalyysi, kaksoiskuvat, yleensä SVD-hajoitelmaan perustuvat
dimensioden vähentämisen menetelmät).</p>
<p>Samat kaavat alkiomuodossa.</p>
<p><span class="math display" id="eq:contrat11">\[\begin{equation}
s_{ij} = \frac{p_{ij}-r_{i}c_{j}} { \sqrt{r_{i}c_{j} } }
\tag{A.4}
\end{equation}\]</span></p>
<p>ja toinen
<span class="math display" id="eq:contrat21">\[\begin{equation}
s_{ij} = \sqrt{r_{i}} \left( \frac{p_{ij}}{r_{i}c_{j}} \right) \sqrt{c_{j}} \;\;\; .
\tag{A.5}
\end{equation}\]</span></p>
<p>Mitäköhän tuosta pitäisi nähdä? Selitykset löytyvät em. teorialiitteestä.</p>
<p>Singulaariarvohajoitelma (singular value decomposition, SVD) matriisille <span class="math inline">\(\boldsymbol{S}\)</span> on</p>
<p><span class="math display" id="eq:svd2">\[\begin{equation}
\boldsymbol{S} = \boldsymbol{U} \boldsymbol{D_{\alpha}} \boldsymbol{V}^{T}
\tag{A.6}
\end{equation}\]</span></p>
<p>missä <span class="math inline">\(\boldsymbol{D_{\alpha}}\)</span> on diagonaalimatriisi, jonka alkiot ovat
singulaariarvot suuruusjärjestyksessä <span class="math inline">\(\alpha_{1}\geq \alpha_{1} \geq \cdots\)</span>.</p>
<p>Matriisit <span class="math inline">\(\boldsymbol{U}\)</span> ja <span class="math inline">\(\boldsymbol{V}\)</span> ovat ortogonaalisia
singulaarivektoreiden matriiseja. Singulaariarvohajoitelman merkitys dimensioiden
vähentämiselle perustuu Eckart - Young - teoreemaan. Teoreema kertoo
että saamme pienimmän neliösumman <span class="math inline">\(m\)</span> - ulotteisen approksimaation matriisille
<span class="math inline">\(\boldsymbol{S}\)</span> (CAinP, ss. 244) matriisien <span class="math inline">\(\boldsymbol{U}\)</span> ja <span class="math inline">\(\boldsymbol{V}\)</span>
ensimmäisten sarakkeiden ja ensimmäisten singulaariarvojen avulla.</p>
<p><span class="math display" id="eq:svd3">\[\begin{equation}
\boldsymbol{S}_{(m)} = \boldsymbol{U}_{(m)} \boldsymbol{D}_{\alpha(m)} \boldsymbol{V}_{(m)}^{T}
\tag{A.7}
\end{equation}\]</span></p>
<p>Korrrespondenssianalyysin ratkaisualgoritmissa tätä tulosta on muokattava niin,
että rivien ja sarakkeiden massat huomioidaan pienimmän neliösumman
approksimaatiossa painoina.</p>
<p>Näin saadaan standardikoordinaatit ja principal-koordinaatit riveille ja
sarakkeille.</p>
<p>Rivien standardikoordinaatit</p>
<p><span class="math display" id="eq:rivistd1">\[\begin{equation}
\boldsymbol{\Phi} = \boldsymbol{D_r}^{-\frac{1}{2}} \boldsymbol{U} \label{B}
\tag{A.8}
\end{equation}\]</span></p>
<p>Sarakkeiden standardikoordinaatit</p>
<p><span class="math display" id="eq:sarakestd1">\[\begin{equation}
 \boldsymbol{\Gamma} = \boldsymbol{D_c}^{-\frac{1}{2}} \boldsymbol{V} \label{C}
 \tag{A.9}
\end{equation}\]</span></p>
<p>Rivien pääkoordinaatit</p>
<p><span class="math display" id="eq:riviprinc1">\[\begin{equation}
 \boldsymbol{F} =   \boldsymbol{D_r}^{-\frac{1}{2}} \boldsymbol{U}  \boldsymbol{D_{\alpha}} = \boldsymbol{\Phi} \boldsymbol{D_{\alpha}} \label{D}
\tag{A.10}
\end{equation}\]</span></p>
<p>Sarakkeiden pääkoordinaatit
<span class="math display" id="eq:sarakeprinc1">\[\begin{equation}
 \boldsymbol{G}  = \boldsymbol{D_c}^{-\frac{1}{2}} \boldsymbol{V} \boldsymbol{D_{\alpha}} = \boldsymbol{\Gamma}  \boldsymbol{D_{\alpha}} \label{E}
 \tag{A.11}
\end{equation}\]</span></p>
<p>Pääakseleiden inertiat (principal inertias) <span class="math inline">\(\lambda_{k}\)</span></p>
<p><span class="math display">\[\begin{equation}
\lambda_{k} = \alpha_{k}^2, k = 1,\dots,K,
K = min \{ I-1, J-1 \}
\end{equation}\]</span></p>
<p><strong>edit 1</strong> CA:ssa ratkaisun akseleiden inertiaa kutsutaan usein ominaisarvoksi,
mutta periaatteessa SVD-ratkaisulla saadaan singulaariarvot, ja niiden neliöt ovat
akseleiden inertioita. Ominaisarvojen ja sigulaariarvojen yhteys on läheinen ja
riippuu diagonalisoitavan matriisin ominaisuuksista.</p>
<p><strong>edit 1</strong> ratkaisun dimenisio, maksimi-inertia.</p>
<p>Bilineaarinen korresepondenssimalli</p>
<p>Korrespondenssimatriisi <span class="math inline">\(\boldsymbol{P}\)</span> voidaan esittää matriisi- ja
alkiomuodossa ns. palautuskaavana (reconstitution formula).</p>
<p><span class="math display" id="eq:reconstform1">\[\begin{equation}
\boldsymbol{P} = \boldsymbol{D}_{r} \left( \boldsymbol{1}\boldsymbol{1}^{T} + \boldsymbol{\Phi}\boldsymbol{D}_{\lambda}^{\frac {1}{2}}\boldsymbol{\Gamma}^{T}\right)\boldsymbol{D}_{c}
\tag{A.12}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:reconstform2">\[\begin{equation}
p_ {ij}= r_{i}c_{j} \left(1 + \sum_{k=1}^{K} \sqrt{\lambda_{k}} \phi_{ik} \gamma_{jk} \right)
\tag{A.13}
\end{equation}\]</span></p>
<p>Tässä viitataan s. 101 (13.4), 109 (14.9), ja 109-110 (14.10 ja 14.11).
Palautuskavoilla on monta esitystapaa bilineaarisessa mallissa.</p>
<p>Rivien ja sarakkeiden riippuvuus ja transitioyhtälöt. ss. 244, 108-109 skalaariversiot.</p>
<p>Pääkoordinaatit standardikoordinaattien funktiona
(ns. barysentrinen ominaisuus - barycentric relationships)</p>
<p><span class="math display" id="eq:barysentr1">\[\begin{equation}
\boldsymbol{F} = \boldsymbol{D}_{r}^{-1} \boldsymbol{P}\boldsymbol{\Gamma}
\tag{A.14}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:barysentr2">\[\begin{equation}
\boldsymbol{G} = \boldsymbol{D}_{c}^{-1} \boldsymbol{P}^{T}\boldsymbol{\Phi}
\tag{A.15}
\end{equation}\]</span></p>
<p>Pääkoordinaatit pääkoordinaattien funktiointa:</p>
<p><span class="math display" id="eq:barysentr3">\[\begin{equation}
\boldsymbol{F} = \boldsymbol{D}_{r}^{-1} \boldsymbol{P}\boldsymbol{G}\boldsymbol{D}_{\lambda}^{-\frac{1}{2}}
\tag{A.16}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:barysentr4">\[\begin{equation}
\boldsymbol{G} = \boldsymbol{D}_{c}^{-1} \boldsymbol{P}^{T}\boldsymbol{F}\boldsymbol{D}_{\lambda}^{-\frac{1}{2}}
\tag{A.17}
\end{equation}\]</span></p>
<p>Yhtälöt <a href="korrespondenssianalyysin-teoriaa.html#eq:barysentr1">(A.14)</a> ja <a href="korrespondenssianalyysin-teoriaa.html#eq:barysentr1">(A.14)</a> esittävät profiilipisteet ideaalipisteiden (vertex points)
painotettuina keskiarvoina, painoina profiilin elementit. Asymmetriset kartat
(rivien tai sarakkeiden suhteen) perustuvat näihin yhtälöihin. Yhtälöiden <a href="korrespondenssianalyysin-teoriaa.html#eq:barysentr3">(A.16)</a>
ja <a href="korrespondenssianalyysin-teoriaa.html#eq:barysentr4">(A.17)</a> kahdet pääkoordinaatit ovat perusta symmetrisille kartoille. Myös niitä
yhdistää barisentrinen painotetun keskiarvon riippuvuus, mutta mukana ovat skaalaustekijät
<span class="math inline">\(\frac{1}{\sqrt{\lambda_{i}}}\)</span>. Skaalaustekijä on jokaisessa dimensiossa sen inertia, suurimmasta pienimpään.</p>
<p>Kokeillaan vielä kaavaviitteitä: kaavojen <a href="yksinkertainen-korrespondenssianalyysi.html#eq:khii21">(3.1)</a> ja <a href="yksinkertainen-korrespondenssianalyysi.html#eq:khii22">(3.2)</a>
yhteyden pitäisi olla selkeä.</p>
<p><strong>Pisteet ja projektio aliavaruuteen</strong></p>
<p>Kuva MG:n kurssimateriaaleista<span class="citation">(M. Greenacre <a href="lähteet-1.html#ref-RefWorks:doc:5b6ef091e4b0984fd9b8c0ca" role="doc-biblioref">2017</a>)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="korrespondenssianalyysin-teoriaa.html#cb28-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&#39;img/CAquality.png&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:projectionimg1"></span>
<img src="img/CAquality.png" alt="Pisteen projektio aliavaruuteen" width="70%" />
<p class="caption">
Kuva A.1: Pisteen projektio aliavaruuteen
</p>
</div>
<p>Kuvassa on esitetty korrespondenssianalyysin ratkaisun minimointiongelma. Pisteen projektio on sitä parempi mitä pienempi kulma on sentroidista pisteeseen piirtetyn janan ja pisteen projektion välillä. COR - tunnusluku ca-funktion
numeerisissa tuloksissa. Kuvasta voi myös hahmottaa sen periaatteen, että projektiossa kaukana olevat pisteet ovat kaukana myös alkuperäisessä avaruudessa. Projektiossa lähekkäin olevat pisteet voivat olla kaukana toisistaan, mutta jos niiden projektion laatu on huono ne voivat olla alkuperäisessä avaruudessa etäällä toisistaan.</p>
</div>
<div id="matriisit-ja-niiden-havainnollistaminen" class="section level2">
<h2><span class="header-section-number">A.2</span> Matriisit ja niiden havainnollistaminen</h2>
<p><strong>edit</strong> Nämä tässä varalla, jos matriisikaavoja tarvitaan lisää. Ehkä ei?</p>
<p><span class="math display">\[\begin{equation}
A = \begin{bmatrix}
    a_{11} &amp; a_{12} &amp; \dots &amp; a_{1k}\\
    \vdots &amp; \ddots &amp; \\
    \\
    \vdots \\
    a_{n1} &amp; \dots  &amp; \dots &amp; a_{nk}
    \end{bmatrix}
\end{equation}\]</span></p>
<p>Ehkäpä ABBA onnistuu paremmin tällä notaatiolla?</p>
<p><span class="math display">\[\begin{equation}
A = \begin{bmatrix}
    A_{11} &amp; B_{12}  \\
    B_{21} &amp; A_{22}
    \end{bmatrix}
\end{equation}\]</span></p>
<p>Pinottujen ja konkatenoitujen matriisien havainnollistaminen?</p>
<p><span class="math display">\[\begin{equation}
A = \begin{bmatrix}
    A_{maa, Q1a} &amp; A_{maa, Q1b}  \\
    B_{gage, Q1a} &amp; B_{gage, Q1b}
    \end{bmatrix}
\end{equation}\]</span></p>
<p>Yksinkertainen korrespondenssianalyysi on kahden luokittelumuuttujan määrittelmän
frekvenssitaulukon analyysiä. Taulukon rivit ovat havaintoyksiköiden (individuals,
havaintoyksikkö) aggregoituja summia, sarakkeet muuttujia.</p>
<p>Analyysissä osa riveistä tai sarakkeista voidaan jättää pois ratkaisun
laskennasta ns. passiviisiksi, ja esittää kartalla täydentävinä pisteinä
(supplementary points). Ne eivät vaikuta ratkaisuun, eli teknisesti niiden massa
on nolla, mutta pisteiden esityksen (projektion) tarkkuus voidaan arvioida.
Täydentävien profiilien on kuintenkin oltava yhteismitallisia taulukon datan
kanssa. Mikä tahansa ei käy (kts. CAinP, vast.luku).</p>
<p>Pinotut tai yhdistetyt matriisit (``stacked matrices’’).
Yksinkertainen korrespondenssianalyysi on kahden luokittelumuuttujan määrittämän
taulukon analyysiä, mutta sitä voi soveltaa myös usean muuttujan analyysiin.
Menetelmän matemaattinen perusta ja ratkaisualgoritmi (SVD) toimivat, tulkinta
vain muuttuu.</p>
<p>Yksinkertaisin laajennus on lisätä alkuperäisen taulukon alle toinen taulukko.
Rivit ovat esimerkissä maittan summattuja vastauksia, ja niiden alle voidaan
lisätä joku toinen luokittelumuuttuja. Havaintojen määrä yhditetyssä (“pinotussa”)
taulussa kaksinkertaistuu. Miksi tämä ei ei vaikuta tuloksiin vääristävästi??</p>
<p>Merkitään edellisten analyysien kuuden maan ja viiden vastausvaihtoehdon
taulukkoa matriisilla <span class="math inline">\(\boldsymbol{ A}_{I J}\)</span>, missä <span class="math inline">\(I\)</span> on rivien ja <span class="math inline">\(J\)</span>
sarakkeiden lukumäärä. Taulukoidaan ikäluokan (1 - 6) ja sukupuolen (<span class="math inline">\(f\)</span> = nainen,
<span class="math inline">\(m\)</span> = mies) vuorovaikutusmuuttuja (<span class="math inline">\(f1,\dots , f6\)</span> ja <span class="math inline">\(m1,\dots , m6\)</span>) samojen
vastausvaihtoehtojen kanssa. Jos tätä taulukkoa merkitään matriisilla
<span class="math inline">\(\boldsymbol{ B}_{I^{`} J}\)</span>, voimme muodostaa yhdistetyn matriisin</p>
<p>Rivien lukumäärä on molemmissa matriiseissa sama, koska luokkia sattuu olemaan
kuusi sekä maa- että ikä- ja sukupuoli - luokittelumuuttujissa. Kun matriisit
ovat dimensioiltaan ja myös muuttujien sisällön kannalta samankaltaiset, niitä
kutsutaan yhteensopiviksi (``matched matrix’’). Tällöin yksinkertaista
korrespondenssianalyyisä voi soveltaa tutkimusongelmaan, jossa halutaan erotella
jonkun ryhmän sisäinen vaihtelu ryhmien välisiestä vaihtelusta.
(Greenacren ehdottama ABBA - analyysi).</p>
<p>ABBA on erityistapaus yleisemmästä moniulotteisen taulukon (multiway table) analyysistä,
jossa useita kahden muuttujan taulukoita ``pinotaan’’ päällekkäin ja rinnakkain.
Voimme ottaa yhden kysymyksen vastausten lisäksi analyysiin mukaan useamman
kysymyksen vastaukset laajentamalla kahden päällekkäisen matriisin taulukkoa oikealle.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="yhteenveto.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="suomenkielinen-lomake-esimerkki.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["JH_capaper.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
