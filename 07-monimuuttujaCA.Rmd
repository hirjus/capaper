# Monimuuttuja-korrespondenssianalyysi (MCA)

Usean muuttujan samanaikainen analyysi voidaan korrespondenssianalyysissä
jakaa kahteen erialaiseen tutkimusasetelmaan.  Ensimmäisessä tutkitaan kahden
erilaisen muuttujaryhmän välisiä suhteita, toisessa yhden homogeenisen
muuttujaryhmän sisäisiä suhteita.

Esimerkkiaineistossa haastateltavien
vastaukset substanssikysymyksiin ovat oma ryhmänsä ja taustamuuttujat toinen
ryhmä. Kahden muuttujaryhmän välisiä suhteita voidaan tutkia rakentamalla
yhdistetty matriisi useasta kahden muuttujan ristiintaulukoinnista. 
Tämä pinottujen ja yhdistettyjen (stacked and concatenated) taulukoiden
menetelmä (CAiP s. 129) ei kerro muuttujaryhmien sisäisistä yhteyksistä,
joita edellä analysoitiin vuorovaikutusmuuttujien avulla.

Toinen asetelma on keskenään homogeenisten muuttujien välisten suhteiden analyysi.
Monimuuttujakorrespondenssianalyysi (multiple correspondence analysis, MCA)
soveltuu hyvin kyselytutkimusten vastausten analyysiin. MCA - kartoilla voidaan
esitttää myös havainnot yksittäiset havainnot, mutta usein on järkevämpää
käyttää kartalla taustamuuttujien keskiarvopisteitä. Keskiarvopisteisiin voi simuloimalla lisätä
luottamusellipsit (CAiP, s. 299).

Esitän molemmista analyyseistä yhden esimerkin. MCA-esimerkissä otan käyttöön
kaikki aineiston havainnot ja useita vastausmuuttujia, puuttuvat tiedot ovat
mukana yhtenä luokittelumuuttujan arvona.

Yksinkertaisen korrespondenssianalyysin yleistys usean muuttujan samanaikaiseen
analyysiin ei ole aivan yksikertainen asia. Silti MCA toimii käytännössä usein
hyvin juuri kyseltutkimusten analyysissä. Vaikka geometrinen tulkinta ei ole
läheskään niin selkeä kuin yksinkertaisessa korrespondenssianalyysissä,
skaalaustulkinta on pätevä. MCA-kartat esittävät luokittelumuuttujien arvot
optimaalisesti, kartalla esitettyjen havaintopisteiden hajonta on maksimaalinen
[@RefWorks:doc:5a857a44e4b0ed2d44664d84 , s. 447, kts. myös Liite 1].


## Pinotut ja yhdistetyt taulukot

Pinottujen taulukoiden idea on esitetty kuvassa \@ref(fig:stackedimg1). Taulukossa
kaksi "selitettävää" muuttujaa on ristiintaulukoitu kolmen taustamuuttujan kanssa.

Jos reunajakaumat ovat samat eli puuttuvia tietoja ei ole, taulukon kokonaisinertia
on osataulukoiden inertioiden keskiarvo. Taulukon analyysi on yhden kysymyksen
ja yhden taustamuuttujan parittaisten suhteiden analyysiä, yksi pari kerrallaan.

Pierre Bourdieun tunnettu tutkimus La Distiction (1979) sovelsi tätä menetelmää.
Ranskan väestö luokitellaan ammattiryhmiin ja taulukoidaan useiden elämäntapaa
kuvaavien muuttujien kanssa. Taulukot yhdistetään pinoamalla ne
päällekkäin ( @RefWorks:doc:5ab76b43e4b003f4468d1f07 , s.21).


```{r stackedimg1, out.width='50%', echo=FALSE, fig.align='center',fig.cap='Pinotut ja yhdistetyt taulut - periaate'}

knitr::include_graphics('img/stacked1.png')

```

Seuraavassa esimerkissä "selitettäviä" luokittelumuuttujia on vain yksi. Tällainen
pinotun taulun analyysi on eräänlainen kaikkien siihen kuuluvien taulukoiden 
"keskiarvokartta" (CAiP, s 136). Kysymyksen Q1b vastauksten ristiintaulkointi
ikäluokan ja sukupuolen kanssa liitetään maarivien taulukkoon.

Pisteiden määrä kartoilla kasvaa, ja muuttujanimiä joudutaan tiivistämään.
Toinen tekninen detalji on kartan kääntäminen. Kuvat kääntyvät herkästi akselien
ympäri, vertailun helpottamiseksi koordinaattien etumerkkejä joutuu joskus
muuttamaan (kts. Liite 3: R-koodi).


```{r concatDat1, echo=F}

# Data
ISSP2012Concat1jh.dat <- select(ISSP2012esim1b.dat, Q1b, maa,sp, age_cat)

# mjca-funktiota ->  Burt-matriisi
Concat1jh.Burt <- mjca(ISSP2012Concat1jh.dat, ps="")$Burt

# Burt-matriisi symmetrinen
#dim(Concat1jh.Burt)
# 19 x 19
#rownames(Concat1jh.Burt)
#[1] "Q1bS"     "Q1bs"     "Q1b?"     "Q1be"     "Q1bE"     "maaBE"    "maaBG"    "maaDE"    "maaDK"
#[10] "maaFI"    "maaHU"    "spm"      "spf"      "age_cat1" "age_cat2" "age_cat3" "age_cat4" "age_cat5"
#[19] "age_cat6"

# maat - vastaukset
ISSP2012Concat2jh.dat <- Concat1jh.Burt[6:11, 1:5]
# ISSP2012Concat2jh.dat
# sukupuoli ja vastaukset
ISSP2012Concat2jh.dat <- rbind(ISSP2012Concat2jh.dat, Concat1jh.Burt[12:13 ,1:5])
# ISSP2012Concat2jh.dat
# ikäluokka ja vastaukset
ISSP2012Concat2jh.dat <- rbind(ISSP2012Concat2jh.dat, Concat1jh.Burt[14:19 ,1:5])
# ISSP2012Concat2jh.dat

Concat1jh.CA1 <- ca(ISSP2012Concat2jh.dat)

```



```{r concatSiisti1, echo=F}

# Käännetään kuva x-akselin ympäri
Concat1jh.CA1$rowcoord[, 2] <- -Concat1jh.CA1$rowcoord[, 2]
Concat1jh.CA1$colcoord[, 2] <- -Concat1jh.CA1$colcoord[, 2]

# Siistitään muuttujien nimet
Concat1jh.CA1$colnames <- c("S", "s", "?", "e", "E")
Concat1jh.CA1$rownames <- c("BE", "BG", "DE", "DK", "FI", "HU", "m", "f",
                            "a1", "a2", "a3", "a4", "a5", "a6")

```



```{r concat1map1, echo = FALSE, fig.cap= "Q1b: Lapsi kärsii jos äiti käy työssä", fig.asp = 1, out.width = "90%",fig.align = "center"}

# pisteiden kasautumien haittaa haittaa tulkintaa

par(cex = 0.6) 
plot(Concat1jh.CA1,
     main = "Pinottu taulukko - symmetrinen kartta",
     sub = "ikäluokat a1-a6, m = miehet, f = naiset"
     )

```


Tulkinta ei muutu, eikä maapisteiden sijaintikaan.

Koko aineiston kartassa ikäluokkapisteet ja sukupuolipisteet ovat pakkautuneet
maapisteitä tiiviimmin origon ympärille. Ikäluokkapisteiden (koko aineiston
keskiarvot) selvä kontrasti on vanhimman (a6)ja toiseksi
nuorimman välillä 1. dimenision suuntaan. 

Ikäluokkapisteet ovat koko aineiston keskiarvopisteitä, niiden sijantia voi
tulkita pistejoukko kerrallaan kuten maapisteidenkin. Naispiste on tiukassa
nipussa ikäluokkien a3 ja a4 kanssa aivan origon vasemmalla puolella. Miesten
keskiarvopiste on hieman origosta oikealle,yhdessä ikäluokan a5 kanssa.


Lisäpisteet on hyvin esitetty, niiden etäisyyksiä voi luotettavasti arvioida
kuvasta. Poikkeus on nuorin ikäluokka (a1, qlt = 501). Inertian osuudet (inr)
ovat yhtä vaatimattomia kuin Belgian (28) ja Saksan (29),
(m =20, f = 17, a2 = 40, a6 = 83), samoin kontribuutiot akseleiden inertiaan.
1. dimension kontribuutio (ctr) on suuri (>800) kaikilla paitsi nuorimmalla
ikäryhmällä (a1) jolla 2. dimension selittää lähes puolet sen inertiasta (470).
En esitä numeerisa tuloksia tarkemmin.

Karttaa vertaa karttaan \@ref(fig:gaCA1map) jossa on esitetty iän ja sukupuolen
yhteisvaikutusmuuttuja. Pinottu taulu on vaihtoehtoinen tapa, ja kartasta 
\@ref(fig:concat1map1) voi päätellä samat asiat: miehet ovat konservatiivisempia
kuin naiset, iäkkäämmät ovat konservatiivisempia kuin nuoret. Nuorin ikäluokka
poikkeaa muista.




```{r concatCA1num, echo=FALSE, eval=FALSE}

summary(Concat1jh.CA1)

# 14 riviä, inertiakontribuution keskiarvo
# 1000/14 = 71 

```



```{r concat1map2,echo=F, fig.cap= "Q1b: Lapsi kärsii jos äiti käy työssä", fig.asp = 1, out.width = "90%",fig.align = "center"}

par(cex = 0.6)
plot(Concat1jh.CA1, map = "rowgreen",
     #mass = c(TRUE, TRUE) ei oikein erotu kuvassa
     contrib =c("relative", "absolute"),
     arrows = c(FALSE, TRUE),
     main = "Pinottu taulukko, kontribuutiokartta (sarakkeet absoluutinen, rivit suhteellinen)",
     sub =  "taustamuuttujat a1-a6 ikäluokat, m = miehet, f = naiset"
     )

```

Kontribuutionkartan sarekkeista E-sarake (täysin eri mieltä) määrittää akseleita
vahvasti, kontrastina kaksi konservatiivista vastausta (S ja s) ja myös
neutraali vaihtoehto (e). Numeeriset tulokset kertovat, että ikäluokat
vaikuttavat juuri ensimmäiseen tärkeimpään dimensioon.

Belgian ja Saksan pisteet on esitetty kartassa huonosti, samoin nuorin ikäluokka.
Muiden pisteiden sijaintia voidaan arvioida myös sarakkeiden ja rivipisteiden
välillä. Ikäluokkien kontrasti on selvä toiseksi nuorimman (a2) ja vanhimman (a6)
välillä.

Kontribuutiokartalla voi arvioida hieman tarkemmin ikäluokkien ja vastausvaihtoehtojen
yhteyttä sarake kerrallaan. Maltillisesti eri mieltä olevien osuus on suhteellisesti 
suurin nuorimmassa ikäluokassa. Jos a1 - pisteen projisoi konservatiivisen
S-vastauksen janalle se ei ikäluokista konservatiivisin. Ikäluokat a2 ja a6 ovat
ääripäitä, muut ikäluokat sijoittuvat lähelle toisiaan mutta liberaalille puolelle.


Esimerkkiaineistossa ei ole puuttuvia tietoja. Ne olisivatkin
pulmallisia, varianssin dekomponointi ei onnistu jos reunajakaumat ovat
alitaulukoissa selvästi erilaisia.


Matriisien yhdistely on monipuolinen laajennus. Eräs kiinnostava malli on 
ABBA, kahden rakenteeltaan samanlaisen matriisin yhdistäminen lohkoina. Nimi
kertoo yhdistetyn matriisin rakenteen (block circulant matrix),
päällekkäin pinotut A ja B liitetään toiseen pinottuun matriisiin B ja A.
Matriiseilla on samat rivit ja sarakkeet, esimerkiksi miesten ja naisten
vastausprofiilit yhteen kysymykseen maittain luokiteltuina.Kokonaisinertia
saadaan dekomponoitua ryhmien sisäiseen ja väliseen hajontaan kahdelle kartalle.
Toinen kuvaa maiden välisiä eroja ja toinen maiden sisäisiä sukupuolten välisiä
eroja (CAiP ss. 177-)


## MCA - monimuuttujakorrespondenssianalyysi

MCA on yhdistettyjen (”pinottujen”)  taulukoiden erikoistapaus, samantyyppiset
muuttujat taulukoidaan keskenään. Tulos riippuu siis vain muuttujien
parittaisista yhteyksistä.


Tätä ”supertaulukkoa” kutsutaan _Burtin matriisiksi_.
_Indikaattorimatriisi_ on toinen tapa esittää data. Indikaattorimatriisin
sarakkeet ovat luokittelumuuttujan arvoja (kategorioita) ja rivit yksittäisiä
vastausprofiileja. Profiilissa on rivi nollia ja ykkösiä, 1 valitun vaihtoehdon
sarakkeessa.

En tässä jaksossa esitä numeerisia tuloksia, niiden tutkimisella voi jatkaa
analyysiä.

Tavoite on tutkia seitsemän kysymyksen vastausvaihtoehtojen yhteyksiä,
miten ne asettuvat kaksiulotteiselle kartalle. Aikaisemmissa jaksoissa etsittiin
yhteyksistä uusia piirteitä ja tarkennettiin analyysiä. Nyt hahmotetaan ison
aineiston muuttujien välisiä yhteyksiä ja erityisesti puuttuvien tietojen ongelmaa.

Koko datassa (kts. luku 2) on 32823 havaintoa 25 maasta. Niistä täydellisiä on
71 prosenttia. Jos valitaan kuusi taustamuuttujaa (edu, sosta, urbru,
maa, ika, sp) ja seitsemän kysymystä, täydellinen havaintoja on 81 prosenttia.

Pelkissä kysymyksissä (Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b) puuttuvia tietoja on
14 prosentissa havaintoja (4554). Kaikkien puutteellisten havaintojen poistamien
(”listwise delete”) on sitä huonompi vaihtoehto mitä enemmän muuttujia on.

Kaikissa kysymyksissä on viisi vastausvaihtoehtoa ja kuudes kategoria puuttuvalle
tiedolle.


```{r 07mcaIsodat1, echo=F, include=F, error= TRUE}
# Tätä dataa ei käytetä - pelkät kysymykset
# str(ISSP2012jh1d.dat) - luotu skripteissä G1_1_data2.Rmd ja G1_1_data_fct1.Rmd
# Tarkistukset näkyvät Galkussa - tässä ei tulosteta
# Kommentoidaan pois tarkistuksia (14.11.2020)
#Valitaan muuttujat joissa puuttuva tieto on koodattu muuttujan arvoksi

MCAvars1 <-  c("Q1am","Q1bm", "Q1cm", "Q1dm","Q1em","Q2am","Q2bm","edum",
                 "sostam", "urbrum", "maa", "ika", "sp" )

MCAdata1jh.dat <- ISSP2012jh1d.dat %>% select(all_of(MCAvars1))

#dim(MCAdata1jh.dat)
# names(MCAdata1jh.dat)

# luodaan ikaluokka-muuttuja ja ikäluokka-sukupuoli - muuttuja
#age_cat
#ikä 1=15-25, 2 =26-35, 3=36-45, 4=46-55, 5=56-65, 6= 66 and older

MCAdata1jh.dat <- mutate(MCAdata1jh.dat, age_cat = ifelse(ika %in% 15:25, "1",
                                ifelse(ika %in% 26:35, "2",
                                ifelse(ika %in% 36:45, "3",
                                ifelse(ika %in% 46:55, "4",
                                ifelse(ika %in% 56:65, "5", "6"))))))

# str(MCAdata1jh.dat$age_cat)

MCAdata1jh.dat <- MCAdata1jh.dat %>%
        mutate(age_cat = as_factor(age_cat))
#tarkastuksia - outo järjestys
#levels(MCAdata1jh.dat$age_cat)
# str(MCAdata1jh.dat$age_cat)

MCAdata1jh.dat<- MCAdata1jh.dat %>%
        mutate(age_cat = fct_relevel(age_cat,
                                   "1",
                                   "2",
                                   "3",
                                   "4",
                                   "5",
                                   "6"))

# Tarkistuksia(16.10.20)

#MCAdata1jh.dat %>%
#        tableX(maa,age_cat,type = "count") #%>%
#        #kable(digits = 2, caption = "Ikäluokka age_cat")

#MCAdata1jh.dat %>%
#        tableX(maa,age_cat,type = "row_perc") #%>%
#        #kable(digits = 2, caption = "age_cat: suhteelliset frekvenssit")


# Ikäluokka-sukupuoli - muuttuja
MCAdata1jh.dat <- mutate(MCAdata1jh.dat,
                             ga = case_when((age_cat == "1")&(sp == "m") ~ "m1",
                                (age_cat == "2")&(sp == "m") ~ "m2",
                                (age_cat == "3")&(sp == "m") ~ "m3",
                                (age_cat == "4")&(sp == "m") ~ "m4",
                                (age_cat == "5")&(sp == "m") ~ "m5",
                                (age_cat == "6")&(sp == "m") ~ "m6",
                                (age_cat == "1")&(sp == "f") ~ "f1",
                                (age_cat == "2")&(sp == "f") ~ "f2",
                                (age_cat == "3")&(sp == "f") ~ "f3",
                                (age_cat == "4")&(sp == "f") ~ "f4",
                                (age_cat == "4")&(sp == "f") ~ "f4",
                                (age_cat == "5")&(sp == "f") ~ "f5",
                                (age_cat == "6")&(sp == "f") ~ "f6",
                                TRUE ~ "missing"
                                ))


#Sosiaalinen status: oma arvio "Top-Bottom self-placement"
#str(ISSP2012jh1d.dat$sosta)
#str(ISSP2012jh1d.dat$urbru)
#str(ISSP2012jh1d.dat$edu)
#Koulutustaso
#str(ISSP2012jh1d.dat$edu)

#Asuipaikka
#str(ISSP2012jh1d.dat$urbru)

# Muunnetaan faktorimuuttujia, mahdollisimman lyhyet tunnisteet kategorioille
MCAdata1jh.dat <- MCAdata1jh.dat %>%
mutate(E = fct_recode(edum,
        "1" = "No formal education",
        "2" = "Primary school (elementary school)",
        "3" = "Lower secondary (secondary completed does not allow entry to university: obligatory school)",
        "4" = "Upper secondary (programs that allows entry to university",
        "5" = "Post secondary, non-tertiary (other upper secondary programs toward labour market or technical formation)",
        "6" = "Lower level tertiary, first stage (also technical schools at a tertiary level)",
        "7" = "Upper level tertiary (Master, Dr.)",
        "P" = "missing"),
       S = fct_recode(sostam,
         "1" = "Lowest, Bottom, 01",
         "2" = "02",
         "3" = "03",
         "4" = "04",
         "5" = "05",
         "6" = "06",
         "7" = "07",
         "8" = "08",
         "9" = "09",
         "10"= "Highest, Top, 10",
         "P" = "missing"),
       U = fct_recode(urbrum,
        "1" = "A big city",
        "2" = "The suburbs or outskirts of a big city",
        "3" = "A town or a small city",
        "4" = "A country village",
        "5" = "A farm or home in the country",
        "P" = "missing")
        )

#names(MCAdata1jh.dat)
#dim(MCAdata1jh.dat)
#MCAdata1jh.dat$E %>% levels()
#MCAdata1jh.dat$S %>% levels()
#MCAdata1jh.dat$U %>% levels()
#MCAdata1jh.dat$age_cat %>% levels()
#str(MCAdata1jh.dat$ga) # toimiikohan - chr-muuttuja? (16.10.20)

MCAdata1jh.dat <- MCAdata1jh.dat %>%
mutate(gaf = as_factor(ga))

#str(MCAdata1jh.dat$gaf)
#levels(MCAdata1jh.dat$gaf) # järjestyksellä ei liene väliä? (16.10.20)

# gaf ja ga: sama järjestys

MCAdata1jh.dat <- MCAdata1jh.dat %>%
       mutate(gaf = fct_relevel(gaf,
                                 "f1",
                                 "f2",
                                 "f3",
                                 "f4",
                                 "f5",
                                 "f6",
                                 "m1",
                                 "m2",
                                 "m3",
                                 "m4",
                                 "m5",
                                 "m6"))

# Lopuksi substanssimuuttutien nimet lyhyiksi

MCAdata1jh.dat <- MCAdata1jh.dat %>% mutate(a1 = Q1am,
                                            b1 = Q1bm,
                                            c1 = Q1cm,
                                            d1 = Q1dm,
                                            e1 = Q1em,
                                            a2 = Q2am,
                                            b2 = Q2bm)


```

```{r 07MCAdataTarkistus,echo=FALSE, error= TRUE, include=FALSE}

# Tarkistustuksia datalle

# MCAdata1jh.dat %>% tableX (a1, Q1am)
# MCAdata1jh.dat %>% tableX (b1, Q1bm)
# MCAdata1jh.dat %>% tableX (c1, Q1cm)
# MCAdata1jh.dat %>% tableX (d1, Q1dm)
# MCAdata1jh.dat %>% tableX (e1, Q1em)
# MCAdata1jh.dat %>% tableX (a2, Q2am)
# MCAdata1jh.dat %>% tableX (b2, Q2bm)
# MCAdata1jh.dat %>% tableX(gaf, ga)

# Perustietoja - TÄSSÄ UUSI PDF-VIRHEILMOITUS 7.11.2020
# Ei tulosteta - kommentoidaan pois

#MCAdata1jh.dat %>% tableX (maa,a1, type = "row_perc")
#MCAdata1jh.dat %>% tableX (maa,b1, type = "row_perc")
#MCAdata1jh.dat %>% tableX (maa,c1, type = "row_perc")
#MCAdata1jh.dat %>% tableX (maa,d1, type = "row_perc")
#MCAdata1jh.dat %>% tableX (maa,e1, type = "row_perc")
#MCAdata1jh.dat %>% tableX (maa,a2,type = "row_perc")
#MCAdata1jh.dat %>% tableX (maa,b2,type = "row_perc")

#MCAdata1jh.dat %>% tableX(gaf, ga,type = "row_perc")
#MCAdata1jh.dat %>% tableX(maa, age_cat,type = "row_perc")
#MCAdata1jh.dat %>% tableX(maa, gaf,type = "row_perc")
#MCAdata1jh.dat %>% tableX(maa, S, type = "row_perc")
#MCAdata1jh.dat %>% tableX(maa, U, type = "row_perc")
#MCAdata1jh.dat %>% tableX(maa, E, type = "row_perc")

```




```{r MCAmissing,  eval = FALSE, echo = FALSE}

#Puuttuvien tietojen yleiskuva

# Puuttuvat tiedot aineistossa - viite datan dokumentointiin jossa taulukot.
# Vaihtelee maittain ja muuttujittain, paljon.

# Koko data (G1_1_data2.Rmd - skriptissä valitut muuttujat ja 25 maata)
#
#sum(!complete.cases(ISSP2012jh1d.dat)) = 9455
#dim(ISSP2012jh1d.dat) = 32823
#9455/32823 = 0.2880602

# Puuttuvat tiedot valitussa MCA-aineistossa

#missingMCAvars1 <-  c("Q1a","Q1b", "Q1c", "Q1d","Q1e","Q2a","Q2b","edu",
#                 "sosta", "urbru", "maa", "ika", "sp" )
#missingTestMCA1.dat <- ISSP2012jh1d.dat %>% select(all_of(missingMCAvars1))

#sum(!complete.cases(missingTestMCA1.dat)) = 6101
#dim(missingTestMCA1.dat) = 32823
#6101/32823 = 0.1858758 Puuttellisten havaintojen osuus.

#Pelkät kysymykset

#missingMCAvars2 <- c("Q1a","Q1b", "Q1c", "Q1d","Q1e","Q2a","Q2b")
#missingTestMCA2.dat <- ISSP2012jh1d.dat %>% select(all_of(missingMCAvars2))
#sum(!complete.cases(missingTestMCA2.dat))
# puuttuvia tietoja 4554
# 4553/32823 = 0.1387137

```



```{r MCA1, echo=F}

# Valitaan data

mcaDat11jh.dat <- MCAdata1jh.dat %>% select(a1,b1,c1, d1, e1,a2,b2)
# dim(mcaDat11jh.dat)

#glimpse(mcaDat11jh.dat)

Qmuuttujat1.mca <- mjca(mcaDat11jh.dat, ps="")

# ps="" muuttujan ja sen kategorian eroitinmerkki

```



```{r MCA1map1,echo=F, fig.cap= "MCA: Seitsemän kysymystä - 25 maata, kartta 1", fig.asp = 1, out.width = "90%",fig.align = "center"}

par(cex = 0.6)
plot.mjca(Qmuuttujat1.mca, labels = c(1,2),
          main = "Symmetrinen kartta",
          sub = "Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, vastaukset S-s-?-e-E-P "
          )


```

Inertian selitysosuudet ovat paljon pienempiä, ja ratkaisu
on selvästi kaksiulotteinen. Puuttuvat vastaukset erottuvat omana ryhmänä, ja
varsinaiset vastaukset ovat pakkautuneet y-akselin oikealle puolelle. Niiden erot
näkyvät vain toisessa dimensiossa. Ensimmäinen dimensio kuvaa vastaamattomuutta,
kontrastina kaikki vastauskategoriat. Kokonaisinertiaa on korjattu
pienemmäksi (ns. adjusted inetia, kts. liite 1).

Pystyakselin suuntaan kontrasti näyttäisi olevan konservatiiviset ylhäällä,
modernit ja liberaalimmat alhaalla. Pisteitä on vaikea erottaa toisistaan.

Karttaa voi parantaa lisäämällä siihen vastaajien pisteet.


```{r  MCA1map2,echo=F, fig.cap= "MCA: Seitsemän kysymystä - 25 maata, kartta 2", fig.asp = 1, out.width = "90%",fig.align = "center"}

par(cex=0.6)
plot.mjca(Qmuuttujat1.mca, what = c("all","all"),labels = c(0,2),
          col = c("lightblue", "red"),
           main = "Symmetrinen kartta",
          sub = "Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b,vastaukset S-s-?-e-E-P, havainnot (n = 32 823)"
          )


```

Jokainen havainto on sarakevektoreiden keskiarvopiste. Sarakevektoreita ei voi
tulkita yhtä selkeästi kuin yksinkertaisessa korrespondenssianalyysissä. Ne eivät
edusta kysymystä vaan kysymyksen yhtä vastauskategoriaa.

Pistepilven muoto näyttää, miten pienenevä joukko vastaajia lähestyy kiilana
puuttivien tietojen pisteitä. Kaikkiin kysymyksiin vastanneet ovat massana kuvan
oikeassa laidassa. Pistepilvet oikealta vasemmalle kuvaavat kuinka moneen
kysymykseen on jätetty vastaamatta.


**Osajoukon MCA**

Osajoukon MCA sopii hyvin sekä puuttuvien tietojen että täydellisten vastausten
analyysiin. Asymmetrisessä kartassa sarakkeet skaalautuvat  pois orgiosta ja
näkyvät paremmin. Kuvaan on piirretty havaintopisteet, joista voi hahmottaa
havaintojen sijoittumista kartalla.


```{r subsetMCA1, echo=F}

#subsetcat viittaa muuttujan luokkien indeksiin

eiPvastaukset <- (1:42)[-c(6,12,18,24,30,36,42)]
# eiPvastaukset
#  puuttuva tieto on kuudes kategoria kaikilla kysymyksillä
# 1  2  3  4  5  7  8  9 10 11 13 14 15 16 17 19 20 21 22 23 25 26 27 28 29 31
# 32 33 34 35 37 38 39 40 41

#mcaDat11jh.dat[1:5,]

Qmuuttujat2.mca <- mjca(mcaDat11jh.dat, ps="", subsetcat=eiPvastaukset)


```

```{r subsetMCA1map1,echo=F, fig.cap= "MCA: Seitsemän kysymystä - 25 maata, kartta 3", fig.asp = 1, out.width = "90%",fig.align = "center"}

# subsetcat viittaa muuttujan luokkien indeksiin

eiPvastaukset <- (1:42)[-c(6,12,18,24,30,36,42)]

# eiPvastaukset
#  puuttuva tieto on kuudes kategora kaikilla kysymyksillä
# 1  2  3  4  5  7  8  9 10 11 13 14 15 16 17 19 20 21 22 23 25 26 27 28 29 31
# 32 33 34 35 37 38 39 40 41

# mcaDat11jh.dat[1:5,]

Qmuuttujat2.mca <- mjca(mcaDat11jh.dat, ps="", subsetcat=eiPvastaukset)

# Kontribuutiokartta on tarpeeksi selkeä, muutujien tunnukset erottuvat.
# Jätetään tämä kuva pois (25.11.20)
#
#plot.mjca(Qmuuttujat2.mca,
#          main="Seitsemän kysymystä, viisi vastausvaihtoehtoa",
#          sub = "subset: ei puuttuvien vastausten kategorioita(*P)")

```



```{r subsetMCA1map2,echo=F, eval = F, echo = F, fig.cap= "MCA: Seitsemän kysymystä - 25 maata, kartta 4", fig.asp = 1, out.width = "90%",fig.align = "center"}

# jätettään symmetrinen kartta pois, asymmetrinen on parempi (25.11.20)

plot.mjca(Qmuuttujat2.mca,
          what = c("all","all"),labels = c(0,2),
          col = c("lightblue", "red"),
          main="Seitsemän kysymystä, viisi vastausvaihtoehtoa",
          sub = "subset: ei puuttuvien vastausten kategoriaa (*P)")


```



```{r subsetMCA1map3,echo=F, fig.cap= "MCA: Seitsemän kysymystä - 25 maata, kartta 3", fig.asp = 1, out.width = "90%",fig.align = "center"}

plot.mjca(Qmuuttujat2.mca, map = "rowprincipal",
          what = c("all","all"),labels = c(0,2),
          col = c("lightblue", "red"),
          main="Asymmetrinen kartta - osajoukko: ei puuttuvia vastauksia",
          sub = "Kysymykset Q1a, Q1b, Q1c, Q1d, Q1e, Q2a, Q2b, vastaukset S-s-?-e-E")


```

Kontrasti on  "ääripäiden" välillä, vahvat mielipiteet (S ja E) hallitsevat vasenta
alakulmaa ja oikeaa laitaa x-akselin tuntumassa. Maltilliset vastaukset ja
neutraali vaihtoehto ovat ylhäällä vasemmalla. Liberaalit vastaukset ovat oikealla
ylhäällä ja jokaiselle löytää vastinparin vasemmalta alhaalta, konservatiivien
kulmasta.Konservatiivisten vastausten joukosta lähimpänä liberaalia ryvästä on
"e1S" ("Kotirouvana oleminen on aivan yhtä antoisaa kuin ansiotyön tekeminen"
- täysin samaa mieltä). Vastaavasti "a2S" ("Sekä miehen että naisen tulee
osallistua perheen toimeentulon hankkimiseen" - täysin samaa mieltä) on lähimpänä
konsertvatiivista kulmaa. Molemmat "ääripäiden maltilliset" pisteet ovat myös
omassa ryhmässään lähimpänä maltillisten ja neutraalien vastausten ryhmää.


Karttaan voi hahmotella diagonaalin suuntaisen 
akselin vahvojen mielipiteiden ryppäiden välille. Muut vastaukset ovat 
mukaisesti näiden välisellä kaarevalla linjalla (Guttman-efekti).


@RefWorks:doc:5a857a43e4b0ed2d44664d7c (s. 139-) analysoi lähes samoja kysymyksiä
ISSP-datalla 2002. Tulokset ovat hyvin samantapaisia. Karttaa \ref(fig:subsetMCA1map3)
vastaavan kuvan jatkoanalyysi on vasemman yläkulman pisteiden tarkempi analyysi.
Greenacre havaitsee, että nämä neutraalit ja maltilliset vastaukset eivät ole
hyvin esitettyjä kaksiulotteisella kartalla, vaan ne karkaavat korkeampiin
ulottuvuuksiin, "dimenisions of middleness".

Tässä aineistossa kolmiulotteinen MCA antaa samantapaisia viitteitä, mutta vain osa
keskikategeorioista on huonosti esitetty myös siinä. Huono kvaliteeetti on vain 
osalla sarakkeita (e1? 475, c1? 71 ja b1? 573).



```{r MCAnumres, echo=F, eval=F}

# pois 25.11.2020
summary(Qmuuttujat2.mca)

```






```{r MCA3d, echo =FALSE, eval = FALSE}
# Pois 25.11.2020
Qmuuttujat2d3  <- mjca(mcaDat11jh.dat, ps="", nd = 3,subsetcat=eiPvastaukset)
summary(Qmuuttujat2d3)

```

